[0m21:27:31.287927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CD112980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CFC9E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CFC9E320>]}


============================== 21:27:31.291832 | 05d76bcb-74bc-4e22-8330-c10ba6f07c62 ==============================
[0m21:27:31.291832 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:27:31.291832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m21:27:32.074572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CD397DC0>]}
[0m21:27:32.120712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CF6C6E00>]}
[0m21:27:32.122854 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:27:32.155800 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:27:32.156306 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:27:32.157319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274E86E3250>]}
[0m21:27:34.264920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274E8BE2CE0>]}
[0m21:27:34.391276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274E8B89A50>]}
[0m21:27:34.392322 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 840 macros
[0m21:27:34.392322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274E8BDB7F0>]}
[0m21:27:34.394445 [info ] [MainThread]: 
[0m21:27:34.394445 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:27:34.399327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:27:34.413769 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:27:34.413769 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:27:34.413769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:35.133337 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.719 seconds
[0m21:27:35.135495 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:27:35.262232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274E8CB1E40>]}
[0m21:27:35.263233 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:27:35.264234 [info ] [MainThread]: 
[0m21:27:35.266444 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:27:35.267796 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:27:35.267796 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:27:35.268801 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:27:35.268801 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:27:35.269818 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:27:35.270819 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:27:35.270819 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:27:35.286628 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:27:35.292323 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:27:35.294826 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:27:35.295839 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:27:35.314175 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:27:35.316221 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:27:35.318260 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:27:35.319764 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:27:35.319764 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:27:35.320786 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:27:35.320786 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:27:35.321787 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:27:35.820995 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.500 seconds
[0m21:27:35.828168 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:27:35.973900 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.70s]
[0m21:27:35.974956 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:27:36.817174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.495 seconds
[0m21:27:36.818183 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:27:36.948084 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.68s]
[0m21:27:36.949329 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:27:36.952063 [info ] [MainThread]: 
[0m21:27:36.952063 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:27:36.956383 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:27:36.960556 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:27:36.960556 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mOK[0m in 0.00s]
[0m21:27:36.961822 [info ] [MainThread]: 
[0m21:27:36.961822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:36.963173 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:27:36.964228 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:27:36.964228 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:27:36.965228 [info ] [MainThread]: 
[0m21:27:36.965228 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m21:27:36.966229 [debug] [MainThread]: Command end result
[0m21:27:37.008245 [info ] [MainThread]: 
[0m21:27:37.008245 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:27:37.009717 [info ] [MainThread]: 
[0m21:27:37.010718 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:27:37.010718 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:27:37.012074 [info ] [MainThread]: 
[0m21:27:37.012074 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:27:37.013093 [info ] [MainThread]: 
[0m21:27:37.014128 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:27:37.015382 [debug] [MainThread]: Command `dbt test` failed at 21:27:37.015382 after 5.79 seconds
[0m21:27:37.016487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CD112980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CF6C6E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274E8C7A140>]}
[0m21:27:37.017523 [debug] [MainThread]: Flushing usage events
[0m21:31:06.829671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DBDE2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DE99A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DE99A320>]}


============================== 21:31:06.833237 | 1b28d757-bfcd-43a7-932d-83178c40b4c0 ==============================
[0m21:31:06.833237 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:31:06.834252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:31:07.629067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DC067DC0>]}
[0m21:31:07.676450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DE3CAE00>]}
[0m21:31:07.677482 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:31:07.700118 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:31:07.816995 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:31:07.818025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DDDBE320>]}
[0m21:31:09.335189 [info ] [MainThread]: Test run complete! Test results are available in the log.
[0m21:31:09.645602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F763EE90>]}
[0m21:31:09.776304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F77DF010>]}
[0m21:31:09.777309 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 838 macros
[0m21:31:09.778328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F763F130>]}
[0m21:31:09.779353 [info ] [MainThread]: 
[0m21:31:09.780362 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:31:09.785318 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:31:09.798868 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:31:09.799899 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:31:09.800935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:10.486296 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.686 seconds
[0m21:31:10.487799 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:31:10.644306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F75DCB20>]}
[0m21:31:10.645345 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:31:10.646357 [info ] [MainThread]: 
[0m21:31:10.649491 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:31:10.649491 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:31:10.650889 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:31:10.651948 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:31:10.651948 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:31:10.653452 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:31:10.653452 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:31:10.654501 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:31:10.669201 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:31:10.674226 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:31:10.675268 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:31:10.682012 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:31:10.692980 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:31:10.694992 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:31:10.696480 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:31:10.697502 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:31:10.697502 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:31:10.698522 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:31:10.698522 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:31:10.699543 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:31:11.283505 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m21:31:11.289986 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:31:11.407821 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.75s]
[0m21:31:11.408845 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:31:12.212650 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.512 seconds
[0m21:31:12.214162 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:31:12.334276 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.68s]
[0m21:31:12.335311 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:31:12.337357 [info ] [MainThread]: 
[0m21:31:12.337861 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:31:12.341420 [info ] [MainThread]: Test run complete! Test results are available in the log.
[0m21:31:12.341420 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:31:12.345622 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:31:12.346631 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mOK[0m in 0.00s]
[0m21:31:12.347632 [info ] [MainThread]: 
[0m21:31:12.347632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:12.348661 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:31:12.348661 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:31:12.349662 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:31:12.349662 [info ] [MainThread]: 
[0m21:31:12.350799 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m21:31:12.350799 [debug] [MainThread]: Command end result
[0m21:31:12.391722 [info ] [MainThread]: 
[0m21:31:12.391722 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:31:12.393225 [info ] [MainThread]: 
[0m21:31:12.393225 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:31:12.394518 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:31:12.395023 [info ] [MainThread]: 
[0m21:31:12.395023 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:31:12.396068 [info ] [MainThread]: 
[0m21:31:12.396068 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:31:12.397480 [debug] [MainThread]: Command `dbt test` failed at 21:31:12.397480 after 5.64 seconds
[0m21:31:12.398511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DBDE2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DE3CAE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DC654F70>]}
[0m21:31:12.398511 [debug] [MainThread]: Flushing usage events
[0m21:32:03.499033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6EC912950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6EF4CA4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6EF4CA2C0>]}


============================== 21:32:03.502117 | ca954922-ffd4-4f16-9d85-b3e989fe23a2 ==============================
[0m21:32:03.502117 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:32:03.502117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:32:04.233049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca954922-ffd4-4f16-9d85-b3e989fe23a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6ECB9BA90>]}
[0m21:32:04.279356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca954922-ffd4-4f16-9d85-b3e989fe23a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A687E097E0>]}
[0m21:32:04.280931 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:32:04.302621 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:32:04.541406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:32:04.542417 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\display_test_results.sql
[0m21:32:04.670424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca954922-ffd4-4f16-9d85-b3e989fe23a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A687F020E0>]}
[0m21:32:04.791623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca954922-ffd4-4f16-9d85-b3e989fe23a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A687E6A9B0>]}
[0m21:32:04.792645 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 838 macros
[0m21:32:04.792645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca954922-ffd4-4f16-9d85-b3e989fe23a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A687FFE440>]}
[0m21:32:04.794147 [info ] [MainThread]: 
[0m21:32:04.795655 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:32:04.800805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:32:04.814657 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:32:04.814657 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:32:04.815700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:05.511973 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.697 seconds
[0m21:32:05.514055 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:32:05.636915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca954922-ffd4-4f16-9d85-b3e989fe23a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6882F18A0>]}
[0m21:32:05.638420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:32:05.639443 [info ] [MainThread]: 
[0m21:32:05.642711 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:32:05.642711 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:32:05.642711 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:32:05.643711 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:32:05.643711 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:32:05.644847 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:32:05.645880 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:32:05.645880 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:32:05.661959 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:32:05.668064 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:32:05.669436 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:32:05.669436 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:32:05.685520 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:32:05.688051 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:32:05.689554 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:32:05.689554 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:32:05.689554 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:32:05.690893 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:32:05.690893 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:32:05.692953 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:32:06.275867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m21:32:06.284885 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:32:06.406225 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m21:32:06.407275 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:32:07.763837 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.071 seconds
[0m21:32:07.765402 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:32:07.888956 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.24s]
[0m21:32:07.889973 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:32:07.890985 [info ] [MainThread]: 
[0m21:32:07.892164 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:32:07.897419 [debug] [MainThread]: Using snowflake connection "master"
[0m21:32:07.898497 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
SELECT COUNT(*) as count FROM some_table
[0m21:32:07.898497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:08.489827 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8002-3201-72d3-000b-f69200018046
[0m21:32:08.490900 [debug] [MainThread]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SOME_TABLE' does not exist or not authorized.
[0m21:32:08.493040 [info ] [MainThread]: Database error while running on-run-end
[0m21:32:08.493040 [debug] [MainThread]: On master: Close
[0m21:32:08.611739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:08.612794 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:32:08.612794 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:32:08.612794 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:32:08.613795 [info ] [MainThread]: 
[0m21:32:08.613795 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m21:32:08.614819 [debug] [MainThread]: Command end result
[0m21:32:08.655719 [info ] [MainThread]: 
[0m21:32:08.656822 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:32:08.657848 [info ] [MainThread]: 
[0m21:32:08.658849 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:32:08.658849 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:32:08.659850 [info ] [MainThread]: 
[0m21:32:08.660851 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:32:08.660851 [info ] [MainThread]: 
[0m21:32:08.661852 [error] [MainThread]:   on-run-end failed, error:
 002003 (42S02): SQL compilation error:
Object 'SOME_TABLE' does not exist or not authorized.
[0m21:32:08.662853 [info ] [MainThread]: 
[0m21:32:08.662853 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:32:08.664357 [debug] [MainThread]: Command `dbt test` failed at 21:32:08.664357 after 5.22 seconds
[0m21:32:08.665359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6EC912950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6882A6B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A687947760>]}
[0m21:32:08.666360 [debug] [MainThread]: Flushing usage events
[0m21:33:52.168396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988773E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988A2FA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988A2FA320>]}


============================== 21:33:52.171502 | 21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9 ==============================
[0m21:33:52.171502 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:33:52.172518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:33:52.899271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198879C7DC0>]}
[0m21:33:52.945259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019889D2AE00>]}
[0m21:33:52.946276 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:33:52.967154 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:33:53.219615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:33:53.220629 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\display_test_results.sql
[0m21:33:53.359752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A2D5FC10>]}
[0m21:33:53.490458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A2C6FD00>]}
[0m21:33:53.490458 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 839 macros
[0m21:33:53.491485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A30D7E50>]}
[0m21:33:53.492536 [info ] [MainThread]: 
[0m21:33:53.493548 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:33:53.498339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:33:53.510749 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:33:53.511936 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:33:53.511936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:54.147211 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.635 seconds
[0m21:33:54.148234 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:33:54.268217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A2ED0C70>]}
[0m21:33:54.269239 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:54.270396 [info ] [MainThread]: 
[0m21:33:54.272574 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:33:54.273595 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:33:54.273595 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:33:54.273595 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:33:54.275099 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:33:54.275099 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:33:54.276132 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:33:54.276132 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:33:54.289930 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:33:54.296107 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:33:54.297137 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:33:54.298151 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:33:54.314849 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:33:54.317928 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:33:54.318942 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:33:54.319954 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:33:54.319954 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:33:54.321090 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:33:54.321090 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:33:54.323317 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:33:54.870238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m21:33:54.877838 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:33:55.004260 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.73s]
[0m21:33:55.006287 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:33:55.878401 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.555 seconds
[0m21:33:55.879905 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:33:56.002904 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.73s]
[0m21:33:56.003905 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:33:56.005409 [info ] [MainThread]: 
[0m21:33:56.006433 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:33:56.010556 [info ] [MainThread]: Database error while running on-run-end
[0m21:33:56.011558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:56.011558 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:33:56.011558 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:33:56.012701 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:33:56.012701 [info ] [MainThread]: 
[0m21:33:56.013713 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m21:33:56.013713 [debug] [MainThread]: Command end result
[0m21:33:56.054410 [info ] [MainThread]: 
[0m21:33:56.055423 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:33:56.055423 [info ] [MainThread]: 
[0m21:33:56.056435 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:33:56.057490 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:33:56.057490 [info ] [MainThread]: 
[0m21:33:56.058503 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:33:56.059504 [info ] [MainThread]: 
[0m21:33:56.059504 [error] [MainThread]:   on-run-end failed, error:
 'display_test_results' is undefined
[0m21:33:56.060533 [info ] [MainThread]: 
[0m21:33:56.060533 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:33:56.061534 [debug] [MainThread]: Command `dbt test` failed at 21:33:56.061534 after 3.95 seconds
[0m21:33:56.062566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988773E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019889D2AE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A3566860>]}
[0m21:33:56.062566 [debug] [MainThread]: Flushing usage events
[0m21:34:23.337396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15B8CE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15E48A4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15E48A2C0>]}


============================== 21:34:23.340599 | 2b793ecb-b35c-48bf-a651-590b24829ac1 ==============================
[0m21:34:23.340599 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:34:23.341630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m21:34:24.081893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15BB57A90>]}
[0m21:34:24.127851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C176D997E0>]}
[0m21:34:24.129896 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:34:24.153980 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:34:24.268826 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:34:24.269846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15D8ACA60>]}
[0m21:34:26.013664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C176F54E20>]}
[0m21:34:26.134456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1770EF2B0>]}
[0m21:34:26.134456 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 839 macros
[0m21:34:26.135457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1770E26B0>]}
[0m21:34:26.136510 [info ] [MainThread]: 
[0m21:34:26.137518 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:34:26.142640 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:34:26.155717 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:34:26.155717 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:34:26.156770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:26.848187 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.691 seconds
[0m21:34:26.849196 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:34:26.969905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1770EF850>]}
[0m21:34:26.970922 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:34:26.970922 [info ] [MainThread]: 
[0m21:34:26.974325 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:34:26.974325 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:34:26.975828 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:34:26.975828 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:34:26.976851 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:34:26.976851 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:34:26.978004 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:34:26.978004 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:34:26.993284 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:34:26.997843 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:34:26.998861 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:34:26.999909 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:34:27.015825 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:34:27.018844 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:34:27.019845 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:34:27.020846 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:34:27.020846 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:34:27.021847 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:34:27.021847 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:34:27.023849 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:34:27.595708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m21:34:27.603160 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:34:27.623583 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m21:34:27.625627 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:34:27.724682 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.75s]
[0m21:34:27.725682 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:34:27.743598 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.77s]
[0m21:34:27.744627 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:34:27.745629 [info ] [MainThread]: 
[0m21:34:27.747010 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:34:27.751606 [info ] [MainThread]: Database error while running on-run-end
[0m21:34:27.751606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:27.752609 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:34:27.752609 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:34:27.753656 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:34:27.753656 [info ] [MainThread]: 
[0m21:34:27.754790 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m21:34:27.755791 [debug] [MainThread]: Command end result
[0m21:34:27.795099 [info ] [MainThread]: 
[0m21:34:27.796105 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:34:27.796594 [info ] [MainThread]: 
[0m21:34:27.797597 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:34:27.797597 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:34:27.798879 [info ] [MainThread]: 
[0m21:34:27.798879 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:34:27.799907 [info ] [MainThread]: 
[0m21:34:27.799907 [error] [MainThread]:   on-run-end failed, error:
 'wwe_get_node_schemas' is undefined
[0m21:34:27.800947 [info ] [MainThread]: 
[0m21:34:27.801991 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:34:27.803004 [debug] [MainThread]: Command `dbt test` failed at 21:34:27.803004 after 4.53 seconds
[0m21:34:27.803004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15B8CE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15B3B34F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15C1463B0>]}
[0m21:34:27.804038 [debug] [MainThread]: Flushing usage events
[0m21:35:07.475912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004C972980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004F52A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004F52A320>]}


============================== 21:35:07.479123 | b18c7274-a390-45d1-81e7-a0cbfdd696dd ==============================
[0m21:35:07.479123 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:35:07.480125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:08.260615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b18c7274-a390-45d1-81e7-a0cbfdd696dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004CBF7DC0>]}
[0m21:35:08.308241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b18c7274-a390-45d1-81e7-a0cbfdd696dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004EF5AE00>]}
[0m21:35:08.309260 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:35:08.330211 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:35:08.589536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:35:08.590548 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://macros\get_node_schemas.sql
[0m21:35:08.590548 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\display_test_results.sql
[0m21:35:08.740217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b18c7274-a390-45d1-81e7-a0cbfdd696dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020067EC32B0>]}
[0m21:35:08.875868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b18c7274-a390-45d1-81e7-a0cbfdd696dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020068325090>]}
[0m21:35:08.877285 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 840 macros
[0m21:35:08.878526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b18c7274-a390-45d1-81e7-a0cbfdd696dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020067EC30D0>]}
[0m21:35:08.879569 [info ] [MainThread]: 
[0m21:35:08.880622 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:35:08.886695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:35:08.901845 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:35:08.902862 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:35:08.902862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:09.554966 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.651 seconds
[0m21:35:09.556470 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:35:10.237280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b18c7274-a390-45d1-81e7-a0cbfdd696dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020068324E80>]}
[0m21:35:10.238362 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:10.239657 [info ] [MainThread]: 
[0m21:35:10.243137 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:35:10.244137 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:35:10.245189 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:35:10.245189 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:35:10.246209 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:35:10.247210 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:35:10.247210 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:35:10.248569 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:35:10.262562 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:35:10.268194 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:35:10.269223 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:35:10.275475 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:35:10.287271 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:35:10.290299 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:35:10.291461 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:35:10.292480 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:35:10.292480 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:35:10.293497 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:35:10.293497 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:35:10.294704 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:35:10.861547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m21:35:10.868974 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:35:10.986078 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.74s]
[0m21:35:10.987087 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:35:12.010182 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.715 seconds
[0m21:35:12.011685 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:35:12.131491 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.88s]
[0m21:35:12.133526 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:35:12.134527 [info ] [MainThread]: 
[0m21:35:12.135584 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:35:12.151362 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:35:12.157198 [debug] [MainThread]: Using snowflake connection "master"
[0m21:35:12.158232 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:35:12.159333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:13.220361 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.061 seconds
[0m21:35:13.221412 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:35:13.227441 [info ] [MainThread]: Database error while running on-run-end
[0m21:35:13.228459 [debug] [MainThread]: On master: Close
[0m21:35:13.355309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:13.356309 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:35:13.356309 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:35:13.356309 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:35:13.357386 [info ] [MainThread]: 
[0m21:35:13.358401 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m21:35:13.359418 [debug] [MainThread]: Command end result
[0m21:35:13.397826 [info ] [MainThread]: 
[0m21:35:13.398862 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:35:13.400365 [info ] [MainThread]: 
[0m21:35:13.400365 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:35:13.401574 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:35:13.401574 [info ] [MainThread]: 
[0m21:35:13.402586 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:35:13.402586 [info ] [MainThread]: 
[0m21:35:13.404089 [error] [MainThread]:   on-run-end failed, error:
 Required var 'dbt_date:time_zone' not found in config:
Vars supplied to dbt_dataops-on-run-end-0 = {}
[0m21:35:13.404089 [info ] [MainThread]: 
[0m21:35:13.405112 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:35:13.406113 [debug] [MainThread]: Command `dbt test` failed at 21:35:13.406113 after 5.99 seconds
[0m21:35:13.406113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004C972980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E970C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020068361330>]}
[0m21:35:13.407135 [debug] [MainThread]: Flushing usage events
[0m21:36:54.620881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022693872980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002269642E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002269642E320>]}


============================== 21:36:54.623227 | d0d01e4f-4749-4aad-89c2-0aa9c1b9508b ==============================
[0m21:36:54.623227 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:36:54.624228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:36:55.415516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022693AF7DC0>]}
[0m21:36:55.461263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022695E5AE00>]}
[0m21:36:55.462352 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:36:55.485119 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:36:55.604091 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:36:55.604091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002269584E320>]}
[0m21:36:57.398036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AF390130>]}
[0m21:36:57.521998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AF080E50>]}
[0m21:36:57.523011 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 840 macros
[0m21:36:57.523011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AF3EB400>]}
[0m21:36:57.525066 [info ] [MainThread]: 
[0m21:36:57.526089 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:36:57.530637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:36:57.543948 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:36:57.544973 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:36:57.544973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:58.243145 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.698 seconds
[0m21:36:58.244175 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:36:58.371273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AF3120E0>]}
[0m21:36:58.372304 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:36:58.372304 [info ] [MainThread]: 
[0m21:36:58.375459 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:36:58.375459 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:36:58.376505 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:36:58.376505 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:36:58.377506 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:36:58.377506 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:36:58.379046 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:36:58.379046 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:36:58.393600 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:36:58.398772 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:36:58.400275 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:36:58.401441 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:36:58.418401 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:36:58.421942 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:36:58.423445 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:36:58.423445 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:36:58.424447 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:36:58.424447 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:36:58.425448 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:36:58.426450 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:36:59.007270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m21:36:59.014486 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:36:59.137319 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m21:36:59.138558 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:36:59.965682 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.539 seconds
[0m21:36:59.967188 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:37:00.095104 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.72s]
[0m21:37:00.096110 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:37:00.096110 [info ] [MainThread]: 
[0m21:37:00.097614 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:37:00.106313 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:37:00.111489 [debug] [MainThread]: Using snowflake connection "master"
[0m21:37:00.111489 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:37:00.112500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:01.206141 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.095 seconds
[0m21:37:01.208677 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:37:01.214335 [info ] [MainThread]: Database error while running on-run-end
[0m21:37:01.215368 [debug] [MainThread]: On master: Close
[0m21:37:01.335974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:01.335974 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:37:01.336973 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:37:01.337479 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:37:01.337479 [info ] [MainThread]: 
[0m21:37:01.338402 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m21:37:01.339443 [debug] [MainThread]: Command end result
[0m21:37:01.458781 [info ] [MainThread]: 
[0m21:37:01.459784 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:37:01.459784 [info ] [MainThread]: 
[0m21:37:01.461259 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:37:01.461259 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:37:01.462297 [info ] [MainThread]: 
[0m21:37:01.462297 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:37:01.463309 [info ] [MainThread]: 
[0m21:37:01.463309 [error] [MainThread]:   on-run-end failed, error:
 Required var 'dbt_date:time_zone' not found in config:
Vars supplied to dbt_dataops-on-run-end-0 = {
    "dbt_date": {
        "time_zone": "America/New_York"
    }
}
[0m21:37:01.464337 [info ] [MainThread]: 
[0m21:37:01.464337 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:37:01.466406 [debug] [MainThread]: Command `dbt test` failed at 21:37:01.466406 after 6.92 seconds
[0m21:37:01.466406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022693872980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022695E5AE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AF7AE920>]}
[0m21:37:01.467406 [debug] [MainThread]: Flushing usage events
[0m21:37:53.791247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C28FBCE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C29278A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C29278A320>]}


============================== 21:37:53.794624 | 3798a1b5-29d4-413e-a813-e757e00bff38 ==============================
[0m21:37:53.794624 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:37:53.795648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m21:37:54.534563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3798a1b5-29d4-413e-a813-e757e00bff38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C28FE57DC0>]}
[0m21:37:54.579789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3798a1b5-29d4-413e-a813-e757e00bff38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2921BAE00>]}
[0m21:37:54.581541 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:37:54.603430 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:37:54.842718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:37:54.843733 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:37:55.028196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3798a1b5-29d4-413e-a813-e757e00bff38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AB122E00>]}
[0m21:37:55.173513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3798a1b5-29d4-413e-a813-e757e00bff38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AB5CE140>]}
[0m21:37:55.174524 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 840 macros
[0m21:37:55.175546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3798a1b5-29d4-413e-a813-e757e00bff38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AB3CFEB0>]}
[0m21:37:55.176583 [info ] [MainThread]: 
[0m21:37:55.176583 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:37:55.181586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:37:55.195915 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:37:55.197117 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:37:55.197117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:55.881700 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.684 seconds
[0m21:37:55.882727 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:37:56.010127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3798a1b5-29d4-413e-a813-e757e00bff38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AB5A9210>]}
[0m21:37:56.011177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:37:56.011177 [info ] [MainThread]: 
[0m21:37:56.014694 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:37:56.015705 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:37:56.015705 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:37:56.016789 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:37:56.016789 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:37:56.018293 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:37:56.018293 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:37:56.018293 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:37:56.033697 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:37:56.040828 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:37:56.043083 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:37:56.043083 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:37:56.058470 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:37:56.061550 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:37:56.062671 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:37:56.062671 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:37:56.064176 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:37:56.064700 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:37:56.064700 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:37:56.065727 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:37:56.568488 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m21:37:56.576144 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:37:56.694182 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.68s]
[0m21:37:56.695278 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:37:57.568283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.503 seconds
[0m21:37:57.570366 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:37:57.689698 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.67s]
[0m21:37:57.691798 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:37:57.692822 [info ] [MainThread]: 
[0m21:37:57.692822 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:37:57.709700 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:37:57.714909 [debug] [MainThread]: Using snowflake connection "master"
[0m21:37:57.715924 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:37:57.715924 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:58.752611 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.036 seconds
[0m21:37:58.753636 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:37:58.767176 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:37:58.768176 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:37:58.772728 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:37:58.774759 [debug] [MainThread]: Using snowflake connection "master"
[0m21:37:58.774759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
insert into dqm.dq_dbt_test_results_central (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(2025-02-19T21:37:57.706697 as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.6773931980133057'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(2025-02-19T21:37:57.706697 as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.6729092597961426'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
  );
[0m21:37:58.863146 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8007-3201-72d3-000b-f69200018062
[0m21:37:58.864168 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 116 unexpected 'T21'.
syntax error line 25 at position 119 unexpected ':'.
syntax error line 25 at position 120 unexpected '37'.
syntax error line 25 at position 123 unexpected '57.706697'.
syntax error line 25 at position 185 unexpected ')'.
[0m21:37:58.864168 [info ] [MainThread]: Database error while running on-run-end
[0m21:37:58.865197 [debug] [MainThread]: On master: Close
[0m21:37:58.986598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:58.986598 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:37:58.988103 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:37:58.988103 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:37:58.989152 [info ] [MainThread]: 
[0m21:37:58.989152 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m21:37:58.990166 [debug] [MainThread]: Command end result
[0m21:37:59.031635 [info ] [MainThread]: 
[0m21:37:59.031635 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:37:59.033137 [info ] [MainThread]: 
[0m21:37:59.034167 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:37:59.034167 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:37:59.035203 [info ] [MainThread]: 
[0m21:37:59.035203 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:37:59.036320 [info ] [MainThread]: 
[0m21:37:59.036320 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 25 at position 116 unexpected 'T21'.
syntax error line 25 at position 119 unexpected ':'.
syntax error line 25 at position 120 unexpected '37'.
syntax error line 25 at position 123 unexpected '57.706697'.
syntax error line 25 at position 185 unexpected ')'.
[0m21:37:59.037397 [info ] [MainThread]: 
[0m21:37:59.037901 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:37:59.038916 [debug] [MainThread]: Command `dbt test` failed at 21:37:59.038916 after 5.31 seconds
[0m21:37:59.039930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C28FBCE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AB61BC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AB616F80>]}
[0m21:37:59.039930 [debug] [MainThread]: Flushing usage events
[0m21:41:24.499236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308E54E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309110E4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309110E2C0>]}


============================== 21:41:24.502296 | 8f27274a-9ba7-4709-b8b3-a8f9073eea93 ==============================
[0m21:41:24.502296 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:41:24.503343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:41:25.252009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f27274a-9ba7-4709-b8b3-a8f9073eea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308E7D7A90>]}
[0m21:41:25.296874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f27274a-9ba7-4709-b8b3-a8f9073eea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A9A197E0>]}
[0m21:41:25.296874 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:41:25.319194 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:41:25.586117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:41:25.586117 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:41:25.745605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f27274a-9ba7-4709-b8b3-a8f9073eea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A9AA34C0>]}
[0m21:41:25.887593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f27274a-9ba7-4709-b8b3-a8f9073eea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A9F4A440>]}
[0m21:41:25.888598 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 840 macros
[0m21:41:25.889624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f27274a-9ba7-4709-b8b3-a8f9073eea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A9D4FE20>]}
[0m21:41:25.890624 [info ] [MainThread]: 
[0m21:41:25.891808 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:41:25.896928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:41:25.911138 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:41:25.911138 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:41:25.912538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:26.576344 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.664 seconds
[0m21:41:26.578384 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:41:26.700769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f27274a-9ba7-4709-b8b3-a8f9073eea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A9F26B60>]}
[0m21:41:26.702294 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:41:26.703321 [info ] [MainThread]: 
[0m21:41:26.706489 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:41:26.706489 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:41:26.707546 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:41:26.707546 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:41:26.708547 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:41:26.708547 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:41:26.709847 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:41:26.710350 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:41:26.724041 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:41:26.730660 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:41:26.730660 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:41:26.737709 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:41:26.749940 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:41:26.753393 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:41:26.755766 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:41:26.755766 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:41:26.756794 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:41:26.757810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:41:26.757810 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:41:26.758877 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:41:27.328571 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m21:41:27.336220 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:41:27.464704 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m21:41:27.465717 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:41:28.328643 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.569 seconds
[0m21:41:28.331341 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:41:28.453944 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.74s]
[0m21:41:28.456045 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:41:28.457211 [info ] [MainThread]: 
[0m21:41:28.458470 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:41:28.499373 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:41:28.531730 [debug] [MainThread]: Using snowflake connection "master"
[0m21:41:28.531730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:41:28.543802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:41:29.608919 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.067 seconds
[0m21:41:29.611452 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:41:29.632791 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:41:29.635137 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:41:29.642152 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:41:29.655707 [debug] [MainThread]: Using snowflake connection "master"
[0m21:41:29.656708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
insert into dqm.dq_dbt_test_results_central (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.756157398223877'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7441558837890625'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
  );
[0m21:41:30.018591 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.361 seconds
[0m21:41:30.019596 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.37s]
[0m21:41:30.020632 [info ] [MainThread]: 
[0m21:41:30.021654 [debug] [MainThread]: On master: Close
[0m21:41:30.140142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:30.141152 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:41:30.141152 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:41:30.142181 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:41:30.142181 [info ] [MainThread]: 
[0m21:41:30.143206 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m21:41:30.144219 [debug] [MainThread]: Command end result
[0m21:41:30.184617 [info ] [MainThread]: 
[0m21:41:30.185629 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:41:30.186797 [info ] [MainThread]: 
[0m21:41:30.187847 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:41:30.187847 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:41:30.188892 [info ] [MainThread]: 
[0m21:41:30.189891 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:41:30.190396 [info ] [MainThread]: 
[0m21:41:30.190396 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:41:30.192455 [debug] [MainThread]: Command `dbt test` failed at 21:41:30.192455 after 5.75 seconds
[0m21:41:30.192455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308E54E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A9F96200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230AA3504F0>]}
[0m21:41:30.193502 [debug] [MainThread]: Flushing usage events
[0m21:45:07.445766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217709BE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177357E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177357E320>]}


============================== 21:45:07.448785 | be0fa207-e6a0-4397-9ea9-d846260e536e ==============================
[0m21:45:07.448785 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:45:07.449788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:45:08.186805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be0fa207-e6a0-4397-9ea9-d846260e536e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021770C47970>]}
[0m21:45:08.231783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be0fa207-e6a0-4397-9ea9-d846260e536e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217729C16F0>]}
[0m21:45:08.232787 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:45:08.253020 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:45:08.489838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:45:08.489838 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m21:45:08.740726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be0fa207-e6a0-4397-9ea9-d846260e536e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170C564100>]}
[0m21:45:08.859575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be0fa207-e6a0-4397-9ea9-d846260e536e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170C5322C0>]}
[0m21:45:08.860750 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:45:08.860750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be0fa207-e6a0-4397-9ea9-d846260e536e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170C24B2B0>]}
[0m21:45:08.862773 [info ] [MainThread]: 
[0m21:45:08.862773 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:45:08.867793 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:45:08.880023 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:45:08.880023 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:45:08.881026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:09.566943 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.686 seconds
[0m21:45:09.567951 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:45:09.696002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be0fa207-e6a0-4397-9ea9-d846260e536e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170BEE23B0>]}
[0m21:45:09.696002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:45:09.697016 [info ] [MainThread]: 
[0m21:45:09.699354 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:45:09.700358 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:45:09.700358 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:45:09.701362 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:45:09.702367 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:45:09.702367 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:45:09.703377 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:45:09.703377 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:45:09.716738 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:45:09.722145 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:45:09.723149 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:45:09.724155 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:45:09.739502 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:45:09.742842 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:45:09.743847 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:45:09.744855 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:45:09.744855 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:45:09.745860 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:45:09.746864 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:45:09.746864 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:45:10.311758 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m21:45:10.318812 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:45:10.441045 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.74s]
[0m21:45:10.442049 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:45:11.241530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.495 seconds
[0m21:45:11.243625 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:45:11.361875 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.66s]
[0m21:45:11.363891 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:45:11.364895 [info ] [MainThread]: 
[0m21:45:11.364895 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:45:11.381061 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:45:11.387085 [debug] [MainThread]: Using snowflake connection "master"
[0m21:45:11.387085 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:45:11.388342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:12.378326 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.990 seconds
[0m21:45:12.379330 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:45:12.391509 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:45:12.392514 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:45:12.397717 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:45:12.398723 [debug] [MainThread]: Using snowflake connection "master"
[0m21:45:12.399754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
insert into dqm.dq_dbt_test_results_central (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7386777400970459'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.6605141162872314'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
  );
[0m21:45:12.784380 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.384 seconds
[0m21:45:12.785384 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.39s]
[0m21:45:12.786395 [info ] [MainThread]: 
[0m21:45:12.786395 [debug] [MainThread]: On master: Close
[0m21:45:12.904571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:12.906075 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:45:12.906075 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:45:12.906075 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:45:12.907243 [info ] [MainThread]: 
[0m21:45:12.908249 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m21:45:12.909253 [debug] [MainThread]: Command end result
[0m21:45:12.944919 [info ] [MainThread]: 
[0m21:45:12.944919 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:45:12.946383 [info ] [MainThread]: 
[0m21:45:12.947388 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:45:12.948437 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:45:12.948437 [info ] [MainThread]: 
[0m21:45:12.949441 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:45:12.950449 [info ] [MainThread]: 
[0m21:45:12.950449 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:45:12.951491 [debug] [MainThread]: Command `dbt test` failed at 21:45:12.951491 after 5.56 seconds
[0m21:45:12.952495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217709BE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217729C16F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170CA347C0>]}
[0m21:45:12.952495 [debug] [MainThread]: Flushing usage events
[0m21:47:32.150894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DFF22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256E2ADA4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256E2ADA2C0>]}


============================== 21:47:32.154472 | 66e036e4-4589-404c-b898-887963c70400 ==============================
[0m21:47:32.154472 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:47:32.155492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:47:32.882946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66e036e4-4589-404c-b898-887963c70400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256E01A7A90>]}
[0m21:47:32.927603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66e036e4-4589-404c-b898-887963c70400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FB3E97E0>]}
[0m21:47:32.928607 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:47:32.949924 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:47:33.196728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:47:33.196728 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:47:33.203762 [error] [MainThread]: Encountered an error:
Compilation Error
  Got a block definition inside control flow at 139:0. All dbt block definitions must be at the top level
[0m21:47:33.204778 [debug] [MainThread]: Command `dbt test` failed at 21:47:33.204778 after 1.11 seconds
[0m21:47:33.204778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DFF22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FB8C97E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FB8C9750>]}
[0m21:47:33.205783 [debug] [MainThread]: Flushing usage events
[0m21:48:41.228689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014132DD28F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001413598E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001413598E230>]}


============================== 21:48:41.231699 | 75ab98dc-989f-443d-a2ee-50ca336ea8d3 ==============================
[0m21:48:41.231699 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:48:41.232810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:48:41.949770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75ab98dc-989f-443d-a2ee-50ca336ea8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001414E2FFBB0>]}
[0m21:48:41.994625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75ab98dc-989f-443d-a2ee-50ca336ea8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014134E0B760>]}
[0m21:48:41.995628 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:48:42.015895 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:48:42.251513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:48:42.251513 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:48:42.387172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75ab98dc-989f-443d-a2ee-50ca336ea8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001414E77F7C0>]}
[0m21:48:42.509870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75ab98dc-989f-443d-a2ee-50ca336ea8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001414E3207F0>]}
[0m21:48:42.509870 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:48:42.510875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ab98dc-989f-443d-a2ee-50ca336ea8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001414E76D4B0>]}
[0m21:48:42.511879 [info ] [MainThread]: 
[0m21:48:42.512883 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:48:42.516905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:48:42.531157 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:48:42.532171 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:48:42.532171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:43.196156 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.664 seconds
[0m21:48:43.198165 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:48:43.327090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ab98dc-989f-443d-a2ee-50ca336ea8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001414E2FF700>]}
[0m21:48:43.328094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:48:43.329098 [info ] [MainThread]: 
[0m21:48:43.331109 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:48:43.332115 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:48:43.332115 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:48:43.333121 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:48:43.333121 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:48:43.334127 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:48:43.334127 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:48:43.348331 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:48:43.348331 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:48:43.355581 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:48:43.355581 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:48:43.371159 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:48:43.372275 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:48:43.375518 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:48:43.376525 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:48:43.376525 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:48:43.377532 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:48:43.378542 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:48:43.378542 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:48:43.380553 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:48:44.018359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.640 seconds
[0m21:48:44.018359 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m21:48:44.025400 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:48:44.027413 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:48:44.154137 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.82s]
[0m21:48:44.155144 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:48:44.164632 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.83s]
[0m21:48:44.165639 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:48:44.166658 [info ] [MainThread]: 
[0m21:48:44.167755 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:48:44.184455 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:48:44.189619 [debug] [MainThread]: Using snowflake connection "master"
[0m21:48:44.189619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:48:44.190624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:45.338403 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.149 seconds
[0m21:48:45.340553 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:48:45.352871 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:48:45.353876 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:48:45.358888 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:48:45.360115 [debug] [MainThread]: Using snowflake connection "master"
[0m21:48:45.361116 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
insert into dqm.dq_dbt_test_results_central (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8198411464691162'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8305048942565918'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  

  
    ) on conflict (test_sk) do nothing;
[0m21:48:45.662248 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8012-3201-7237-000b-f6920001469e
[0m21:48:45.662248 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 103 at position 6 unexpected 'on'.
[0m21:48:45.663251 [info ] [MainThread]: Database error while running on-run-end
[0m21:48:45.664255 [debug] [MainThread]: On master: Close
[0m21:48:45.783218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:45.784222 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:48:45.784222 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:48:45.784222 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:48:45.785298 [info ] [MainThread]: 
[0m21:48:45.785298 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m21:48:45.787312 [debug] [MainThread]: Command end result
[0m21:48:45.823762 [info ] [MainThread]: 
[0m21:48:45.824767 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:48:45.824767 [info ] [MainThread]: 
[0m21:48:45.825771 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:48:45.826774 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:48:45.827777 [info ] [MainThread]: 
[0m21:48:45.827777 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:48:45.828782 [info ] [MainThread]: 
[0m21:48:45.828782 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 103 at position 6 unexpected 'on'.
[0m21:48:45.829786 [info ] [MainThread]: 
[0m21:48:45.829786 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:48:45.831976 [debug] [MainThread]: Command `dbt test` failed at 21:48:45.831976 after 4.66 seconds
[0m21:48:45.831976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014132DD28F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141330F27A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141352C1AB0>]}
[0m21:48:45.832979 [debug] [MainThread]: Flushing usage events
[0m21:50:53.007157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002945F10E8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029461CCA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029461CCA230>]}


============================== 21:50:53.010414 | 8257b523-54fc-4d0e-ae25-f089c7a1dea4 ==============================
[0m21:50:53.010414 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:50:53.011589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:50:53.776064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8257b523-54fc-4d0e-ae25-f089c7a1dea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002945F397340>]}
[0m21:50:53.824213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8257b523-54fc-4d0e-ae25-f089c7a1dea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002946114B730>]}
[0m21:50:53.825214 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:50:53.848860 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:50:54.097264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:50:54.097264 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:50:54.238178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8257b523-54fc-4d0e-ae25-f089c7a1dea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947A660BE0>]}
[0m21:50:54.380034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8257b523-54fc-4d0e-ae25-f089c7a1dea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947AABEE60>]}
[0m21:50:54.381035 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:50:54.381035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8257b523-54fc-4d0e-ae25-f089c7a1dea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947AAB1450>]}
[0m21:50:54.383501 [info ] [MainThread]: 
[0m21:50:54.383501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:50:54.389045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:50:54.405871 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:50:54.407154 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:50:54.407154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:55.078805 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.671 seconds
[0m21:50:55.079809 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:50:55.218243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8257b523-54fc-4d0e-ae25-f089c7a1dea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947AB047C0>]}
[0m21:50:55.218243 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:50:55.219445 [info ] [MainThread]: 
[0m21:50:55.222598 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:55.223605 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:50:55.223605 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:50:55.224688 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:50:55.224688 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:50:55.225694 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:50:55.225694 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:55.226743 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:50:55.241118 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:55.248588 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:55.249593 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:55.260675 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:50:55.267175 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:55.270197 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:55.271203 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:55.272207 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:55.273212 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:50:55.273212 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:50:55.274216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:50:55.274216 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:50:55.839669 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m21:50:55.847048 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:50:55.975166 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.75s]
[0m21:50:55.976172 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:50:56.835841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.561 seconds
[0m21:50:56.836846 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:50:56.967775 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.74s]
[0m21:50:56.969782 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:56.970786 [info ] [MainThread]: 
[0m21:50:56.970786 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:50:56.987415 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:50:56.994678 [debug] [MainThread]: Using snowflake connection "master"
[0m21:50:56.994678 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:50:56.995683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:50:58.019429 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.024 seconds
[0m21:50:58.021431 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:50:58.034473 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:50:58.035933 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:50:58.039025 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:50:58.042239 [debug] [MainThread]: Using snowflake connection "master"
[0m21:50:58.042239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
insert into dqm.dq_dbt_test_results_central
    select * from (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7494726181030273'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.743086576461792'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  

  
    ) as new_data
    where not exists (
         select 1 from dqm.dq_dbt_test_results_central t where t.test_sk = new_data.test_sk
    );
[0m21:50:58.457466 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.414 seconds
[0m21:50:58.458471 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.42s]
[0m21:50:58.459475 [info ] [MainThread]: 
[0m21:50:58.459475 [debug] [MainThread]: On master: Close
[0m21:50:58.580494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:58.580494 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:50:58.580494 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:50:58.581705 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:50:58.581705 [info ] [MainThread]: 
[0m21:50:58.582797 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m21:50:58.583822 [debug] [MainThread]: Command end result
[0m21:50:58.622531 [info ] [MainThread]: 
[0m21:50:58.623564 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:50:58.624081 [info ] [MainThread]: 
[0m21:50:58.625100 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:50:58.626143 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:50:58.626657 [info ] [MainThread]: 
[0m21:50:58.627683 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:50:58.628193 [info ] [MainThread]: 
[0m21:50:58.628706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:50:58.629747 [debug] [MainThread]: Command `dbt test` failed at 21:50:58.629747 after 5.68 seconds
[0m21:50:58.629747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002945F10E8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947AB55390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947AABE0E0>]}
[0m21:50:58.630778 [debug] [MainThread]: Flushing usage events
[0m21:51:45.325985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DFD9E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E293E440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E293E260>]}


============================== 21:51:45.328994 | 20a1a5cb-7c80-4f59-b565-d76004f36537 ==============================
[0m21:51:45.328994 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:51:45.329998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:51:46.079721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20a1a5cb-7c80-4f59-b565-d76004f36537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E0653F10>]}
[0m21:51:46.125242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20a1a5cb-7c80-4f59-b565-d76004f36537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E1D609A0>]}
[0m21:51:46.127249 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:51:46.147799 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:51:46.391721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:51:46.392724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:51:46.443092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20a1a5cb-7c80-4f59-b565-d76004f36537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FB778130>]}
[0m21:51:46.613405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20a1a5cb-7c80-4f59-b565-d76004f36537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FB740BE0>]}
[0m21:51:46.613405 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:51:46.614410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20a1a5cb-7c80-4f59-b565-d76004f36537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FB72D0C0>]}
[0m21:51:46.615413 [info ] [MainThread]: 
[0m21:51:46.616426 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:51:46.620442 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:51:46.634313 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:51:46.635816 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:51:46.635816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:47.350828 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.715 seconds
[0m21:51:47.352920 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:51:47.491659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20a1a5cb-7c80-4f59-b565-d76004f36537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FB743760>]}
[0m21:51:47.491659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:51:47.492666 [info ] [MainThread]: 
[0m21:51:47.495688 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:51:47.495688 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:51:47.496700 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:51:47.496700 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:51:47.496700 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:51:47.497979 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:51:47.498985 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:51:47.498985 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:51:47.514137 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:51:47.519144 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:51:47.520355 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:51:47.535656 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:51:47.536756 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:51:47.539209 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:51:47.541219 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:51:47.541219 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:51:47.542237 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:51:47.542237 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:51:47.543382 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:51:47.543382 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:51:48.145078 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m21:51:48.152105 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:51:48.284667 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.79s]
[0m21:51:48.286674 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:51:49.286825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.743 seconds
[0m21:51:49.287829 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:51:49.403482 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.91s]
[0m21:51:49.404494 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:51:49.406504 [info ] [MainThread]: 
[0m21:51:49.406504 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:51:49.422711 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:51:49.427851 [debug] [MainThread]: Using snowflake connection "master"
[0m21:51:49.427851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:51:49.428855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:50.567120 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.138 seconds
[0m21:51:50.568124 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:51:50.581509 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:51:50.582514 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:51:50.586673 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:51:50.588738 [debug] [MainThread]: Using snowflake connection "master"
[0m21:51:50.589751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
insert into dqm.dq_dbt_test_results_central
    select * from (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7866880893707275'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.9067811965942383'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  

  
    ) as new_data
    where not exists (
         select 1 from dqm.dq_dbt_test_results_central t where t.test_sk = new_data.test_sk
    );
[0m21:51:51.290818 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.701 seconds
[0m21:51:51.291838 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.70s]
[0m21:51:51.292856 [info ] [MainThread]: 
[0m21:51:51.293860 [debug] [MainThread]: On master: Close
[0m21:51:51.410564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:51.410564 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:51:51.411565 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:51:51.411565 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:51:51.411565 [info ] [MainThread]: 
[0m21:51:51.413043 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m21:51:51.414046 [debug] [MainThread]: Command end result
[0m21:51:51.450379 [info ] [MainThread]: 
[0m21:51:51.450379 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:51:51.451514 [info ] [MainThread]: 
[0m21:51:51.452516 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:51:51.453548 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:51:51.453548 [info ] [MainThread]: 
[0m21:51:51.454553 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:51:51.455642 [info ] [MainThread]: 
[0m21:51:51.455642 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:51:51.456860 [debug] [MainThread]: Command `dbt test` failed at 21:51:51.456860 after 6.19 seconds
[0m21:51:51.457887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DFD9E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DFC31B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FB2AFA60>]}
[0m21:51:51.458894 [debug] [MainThread]: Flushing usage events
[0m21:53:58.487821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023316BEE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002331978E440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002331978E260>]}


============================== 21:53:58.490870 | 83ccadd2-4441-4b30-a88e-594ed00bdade ==============================
[0m21:53:58.490870 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:53:58.492007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m21:53:59.262537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83ccadd2-4441-4b30-a88e-594ed00bdade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023317497F10>]}
[0m21:53:59.310387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83ccadd2-4441-4b30-a88e-594ed00bdade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023318BAC9A0>]}
[0m21:53:59.311391 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:53:59.332438 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:53:59.572816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:53:59.573819 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:53:59.721271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83ccadd2-4441-4b30-a88e-594ed00bdade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333259CA90>]}
[0m21:53:59.850589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83ccadd2-4441-4b30-a88e-594ed00bdade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233320FF730>]}
[0m21:53:59.851772 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:53:59.852776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ccadd2-4441-4b30-a88e-594ed00bdade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333256D7B0>]}
[0m21:53:59.853783 [info ] [MainThread]: 
[0m21:53:59.855008 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:53:59.859185 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:53:59.873510 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:53:59.873510 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:53:59.874958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:00.577220 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.703 seconds
[0m21:54:00.579229 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:54:00.713000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ccadd2-4441-4b30-a88e-594ed00bdade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233325C5F30>]}
[0m21:54:00.713000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:54:00.714001 [info ] [MainThread]: 
[0m21:54:00.717004 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:00.717004 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:00.718005 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:54:00.719006 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:54:00.719006 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:54:00.720082 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:54:00.720082 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:00.721086 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:00.735092 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:00.740158 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:00.742161 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:00.742161 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:00.757601 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:00.760797 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:00.761807 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:00.762813 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:54:00.762813 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:00.763819 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:54:00.763819 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:54:00.765830 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:54:01.348653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m21:54:01.354696 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:54:01.478806 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m21:54:01.479810 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:02.302230 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.537 seconds
[0m21:54:02.304247 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:54:02.435591 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.72s]
[0m21:54:02.436604 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:02.437610 [info ] [MainThread]: 
[0m21:54:02.438620 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:54:02.456310 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:54:02.462574 [debug] [MainThread]: Using snowflake connection "master"
[0m21:54:02.463579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:54:02.463579 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:03.677135 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.213 seconds
[0m21:54:03.678138 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:54:03.691275 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:54:03.692279 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:54:03.696305 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:54:03.699479 [debug] [MainThread]: Using snowflake connection "master"
[0m21:54:03.699479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7597999572753906'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7155086994171143'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target._timestamp::date = source._timestamp::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, _timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source._timestamp
      )
  
  ;
[0m21:54:03.784222 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8018-3201-72d0-000b-f692000173a2
[0m21:54:03.785505 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 111 at position 54
invalid identifier '_TIMESTAMP'
[0m21:54:03.785505 [info ] [MainThread]: Database error while running on-run-end
[0m21:54:03.786526 [debug] [MainThread]: On master: Close
[0m21:54:03.912910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:03.913913 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:54:03.913913 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:54:03.913913 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:54:03.915092 [info ] [MainThread]: 
[0m21:54:03.916096 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m21:54:03.917099 [debug] [MainThread]: Command end result
[0m21:54:03.968044 [info ] [MainThread]: 
[0m21:54:03.969046 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:54:03.970046 [info ] [MainThread]: 
[0m21:54:03.971110 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:54:03.972115 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:54:03.972115 [info ] [MainThread]: 
[0m21:54:03.973119 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:54:03.973119 [info ] [MainThread]: 
[0m21:54:03.974123 [error] [MainThread]:   on-run-end failed, error:
 000904 (42000): SQL compilation error: error line 111 at position 54
invalid identifier '_TIMESTAMP'
[0m21:54:03.975127 [info ] [MainThread]: 
[0m21:54:03.975127 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:54:03.976295 [debug] [MainThread]: Command `dbt test` failed at 21:54:03.976295 after 5.55 seconds
[0m21:54:03.977299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023316BEE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023318BAF4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023318BAC9A0>]}
[0m21:54:03.977299 [debug] [MainThread]: Flushing usage events
[0m21:54:23.386097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221553CE8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022157F8A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022157F8A230>]}


============================== 21:54:23.389312 | c65ce340-a090-49ad-84f0-470723aa7cf5 ==============================
[0m21:54:23.389312 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:54:23.390543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m21:54:24.120684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c65ce340-a090-49ad-84f0-470723aa7cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022155657340>]}
[0m21:54:24.165081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c65ce340-a090-49ad-84f0-470723aa7cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002215740B730>]}
[0m21:54:24.166231 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:54:24.187549 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:54:24.453131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:54:24.454135 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:54:24.597049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c65ce340-a090-49ad-84f0-470723aa7cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022170920BE0>]}
[0m21:54:24.719283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c65ce340-a090-49ad-84f0-470723aa7cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022170B62E60>]}
[0m21:54:24.720288 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:54:24.721295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65ce340-a090-49ad-84f0-470723aa7cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022170D71450>]}
[0m21:54:24.722467 [info ] [MainThread]: 
[0m21:54:24.723470 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:54:24.727785 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:54:24.740928 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:54:24.741941 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:54:24.741941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:25.429408 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.688 seconds
[0m21:54:25.431538 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:54:25.549947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65ce340-a090-49ad-84f0-470723aa7cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022170DC0580>]}
[0m21:54:25.549947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:54:25.550951 [info ] [MainThread]: 
[0m21:54:25.553972 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:25.553972 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:25.555141 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:54:25.555141 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:54:25.556144 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:54:25.556144 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:54:25.557188 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:25.558193 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:25.572324 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:25.578852 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:25.579856 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:25.579856 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:25.596137 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:25.599173 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:25.600176 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:25.601295 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:25.602301 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:54:25.602301 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:54:25.603304 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:54:25.603304 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:54:26.136496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m21:54:26.144726 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:54:26.272138 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.72s]
[0m21:54:26.273161 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:27.198465 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.595 seconds
[0m21:54:27.199469 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:54:27.318800 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.76s]
[0m21:54:27.319806 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:27.321821 [info ] [MainThread]: 
[0m21:54:27.321821 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:54:27.337950 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:54:27.343975 [debug] [MainThread]: Using snowflake connection "master"
[0m21:54:27.343975 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:54:27.344979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:28.390940 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.046 seconds
[0m21:54:28.391944 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:54:28.404104 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:54:28.406113 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:54:28.411223 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:54:28.413233 [debug] [MainThread]: Using snowflake connection "master"
[0m21:54:28.414236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7169976234436035'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', currentTIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.76265549659729'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', currentTIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m21:54:28.500513 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8018-3201-7237-000b-f692000146ee
[0m21:54:28.501514 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 48 at position 45
invalid identifier 'CURRENTTIMESTAMP'
[0m21:54:28.502688 [info ] [MainThread]: Database error while running on-run-end
[0m21:54:28.502688 [debug] [MainThread]: On master: Close
[0m21:54:28.623595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:28.623595 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:54:28.624660 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:54:28.624660 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:54:28.624660 [info ] [MainThread]: 
[0m21:54:28.625915 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m21:54:28.626926 [debug] [MainThread]: Command end result
[0m21:54:28.663491 [info ] [MainThread]: 
[0m21:54:28.664496 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:54:28.665499 [info ] [MainThread]: 
[0m21:54:28.666507 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:54:28.666507 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:54:28.667512 [info ] [MainThread]: 
[0m21:54:28.667512 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:54:28.668517 [info ] [MainThread]: 
[0m21:54:28.669522 [error] [MainThread]:   on-run-end failed, error:
 000904 (42000): SQL compilation error: error line 48 at position 45
invalid identifier 'CURRENTTIMESTAMP'
[0m21:54:28.669522 [info ] [MainThread]: 
[0m21:54:28.670697 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:54:28.671710 [debug] [MainThread]: Command `dbt test` failed at 21:54:28.671710 after 5.35 seconds
[0m21:54:28.671710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221553CE8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221578C19F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022170DC1F00>]}
[0m21:54:28.672736 [debug] [MainThread]: Flushing usage events
[0m21:54:40.703252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CC02E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CEBDA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CEBDA320>]}


============================== 21:54:40.706255 | c18a6290-55de-4c8e-8213-7ca8234036b9 ==============================
[0m21:54:40.706255 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:54:40.707255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:54:41.434409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c18a6290-55de-4c8e-8213-7ca8234036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CC2B7DC0>]}
[0m21:54:41.479705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c18a6290-55de-4c8e-8213-7ca8234036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CE606E00>]}
[0m21:54:41.480708 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:54:41.501948 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:54:41.747201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:54:41.748204 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:54:41.889211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c18a6290-55de-4c8e-8213-7ca8234036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E79EDC90>]}
[0m21:54:42.009342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c18a6290-55de-4c8e-8213-7ca8234036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E75722C0>]}
[0m21:54:42.010347 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:54:42.011351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c18a6290-55de-4c8e-8213-7ca8234036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E79BD5D0>]}
[0m21:54:42.012358 [info ] [MainThread]: 
[0m21:54:42.013361 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:54:42.018515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:54:42.032130 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:54:42.032130 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:54:42.033137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:42.660824 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.628 seconds
[0m21:54:42.663005 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:54:42.797360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c18a6290-55de-4c8e-8213-7ca8234036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E74C3B50>]}
[0m21:54:42.797360 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:54:42.798369 [info ] [MainThread]: 
[0m21:54:42.801390 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:42.801390 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:42.802394 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:54:42.802394 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:54:42.803829 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:54:42.803829 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:54:42.803829 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:42.805276 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:42.818140 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:42.824945 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:42.825949 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:42.825949 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:42.842633 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:42.845635 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:42.846719 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:42.848080 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:42.848080 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:54:42.848080 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:54:42.849461 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:54:42.849461 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:54:43.363404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m21:54:43.370856 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:54:43.494166 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.69s]
[0m21:54:43.495177 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:44.415505 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.566 seconds
[0m21:54:44.417515 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:54:44.548637 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.74s]
[0m21:54:44.549642 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:44.550646 [info ] [MainThread]: 
[0m21:54:44.550646 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:54:44.568259 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:54:44.573435 [debug] [MainThread]: Using snowflake connection "master"
[0m21:54:44.573435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:54:44.574439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:46.006134 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.431 seconds
[0m21:54:46.007138 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:54:46.020332 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:54:46.021335 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:54:46.025568 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:54:46.027586 [debug] [MainThread]: Using snowflake connection "master"
[0m21:54:46.028593 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.6917722225189209'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7438018321990967'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m21:54:46.425821 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.397 seconds
[0m21:54:46.426822 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.40s]
[0m21:54:46.427870 [info ] [MainThread]: 
[0m21:54:46.427870 [debug] [MainThread]: On master: Close
[0m21:54:46.546798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:46.547801 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:54:46.547801 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:54:46.547801 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:54:46.548829 [info ] [MainThread]: 
[0m21:54:46.548829 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m21:54:46.549834 [debug] [MainThread]: Command end result
[0m21:54:46.586475 [info ] [MainThread]: 
[0m21:54:46.586475 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:54:46.587556 [info ] [MainThread]: 
[0m21:54:46.588562 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:54:46.589570 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:54:46.589570 [info ] [MainThread]: 
[0m21:54:46.590575 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:54:46.591578 [info ] [MainThread]: 
[0m21:54:46.591578 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:54:46.593617 [debug] [MainThread]: Command `dbt test` failed at 21:54:46.592612 after 5.95 seconds
[0m21:54:46.593617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CC02E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CC2B7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7570760>]}
[0m21:54:46.593617 [debug] [MainThread]: Flushing usage events
[0m21:56:16.167409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153A10EE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153A3CAA530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153A3CAA350>]}


============================== 21:56:16.170419 | 5b17602c-43dd-4832-992a-8ee81fd07899 ==============================
[0m21:56:16.170419 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:56:16.171569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:56:16.899119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b17602c-43dd-4832-992a-8ee81fd07899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153A1377970>]}
[0m21:56:16.944116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b17602c-43dd-4832-992a-8ee81fd07899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153A0BC3580>]}
[0m21:56:16.946129 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:56:16.966287 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:56:17.207753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:56:17.208756 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m21:56:17.579271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b17602c-43dd-4832-992a-8ee81fd07899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153BCE1BE50>]}
[0m21:56:17.702048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b17602c-43dd-4832-992a-8ee81fd07899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153BC7C26E0>]}
[0m21:56:17.703051 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m21:56:17.704060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b17602c-43dd-4832-992a-8ee81fd07899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153BC8DE590>]}
[0m21:56:17.705065 [info ] [MainThread]: 
[0m21:56:17.706069 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:56:17.710301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:56:17.723412 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:56:17.724420 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:56:17.724420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:18.364496 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.640 seconds
[0m21:56:18.365497 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:56:18.488801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b17602c-43dd-4832-992a-8ee81fd07899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153BC7C19F0>]}
[0m21:56:18.489814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:56:18.489814 [info ] [MainThread]: 
[0m21:56:18.494225 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m21:56:18.494225 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:56:18.495231 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:56:18.495231 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m21:56:18.496314 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:56:18.496314 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:56:18.497817 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m21:56:18.497817 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:56:18.499190 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:56:18.499190 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m21:56:18.500198 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:56:18.500198 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:56:18.508263 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m21:56:18.514384 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:56:18.520506 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:56:18.521509 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m21:56:18.526533 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:56:18.526533 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:56:18.537106 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m21:56:18.540116 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:56:18.543126 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:56:18.544176 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m21:56:18.545182 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:56:18.546189 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m21:56:18.546189 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:56:18.547202 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:56:18.548236 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:56:18.548236 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:56:18.549240 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:56:18.550276 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:56:19.107059 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.556 seconds
[0m21:56:19.113259 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:56:19.232753 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.73s]
[0m21:56:19.233756 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:56:20.151821 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.603 seconds
[0m21:56:20.152831 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:56:20.268081 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.77s]
[0m21:56:20.269085 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:56:21.347616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.800 seconds
[0m21:56:21.349638 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m21:56:21.468261 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 2.97s]
[0m21:56:21.469267 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m21:56:21.471294 [info ] [MainThread]: 
[0m21:56:21.471294 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:56:21.495419 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m21:56:21.501980 [debug] [MainThread]: Using snowflake connection "master"
[0m21:56:21.502987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:56:21.502987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:22.512283 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.009 seconds
[0m21:56:22.513905 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:56:22.527018 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:56:22.528023 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:56:22.529190 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:56:22.533363 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:56:22.536419 [debug] [MainThread]: Using snowflake connection "master"
[0m21:56:22.536419 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7349364757537842'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7688910961151123'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '2.9704439640045166'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m21:56:22.901283 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.364 seconds
[0m21:56:22.902310 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.37s]
[0m21:56:22.903313 [info ] [MainThread]: 
[0m21:56:22.903313 [debug] [MainThread]: On master: Close
[0m21:56:23.062153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:23.062153 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:56:23.063157 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m21:56:23.063157 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:56:23.064162 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:56:23.064162 [info ] [MainThread]: 
[0m21:56:23.065175 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m21:56:23.066178 [debug] [MainThread]: Command end result
[0m21:56:23.175698 [info ] [MainThread]: 
[0m21:56:23.175698 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:56:23.176971 [info ] [MainThread]: 
[0m21:56:23.177983 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:56:23.178988 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:56:23.178988 [info ] [MainThread]: 
[0m21:56:23.179993 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:56:23.179993 [info ] [MainThread]: 
[0m21:56:23.180998 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:56:23.183016 [debug] [MainThread]: Command `dbt test` failed at 21:56:23.183016 after 7.07 seconds
[0m21:56:23.183016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153A10EE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153BCD45600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153BCD78460>]}
[0m21:56:23.184020 [debug] [MainThread]: Flushing usage events
[0m21:59:59.247512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00B6AE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00E23A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00E23A230>]}


============================== 21:59:59.250521 | 40620018-dfb0-4dc8-847b-a9dfd29e709d ==============================
[0m21:59:59.250521 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:59:59.251529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m21:59:59.972869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40620018-dfb0-4dc8-847b-a9dfd29e709d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00B937CD0>]}
[0m22:00:00.018397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40620018-dfb0-4dc8-847b-a9dfd29e709d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00D6BB760>]}
[0m22:00:00.019400 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:00:00.040696 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:00:00.284011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:00:00.285069 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:00:00.427601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40620018-dfb0-4dc8-847b-a9dfd29e709d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D026C43880>]}
[0m22:00:00.550275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40620018-dfb0-4dc8-847b-a9dfd29e709d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D02706EB60>]}
[0m22:00:00.550275 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:00:00.551280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40620018-dfb0-4dc8-847b-a9dfd29e709d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0270174C0>]}
[0m22:00:00.553290 [info ] [MainThread]: 
[0m22:00:00.553290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:00:00.558330 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:00:00.572224 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:00:00.572224 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:00:00.573228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:01.265305 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.692 seconds
[0m22:00:01.266314 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:00:01.392087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40620018-dfb0-4dc8-847b-a9dfd29e709d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D026D618D0>]}
[0m22:00:01.392087 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:00:01.393202 [info ] [MainThread]: 
[0m22:00:01.396250 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:00:01.396250 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:00:01.396250 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:00:01.397256 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:00:01.397256 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:00:01.398262 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:00:01.399268 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:00:01.399268 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:00:01.400274 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:00:01.400274 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:00:01.401291 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:00:01.401291 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:00:01.415842 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:00:01.423002 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:00:01.428056 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:00:01.429130 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:00:01.436198 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:00:01.446418 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:00:01.449431 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:00:01.449431 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:00:01.453443 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:00:01.453443 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:00:01.454860 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:00:01.454860 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:00:01.455861 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:00:01.455861 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:00:01.456862 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:00:01.457864 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:00:01.457864 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:00:01.459866 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:00:02.054381 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m22:00:02.061622 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:00:02.070765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m22:00:02.071770 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:00:02.213197 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.81s]
[0m22:00:02.214738 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:00:02.216125 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.82s]
[0m22:00:02.217142 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:00:02.962829 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.503 seconds
[0m22:00:02.963969 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:00:03.081665 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.68s]
[0m22:00:03.083670 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:00:03.084173 [info ] [MainThread]: 
[0m22:00:03.085202 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:00:03.101303 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:00:03.106327 [debug] [MainThread]: Using snowflake connection "master"
[0m22:00:03.106327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:00:03.106327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:04.067356 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.960 seconds
[0m22:00:04.068365 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:00:04.082435 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:00:04.083979 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:00:04.085525 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:00:04.089629 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:00:04.094721 [debug] [MainThread]: Using snowflake connection "master"
[0m22:00:04.095231 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
      with current_test_runs as (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8139290809631348'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
       true as is_active,
       convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified,
       convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8178637027740479'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
       true as is_active,
       convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified,
       convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.6813907623291016'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
       true as is_active,
       convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified,
       convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
      )
      select * from current_test_runs
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set is_active = true,
                last_modified = source.last_modified
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_modified
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_modified
      );
[0m22:00:04.565223 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.469 seconds
[0m22:00:04.565223 [debug] [MainThread]: Using snowflake connection "master"
[0m22:00:04.566230 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Mark tests as inactive if they weren't part of current run
    update dqm.dq_dbt_test_results_central
    set is_active = false,
        last_modified = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where test_name not in (
      select distinct test_name 
      from current_test_runs
    )
    and is_active = true;
[0m22:00:04.659461 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba801e-3201-7237-000b-f6920001470a
[0m22:00:04.660463 [debug] [MainThread]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CURRENT_TEST_RUNS' does not exist or not authorized.
[0m22:00:04.660463 [info ] [MainThread]: Database error while running on-run-end
[0m22:00:04.661648 [debug] [MainThread]: On master: Close
[0m22:00:04.785844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:04.786870 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:00:04.786870 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:00:04.786870 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:00:04.787874 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:00:04.787874 [info ] [MainThread]: 
[0m22:00:04.788877 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.23 seconds (4.23s).
[0m22:00:04.789880 [debug] [MainThread]: Command end result
[0m22:00:04.826014 [info ] [MainThread]: 
[0m22:00:04.827076 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:00:04.828149 [info ] [MainThread]: 
[0m22:00:04.828149 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:00:04.829384 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:00:04.829384 [info ] [MainThread]: 
[0m22:00:04.830388 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:00:04.831506 [info ] [MainThread]: 
[0m22:00:04.831506 [error] [MainThread]:   on-run-end failed, error:
 002003 (42S02): SQL compilation error:
Object 'CURRENT_TEST_RUNS' does not exist or not authorized.
[0m22:00:04.831506 [info ] [MainThread]: 
[0m22:00:04.832980 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:00:04.833983 [debug] [MainThread]: Command `dbt test` failed at 22:00:04.833983 after 5.65 seconds
[0m22:00:04.833983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00B6AE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00D6BB760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D02706F670>]}
[0m22:00:04.835310 [debug] [MainThread]: Flushing usage events
[0m22:01:50.349914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168053529B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016807F0A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016807F0A350>]}


============================== 22:01:50.353388 | db982a1c-c030-475a-a56a-0a67916ad51f ==============================
[0m22:01:50.353388 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:01:50.353388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:01:51.100172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db982a1c-c030-475a-a56a-0a67916ad51f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168055D7970>]}
[0m22:01:51.144997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db982a1c-c030-475a-a56a-0a67916ad51f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016804E23580>]}
[0m22:01:51.146537 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:01:51.165511 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:01:51.424637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:01:51.424637 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:01:51.569079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db982a1c-c030-475a-a56a-0a67916ad51f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168209D0940>]}
[0m22:01:51.691501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db982a1c-c030-475a-a56a-0a67916ad51f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016820AD11E0>]}
[0m22:01:51.691501 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:01:51.692712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db982a1c-c030-475a-a56a-0a67916ad51f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016820CED5D0>]}
[0m22:01:51.694738 [info ] [MainThread]: 
[0m22:01:51.694738 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:01:51.699583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:01:51.714861 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:01:51.716184 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:01:51.717186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:52.399320 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.683 seconds
[0m22:01:52.401333 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:01:52.521370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db982a1c-c030-475a-a56a-0a67916ad51f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016820AD20B0>]}
[0m22:01:52.521370 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:52.522503 [info ] [MainThread]: 
[0m22:01:52.525516 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:01:52.525516 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:01:52.525516 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:01:52.525516 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:01:52.527020 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:01:52.528034 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:01:52.528034 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:01:52.528034 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:01:52.529387 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:01:52.530396 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:01:52.530396 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:01:52.531404 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:01:52.547131 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:01:52.553242 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:01:52.557930 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:01:52.559943 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:01:52.559943 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:01:52.575899 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:01:52.577402 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:01:52.580431 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:01:52.583434 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:01:52.584605 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:01:52.585611 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:01:52.585611 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:01:52.587115 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:01:52.587115 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:01:52.588132 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:01:52.588132 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:01:52.589138 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:01:52.592157 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:01:53.180338 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m22:01:53.187866 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:01:53.239483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m22:01:53.241512 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:01:53.313449 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.78s]
[0m22:01:53.315307 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:01:53.363839 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.84s]
[0m22:01:53.366008 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:01:54.431540 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.843 seconds
[0m22:01:54.434547 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:01:54.562931 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.03s]
[0m22:01:54.563935 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:01:54.564959 [info ] [MainThread]: 
[0m22:01:54.565966 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:01:54.584513 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:01:54.590156 [debug] [MainThread]: Using snowflake connection "master"
[0m22:01:54.590156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:01:54.591274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:01:55.694452 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.104 seconds
[0m22:01:55.696456 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:01:55.711225 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:01:55.712533 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:01:55.714543 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:01:55.718077 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:01:55.722107 [debug] [MainThread]: Using snowflake connection "master"
[0m22:01:55.723110 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.784062385559082'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8358051776885986'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '2.0348968505859375'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set 
        last_modified_at = source.last_modified_at,
        is_active = true,
        test_result = source.test_result,
        execution_time_seconds = source.execution_time_seconds
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_modified_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_modified_at
      );
[0m22:01:56.114870 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.392 seconds
[0m22:01:56.115987 [debug] [MainThread]: Using snowflake connection "master"
[0m22:01:56.115987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Mark tests as inactive if they're not in the current run
    update dqm.dq_dbt_test_results_central
    set is_active = false,
        last_modified_at = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where test_name not in (
      
        'unique'
        ,
      
        'expression_is_true'
        ,
      
        'not_null'
        
      
    )
    and is_active = true;
[0m22:01:56.435580 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.320 seconds
[0m22:01:56.437084 [debug] [MainThread]: Using snowflake connection "master"
[0m22:01:56.438094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
;
[0m22:01:56.523313 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba801f-3201-72d0-000b-f692000173d2
[0m22:01:56.524314 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000900 (42601): SQL compilation error:
Empty SQL statement.
[0m22:01:56.524314 [debug] [MainThread]: Snowflake adapter: got empty sql statement, moving on
[0m22:01:56.525433 [debug] [MainThread]: On master: Close
[0m22:01:56.657333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:56.658415 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:01:56.658415 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:01:56.658415 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:01:56.659419 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:01:56.659419 [info ] [MainThread]: 
[0m22:01:56.660422 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.96 seconds (4.96s).
[0m22:01:56.661437 [error] [MainThread]: Encountered an error:
cannot unpack non-iterable NoneType object
[0m22:01:56.662443 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 816, in test
    results = task.run()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 488, in execute_with_hooks
    self.after_run(adapter, res)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 484, in after_run
    self.safe_run_hooks(adapter, RunHookType.End, extras)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 423, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 391, in run_hooks
    response, _ = adapter.execute(sql, auto_begin=False, fetch=False)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 379, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 471, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 506, in add_query
    connection, cursor = self._add_standard_queries(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 562, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
TypeError: cannot unpack non-iterable NoneType object

[0m22:01:56.663447 [debug] [MainThread]: Command `dbt test` failed at 22:01:56.663447 after 6.37 seconds
[0m22:01:56.664450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168053529B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016820AE7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016820CED5D0>]}
[0m22:01:56.664450 [debug] [MainThread]: Flushing usage events
[0m22:03:37.070289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725BE12980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725E9BA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725E9BA2F0>]}


============================== 22:03:37.073307 | 34963b47-506b-425c-90f9-a04e621b8c97 ==============================
[0m22:03:37.073307 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:03:37.074310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m22:03:37.814131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34963b47-506b-425c-90f9-a04e621b8c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725E976980>]}
[0m22:03:37.864282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34963b47-506b-425c-90f9-a04e621b8c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725C6C3730>]}
[0m22:03:37.865287 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:03:37.887579 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:03:38.132134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:03:38.133138 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:03:38.303909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34963b47-506b-425c-90f9-a04e621b8c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027277484B20>]}
[0m22:03:38.433566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34963b47-506b-425c-90f9-a04e621b8c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002727760EE00>]}
[0m22:03:38.434571 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:03:38.434571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34963b47-506b-425c-90f9-a04e621b8c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002727779D690>]}
[0m22:03:38.436574 [info ] [MainThread]: 
[0m22:03:38.436574 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:03:38.442069 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:03:38.457306 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:03:38.458310 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:03:38.458310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:39.122983 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.665 seconds
[0m22:03:39.124985 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:03:39.245632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34963b47-506b-425c-90f9-a04e621b8c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002727760FC10>]}
[0m22:03:39.246644 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:03:39.247652 [info ] [MainThread]: 
[0m22:03:39.249707 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:39.250711 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:39.250711 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:39.251715 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:03:39.251715 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:03:39.252720 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:03:39.252720 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:03:39.253724 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:03:39.253724 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:03:39.254729 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:39.254729 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:39.255735 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:39.271270 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:03:39.277507 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:03:39.282991 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:03:39.283998 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:39.285002 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:39.301127 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:03:39.302131 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:39.305189 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:03:39.307207 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:03:39.308210 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:03:39.309214 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:03:39.309214 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:03:39.310223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:03:39.310223 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:03:39.311228 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:03:39.313427 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:03:39.313427 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:03:39.314665 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:03:39.907413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m22:03:39.914447 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:03:40.141626 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.89s]
[0m22:03:40.142632 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:40.269810 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.955 seconds
[0m22:03:40.270813 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:03:40.397089 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.14s]
[0m22:03:40.398188 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:40.861861 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.548 seconds
[0m22:03:40.863868 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:03:40.984740 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.73s]
[0m22:03:40.985744 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:40.986755 [info ] [MainThread]: 
[0m22:03:40.986755 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:03:41.005681 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:03:41.006684 [debug] [MainThread]: Using snowflake connection "master"
[0m22:03:41.006684 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select count(*) as count 
    from information_schema.tables 
    where table_schema = upper('dqm')
    and table_name = 'DQ_DBT_TEST_RESULTS_CENTRAL'
[0m22:03:41.007713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:42.054859 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.047 seconds
[0m22:03:42.056883 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:03:42.069546 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:03:42.070551 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:03:42.071558 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:03:42.075582 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:03:42.080751 [debug] [MainThread]: Using snowflake connection "master"
[0m22:03:42.080751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8889064788818359'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.1433649063110352'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7300045490264893'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set 
        last_modified_at = source.last_modified_at,
        is_active = true,
        test_result = source.test_result,
        execution_time_seconds = source.execution_time_seconds
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_modified_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_modified_at
      );
[0m22:03:42.579938 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.498 seconds
[0m22:03:42.579938 [debug] [MainThread]: Using snowflake connection "master"
[0m22:03:42.581247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Mark tests as inactive if they're not in the current run
    update dqm.dq_dbt_test_results_central
    set is_active = false,
        last_modified_at = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where test_name not in (
      
        'expression_is_true'
        ,
      
        'not_null'
        ,
      
        'unique'
        
      
    )
    and is_active = true;
[0m22:03:42.850845 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.269 seconds
[0m22:03:42.850845 [debug] [MainThread]: Using snowflake connection "master"
[0m22:03:42.851849 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
;
[0m22:03:42.928354 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8021-3201-72f0-000b-f6920001b062
[0m22:03:42.929359 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000900 (42601): SQL compilation error:
Empty SQL statement.
[0m22:03:42.929359 [debug] [MainThread]: Snowflake adapter: got empty sql statement, moving on
[0m22:03:42.930363 [debug] [MainThread]: On master: Close
[0m22:03:43.058767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:43.058767 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:03:43.059767 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:03:43.059767 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:03:43.059767 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:03:43.060891 [info ] [MainThread]: 
[0m22:03:43.060891 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m22:03:43.061895 [error] [MainThread]: Encountered an error:
cannot unpack non-iterable NoneType object
[0m22:03:43.062900 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 816, in test
    results = task.run()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 488, in execute_with_hooks
    self.after_run(adapter, res)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 484, in after_run
    self.safe_run_hooks(adapter, RunHookType.End, extras)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 423, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 391, in run_hooks
    response, _ = adapter.execute(sql, auto_begin=False, fetch=False)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 379, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 471, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 506, in add_query
    connection, cursor = self._add_standard_queries(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 562, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
TypeError: cannot unpack non-iterable NoneType object

[0m22:03:43.065072 [debug] [MainThread]: Command `dbt test` failed at 22:03:43.065072 after 6.05 seconds
[0m22:03:43.065072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725BE12980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027277CA0B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027277CA0D90>]}
[0m22:03:43.066089 [debug] [MainThread]: Flushing usage events
[0m22:03:56.395672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF2ADE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF569A4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF569A2F0>]}


============================== 22:03:56.398860 | 8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8 ==============================
[0m22:03:56.398860 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:03:56.398860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m22:03:57.103579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF5656980>]}
[0m22:03:57.147119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF33A3730>]}
[0m22:03:57.148123 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:03:57.169349 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:03:57.404457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:03:57.404457 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:03:57.542742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E1C5600>]}
[0m22:03:57.672602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E2212D0>]}
[0m22:03:57.673606 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:03:57.674609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E4E5660>]}
[0m22:03:57.675611 [info ] [MainThread]: 
[0m22:03:57.676611 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:03:57.680813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:03:57.696204 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:03:57.696204 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:03:57.697227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:58.353971 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.657 seconds
[0m22:03:58.354975 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:03:58.471527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E222110>]}
[0m22:03:58.472532 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:03:58.472532 [info ] [MainThread]: 
[0m22:03:58.475555 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:58.476568 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:58.476568 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:58.476568 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:03:58.477574 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:03:58.478579 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:03:58.478579 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:03:58.479584 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:03:58.479584 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:58.480588 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:03:58.480588 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:58.494851 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:03:58.495856 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:58.502006 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:03:58.507144 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:03:58.508648 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:58.514802 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:58.524049 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:03:58.527069 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:03:58.527069 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:58.530248 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:03:58.531292 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:03:58.532296 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:03:58.533305 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:03:58.534311 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:03:58.534311 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:03:58.534311 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:03:58.535317 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:03:58.535317 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:03:58.537338 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:03:59.130211 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m22:03:59.137454 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:03:59.138458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m22:03:59.141476 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:03:59.286538 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.81s]
[0m22:03:59.288634 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:59.287550 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.81s]
[0m22:03:59.289639 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:04:00.326621 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.789 seconds
[0m22:04:00.328631 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:04:00.448475 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.97s]
[0m22:04:00.449478 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:04:00.451486 [info ] [MainThread]: 
[0m22:04:00.451486 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:04:00.468830 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:04:00.473867 [debug] [MainThread]: Using snowflake connection "master"
[0m22:04:00.474871 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:04:00.474871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:04:01.436745 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.961 seconds
[0m22:04:01.437755 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:04:01.450937 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:04:01.451942 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:04:01.453951 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:04:01.458050 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:04:01.462103 [debug] [MainThread]: Using snowflake connection "master"
[0m22:04:01.463106 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8079583644866943'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8079664707183838'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.9678864479064941'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set 
        last_modified_at = source.last_modified_at,
        is_active = true,
        test_result = source.test_result,
        execution_time_seconds = source.execution_time_seconds
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_modified_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_modified_at
      );
[0m22:04:01.921421 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.457 seconds
[0m22:04:01.921421 [debug] [MainThread]: Using snowflake connection "master"
[0m22:04:01.922422 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Mark tests as inactive if they're not in the current run
    update dqm.dq_dbt_test_results_central
    set is_active = false,
        last_modified_at = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where test_name not in (
      
        'expression_is_true'
        ,
      
        'not_null'
        ,
      
        'unique'
        
      
    )
    and is_active = true;
[0m22:04:02.135741 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.212 seconds
[0m22:04:02.135741 [debug] [MainThread]: Using snowflake connection "master"
[0m22:04:02.136774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
;
[0m22:04:02.233071 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8022-3201-72f0-000b-f6920001b06a
[0m22:04:02.233071 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000900 (42601): SQL compilation error:
Empty SQL statement.
[0m22:04:02.234155 [debug] [MainThread]: Snowflake adapter: got empty sql statement, moving on
[0m22:04:02.234155 [debug] [MainThread]: On master: Close
[0m22:04:02.361948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:02.363122 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:04:02.363122 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:04:02.363122 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:04:02.364150 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:04:02.364150 [info ] [MainThread]: 
[0m22:04:02.365153 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m22:04:02.365153 [error] [MainThread]: Encountered an error:
cannot unpack non-iterable NoneType object
[0m22:04:02.366326 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 816, in test
    results = task.run()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 488, in execute_with_hooks
    self.after_run(adapter, res)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 484, in after_run
    self.safe_run_hooks(adapter, RunHookType.End, extras)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 423, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 391, in run_hooks
    response, _ = adapter.execute(sql, auto_begin=False, fetch=False)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 379, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 471, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 506, in add_query
    connection, cursor = self._add_standard_queries(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 562, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
TypeError: cannot unpack non-iterable NoneType object

[0m22:04:02.368337 [debug] [MainThread]: Command `dbt test` failed at 22:04:02.368337 after 6.03 seconds
[0m22:04:02.368337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF2ADE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E872C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8EA12560>]}
[0m22:04:02.369341 [debug] [MainThread]: Flushing usage events
[0m22:05:06.094372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC7E7E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCAA3A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCAA3A320>]}


============================== 22:05:06.097556 | d3ee074d-ef89-4d8a-9079-38043738bd3a ==============================
[0m22:05:06.097556 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:05:06.098559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:06.819967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3ee074d-ef89-4d8a-9079-38043738bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC8107EB0>]}
[0m22:05:06.864107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3ee074d-ef89-4d8a-9079-38043738bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE33497E0>]}
[0m22:05:06.866202 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:05:06.887361 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:05:07.120675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:05:07.121678 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:05:07.263704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3ee074d-ef89-4d8a-9079-38043738bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE3443AF0>]}
[0m22:05:07.387105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3ee074d-ef89-4d8a-9079-38043738bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE33AFC40>]}
[0m22:05:07.387105 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:05:07.388284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3ee074d-ef89-4d8a-9079-38043738bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE353E440>]}
[0m22:05:07.390298 [info ] [MainThread]: 
[0m22:05:07.390298 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:05:07.395315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:05:07.409502 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:05:07.410509 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:05:07.410509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:08.091478 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.681 seconds
[0m22:05:08.093493 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:05:08.220963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3ee074d-ef89-4d8a-9079-38043738bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE33AC5E0>]}
[0m22:05:08.220963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:08.221964 [info ] [MainThread]: 
[0m22:05:08.224967 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:05:08.225968 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:05:08.225968 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:05:08.227030 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:05:08.227030 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:05:08.228036 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:05:08.228036 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:05:08.228036 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:05:08.229541 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:05:08.229541 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:05:08.230620 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:05:08.230620 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:05:08.244857 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:05:08.251035 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:05:08.256052 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:05:08.257066 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:05:08.265429 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:05:08.272550 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:05:08.275564 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:05:08.276569 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:05:08.279593 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:05:08.280598 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:05:08.281795 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:05:08.281795 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:05:08.282800 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:05:08.283810 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:05:08.283810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:08.284816 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:05:08.284816 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:05:08.286864 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:05:08.920017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m22:05:08.927052 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:05:08.945969 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m22:05:08.947986 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:05:09.046984 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.82s]
[0m22:05:09.047987 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:05:09.063707 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.83s]
[0m22:05:09.064824 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:05:09.855321 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.570 seconds
[0m22:05:09.857335 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:05:09.989505 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.76s]
[0m22:05:09.990508 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:05:09.992144 [info ] [MainThread]: 
[0m22:05:09.992144 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:05:10.008461 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:05:10.013486 [debug] [MainThread]: Using snowflake connection "master"
[0m22:05:10.013486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:05:10.014486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:11.096123 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.082 seconds
[0m22:05:11.097146 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:05:11.110279 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:05:11.111284 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:05:11.112287 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:05:11.116435 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:05:11.120453 [debug] [MainThread]: Using snowflake connection "master"
[0m22:05:11.121465 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8189480304718018'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.834165096282959'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7614691257476807'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m22:05:11.523813 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.401 seconds
[0m22:05:11.524819 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.41s]
[0m22:05:11.524819 [info ] [MainThread]: 
[0m22:05:11.525833 [debug] [MainThread]: On master: Close
[0m22:05:11.646626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:11.647631 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:05:11.647631 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:05:11.647631 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:05:11.648636 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:05:11.648636 [info ] [MainThread]: 
[0m22:05:11.649640 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m22:05:11.650644 [debug] [MainThread]: Command end result
[0m22:05:11.686085 [info ] [MainThread]: 
[0m22:05:11.687090 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:05:11.688118 [info ] [MainThread]: 
[0m22:05:11.688118 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:05:11.689122 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:05:11.690188 [info ] [MainThread]: 
[0m22:05:11.690188 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:05:11.691191 [info ] [MainThread]: 
[0m22:05:11.691191 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:05:11.692210 [debug] [MainThread]: Command `dbt test` failed at 22:05:11.692210 after 5.65 seconds
[0m22:05:11.693223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC7E7E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC9E634C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE33ACFD0>]}
[0m22:05:11.693223 [debug] [MainThread]: Flushing usage events
[0m22:06:49.656699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74B2128F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74DDCE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74DDCE230>]}


============================== 22:06:49.658707 | d7abaec7-5f1a-4c58-8be4-7111e84ffd51 ==============================
[0m22:06:49.658707 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:06:49.659710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:50.362663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7abaec7-5f1a-4c58-8be4-7111e84ffd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74B49BCD0>]}
[0m22:06:50.408300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7abaec7-5f1a-4c58-8be4-7111e84ffd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74D24B760>]}
[0m22:06:50.409307 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:06:50.430688 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:06:50.675528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:06:50.676647 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:06:50.823392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7abaec7-5f1a-4c58-8be4-7111e84ffd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7667D3880>]}
[0m22:06:50.943934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7abaec7-5f1a-4c58-8be4-7111e84ffd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766BFEB60>]}
[0m22:06:50.945170 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:06:50.945170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7abaec7-5f1a-4c58-8be4-7111e84ffd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766BA74C0>]}
[0m22:06:50.946623 [info ] [MainThread]: 
[0m22:06:50.947624 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:06:50.951718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:06:50.966646 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:06:50.966646 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:06:50.967651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:51.600164 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.633 seconds
[0m22:06:51.602337 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:06:51.724291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7abaec7-5f1a-4c58-8be4-7111e84ffd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7668ED8D0>]}
[0m22:06:51.725294 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:06:51.725294 [info ] [MainThread]: 
[0m22:06:51.728393 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:06:51.729398 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:06:51.729398 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:06:51.729398 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:06:51.730403 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:06:51.731407 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:06:51.730403 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:06:51.732412 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:06:51.732412 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:06:51.733418 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:06:51.733418 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:06:51.747753 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:06:51.748910 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:06:51.754964 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:06:51.760186 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:06:51.761188 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:06:51.771477 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:06:51.776615 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:06:51.779634 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:06:51.779634 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:06:51.780638 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:06:51.783692 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:06:51.783692 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:06:51.784702 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:06:51.785708 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:51.786723 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:06:51.786723 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:06:51.788836 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:06:51.788836 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:06:51.789841 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:06:52.382797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m22:06:52.391495 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:06:52.392500 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m22:06:52.395516 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:06:52.518444 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.79s]
[0m22:06:52.520453 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:06:52.519447 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.79s]
[0m22:06:52.521461 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:06:53.319314 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.530 seconds
[0m22:06:53.321317 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:06:53.441967 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.71s]
[0m22:06:53.442970 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:06:53.444978 [info ] [MainThread]: 
[0m22:06:53.444978 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:06:53.461173 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:06:53.467294 [debug] [MainThread]: Using snowflake connection "master"
[0m22:06:53.467294 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:06:53.467294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:54.452233 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.984 seconds
[0m22:06:54.453774 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:06:54.466067 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:06:54.467070 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:06:54.468441 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:06:54.472471 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:06:54.476511 [debug] [MainThread]: Using snowflake connection "master"
[0m22:06:54.476511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7860321998596191'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7880399227142334'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7105591297149658'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set 
        target.compiled_sql = source.compiled_sql,
        target.test_result = source.test_result,
        target.execution_time_seconds = source.execution_time_seconds,
        target.is_active = true,
        target.last_updated_at = source.last_updated_at
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_updated_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_updated_at
      )
    when not matched by source then
      update set 
        target.is_active = false,
        target.last_updated_at = convert_timezone('America/New_York', current_TIMESTAMP::timestamp_ntz)
  
  ;
[0m22:06:54.560562 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8024-3201-72d3-000b-f6920001814a
[0m22:06:54.561572 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 180 at position 21 unexpected 'by'.
[0m22:06:54.561572 [info ] [MainThread]: Database error while running on-run-end
[0m22:06:54.562576 [debug] [MainThread]: On master: Close
[0m22:06:54.688838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:54.688838 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:06:54.689844 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:06:54.689844 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:06:54.690850 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:06:54.690850 [info ] [MainThread]: 
[0m22:06:54.691853 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m22:06:54.692900 [debug] [MainThread]: Command end result
[0m22:06:54.728204 [info ] [MainThread]: 
[0m22:06:54.729280 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:06:54.730284 [info ] [MainThread]: 
[0m22:06:54.731287 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:06:54.731287 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:06:54.732348 [info ] [MainThread]: 
[0m22:06:54.733354 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:06:54.733354 [info ] [MainThread]: 
[0m22:06:54.734362 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 180 at position 21 unexpected 'by'.
[0m22:06:54.734362 [info ] [MainThread]: 
[0m22:06:54.735401 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:06:54.736406 [debug] [MainThread]: Command `dbt test` failed at 22:06:54.736406 after 5.14 seconds
[0m22:06:54.737410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74B2128F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74D24B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766BFF670>]}
[0m22:06:54.737410 [debug] [MainThread]: Flushing usage events
[0m22:10:23.539144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E5322E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E55DEA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E55DEA320>]}


============================== 22:10:23.542090 | 408657c5-50a8-44ff-85b8-fd7821fa6a09 ==============================
[0m22:10:23.542090 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:10:23.543206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:24.267182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '408657c5-50a8-44ff-85b8-fd7821fa6a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E534B7EB0>]}
[0m22:10:24.311578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '408657c5-50a8-44ff-85b8-fd7821fa6a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E6F97E0>]}
[0m22:10:24.313586 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:10:24.334329 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:10:24.581934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:10:24.582938 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:10:24.727758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '408657c5-50a8-44ff-85b8-fd7821fa6a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E7F3AF0>]}
[0m22:10:24.851242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '408657c5-50a8-44ff-85b8-fd7821fa6a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E757C40>]}
[0m22:10:24.851242 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:10:24.852246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408657c5-50a8-44ff-85b8-fd7821fa6a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E8EE440>]}
[0m22:10:24.853272 [info ] [MainThread]: 
[0m22:10:24.854276 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:10:24.858310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:10:24.872473 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:10:24.872473 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:10:24.873474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:25.586552 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.713 seconds
[0m22:10:25.588560 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:10:25.712505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408657c5-50a8-44ff-85b8-fd7821fa6a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E7545E0>]}
[0m22:10:25.713508 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:10:25.714511 [info ] [MainThread]: 
[0m22:10:25.717527 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:10:25.717527 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:10:25.718528 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:10:25.718528 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:10:25.719590 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:10:25.719590 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:10:25.721098 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:10:25.721098 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:10:25.722103 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:10:25.723108 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:10:25.723108 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:10:25.724112 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:10:25.738891 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:10:25.745916 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:10:25.750571 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:10:25.751585 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:10:25.763160 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:10:25.768373 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:10:25.770881 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:10:25.771884 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:10:25.774897 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:10:25.775900 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:10:25.775900 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:10:25.776913 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:10:25.777918 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:10:25.777918 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:10:25.777918 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:10:25.778924 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:10:25.778924 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:10:25.780428 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:10:26.336796 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m22:10:26.343334 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:10:26.468261 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.75s]
[0m22:10:26.469265 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:10:27.366748 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.588 seconds
[0m22:10:27.367758 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:10:27.488903 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 1.77s]
[0m22:10:27.490407 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:10:27.521414 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.743 seconds
[0m22:10:27.523422 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:10:27.647325 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.93s]
[0m22:10:27.648335 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:10:27.650340 [info ] [MainThread]: 
[0m22:10:27.650340 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:10:27.666493 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:10:27.672097 [debug] [MainThread]: Using snowflake connection "master"
[0m22:10:27.673186 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:10:27.673186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:28.677623 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.004 seconds
[0m22:10:28.678628 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:10:28.691950 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:10:28.692956 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:10:28.694121 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:10:28.699163 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:10:28.702415 [debug] [MainThread]: Using snowflake connection "master"
[0m22:10:28.703537 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7461588382720947'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.768310308456421'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.9262275695800781'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set 
        target.compiled_sql = source.compiled_sql,
        target.test_result = source.test_result,
        target.execution_time_seconds = source.execution_time_seconds,
        target.is_active = true,
        target.last_updated_at = source.last_updated_at
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_updated_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_updated_at
      )
    when not matched by source and target.is_active = true then
      update set 
        target.is_active = false,
        target.last_updated_at = convert_timezone('America/New_York', current_TIMESTAMP::timestamp_ntz)
  
  ;
[0m22:10:28.789028 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8028-3201-72d0-000b-f692000173fa
[0m22:10:28.790532 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 180 at position 21 unexpected 'by'.
[0m22:10:28.791547 [info ] [MainThread]: Database error while running on-run-end
[0m22:10:28.791547 [debug] [MainThread]: On master: Close
[0m22:10:28.924388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:28.925391 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:10:28.925391 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:10:28.925391 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:10:28.926409 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:10:28.926409 [info ] [MainThread]: 
[0m22:10:28.927413 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m22:10:28.928416 [debug] [MainThread]: Command end result
[0m22:10:28.963933 [info ] [MainThread]: 
[0m22:10:28.964936 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:10:28.965937 [info ] [MainThread]: 
[0m22:10:28.967117 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:10:28.967117 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:10:28.968124 [info ] [MainThread]: 
[0m22:10:28.969130 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:10:28.969130 [info ] [MainThread]: 
[0m22:10:28.969130 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 180 at position 21 unexpected 'by'.
[0m22:10:28.970633 [info ] [MainThread]: 
[0m22:10:28.970633 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:10:28.972654 [debug] [MainThread]: Command `dbt test` failed at 22:10:28.971650 after 5.49 seconds
[0m22:10:28.972654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E5322E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E754940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E7579D0>]}
[0m22:10:28.972654 [debug] [MainThread]: Flushing usage events
[0m22:11:39.252529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001500695E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001500952A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001500952A350>]}


============================== 22:11:39.255540 | 4c07b83c-b804-4183-af53-1d97ad77e468 ==============================
[0m22:11:39.255540 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:11:39.255540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:11:39.967930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c07b83c-b804-4183-af53-1d97ad77e468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015006BE7970>]}
[0m22:11:40.011506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c07b83c-b804-4183-af53-1d97ad77e468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015006433580>]}
[0m22:11:40.013512 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:11:40.033940 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:11:40.284129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:11:40.285132 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:11:40.427221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c07b83c-b804-4183-af53-1d97ad77e468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015021E9C550>]}
[0m22:11:40.549290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c07b83c-b804-4183-af53-1d97ad77e468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502233DDE0>]}
[0m22:11:40.549290 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:11:40.550794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c07b83c-b804-4183-af53-1d97ad77e468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502202E0B0>]}
[0m22:11:40.552938 [info ] [MainThread]: 
[0m22:11:40.552938 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:11:40.557957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:11:40.571197 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:11:40.572203 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:11:40.572203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:41.194575 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.622 seconds
[0m22:11:41.195581 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:11:41.338752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c07b83c-b804-4183-af53-1d97ad77e468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502233E4A0>]}
[0m22:11:41.339755 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:11:41.340757 [info ] [MainThread]: 
[0m22:11:41.343207 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:11:41.344302 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:11:41.344302 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:11:41.344302 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:11:41.345311 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:11:41.346324 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:11:41.346324 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:11:41.347330 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:11:41.347330 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:11:41.348336 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:11:41.348336 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:11:41.349341 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:11:41.363763 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:11:41.369827 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:11:41.374353 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:11:41.375490 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:11:41.390093 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:11:41.391600 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:11:41.393610 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:11:41.394616 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:11:41.397636 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:11:41.399141 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:11:41.399141 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:11:41.400159 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:11:41.400159 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:11:41.401160 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:11:41.401666 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:11:41.401666 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:11:41.402671 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:11:41.405688 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:11:41.962688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m22:11:41.969323 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:11:42.095682 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.75s]
[0m22:11:42.096690 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:11:43.175743 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.770 seconds
[0m22:11:43.177759 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:11:43.295238 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.95s]
[0m22:11:43.296242 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:11:44.140769 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.738 seconds
[0m22:11:44.141784 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:11:44.262154 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.91s]
[0m22:11:44.263159 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:11:44.264165 [info ] [MainThread]: 
[0m22:11:44.265189 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:11:44.280844 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:11:44.286456 [debug] [MainThread]: Using snowflake connection "master"
[0m22:11:44.287461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:11:44.287461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:11:45.349200 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.062 seconds
[0m22:11:45.350928 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:11:45.363479 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:11:45.364482 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:11:45.365677 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:11:45.371213 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:11:45.374428 [debug] [MainThread]: Using snowflake connection "master"
[0m22:11:45.375431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7493572235107422'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.9479081630706787'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '2.9148244857788086'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    WHEN MATCHED THEN
      update set 
        target.compiled_sql = source.compiled_sql,
        target.test_result = source.test_result,
        target.execution_time_seconds = source.execution_time_seconds,
        target.is_active = true,
        target.last_updated_at = source.last_updated_at
    WHEN NOT MATCHED BY SOURCE AND target.is_active = true THEN
      update set 
        target.is_active = false,
        target.last_updated_at = convert_timezone('America/New_York', current_TIMESTAMP::timestamp_ntz)
    WHEN NOT MATCHED THEN
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_updated_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_updated_at
      )
  
  ;
[0m22:11:45.465422 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8029-3201-72e6-000b-f6920001a0ba
[0m22:11:45.465422 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 165 at position 21 unexpected 'BY'.
[0m22:11:45.466433 [info ] [MainThread]: Database error while running on-run-end
[0m22:11:45.467439 [debug] [MainThread]: On master: Close
[0m22:11:45.587134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:45.588137 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:11:45.588137 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:11:45.588137 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:11:45.589160 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:11:45.589160 [info ] [MainThread]: 
[0m22:11:45.590164 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m22:11:45.591166 [debug] [MainThread]: Command end result
[0m22:11:45.627124 [info ] [MainThread]: 
[0m22:11:45.627124 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:11:45.628129 [info ] [MainThread]: 
[0m22:11:45.629252 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:11:45.629252 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:11:45.630757 [info ] [MainThread]: 
[0m22:11:45.631774 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:11:45.631774 [info ] [MainThread]: 
[0m22:11:45.632783 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 165 at position 21 unexpected 'BY'.
[0m22:11:45.633789 [info ] [MainThread]: 
[0m22:11:45.633789 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:11:45.635800 [debug] [MainThread]: Command `dbt test` failed at 22:11:45.635800 after 6.44 seconds
[0m22:11:45.635800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001500695E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015006433580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502233FA60>]}
[0m22:11:45.636813 [debug] [MainThread]: Flushing usage events
[0m22:13:39.970661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224D3C2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224FFB6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224FFB6320>]}


============================== 22:13:39.973867 | 6c9a923a-855d-4436-badb-4a92e305be09 ==============================
[0m22:13:39.973867 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:13:39.974870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m22:13:40.687104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c9a923a-855d-4436-badb-4a92e305be09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224D64BEB0>]}
[0m22:13:40.732086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c9a923a-855d-4436-badb-4a92e305be09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222688897E0>]}
[0m22:13:40.734092 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:13:40.756240 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:13:41.003258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:13:41.004262 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:13:41.146434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c9a923a-855d-4436-badb-4a92e305be09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022268983AF0>]}
[0m22:13:41.292978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c9a923a-855d-4436-badb-4a92e305be09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222688EFC40>]}
[0m22:13:41.293986 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:13:41.294988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c9a923a-855d-4436-badb-4a92e305be09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022268A82440>]}
[0m22:13:41.297063 [info ] [MainThread]: 
[0m22:13:41.298451 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:13:41.303828 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:13:41.317023 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:13:41.317023 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:13:41.318028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:41.974923 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.657 seconds
[0m22:13:41.975928 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:13:42.097999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c9a923a-855d-4436-badb-4a92e305be09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222688EC5E0>]}
[0m22:13:42.099004 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:13:42.099004 [info ] [MainThread]: 
[0m22:13:42.102018 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:13:42.103059 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:13:42.103059 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:13:42.103059 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:13:42.104238 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:13:42.105240 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:13:42.104238 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:13:42.105240 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:13:42.106315 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:13:42.106315 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:13:42.107319 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:13:42.121522 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:13:42.121522 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:13:42.128722 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:13:42.134728 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:13:42.136099 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:13:42.152809 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:13:42.152809 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:13:42.153814 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:13:42.155830 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:13:42.156848 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:13:42.160076 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:13:42.161080 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:13:42.162085 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:13:42.162085 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:13:42.162085 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:13:42.163088 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:13:42.164186 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:13:42.165465 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:13:42.167480 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:13:42.721761 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.556 seconds
[0m22:13:42.727862 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:13:42.745789 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m22:13:42.747887 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:13:42.848607 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.74s]
[0m22:13:42.850110 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:13:42.864658 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.76s]
[0m22:13:42.866806 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:13:43.897103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.735 seconds
[0m22:13:43.898104 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:13:44.019164 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 1.91s]
[0m22:13:44.020857 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:13:44.022043 [info ] [MainThread]: 
[0m22:13:44.023050 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:13:44.038177 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:13:44.044344 [debug] [MainThread]: Using snowflake connection "master"
[0m22:13:44.045348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:13:44.045348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:13:45.013395 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.968 seconds
[0m22:13:45.014398 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:13:45.026550 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:13:45.028557 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:13:45.029561 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:13:45.033717 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:13:45.037719 [debug] [MainThread]: Using snowflake connection "master"
[0m22:13:45.037719 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7433667182922363'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7583422660827637'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.913924217224121'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    WHEN MATCHED THEN
      update set 
        target.compiled_sql = source.compiled_sql,
        target.test_result = source.test_result,
        target.execution_time_seconds = source.execution_time_seconds,
        target.is_active = true,
        target.last_updated_at = source.last_updated_at
    WHEN NOT MATCHED BY TARGET THEN
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_updated_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_updated_at
      )
    WHEN NOT MATCHED BY SOURCE THEN
      update set 
        target.is_active = false,
        target.last_updated_at = convert_timezone('America/New_York', current_TIMESTAMP::timestamp_ntz)
  
  ;
[0m22:13:45.124577 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba802b-3201-727e-000b-f69200019126
[0m22:13:45.125584 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 163 at position 21 unexpected 'BY'.
syntax error line 178 at position 21 unexpected 'BY'.
[0m22:13:45.125584 [info ] [MainThread]: Database error while running on-run-end
[0m22:13:45.126593 [debug] [MainThread]: On master: Close
[0m22:13:45.277109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:45.278121 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:13:45.278121 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:13:45.278121 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:13:45.279127 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:13:45.279127 [info ] [MainThread]: 
[0m22:13:45.280222 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m22:13:45.281230 [debug] [MainThread]: Command end result
[0m22:13:45.317921 [info ] [MainThread]: 
[0m22:13:45.317921 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:13:45.318928 [info ] [MainThread]: 
[0m22:13:45.319933 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:13:45.320938 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:13:45.320938 [info ] [MainThread]: 
[0m22:13:45.321974 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:13:45.321974 [info ] [MainThread]: 
[0m22:13:45.322979 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 163 at position 21 unexpected 'BY'.
syntax error line 178 at position 21 unexpected 'BY'.
[0m22:13:45.322979 [info ] [MainThread]: 
[0m22:13:45.323984 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:13:45.324988 [debug] [MainThread]: Command `dbt test` failed at 22:13:45.324988 after 5.41 seconds
[0m22:13:45.324988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224D3C2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222688EC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222688EF9D0>]}
[0m22:13:45.326054 [debug] [MainThread]: Flushing usage events
[0m22:15:18.578944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC53EDE860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC56A8E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC56A8E1D0>]}


============================== 22:15:18.582318 | 099fe1da-0227-4a52-8f06-f218ba5c501c ==============================
[0m22:15:18.582318 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:15:18.582318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:15:19.290522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '099fe1da-0227-4a52-8f06-f218ba5c501c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC5416B730>]}
[0m22:15:19.335034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '099fe1da-0227-4a52-8f06-f218ba5c501c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC56482EC0>]}
[0m22:15:19.336037 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:15:19.356788 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:15:19.603417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:15:19.604422 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:15:19.741433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '099fe1da-0227-4a52-8f06-f218ba5c501c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC6F550790>]}
[0m22:15:19.862045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '099fe1da-0227-4a52-8f06-f218ba5c501c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC6F8B2F80>]}
[0m22:15:19.862045 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:15:19.863054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099fe1da-0227-4a52-8f06-f218ba5c501c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC6F8F6EC0>]}
[0m22:15:19.864058 [info ] [MainThread]: 
[0m22:15:19.865062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:15:19.870165 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:15:19.883405 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:15:19.883405 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:15:19.884519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:20.524049 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.640 seconds
[0m22:15:20.526058 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:15:20.644895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099fe1da-0227-4a52-8f06-f218ba5c501c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC6F8B3AC0>]}
[0m22:15:20.645898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:20.645898 [info ] [MainThread]: 
[0m22:15:20.649751 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:15:20.649751 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:15:20.649751 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:15:20.650752 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:15:20.651257 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:15:20.651257 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:15:20.652262 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:15:20.653270 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:15:20.653270 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:15:20.654275 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:15:20.654275 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:15:20.654275 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:15:20.668507 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:15:20.675613 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:15:20.680673 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:15:20.681682 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:15:20.681682 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:15:20.697935 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:15:20.701211 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:15:20.701211 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:15:20.702410 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:15:20.705555 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:15:20.705555 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:15:20.706580 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:15:20.707584 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:15:20.707584 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:15:20.708631 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:15:20.709957 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:15:20.711244 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:15:20.712579 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:15:21.318637 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m22:15:21.319644 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m22:15:21.326698 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:15:21.327704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m22:15:21.328710 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:15:21.331728 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:15:21.453991 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.80s]
[0m22:15:21.454997 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:15:21.456127 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.80s]
[0m22:15:21.457142 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:15:21.457142 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.80s]
[0m22:15:21.458146 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:15:21.459168 [info ] [MainThread]: 
[0m22:15:21.460172 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:15:21.476936 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:15:21.483387 [debug] [MainThread]: Using snowflake connection "master"
[0m22:15:21.483387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:15:21.483387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:22.468018 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.984 seconds
[0m22:15:22.469027 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:15:22.482203 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:15:22.483210 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:15:22.485241 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:15:22.490341 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:15:22.493367 [debug] [MainThread]: Using snowflake connection "master"
[0m22:15:22.493367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8017292022705078'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8028576374053955'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8048801422119141'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target._timestamp::date = source._timestamp::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, _timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source._timestamp
      )
    when matched then
      update set
        test_result = source.test_result,
        execution_time_seconds = source.execution_time_seconds,
        _timestamp = source._timestamp
    when not matched by source and target.test_name not in ('not_null_my_first_dbt_model_id','unique_my_first_dbt_model_id','dbt_utils_expression_is_true_my_first_dbt_model_id___1') then
      update set
        test_result = 'inactive',
        _timestamp = current_timestamp
  
  ;
[0m22:15:22.577051 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba802d-3201-72e6-000b-f6920001a0f2
[0m22:15:22.578057 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 170 at position 21 unexpected 'by'.
[0m22:15:22.578057 [info ] [MainThread]: Database error while running on-run-end
[0m22:15:22.579063 [debug] [MainThread]: On master: Close
[0m22:15:22.704403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:22.705409 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:15:22.705409 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:15:22.705409 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:15:22.706415 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:15:22.706415 [info ] [MainThread]: 
[0m22:15:22.707420 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m22:15:22.708425 [debug] [MainThread]: Command end result
[0m22:15:22.746347 [info ] [MainThread]: 
[0m22:15:22.747351 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:15:22.747351 [info ] [MainThread]: 
[0m22:15:22.748356 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:15:22.749358 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:15:22.749358 [info ] [MainThread]: 
[0m22:15:22.750375 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:15:22.751381 [info ] [MainThread]: 
[0m22:15:22.751381 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 170 at position 21 unexpected 'by'.
[0m22:15:22.752386 [info ] [MainThread]: 
[0m22:15:22.752386 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:15:22.754407 [debug] [MainThread]: Command `dbt test` failed at 22:15:22.754407 after 4.23 seconds
[0m22:15:22.754407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC53EDE860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC56482EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC6F8B0FD0>]}
[0m22:15:22.755484 [debug] [MainThread]: Flushing usage events
[0m22:16:19.882316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F187E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F443E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F443E320>]}


============================== 22:16:19.885915 | 02c5a1f1-9939-4fb1-a4e2-b454fa59ed75 ==============================
[0m22:16:19.885915 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:16:19.886921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:16:20.611611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02c5a1f1-9939-4fb1-a4e2-b454fa59ed75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F1B07A90>]}
[0m22:16:20.661367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02c5a1f1-9939-4fb1-a4e2-b454fa59ed75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F1353520>]}
[0m22:16:20.662368 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:16:20.685705 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:16:20.934779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:16:20.934779 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:16:21.080858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02c5a1f1-9939-4fb1-a4e2-b454fa59ed75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FFF35360>]}
[0m22:16:21.203950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02c5a1f1-9939-4fb1-a4e2-b454fa59ed75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E48D13CCA0>]}
[0m22:16:21.205227 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:16:21.205227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02c5a1f1-9939-4fb1-a4e2-b454fa59ed75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E48D2DFA60>]}
[0m22:16:21.206670 [info ] [MainThread]: 
[0m22:16:21.207976 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:16:21.212011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:16:21.225702 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:16:21.226706 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:16:21.226706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:21.883153 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.656 seconds
[0m22:16:21.884164 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:16:22.022613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02c5a1f1-9939-4fb1-a4e2-b454fa59ed75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E48D309FF0>]}
[0m22:16:22.023617 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:16:22.024621 [info ] [MainThread]: 
[0m22:16:22.027707 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:16:22.027707 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:16:22.027707 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:16:22.027707 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:16:22.029153 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:16:22.029153 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:16:22.030165 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:16:22.031168 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:16:22.031168 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:16:22.031168 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:16:22.032602 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:16:22.032602 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:16:22.048052 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:16:22.054060 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:16:22.060430 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:16:22.061444 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:16:22.072941 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:16:22.078099 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:16:22.082102 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:16:22.082102 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:16:22.083103 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:16:22.086106 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:16:22.086106 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:16:22.087109 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:16:22.088110 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:16:22.088110 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:16:22.089110 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:16:22.090246 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:16:22.091252 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:16:22.093268 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:16:22.670939 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m22:16:22.678028 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:16:22.687182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m22:16:22.688185 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:16:22.796817 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.77s]
[0m22:16:22.798067 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:16:22.816282 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.79s]
[0m22:16:22.817289 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:16:23.615815 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.526 seconds
[0m22:16:23.618043 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:16:23.743959 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.71s]
[0m22:16:23.744963 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:16:23.745969 [info ] [MainThread]: 
[0m22:16:23.747123 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:16:23.764332 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:16:23.770531 [debug] [MainThread]: Using snowflake connection "master"
[0m22:16:23.771539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:16:23.771539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:24.750974 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.979 seconds
[0m22:16:24.751978 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:16:24.764153 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:16:24.766169 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:16:24.767180 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:16:24.772284 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:16:24.775295 [debug] [MainThread]: Using snowflake connection "master"
[0m22:16:24.776299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.765648603439331'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7861175537109375'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.713794231414795'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target._timestamp::date = source._timestamp::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, _timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source._timestamp
      )
    when matched then
      update set
        test_result = source.test_result,
        execution_time_seconds = source.execution_time_seconds,
        _timestamp = source._timestamp
    when not matched by source then
      update set
        test_result = 'inactive',
        _timestamp = current_timestamp
    where target.test_name not in ('unique_my_first_dbt_model_id','dbt_utils_expression_is_true_my_first_dbt_model_id___1','not_null_my_first_dbt_model_id')
  
  ;
[0m22:16:24.859533 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba802e-3201-7237-000b-f6920001477e
[0m22:16:24.859533 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 170 at position 21 unexpected 'by'.
[0m22:16:24.860534 [info ] [MainThread]: Database error while running on-run-end
[0m22:16:24.860534 [debug] [MainThread]: On master: Close
[0m22:16:24.976189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:24.977192 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:16:24.977192 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:16:24.978196 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:16:24.978196 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:16:24.978196 [info ] [MainThread]: 
[0m22:16:24.979200 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m22:16:24.980204 [debug] [MainThread]: Command end result
[0m22:16:25.015721 [info ] [MainThread]: 
[0m22:16:25.016723 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:16:25.017920 [info ] [MainThread]: 
[0m22:16:25.018924 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:16:25.018924 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:16:25.019929 [info ] [MainThread]: 
[0m22:16:25.019929 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:16:25.021195 [info ] [MainThread]: 
[0m22:16:25.022221 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 170 at position 21 unexpected 'by'.
[0m22:16:25.022221 [info ] [MainThread]: 
[0m22:16:25.023225 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:16:25.024231 [debug] [MainThread]: Command `dbt test` failed at 22:16:25.024231 after 5.20 seconds
[0m22:16:25.025234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F187E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FFD7B880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F385ED10>]}
[0m22:16:25.025234 [debug] [MainThread]: Flushing usage events
[0m22:18:51.730980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D3345E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D35FEA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D35FEA2F0>]}


============================== 22:18:51.733993 | fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9 ==============================
[0m22:18:51.733993 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:18:51.734996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:18:52.503636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D35FA6980>]}
[0m22:18:52.550666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D33D07730>]}
[0m22:18:52.551667 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:18:52.575418 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:18:52.818266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:18:52.819267 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:18:52.961839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4E955840>]}
[0m22:18:53.082411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4EDF9990>]}
[0m22:18:53.083416 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:18:53.083416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4EDC7D30>]}
[0m22:18:53.085583 [info ] [MainThread]: 
[0m22:18:53.086590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:18:53.092642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:18:53.106884 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:18:53.106884 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:18:53.106884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:53.762014 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.655 seconds
[0m22:18:53.764026 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:18:53.886095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4E8D2DA0>]}
[0m22:18:53.887110 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:53.887110 [info ] [MainThread]: 
[0m22:18:53.890250 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:18:53.891255 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:18:53.891255 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:18:53.892292 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:18:53.892292 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:18:53.893297 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:18:53.894302 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:18:53.894302 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:18:53.895306 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:18:53.895306 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:18:53.896311 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:18:53.896311 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:18:53.912829 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:18:53.918873 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:18:53.926212 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:18:53.927218 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:18:53.927218 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:18:53.944767 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:18:53.944767 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:18:53.947788 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:18:53.950802 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:18:53.951951 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:18:53.952953 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:18:53.952953 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:18:53.953978 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:18:53.953978 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:18:53.954984 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:18:53.956995 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:18:53.956995 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:18:53.958000 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:18:54.539130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m22:18:54.546158 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:18:54.547169 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m22:18:54.549181 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:18:54.666137 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.77s]
[0m22:18:54.668149 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:18:54.671210 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m22:18:54.672215 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:18:55.527455 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.569 seconds
[0m22:18:55.528455 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:18:55.662578 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.77s]
[0m22:18:55.663586 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:18:55.664590 [info ] [MainThread]: 
[0m22:18:55.665595 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:18:55.680752 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:18:55.686412 [debug] [MainThread]: Using snowflake connection "master"
[0m22:18:55.687432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:18:55.687432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:56.678379 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.991 seconds
[0m22:18:56.680381 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:18:56.693384 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:18:56.694393 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:18:56.695843 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:18:56.700365 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:18:56.705526 [debug] [MainThread]: Using snowflake connection "master"
[0m22:18:56.705526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7728395462036133'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7769088745117188'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7672719955444336'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target._timestamp::date = source._timestamp::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, _timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source._timestamp
      )
  
  ;
[0m22:18:56.809636 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8030-3201-72d0-000b-f6920001742a
[0m22:18:56.810640 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 156 at position 54
invalid identifier '_TIMESTAMP'
[0m22:18:56.810640 [info ] [MainThread]: Database error while running on-run-end
[0m22:18:56.811651 [debug] [MainThread]: On master: Close
[0m22:18:56.928301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:56.928301 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:18:56.929307 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:18:56.929307 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:18:56.930310 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:18:56.930310 [info ] [MainThread]: 
[0m22:18:56.931320 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m22:18:56.932386 [debug] [MainThread]: Command end result
[0m22:18:56.970017 [info ] [MainThread]: 
[0m22:18:56.970017 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:18:56.971021 [info ] [MainThread]: 
[0m22:18:56.972022 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:18:56.972022 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:18:56.973388 [info ] [MainThread]: 
[0m22:18:56.973388 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:18:56.974392 [info ] [MainThread]: 
[0m22:18:56.974392 [error] [MainThread]:   on-run-end failed, error:
 000904 (42000): SQL compilation error: error line 156 at position 54
invalid identifier '_TIMESTAMP'
[0m22:18:56.975396 [info ] [MainThread]: 
[0m22:18:56.975396 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:18:56.977412 [debug] [MainThread]: Command `dbt test` failed at 22:18:56.976409 after 5.31 seconds
[0m22:18:56.977412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D3345E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D33D07730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4EDF90C0>]}
[0m22:18:56.978537 [debug] [MainThread]: Flushing usage events
[0m22:19:22.962193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB64AE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB906A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB906A320>]}


============================== 22:19:22.965598 | fb9a4068-f7dd-4d42-af55-482c5bb591c5 ==============================
[0m22:19:22.965598 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:19:22.966601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:19:23.689976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb9a4068-f7dd-4d42-af55-482c5bb591c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB6737A90>]}
[0m22:19:23.734961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb9a4068-f7dd-4d42-af55-482c5bb591c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB5F83520>]}
[0m22:19:23.735964 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:19:23.757291 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:19:24.011749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:19:24.011749 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:19:24.153764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb9a4068-f7dd-4d42-af55-482c5bb591c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD1AD91B0>]}
[0m22:19:24.275400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb9a4068-f7dd-4d42-af55-482c5bb591c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD19DEDD0>]}
[0m22:19:24.275400 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:19:24.276410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb9a4068-f7dd-4d42-af55-482c5bb591c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD1B6E470>]}
[0m22:19:24.278419 [info ] [MainThread]: 
[0m22:19:24.278419 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:19:24.283491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:19:24.297696 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:19:24.298701 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:19:24.298701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:24.930527 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.632 seconds
[0m22:19:24.931531 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:19:25.059199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb9a4068-f7dd-4d42-af55-482c5bb591c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD19DF130>]}
[0m22:19:25.059199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:19:25.060201 [info ] [MainThread]: 
[0m22:19:25.063312 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:25.063312 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:25.063312 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:25.064316 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:19:25.064316 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:19:25.065820 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:19:25.066428 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:19:25.066428 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:19:25.067440 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:19:25.067440 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:25.068446 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:25.068446 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:25.085928 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:19:25.094770 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:19:25.100054 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:19:25.101058 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:25.112140 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:25.118288 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:19:25.122390 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:19:25.122390 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:25.123465 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:19:25.126495 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:19:25.127511 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:19:25.128108 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:19:25.129114 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:19:25.129114 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:19:25.130119 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:19:25.130119 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:19:25.131123 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:19:25.133541 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:19:25.717122 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m22:19:25.724155 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:19:25.726953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m22:19:25.728739 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:19:25.849330 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.78s]
[0m22:19:25.850804 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:25.855933 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.79s]
[0m22:19:25.856937 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:26.693201 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.563 seconds
[0m22:19:26.695208 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:19:26.822131 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.76s]
[0m22:19:26.823135 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:26.825353 [info ] [MainThread]: 
[0m22:19:26.825353 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:19:26.841793 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:19:26.846813 [debug] [MainThread]: Using snowflake connection "master"
[0m22:19:26.846813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:19:26.847816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:19:27.820433 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.973 seconds
[0m22:19:27.822446 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:19:27.834465 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:19:27.836610 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:19:27.837837 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:19:27.842868 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:19:27.847086 [debug] [MainThread]: Using snowflake connection "master"
[0m22:19:27.847086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7818901538848877'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7901122570037842'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7557024955749512'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m22:19:28.230223 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.382 seconds
[0m22:19:28.231373 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 3[0m in 0.39s]
[0m22:19:28.232376 [info ] [MainThread]: 
[0m22:19:28.232376 [debug] [MainThread]: On master: Close
[0m22:19:28.358540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:28.359550 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:19:28.359550 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:19:28.360553 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:19:28.360553 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:19:28.360553 [info ] [MainThread]: 
[0m22:19:28.361559 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m22:19:28.362565 [debug] [MainThread]: Command end result
[0m22:19:28.399657 [info ] [MainThread]: 
[0m22:19:28.400781 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:19:28.400781 [info ] [MainThread]: 
[0m22:19:28.401793 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:19:28.402796 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:19:28.402796 [info ] [MainThread]: 
[0m22:19:28.403804 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:19:28.404809 [info ] [MainThread]: 
[0m22:19:28.404809 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:19:28.406821 [debug] [MainThread]: Command `dbt test` failed at 22:19:28.406821 after 5.50 seconds
[0m22:19:28.407825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB64AE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB848F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD233C340>]}
[0m22:19:28.407825 [debug] [MainThread]: Flushing usage events
[0m22:19:50.720048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D79EE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213DA5AE530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213DA5AE350>]}


============================== 22:19:50.723269 | 2cd9f384-3270-4969-8447-b6ecedcaed7c ==============================
[0m22:19:50.723269 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:19:50.723269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:19:51.443479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cd9f384-3270-4969-8447-b6ecedcaed7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D7C77970>]}
[0m22:19:51.488167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cd9f384-3270-4969-8447-b6ecedcaed7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D74C3580>]}
[0m22:19:51.490176 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:19:51.511558 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:19:51.750016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:19:51.750016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:19:51.797657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cd9f384-3270-4969-8447-b6ecedcaed7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F33F0130>]}
[0m22:19:51.964672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cd9f384-3270-4969-8447-b6ecedcaed7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F2EE02E0>]}
[0m22:19:51.965679 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:19:51.965679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd9f384-3270-4969-8447-b6ecedcaed7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213DA0A4760>]}
[0m22:19:51.968012 [info ] [MainThread]: 
[0m22:19:51.968012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:19:51.973204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:19:51.986935 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:19:51.988008 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:19:51.988008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:52.661413 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.673 seconds
[0m22:19:52.663415 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:19:52.782186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd9f384-3270-4969-8447-b6ecedcaed7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F2EE39A0>]}
[0m22:19:52.782186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:19:52.783191 [info ] [MainThread]: 
[0m22:19:52.786214 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:52.787216 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:52.787216 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:52.787216 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:19:52.788238 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:19:52.788238 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:19:52.789241 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:19:52.790242 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:19:52.790242 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:19:52.791242 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:52.791242 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:52.792243 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:52.807611 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:19:52.813801 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:19:52.818812 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:19:52.818812 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:52.837992 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:19:52.838996 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:52.838996 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:52.842153 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:19:52.843317 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:19:52.845321 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:19:52.845321 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:19:52.846805 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:19:52.846805 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:19:52.847999 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:19:52.847999 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:19:52.850227 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:19:52.851317 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:19:52.851317 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:19:53.378980 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m22:19:53.386219 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:19:53.418433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m22:19:53.420445 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:19:53.505592 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.72s]
[0m22:19:53.506596 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:53.542382 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.75s]
[0m22:19:53.543393 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:54.386015 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.535 seconds
[0m22:19:54.388023 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:19:54.505892 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.72s]
[0m22:19:54.507039 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:54.508042 [info ] [MainThread]: 
[0m22:19:54.509126 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:19:54.525562 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:19:54.530572 [debug] [MainThread]: Using snowflake connection "master"
[0m22:19:54.530572 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:19:54.531573 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:19:55.532070 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.000 seconds
[0m22:19:55.533073 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:19:55.546356 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:19:55.547708 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:19:55.549258 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:19:55.553902 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:19:55.557512 [debug] [MainThread]: Using snowflake connection "master"
[0m22:19:55.558535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7163510322570801'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7531418800354004'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7156500816345215'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m22:19:55.919470 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.360 seconds
[0m22:19:55.920476 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.37s]
[0m22:19:55.921483 [info ] [MainThread]: 
[0m22:19:55.921483 [debug] [MainThread]: On master: Close
[0m22:19:56.038097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:56.038097 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:19:56.039105 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:19:56.039105 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:19:56.040109 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:19:56.040109 [info ] [MainThread]: 
[0m22:19:56.041112 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m22:19:56.043316 [debug] [MainThread]: Command end result
[0m22:19:56.079153 [info ] [MainThread]: 
[0m22:19:56.079153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:19:56.080156 [info ] [MainThread]: 
[0m22:19:56.081392 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:19:56.081392 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:19:56.081392 [info ] [MainThread]: 
[0m22:19:56.082791 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:19:56.083796 [info ] [MainThread]: 
[0m22:19:56.083796 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:19:56.085042 [debug] [MainThread]: Command `dbt test` failed at 22:19:56.085042 after 5.42 seconds
[0m22:19:56.085042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D79EE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D74C3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F3765930>]}
[0m22:19:56.086340 [debug] [MainThread]: Flushing usage events
[0m22:21:34.935598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC40E02950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC439BE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC439BE320>]}


============================== 22:21:34.938607 | 0c423a0a-0e85-4189-a531-25c4698aa656 ==============================
[0m22:21:34.938607 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:21:34.939610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:21:35.680809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c423a0a-0e85-4189-a531-25c4698aa656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC41087A90>]}
[0m22:21:35.723450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c423a0a-0e85-4189-a531-25c4698aa656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC408D3520>]}
[0m22:21:35.724453 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:21:35.744672 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:21:35.973891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:21:35.974894 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:21:36.112238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c423a0a-0e85-4189-a531-25c4698aa656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5C4291B0>]}
[0m22:21:36.232993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c423a0a-0e85-4189-a531-25c4698aa656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5C326DD0>]}
[0m22:21:36.232993 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:21:36.233997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c423a0a-0e85-4189-a531-25c4698aa656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5C4BE470>]}
[0m22:21:36.235004 [info ] [MainThread]: 
[0m22:21:36.236007 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:21:36.240020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:21:36.254576 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:21:36.254576 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:21:36.255595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:36.985780 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.730 seconds
[0m22:21:36.986781 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:21:37.109952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c423a0a-0e85-4189-a531-25c4698aa656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5C327130>]}
[0m22:21:37.111751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:21:37.111751 [info ] [MainThread]: 
[0m22:21:37.115468 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:21:37.115468 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:21:37.116591 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:21:37.116591 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:21:37.117597 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:21:37.118605 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:21:37.118605 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:21:37.119611 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:21:37.120619 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:21:37.120619 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:21:37.120619 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:21:37.122124 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:21:37.137420 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:21:37.142869 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:21:37.149071 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:21:37.150082 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:21:37.150082 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:21:37.165715 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:21:37.167722 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:21:37.168725 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:21:37.171744 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:21:37.172849 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:21:37.172849 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:21:37.173854 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:21:37.173854 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:21:37.174857 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:21:37.174857 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:21:37.175982 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:21:37.175982 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:21:37.178003 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:21:37.784060 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m22:21:37.791105 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:21:37.941434 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.82s]
[0m22:21:37.942442 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:21:38.726980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.552 seconds
[0m22:21:38.728990 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:21:38.851705 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 1.73s]
[0m22:21:38.852711 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:21:39.869126 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.693 seconds
[0m22:21:39.871136 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:21:39.994648 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.88s]
[0m22:21:39.995655 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:21:39.996667 [info ] [MainThread]: 
[0m22:21:39.997670 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:21:40.012798 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:21:40.018989 [debug] [MainThread]: Using snowflake connection "master"
[0m22:21:40.018989 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:21:40.019990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:41.043867 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.024 seconds
[0m22:21:41.044870 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:21:41.058021 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:21:41.059026 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:21:41.060048 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:21:41.065086 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:21:41.067097 [debug] [MainThread]: Using snowflake connection "master"
[0m22:21:41.068114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8218221664428711'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7330996990203857'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '2.8750362396240234'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m22:21:41.534917 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.466 seconds
[0m22:21:41.535918 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 3[0m in 0.47s]
[0m22:21:41.535918 [info ] [MainThread]: 
[0m22:21:41.537319 [debug] [MainThread]: On master: Close
[0m22:21:41.693963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:41.693963 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:21:41.693963 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:21:41.695173 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:21:41.695173 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:21:41.696178 [info ] [MainThread]: 
[0m22:21:41.696178 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m22:21:41.697181 [debug] [MainThread]: Command end result
[0m22:21:41.734812 [info ] [MainThread]: 
[0m22:21:41.735817 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:21:41.736828 [info ] [MainThread]: 
[0m22:21:41.737861 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:21:41.737861 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:21:41.738889 [info ] [MainThread]: 
[0m22:21:41.739894 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:21:41.739894 [info ] [MainThread]: 
[0m22:21:41.740975 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:21:41.743203 [debug] [MainThread]: Command `dbt test` failed at 22:21:41.742193 after 6.86 seconds
[0m22:21:41.743203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC40E02950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC42DE2D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5C326740>]}
[0m22:21:41.743203 [debug] [MainThread]: Flushing usage events
[0m22:22:46.999856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F35672980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3826A680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3826A4A0>]}


============================== 22:22:47.002938 | 13a833c1-92bd-49c1-a5ff-7b2c5ad3060f ==============================
[0m22:22:47.002938 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:22:47.004152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:22:47.712181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13a833c1-92bd-49c1-a5ff-7b2c5ad3060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F358F7DC0>]}
[0m22:22:47.760469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13a833c1-92bd-49c1-a5ff-7b2c5ad3060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F35173550>]}
[0m22:22:47.761474 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:22:47.783078 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:22:48.027443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:22:48.027443 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m22:22:48.028447 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_second_dbt_model.sql
[0m22:22:48.202809 [error] [MainThread]: Encountered an error:
Compilation Error in model my_second_dbt_model (models\example\my_second_dbt_model.sql)
  expected token ',', got 'tags'
    line 3
      tags=['example_1']
[0m22:22:48.204203 [debug] [MainThread]: Command `dbt build` failed at 22:22:48.204203 after 1.26 seconds
[0m22:22:48.204203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F35672980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F510EB940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F510EBB80>]}
[0m22:22:48.205220 [debug] [MainThread]: Flushing usage events
[0m22:22:56.936274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021203CFE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212068C26B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212068C24D0>]}


============================== 22:22:56.939287 | 6d2711ed-11bf-4570-bcc2-83ed6a770d3c ==============================
[0m22:22:56.939287 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:22:56.940294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:57.653589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d2711ed-11bf-4570-bcc2-83ed6a770d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021203F87940>]}
[0m22:22:57.698457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d2711ed-11bf-4570-bcc2-83ed6a770d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212037D35B0>]}
[0m22:22:57.699460 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:22:57.719907 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:22:57.948286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:22:57.949289 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m22:22:57.949289 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_second_dbt_model.sql
[0m22:22:58.309206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d2711ed-11bf-4570-bcc2-83ed6a770d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121FA20130>]}
[0m22:22:58.429625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d2711ed-11bf-4570-bcc2-83ed6a770d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121FA23580>]}
[0m22:22:58.430626 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m22:22:58.432662 [info ] [MainThread]: 
[0m22:22:58.432662 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:22:58.434671 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m22:22:58.444855 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m22:22:58.445860 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m22:22:58.445860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:59.058732 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.613 seconds
[0m22:22:59.059736 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m22:22:59.190202 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:22:59.197238 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:22:59.197238 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:22:59.198241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:59.768798 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.571 seconds
[0m22:22:59.770810 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:22:59.888149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d2711ed-11bf-4570-bcc2-83ed6a770d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121F9B4BB0>]}
[0m22:22:59.889158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:22:59.889158 [info ] [MainThread]: 
[0m22:22:59.892385 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m22:22:59.893391 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m22:22:59.893391 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m22:22:59.894397 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m22:22:59.901574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m22:22:59.902579 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m22:22:59.925855 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m22:22:59.926861 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m22:22:59.926861 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m22:22:59.927867 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:23:00.798693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.870 seconds
[0m22:23:00.813872 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m22:23:00.932213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2711ed-11bf-4570-bcc2-83ed6a770d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121F19FC40>]}
[0m22:23:00.933216 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.04s]
[0m22:23:00.934229 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m22:23:00.935372 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m22:23:00.935372 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m22:23:00.936385 [info ] [Thread-3 (]: 2 of 3 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m22:23:00.936385 [info ] [Thread-4 (]: 3 of 3 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m22:23:00.937464 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m22:23:00.938494 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m22:23:00.938494 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m22:23:00.939497 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m22:23:00.948536 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m22:23:00.954720 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:23:00.956730 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m22:23:00.956730 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m22:23:00.971991 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m22:23:00.974995 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:23:00.976107 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m22:23:00.977110 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:23:00.977110 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:23:00.977110 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:23:00.978526 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:23:00.978526 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:23:01.598746 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m22:23:01.601874 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m22:23:01.731913 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.79s]
[0m22:23:01.732920 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m22:23:02.535155 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.557 seconds
[0m22:23:02.537164 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m22:23:02.655439 [info ] [Thread-3 (]: 2 of 3 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.72s]
[0m22:23:02.656921 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m22:23:02.657928 [info ] [MainThread]: 
[0m22:23:02.658933 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:23:02.675148 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:23:02.681581 [debug] [MainThread]: Using snowflake connection "master"
[0m22:23:02.681581 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:23:02.682732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:23:03.646064 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.963 seconds
[0m22:23:03.647072 [info ] [MainThread]: extracted_names [['my_second_dbt_model']]
[0m22:23:03.660200 [info ] [MainThread]: extracted_names [['my_second_dbt_model']]
[0m22:23:03.661205 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:23:03.666232 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:23:03.730527 [debug] [MainThread]: Using snowflake connection "master"
[0m22:23:03.731532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7944488525390625'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.717975378036499'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m22:23:04.244009 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.512 seconds
[0m22:23:04.245013 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.58s]
[0m22:23:04.246017 [info ] [MainThread]: 
[0m22:23:04.246017 [debug] [MainThread]: On master: Close
[0m22:23:04.366164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:04.367169 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m22:23:04.367169 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:23:04.367169 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m22:23:04.368175 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m22:23:04.368175 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m22:23:04.368175 [info ] [MainThread]: 
[0m22:23:04.369179 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 5.94 seconds (5.94s).
[0m22:23:04.371199 [debug] [MainThread]: Command end result
[0m22:23:04.408014 [info ] [MainThread]: 
[0m22:23:04.408014 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:23:04.409019 [info ] [MainThread]: 
[0m22:23:04.409019 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:23:04.411028 [debug] [MainThread]: Command `dbt build` succeeded at 22:23:04.411028 after 7.53 seconds
[0m22:23:04.411028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021203CFE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121F7FCC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121F7FCCD0>]}
[0m22:23:04.412059 [debug] [MainThread]: Flushing usage events
[0m22:45:16.155275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C4EB6E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C5172E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C5172E2F0>]}


============================== 22:45:16.157426 | 9fd319bd-bb6a-4078-a22f-e4fda18a2233 ==============================
[0m22:45:16.157426 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:45:16.158429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:45:16.882043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fd319bd-bb6a-4078-a22f-e4fda18a2233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C516E6980>]}
[0m22:45:16.926675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fd319bd-bb6a-4078-a22f-e4fda18a2233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C4F42A2C0>]}
[0m22:45:16.928682 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:45:16.949934 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:45:17.195488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:45:17.196491 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m22:45:17.197494 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:45:17.560875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fd319bd-bb6a-4078-a22f-e4fda18a2233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6A88BE50>]}
[0m22:45:17.678818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fd319bd-bb6a-4078-a22f-e4fda18a2233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6A88B8B0>]}
[0m22:45:17.678818 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:45:17.679825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd319bd-bb6a-4078-a22f-e4fda18a2233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6A2F3D60>]}
[0m22:45:17.681839 [info ] [MainThread]: 
[0m22:45:17.681839 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:45:17.686857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:45:17.699881 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:45:17.699881 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:45:17.700882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:18.374438 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.674 seconds
[0m22:45:18.375442 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:45:18.494769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd319bd-bb6a-4078-a22f-e4fda18a2233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6A888C10>]}
[0m22:45:18.495773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:45:18.496777 [info ] [MainThread]: 
[0m22:45:18.498877 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:45:18.499881 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:45:18.499881 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:45:18.500886 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:45:18.500886 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:45:18.501892 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:45:18.502900 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:45:18.502900 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:45:18.503900 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:45:18.503900 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:45:18.504901 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:45:18.504901 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:45:18.520545 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:45:18.526584 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:45:18.532709 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:45:18.533717 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:45:18.543802 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:45:18.549964 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:45:18.551980 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:45:18.552984 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:45:18.554998 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:45:18.556004 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:45:18.557010 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:45:18.557010 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:45:18.558016 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:45:18.558016 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:45:18.559021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:45:18.559021 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:45:18.560172 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:45:18.563207 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:45:19.153049 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m22:45:19.161081 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:45:19.161081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m22:45:19.164224 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:45:19.283290 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m22:45:19.284295 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:45:19.295345 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.79s]
[0m22:45:19.296350 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:45:20.317640 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.754 seconds
[0m22:45:20.318652 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:45:20.437496 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.93s]
[0m22:45:20.438499 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:45:20.439537 [info ] [MainThread]: 
[0m22:45:20.440549 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:45:20.457266 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:45:20.462572 [debug] [MainThread]: Using snowflake connection "master"
[0m22:45:20.463648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:45:20.463648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:45:21.791186 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.327 seconds
[0m22:45:21.792197 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:45:21.804325 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:45:21.806342 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:45:21.807347 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:45:21.811471 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:45:21.815495 [debug] [MainThread]: Using snowflake connection "master"
[0m22:45:21.816501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  with current_test_runs as (
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.780390739440918'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7934534549713135'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.9335956573486328'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    
  
  
  )
  select 
    s.*,
    'Y' as is_active,
    current_timestamp as created_timestamp,
    null as deactivated_timestamp
  from current_test_runs s
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      )
    when not matched by source and target.is_active = 'Y' then
      update set 
        is_active = 'N',
        deactivated_timestamp = current_timestamp
  
  ;
[0m22:45:21.902076 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba804b-3201-7237-000b-f692000147ae
[0m22:45:21.902076 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 177 at position 21 unexpected 'by'.
[0m22:45:21.903080 [info ] [MainThread]: Database error while running on-run-end
[0m22:45:21.903080 [debug] [MainThread]: On master: Close
[0m22:45:22.020562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:45:22.021565 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:45:22.021565 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:45:22.021565 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:45:22.022569 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:45:22.022569 [info ] [MainThread]: 
[0m22:45:22.023575 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m22:45:22.024579 [debug] [MainThread]: Command end result
[0m22:45:22.122359 [info ] [MainThread]: 
[0m22:45:22.123364 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:45:22.123364 [info ] [MainThread]: 
[0m22:45:22.124370 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:45:22.125374 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:45:22.126401 [info ] [MainThread]: 
[0m22:45:22.126401 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:45:22.127405 [info ] [MainThread]: 
[0m22:45:22.128437 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 177 at position 21 unexpected 'by'.
[0m22:45:22.128437 [info ] [MainThread]: 
[0m22:45:22.129440 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:45:22.130457 [debug] [MainThread]: Command `dbt test` failed at 22:45:22.130457 after 6.03 seconds
[0m22:45:22.131461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C4EB6E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6AC895D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6AC8AE00>]}
[0m22:45:22.131461 [debug] [MainThread]: Flushing usage events
[0m22:47:37.980429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFA992920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFD54A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFD54A320>]}


============================== 22:47:37.983027 | 8e594462-4e7b-4cb9-9902-1278d22c6d5b ==============================
[0m22:47:37.983027 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:47:37.984222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:47:38.760279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e594462-4e7b-4cb9-9902-1278d22c6d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFAC17EB0>]}
[0m22:47:38.805698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e594462-4e7b-4cb9-9902-1278d22c6d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C95F097E0>]}
[0m22:47:38.807704 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:47:38.829246 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:47:39.077961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:47:39.078962 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:47:39.218207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e594462-4e7b-4cb9-9902-1278d22c6d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C96439750>]}
[0m22:47:39.367284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e594462-4e7b-4cb9-9902-1278d22c6d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C961C83A0>]}
[0m22:47:39.367284 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:47:39.368285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e594462-4e7b-4cb9-9902-1278d22c6d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C963ED7B0>]}
[0m22:47:39.370318 [info ] [MainThread]: 
[0m22:47:39.371334 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:47:39.376360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:47:39.390705 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:47:39.391709 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:47:39.391709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:40.066813 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.675 seconds
[0m22:47:40.068835 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:47:40.194297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e594462-4e7b-4cb9-9902-1278d22c6d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C96433AC0>]}
[0m22:47:40.195335 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:40.196347 [info ] [MainThread]: 
[0m22:47:40.199366 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:47:40.199366 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:47:40.200760 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:47:40.200760 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:47:40.202001 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:47:40.203038 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:47:40.204044 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:47:40.204044 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:47:40.205050 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:47:40.205050 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:47:40.206553 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:47:40.206553 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:47:40.222019 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:47:40.229251 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:47:40.235392 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:47:40.236400 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:47:40.252794 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:47:40.253803 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:47:40.253803 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:47:40.257833 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:47:40.259846 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:47:40.260850 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:47:40.261984 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:47:40.261984 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:47:40.262990 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:40.263998 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:47:40.263998 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:47:40.266010 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:47:40.267017 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:47:40.267017 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:47:40.905137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m22:47:40.911685 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:47:40.935455 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m22:47:40.937473 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:47:41.033121 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.83s]
[0m22:47:41.035131 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:47:41.056392 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.85s]
[0m22:47:41.057396 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:47:41.784096 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.517 seconds
[0m22:47:41.786114 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:47:41.909277 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.70s]
[0m22:47:41.911322 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:47:41.913336 [info ] [MainThread]: 
[0m22:47:41.913336 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:47:41.930065 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:47:41.936100 [debug] [MainThread]: Using snowflake connection "master"
[0m22:47:41.936100 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:47:41.937103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:42.980635 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.043 seconds
[0m22:47:42.994693 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:47:42.999779 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:47:43.002798 [debug] [MainThread]: Using snowflake connection "master"
[0m22:47:43.003801 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
  

  with current_test_runs as (select
        md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
        'expression_is_true'::varchar(4000) as test_name,
        'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
        'generic'::varchar(250) as test_type,
        'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
        ''::varchar(10000) as source_refs,
        'ERROR'::varchar(250) as test_severity_config,
        '0.8300833702087402'::text as execution_time_seconds,
        'pass'::varchar(125) as test_result,
        'models\example\schema.yml'::varchar(4000) as file_test_defined,
        'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
        convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP union allselect
        md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
        'not_null'::varchar(4000) as test_name,
        'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
        'generic'::varchar(250) as test_type,
        'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
        ''::varchar(10000) as source_refs,
        'ERROR'::varchar(250) as test_severity_config,
        '0.8523480892181396'::text as execution_time_seconds,
        'fail'::varchar(125) as test_result,
        'models\example\schema.yml'::varchar(4000) as file_test_defined,
        'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
        convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP union allselect
        md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
        'unique'::varchar(4000) as test_name,
        'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
        'generic'::varchar(250) as test_type,
        'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
        ''::varchar(10000) as source_refs,
        'ERROR'::varchar(250) as test_severity_config,
        '1.7042264938354492'::text as execution_time_seconds,
        'pass'::varchar(125) as test_result,
        'models\example\schema.yml'::varchar(4000) as file_test_defined,
        'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
        convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP)
  select 
    s.*,
    'Y' as is_active,
    current_timestamp as created_timestamp,
    null as deactivated_timestamp
  from current_test_runs s
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      )
    when not matched by source and target.is_active = 'Y' then
      update set 
        is_active = 'N',
        deactivated_timestamp = current_timestamp
  
  ;
[0m22:47:43.097365 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba804d-3201-72f0-000b-f6920001b0ee
[0m22:47:43.098371 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 98 unexpected 'allselect'.
syntax error line 70 at position 21 unexpected 'by'.
[0m22:47:43.098371 [info ] [MainThread]: Database error while running on-run-end
[0m22:47:43.099377 [debug] [MainThread]: On master: Close
[0m22:47:43.229932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:43.230933 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:47:43.230933 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:47:43.231934 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:47:43.231934 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:47:43.232935 [info ] [MainThread]: 
[0m22:47:43.232935 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m22:47:43.234162 [debug] [MainThread]: Command end result
[0m22:47:43.275420 [info ] [MainThread]: 
[0m22:47:43.276430 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:47:43.276430 [info ] [MainThread]: 
[0m22:47:43.277443 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:47:43.278500 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:47:43.279599 [info ] [MainThread]: 
[0m22:47:43.280704 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:47:43.280704 [info ] [MainThread]: 
[0m22:47:43.281707 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 16 at position 98 unexpected 'allselect'.
syntax error line 70 at position 21 unexpected 'by'.
[0m22:47:43.281707 [info ] [MainThread]: 
[0m22:47:43.282721 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:47:43.283726 [debug] [MainThread]: Command `dbt test` failed at 22:47:43.283726 after 5.36 seconds
[0m22:47:43.284732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFA992920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFC96ECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C968D8790>]}
[0m22:47:43.284732 [debug] [MainThread]: Flushing usage events
[0m22:50:22.048284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D2102980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D4C8E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D4C8E2F0>]}


============================== 22:50:22.051835 | e626daf8-d464-4663-91df-45e9b00a3412 ==============================
[0m22:50:22.051835 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:50:22.052847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:50:22.781481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e626daf8-d464-4663-91df-45e9b00a3412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D4C46980>]}
[0m22:50:22.827618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e626daf8-d464-4663-91df-45e9b00a3412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D29B3730>]}
[0m22:50:22.828623 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:50:22.848846 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:50:23.089872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:50:23.090875 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:50:23.239746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e626daf8-d464-4663-91df-45e9b00a3412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EDAE8130>]}
[0m22:50:23.356619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e626daf8-d464-4663-91df-45e9b00a3412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EDA67BE0>]}
[0m22:50:23.357908 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:50:23.358910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e626daf8-d464-4663-91df-45e9b00a3412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D248BA90>]}
[0m22:50:23.359911 [info ] [MainThread]: 
[0m22:50:23.361060 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:50:23.366090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:50:23.380173 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:50:23.380173 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:50:23.381177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:24.059519 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.678 seconds
[0m22:50:24.060526 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:50:24.185187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e626daf8-d464-4663-91df-45e9b00a3412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EDA66B60>]}
[0m22:50:24.185187 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:50:24.186567 [info ] [MainThread]: 
[0m22:50:24.189610 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:50:24.190628 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:50:24.190628 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:50:24.191633 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:50:24.191633 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:50:24.192638 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:50:24.193639 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:50:24.193639 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:50:24.194689 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:50:24.195693 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:50:24.195693 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:50:24.195693 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:50:24.212943 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:50:24.218677 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:50:24.223813 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:50:24.224822 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:50:24.224822 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:50:24.240147 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:50:24.241150 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:50:24.244164 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:50:24.247329 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:50:24.248333 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:50:24.249338 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:50:24.249338 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:50:24.250344 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:50:24.251359 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:50:24.251359 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:50:24.251359 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:50:24.252365 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:50:24.255383 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:50:24.826534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m22:50:24.833563 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:50:24.954574 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.76s]
[0m22:50:24.955660 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:50:25.789803 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.535 seconds
[0m22:50:25.792358 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:50:25.911894 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.72s]
[0m22:50:25.912898 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:50:26.999932 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.748 seconds
[0m22:50:27.001943 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:50:27.123836 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.93s]
[0m22:50:27.125858 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:50:27.126910 [info ] [MainThread]: 
[0m22:50:27.126910 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:50:27.154928 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:50:27.160245 [debug] [MainThread]: Using snowflake connection "master"
[0m22:50:27.161247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:50:27.162520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:50:28.122518 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.960 seconds
[0m22:50:28.136036 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:50:28.140625 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:50:28.143642 [debug] [MainThread]: Using snowflake connection "master"
[0m22:50:28.144646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7609348297119141'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP union allselect
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7172050476074219'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP union allselect
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.93019700050354'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP)
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:50:28.236075 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8050-3201-7237-000b-f692000147d2
[0m22:50:28.236075 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 102 unexpected 'allselect'.
[0m22:50:28.237079 [info ] [MainThread]: Database error while running on-run-end
[0m22:50:28.237079 [debug] [MainThread]: On master: Close
[0m22:50:28.360681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:28.360681 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:50:28.361691 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:50:28.361691 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:50:28.362694 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:50:28.362694 [info ] [MainThread]: 
[0m22:50:28.363698 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m22:50:28.364701 [debug] [MainThread]: Command end result
[0m22:50:28.402915 [info ] [MainThread]: 
[0m22:50:28.404003 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:50:28.405016 [info ] [MainThread]: 
[0m22:50:28.405016 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:50:28.406302 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:50:28.406302 [info ] [MainThread]: 
[0m22:50:28.406302 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:50:28.407570 [info ] [MainThread]: 
[0m22:50:28.407570 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 14 at position 102 unexpected 'allselect'.
[0m22:50:28.408573 [info ] [MainThread]: 
[0m22:50:28.408573 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:50:28.409594 [debug] [MainThread]: Command `dbt test` failed at 22:50:28.409594 after 6.42 seconds
[0m22:50:28.410597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D2102980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D4C46980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D40AF100>]}
[0m22:50:28.410597 [debug] [MainThread]: Flushing usage events
[0m22:51:49.668734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CB18A9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CDD4A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CDD4A350>]}


============================== 22:51:49.672020 | eb635deb-d875-4448-b333-a7de29e52f68 ==============================
[0m22:51:49.672020 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:51:49.673234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:51:50.484899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb635deb-d875-4448-b333-a7de29e52f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CB417970>]}
[0m22:51:50.529435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb635deb-d875-4448-b333-a7de29e52f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CAC83580>]}
[0m22:51:50.530443 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:51:50.551660 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:51:50.798393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:51:50.799396 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:51:50.949732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb635deb-d875-4448-b333-a7de29e52f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E6BA8130>]}
[0m22:51:51.077209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb635deb-d875-4448-b333-a7de29e52f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E6BAB3A0>]}
[0m22:51:51.078214 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:51:51.079218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb635deb-d875-4448-b333-a7de29e52f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E6B44460>]}
[0m22:51:51.080223 [info ] [MainThread]: 
[0m22:51:51.081227 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:51:51.086275 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:51:51.101070 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:51:51.101070 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:51:51.102075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:51:51.796048 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.694 seconds
[0m22:51:51.798195 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:51:51.922893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb635deb-d875-4448-b333-a7de29e52f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E6BABE20>]}
[0m22:51:51.923893 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:51:51.924903 [info ] [MainThread]: 
[0m22:51:51.927925 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:51:51.927925 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:51:51.928930 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:51:51.928930 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:51:51.930229 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:51:51.930229 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:51:51.931263 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:51:51.932266 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:51:51.932266 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:51:51.933321 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:51:51.933321 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:51:51.934326 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:51:51.949568 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:51:51.955780 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:51:51.961820 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:51:51.962824 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:51:51.979847 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:51:51.981001 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:51:51.982006 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:51:51.985144 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:51:51.988169 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:51:51.988169 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:51:51.989172 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:51:51.990174 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:51:51.990174 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:51:51.991447 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:51:51.991447 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:51:51.993746 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:51:51.994750 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:51:51.994750 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:51:52.494941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m22:51:52.501996 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:51:52.619075 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.69s]
[0m22:51:52.620078 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:51:53.497258 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.502 seconds
[0m22:51:53.499390 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:51:53.627137 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.69s]
[0m22:51:53.628157 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:51:54.758012 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.763 seconds
[0m22:51:54.759016 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:51:54.880197 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.95s]
[0m22:51:54.882216 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:51:54.883221 [info ] [MainThread]: 
[0m22:51:54.884227 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:51:54.903587 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:51:54.909933 [debug] [MainThread]: Using snowflake connection "master"
[0m22:51:54.910948 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:51:54.911952 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:51:55.938996 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.028 seconds
[0m22:51:55.953484 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:51:55.957524 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:51:55.960544 [debug] [MainThread]: Using snowflake connection "master"
[0m22:51:55.961649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6878116130828857'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          
          UNION ALLselect
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.6948704719543457'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          
          UNION ALLselect
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.9479305744171143'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP)
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:51:56.045839 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8051-3201-72e6-000b-f6920001a162
[0m22:51:56.046843 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 16 unexpected 'ALLselect'.
[0m22:51:56.046843 [info ] [MainThread]: Database error while running on-run-end
[0m22:51:56.047847 [debug] [MainThread]: On master: Close
[0m22:51:56.165180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:51:56.165180 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:51:56.166184 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:51:56.166184 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:51:56.167188 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:51:56.167188 [info ] [MainThread]: 
[0m22:51:56.168192 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m22:51:56.169197 [debug] [MainThread]: Command end result
[0m22:51:56.203940 [info ] [MainThread]: 
[0m22:51:56.204941 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:51:56.206085 [info ] [MainThread]: 
[0m22:51:56.206085 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:51:56.207088 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:51:56.207088 [info ] [MainThread]: 
[0m22:51:56.207088 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:51:56.208548 [info ] [MainThread]: 
[0m22:51:56.209549 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 16 at position 16 unexpected 'ALLselect'.
[0m22:51:56.209549 [info ] [MainThread]: 
[0m22:51:56.210749 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:51:56.212784 [debug] [MainThread]: Command `dbt test` failed at 22:51:56.212784 after 6.60 seconds
[0m22:51:56.212784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CB18A9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CAC83580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CBAA4B20>]}
[0m22:51:56.212784 [debug] [MainThread]: Flushing usage events
[0m22:52:58.818305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43C6EE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43F27E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43F27E320>]}


============================== 22:52:58.821562 | f615af0a-5982-4ac4-b79a-2fc5e6e69e19 ==============================
[0m22:52:58.821562 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:52:58.822566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:52:59.525909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f615af0a-5982-4ac4-b79a-2fc5e6e69e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43C977A90>]}
[0m22:52:59.571651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f615af0a-5982-4ac4-b79a-2fc5e6e69e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43C1E3520>]}
[0m22:52:59.572659 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:52:59.593351 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:52:59.836486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:52:59.837493 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:52:59.980717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f615af0a-5982-4ac4-b79a-2fc5e6e69e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4580D8130>]}
[0m22:53:00.105769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f615af0a-5982-4ac4-b79a-2fc5e6e69e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E458056B60>]}
[0m22:53:00.106770 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:53:00.106770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f615af0a-5982-4ac4-b79a-2fc5e6e69e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E458078880>]}
[0m22:53:00.109100 [info ] [MainThread]: 
[0m22:53:00.109100 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:53:00.114794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:53:00.129162 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:53:00.130168 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:53:00.130168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:00.778005 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.648 seconds
[0m22:53:00.779008 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:53:00.900138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f615af0a-5982-4ac4-b79a-2fc5e6e69e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E458056FE0>]}
[0m22:53:00.901143 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:53:00.902149 [info ] [MainThread]: 
[0m22:53:00.905161 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:53:00.905161 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:53:00.905161 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:53:00.906165 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:53:00.907278 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:53:00.907278 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:53:00.908280 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:53:00.908280 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:53:00.909670 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:53:00.909670 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:53:00.910693 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:53:00.910693 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:53:00.926906 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:53:00.932488 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:53:00.937495 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:53:00.938608 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:53:00.952946 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:53:00.955038 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:53:00.956050 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:53:00.959060 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:53:00.961187 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:53:00.962209 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:53:00.963428 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:53:00.963428 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:53:00.964504 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:53:00.964504 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:53:00.965534 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:53:00.965534 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:53:00.966535 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:53:00.969811 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:53:01.540593 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m22:53:01.547638 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:53:01.672408 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m22:53:01.673411 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:53:02.533014 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.563 seconds
[0m22:53:02.534045 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:53:02.660149 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.75s]
[0m22:53:02.661154 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:53:03.727242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.763 seconds
[0m22:53:03.729304 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:53:03.852784 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 2.94s]
[0m22:53:03.853787 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:53:03.854878 [info ] [MainThread]: 
[0m22:53:03.856185 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:53:03.880171 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:53:03.886176 [debug] [MainThread]: Using snowflake connection "master"
[0m22:53:03.886176 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:53:03.887439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:04.873275 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.986 seconds
[0m22:53:04.887566 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:53:04.890678 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:53:04.894715 [debug] [MainThread]: Using snowflake connection "master"
[0m22:53:04.894715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7641282081604004'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMPUNION ALLselect
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.750478744506836'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMPUNION ALLselect
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.9445042610168457'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP)
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:53:04.983268 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8053-3201-72f1-000b-f6920001c082
[0m22:53:04.983268 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 101 unexpected 'ALLselect'.
[0m22:53:04.984274 [info ] [MainThread]: Database error while running on-run-end
[0m22:53:04.984274 [debug] [MainThread]: On master: Close
[0m22:53:05.105007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:05.106012 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:53:05.106012 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:53:05.106605 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:53:05.106605 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:53:05.107615 [info ] [MainThread]: 
[0m22:53:05.107615 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m22:53:05.108619 [debug] [MainThread]: Command end result
[0m22:53:05.145788 [info ] [MainThread]: 
[0m22:53:05.146792 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:53:05.147795 [info ] [MainThread]: 
[0m22:53:05.148829 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:53:05.149834 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:53:05.149834 [info ] [MainThread]: 
[0m22:53:05.150838 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:53:05.151880 [info ] [MainThread]: 
[0m22:53:05.151880 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 14 at position 101 unexpected 'ALLselect'.
[0m22:53:05.152885 [info ] [MainThread]: 
[0m22:53:05.152885 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:53:05.155017 [debug] [MainThread]: Command `dbt test` failed at 22:53:05.155017 after 6.39 seconds
[0m22:53:05.155017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43C6EE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43C1E3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43E69F490>]}
[0m22:53:05.156032 [debug] [MainThread]: Flushing usage events
[0m22:53:59.430870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D56B9E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5975E530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5975E350>]}


============================== 22:53:59.434424 | c4da65be-7c32-4bcd-9030-08b06be64a13 ==============================
[0m22:53:59.434424 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:53:59.435427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:54:00.162481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4da65be-7c32-4bcd-9030-08b06be64a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D56E27970>]}
[0m22:54:00.207199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4da65be-7c32-4bcd-9030-08b06be64a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D56673580>]}
[0m22:54:00.208202 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:54:00.228625 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:54:00.471621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:54:00.472622 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:54:00.611378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4da65be-7c32-4bcd-9030-08b06be64a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D725B8130>]}
[0m22:54:00.733589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4da65be-7c32-4bcd-9030-08b06be64a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D725BB3A0>]}
[0m22:54:00.733589 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:54:00.734595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4da65be-7c32-4bcd-9030-08b06be64a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D72558460>]}
[0m22:54:00.735618 [info ] [MainThread]: 
[0m22:54:00.736621 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:54:00.741639 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:54:00.755243 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:54:00.756244 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:54:00.756244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:01.407729 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.651 seconds
[0m22:54:01.409731 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:54:01.530712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4da65be-7c32-4bcd-9030-08b06be64a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D725BBE20>]}
[0m22:54:01.531716 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:54:01.532718 [info ] [MainThread]: 
[0m22:54:01.535875 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:54:01.535875 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:54:01.536880 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:54:01.536880 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:54:01.537920 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:54:01.538922 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:54:01.538922 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:54:01.540249 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:54:01.540249 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:54:01.541310 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:54:01.541310 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:54:01.542314 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:54:01.558635 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:54:01.566031 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:54:01.572052 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:54:01.573076 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:54:01.589867 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:54:01.589867 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:54:01.590870 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:54:01.593991 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:54:01.595019 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:54:01.599025 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:54:01.600465 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:54:01.601527 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:54:01.601527 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:54:01.602532 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:54:01.602532 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:54:01.604539 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:54:01.605975 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:54:01.605975 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:54:02.168426 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.562 seconds
[0m22:54:02.174461 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:54:02.197925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m22:54:02.199940 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:54:02.293074 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.75s]
[0m22:54:02.294078 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:54:02.320971 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.78s]
[0m22:54:02.321976 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:54:03.338753 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.732 seconds
[0m22:54:03.339756 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:54:03.484051 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.94s]
[0m22:54:03.485056 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:54:03.486063 [info ] [MainThread]: 
[0m22:54:03.487066 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:54:03.508612 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:54:03.514899 [debug] [MainThread]: Using snowflake connection "master"
[0m22:54:03.514899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:54:03.515904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:54:04.486152 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.970 seconds
[0m22:54:04.500281 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:54:04.504300 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:54:04.507311 [debug] [MainThread]: Using snowflake connection "master"
[0m22:54:04.508315 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7528250217437744'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP

          UNION ALLselect
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7810304164886475'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP

          UNION ALLselect
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9427974224090576'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP)
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:54:04.603623 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8054-3201-7237-000b-f692000147e2
[0m22:54:04.604626 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 16 unexpected 'ALLselect'.
[0m22:54:04.605630 [info ] [MainThread]: Database error while running on-run-end
[0m22:54:04.605630 [debug] [MainThread]: On master: Close
[0m22:54:04.725818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:04.726822 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:54:04.726822 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:54:04.727826 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:54:04.727826 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:54:04.728830 [info ] [MainThread]: 
[0m22:54:04.728830 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m22:54:04.730839 [debug] [MainThread]: Command end result
[0m22:54:04.769285 [info ] [MainThread]: 
[0m22:54:04.770294 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:54:04.770294 [info ] [MainThread]: 
[0m22:54:04.771301 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:54:04.772306 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:54:04.772306 [info ] [MainThread]: 
[0m22:54:04.773310 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:54:04.773310 [info ] [MainThread]: 
[0m22:54:04.774316 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 16 at position 16 unexpected 'ALLselect'.
[0m22:54:04.774316 [info ] [MainThread]: 
[0m22:54:04.775320 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:54:04.775320 [debug] [MainThread]: Command `dbt test` failed at 22:54:04.775320 after 5.40 seconds
[0m22:54:04.776798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D56B9E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D56673580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D574B4B20>]}
[0m22:54:04.777797 [debug] [MainThread]: Flushing usage events
[0m22:55:09.647345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754711E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027549CBE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027549CBE320>]}


============================== 22:55:09.650366 | d42e91da-cfc7-404d-aa85-356b8017c8f5 ==============================
[0m22:55:09.650366 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:55:09.650366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:55:10.355601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd42e91da-cfc7-404d-aa85-356b8017c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275473ABA90>]}
[0m22:55:10.400370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd42e91da-cfc7-404d-aa85-356b8017c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027546C13520>]}
[0m22:55:10.401376 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:55:10.424031 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:55:10.667892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:55:10.667892 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:55:10.808388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd42e91da-cfc7-404d-aa85-356b8017c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562B18130>]}
[0m22:55:10.927228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd42e91da-cfc7-404d-aa85-356b8017c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562A96B60>]}
[0m22:55:10.927228 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:55:10.928234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd42e91da-cfc7-404d-aa85-356b8017c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562AB4880>]}
[0m22:55:10.929238 [info ] [MainThread]: 
[0m22:55:10.930241 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:55:10.935265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:55:10.949417 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:55:10.950421 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:55:10.950421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:11.597362 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.647 seconds
[0m22:55:11.599392 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:55:11.720768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd42e91da-cfc7-404d-aa85-356b8017c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562A96FE0>]}
[0m22:55:11.720768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:55:11.722196 [info ] [MainThread]: 
[0m22:55:11.725326 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:11.725326 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:11.725326 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:11.726335 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:55:11.726335 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:55:11.727341 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:55:11.728345 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:55:11.728345 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:55:11.729349 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:55:11.729349 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:11.730356 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:11.730356 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:11.744546 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:55:11.750573 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:55:11.755673 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:55:11.756682 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:11.756682 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:11.772964 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:55:11.775979 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:55:11.775979 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:11.778997 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:55:11.778997 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:55:11.780002 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:55:11.781006 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:55:11.781812 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:55:11.782820 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:55:11.782820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:11.784105 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:55:11.784105 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:55:11.786177 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:55:12.367836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m22:55:12.373965 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:55:12.495631 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.77s]
[0m22:55:12.496635 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:13.330227 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.544 seconds
[0m22:55:13.331238 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:55:13.455721 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.73s]
[0m22:55:13.456725 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:14.508740 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.724 seconds
[0m22:55:14.509744 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:55:14.648166 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.92s]
[0m22:55:14.648166 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:14.650615 [info ] [MainThread]: 
[0m22:55:14.650615 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:55:14.672226 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:55:14.677516 [debug] [MainThread]: Using snowflake connection "master"
[0m22:55:14.678523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:55:14.678523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:15.897168 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.218 seconds
[0m22:55:15.911388 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:55:15.915407 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:55:15.918439 [debug] [MainThread]: Using snowflake connection "master"
[0m22:55:15.919442 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7682895660400391'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMPUNION ALLselect
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7263712882995605'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMPUNION ALLselect
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.918820381164551'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP)
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:55:16.007846 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8055-3201-72d3-000b-f692000181e2
[0m22:55:16.008357 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 101 unexpected 'ALLselect'.
[0m22:55:16.008872 [info ] [MainThread]: Database error while running on-run-end
[0m22:55:16.009907 [debug] [MainThread]: On master: Close
[0m22:55:16.140039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:16.141043 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:55:16.141043 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:55:16.141043 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:55:16.142048 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:55:16.142048 [info ] [MainThread]: 
[0m22:55:16.143196 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m22:55:16.144201 [debug] [MainThread]: Command end result
[0m22:55:16.180712 [info ] [MainThread]: 
[0m22:55:16.181917 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:55:16.181917 [info ] [MainThread]: 
[0m22:55:16.182923 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:55:16.183926 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:55:16.184983 [info ] [MainThread]: 
[0m22:55:16.184983 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:55:16.186009 [info ] [MainThread]: 
[0m22:55:16.186009 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 14 at position 101 unexpected 'ALLselect'.
[0m22:55:16.186009 [info ] [MainThread]: 
[0m22:55:16.187282 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:55:16.188286 [debug] [MainThread]: Command `dbt test` failed at 22:55:16.188286 after 6.60 seconds
[0m22:55:16.189290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754711E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027546C13520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275490CF490>]}
[0m22:55:16.189290 [debug] [MainThread]: Flushing usage events
[0m22:55:39.961365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6A81F29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AADAE530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AADAE350>]}


============================== 22:55:39.964458 | dc95aa22-5973-4cbc-a078-65d594a367e1 ==============================
[0m22:55:39.964458 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:55:39.965463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:55:40.683438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc95aa22-5973-4cbc-a078-65d594a367e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6A8477970>]}
[0m22:55:40.726846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc95aa22-5973-4cbc-a078-65d594a367e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6A7CE3580>]}
[0m22:55:40.727849 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:55:40.748012 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:55:40.991029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:55:40.991029 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:55:41.130456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc95aa22-5973-4cbc-a078-65d594a367e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C3C08130>]}
[0m22:55:41.248238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc95aa22-5973-4cbc-a078-65d594a367e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C3B86FE0>]}
[0m22:55:41.249245 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:55:41.250248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc95aa22-5973-4cbc-a078-65d594a367e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C3BA84F0>]}
[0m22:55:41.251342 [info ] [MainThread]: 
[0m22:55:41.252346 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:55:41.256359 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:55:41.271228 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:55:41.271228 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:55:41.272231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:41.901250 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.629 seconds
[0m22:55:41.902270 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:55:42.023799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc95aa22-5973-4cbc-a078-65d594a367e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C3970910>]}
[0m22:55:42.024804 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:55:42.025813 [info ] [MainThread]: 
[0m22:55:42.027819 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:42.028878 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:42.028878 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:42.028878 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:55:42.029887 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:55:42.030949 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:55:42.030949 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:55:42.031953 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:55:42.031953 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:55:42.032973 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:42.032973 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:42.033979 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:42.048155 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:55:42.054187 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:55:42.059218 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:55:42.060224 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:42.075280 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:55:42.075280 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:42.076285 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:42.079418 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:55:42.080419 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:55:42.083421 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:55:42.084525 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:55:42.085541 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:55:42.085541 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:42.086544 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:55:42.086544 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:55:42.088649 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:55:42.089654 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:55:42.089654 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:55:42.680366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m22:55:42.681371 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m22:55:42.688405 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:55:42.690412 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:55:42.809960 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m22:55:42.810979 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:42.815865 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.78s]
[0m22:55:42.816868 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:43.585545 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.496 seconds
[0m22:55:43.587559 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:55:43.706349 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.67s]
[0m22:55:43.707368 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:43.708372 [info ] [MainThread]: 
[0m22:55:43.709693 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:55:43.728910 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:55:43.734106 [debug] [MainThread]: Using snowflake connection "master"
[0m22:55:43.735108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:55:43.735108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:44.707474 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.972 seconds
[0m22:55:44.721705 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:55:44.725732 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:55:44.728810 [debug] [MainThread]: Using snowflake connection "master"
[0m22:55:44.729813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7780063152313232'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7839109897613525'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.6743953227996826'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:55:45.328867 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.598 seconds
[0m22:55:45.328867 [debug] [MainThread]: Using snowflake connection "master"
[0m22:55:45.329876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from () as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m22:55:45.425574 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8055-3201-72e6-000b-f6920001a16e
[0m22:55:45.425574 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 12 unexpected ')'.
[0m22:55:45.426577 [info ] [MainThread]: Database error while running on-run-end
[0m22:55:45.427581 [debug] [MainThread]: On master: Close
[0m22:55:45.557454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:45.558461 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:55:45.558461 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:55:45.558461 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:55:45.559466 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:55:45.559466 [info ] [MainThread]: 
[0m22:55:45.560469 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.31 seconds (4.31s).
[0m22:55:45.561473 [debug] [MainThread]: Command end result
[0m22:55:45.598660 [info ] [MainThread]: 
[0m22:55:45.599669 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:55:45.599669 [info ] [MainThread]: 
[0m22:55:45.600673 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:55:45.601676 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:55:45.601676 [info ] [MainThread]: 
[0m22:55:45.602700 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:55:45.602700 [info ] [MainThread]: 
[0m22:55:45.603767 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 7 at position 12 unexpected ')'.
[0m22:55:45.603767 [info ] [MainThread]: 
[0m22:55:45.604816 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:55:45.605820 [debug] [MainThread]: Command `dbt test` failed at 22:55:45.605820 after 5.70 seconds
[0m22:55:45.605820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6A81F29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6A7CE3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C3C09F00>]}
[0m22:55:45.606825 [debug] [MainThread]: Flushing usage events
[0m22:57:34.635860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9574029B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C959FF6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C959FF6350>]}


============================== 22:57:34.639886 | a60ce6f1-869e-44be-8f36-db1d28cee42c ==============================
[0m22:57:34.639886 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:57:34.640890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m22:57:35.401235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a60ce6f1-869e-44be-8f36-db1d28cee42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C957687970>]}
[0m22:57:35.446634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a60ce6f1-869e-44be-8f36-db1d28cee42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C956ED3580>]}
[0m22:57:35.447706 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:57:35.473062 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:57:35.740126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:57:35.741135 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:57:35.908949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a60ce6f1-869e-44be-8f36-db1d28cee42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C972E18130>]}
[0m22:57:36.033102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a60ce6f1-869e-44be-8f36-db1d28cee42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C972D97490>]}
[0m22:57:36.034106 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:57:36.035109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a60ce6f1-869e-44be-8f36-db1d28cee42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C972DB4550>]}
[0m22:57:36.036315 [info ] [MainThread]: 
[0m22:57:36.037317 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:57:36.041321 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:57:36.055854 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:57:36.056858 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:57:36.056858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:36.705979 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.649 seconds
[0m22:57:36.707988 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:57:36.833416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a60ce6f1-869e-44be-8f36-db1d28cee42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C972D97A00>]}
[0m22:57:36.833416 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:57:36.834471 [info ] [MainThread]: 
[0m22:57:36.837890 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:57:36.837890 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:57:36.837890 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:57:36.838896 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:57:36.838896 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:57:36.839901 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:57:36.840910 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:57:36.840910 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:57:36.841914 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:57:36.841914 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:57:36.842918 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:57:36.842918 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:57:36.858267 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:57:36.864299 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:57:36.870572 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:57:36.871619 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:57:36.882710 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:57:36.888933 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:57:36.891949 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:57:36.891949 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:57:36.894963 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:57:36.895963 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:57:36.897049 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:57:36.897049 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:57:36.898052 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:57:36.898052 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:57:36.899054 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:57:36.899054 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:57:36.900054 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:57:36.901055 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:57:37.491222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m22:57:37.497249 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:57:37.498753 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m22:57:37.501881 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:57:37.622964 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.78s]
[0m22:57:37.623964 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m22:57:37.625420 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:57:37.625420 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:57:38.409542 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.508 seconds
[0m22:57:38.411592 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:57:38.535458 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.69s]
[0m22:57:38.536461 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:57:38.537503 [info ] [MainThread]: 
[0m22:57:38.538511 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:57:38.560633 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:57:38.566868 [debug] [MainThread]: Using snowflake connection "master"
[0m22:57:38.567873 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:57:38.567873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:57:39.602282 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.034 seconds
[0m22:57:39.616517 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:57:39.620533 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:57:39.624549 [debug] [MainThread]: Using snowflake connection "master"
[0m22:57:39.625562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.783062219619751'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7830541133880615'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.6945481300354004'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:57:40.141852 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.516 seconds
[0m22:57:40.141852 [debug] [MainThread]: Using snowflake connection "master"
[0m22:57:40.142856 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'expression_is_true'::varchar(4000) as test_name,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m22:57:40.490431 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.347 seconds
[0m22:57:40.491432 [debug] [MainThread]: Using snowflake connection "master"
[0m22:57:40.491432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
;
[0m22:57:40.574169 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8057-3201-72f0-000b-f6920001b122
[0m22:57:40.575173 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000900 (42601): SQL compilation error:
Empty SQL statement.
[0m22:57:40.575173 [debug] [MainThread]: Snowflake adapter: got empty sql statement, moving on
[0m22:57:40.575173 [debug] [MainThread]: On master: Close
[0m22:57:40.695533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:40.696534 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:57:40.696534 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:57:40.696534 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:57:40.697690 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:57:40.697690 [info ] [MainThread]: 
[0m22:57:40.698697 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m22:57:40.699706 [error] [MainThread]: Encountered an error:
cannot unpack non-iterable NoneType object
[0m22:57:40.701159 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 816, in test
    results = task.run()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 488, in execute_with_hooks
    self.after_run(adapter, res)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 484, in after_run
    self.safe_run_hooks(adapter, RunHookType.End, extras)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 423, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 391, in run_hooks
    response, _ = adapter.execute(sql, auto_begin=False, fetch=False)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 379, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 471, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 506, in add_query
    connection, cursor = self._add_standard_queries(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 562, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
TypeError: cannot unpack non-iterable NoneType object

[0m22:57:40.702542 [debug] [MainThread]: Command `dbt test` failed at 22:57:40.702542 after 6.12 seconds
[0m22:57:40.702542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9574029B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C973149750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9732996C0>]}
[0m22:57:40.703675 [debug] [MainThread]: Flushing usage events
[0m22:58:46.791836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592407E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025926C4E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025926C4E320>]}


============================== 22:58:46.794906 | 59f2bff4-d241-4377-a61d-faf0a5c640c9 ==============================
[0m22:58:46.794906 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:58:46.795917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:58:47.562404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59f2bff4-d241-4377-a61d-faf0a5c640c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025924307EB0>]}
[0m22:58:47.606704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59f2bff4-d241-4377-a61d-faf0a5c640c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002593F5597E0>]}
[0m22:58:47.607706 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:58:47.629635 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:58:47.873119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:58:47.874122 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:58:48.016475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59f2bff4-d241-4377-a61d-faf0a5c640c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002593FAA8130>]}
[0m22:58:48.138165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59f2bff4-d241-4377-a61d-faf0a5c640c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002593FAABEE0>]}
[0m22:58:48.139171 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:58:48.139171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f2bff4-d241-4377-a61d-faf0a5c640c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002593FA48D00>]}
[0m22:58:48.141182 [info ] [MainThread]: 
[0m22:58:48.142187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:58:48.147331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:58:48.166854 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:58:48.166854 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:58:48.168337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:48.784729 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.616 seconds
[0m22:58:48.786736 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:58:48.911513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f2bff4-d241-4377-a61d-faf0a5c640c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002593F6DE4D0>]}
[0m22:58:48.911513 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:58:48.912516 [info ] [MainThread]: 
[0m22:58:48.915523 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:58:48.916657 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:58:48.916657 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:58:48.917661 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:58:48.917661 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:58:48.918668 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:58:48.918668 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:58:48.919672 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:58:48.920823 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:58:48.920823 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:58:48.921827 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:58:48.921827 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:58:48.937354 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:58:48.943389 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:58:48.948404 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:58:48.949408 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:58:48.964777 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:58:48.964777 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:58:48.965781 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:58:48.969930 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:58:48.969930 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:58:48.972957 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:58:48.973962 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:58:48.974966 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:58:48.974966 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:58:48.975968 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:58:48.975968 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:58:48.977975 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:58:48.978978 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:58:48.978978 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:58:49.516284 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m22:58:49.523446 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:58:49.644916 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.73s]
[0m22:58:49.645941 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:58:50.543641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.568 seconds
[0m22:58:50.544645 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:58:50.555216 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.576 seconds
[0m22:58:50.557223 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:58:50.665666 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 1.75s]
[0m22:58:50.666678 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:58:50.676021 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.76s]
[0m22:58:50.677141 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:58:50.678146 [info ] [MainThread]: 
[0m22:58:50.678146 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:58:50.700462 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:58:50.705627 [debug] [MainThread]: Using snowflake connection "master"
[0m22:58:50.706630 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:58:50.706630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:51.665472 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.958 seconds
[0m22:58:51.679044 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:58:51.683069 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:58:51.687106 [debug] [MainThread]: Using snowflake connection "master"
[0m22:58:51.688111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7252438068389893'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7469985485076904'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7563488483428955'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:58:52.305415 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.617 seconds
[0m22:58:52.305415 [debug] [MainThread]: Using snowflake connection "master"
[0m22:58:52.306641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'expression_is_true'::varchar(4000) as test_name,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m22:58:52.636713 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.329 seconds
[0m22:58:52.637717 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.95s]
[0m22:58:52.638722 [info ] [MainThread]: 
[0m22:58:52.638722 [debug] [MainThread]: On master: Close
[0m22:58:52.767902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:52.769010 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:58:52.769010 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:58:52.770014 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:58:52.770014 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:58:52.770014 [info ] [MainThread]: 
[0m22:58:52.771018 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 4.63 seconds (4.63s).
[0m22:58:52.772021 [debug] [MainThread]: Command end result
[0m22:58:52.810697 [info ] [MainThread]: 
[0m22:58:52.811698 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:58:52.812777 [info ] [MainThread]: 
[0m22:58:52.812777 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:58:52.813780 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:58:52.814901 [info ] [MainThread]: 
[0m22:58:52.814901 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:58:52.815926 [info ] [MainThread]: 
[0m22:58:52.815926 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:58:52.818436 [debug] [MainThread]: Command `dbt test` failed at 22:58:52.817430 after 6.08 seconds
[0m22:58:52.818436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592407E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002593F6B8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592605F4C0>]}
[0m22:58:52.818436 [debug] [MainThread]: Flushing usage events
[0m22:59:39.161199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB492E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB74EA530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB74EA350>]}


============================== 22:59:39.164208 | 1ebe7988-94f5-4846-8ced-ae9d93ff2e43 ==============================
[0m22:59:39.164208 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:59:39.165211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:39.945032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ebe7988-94f5-4846-8ced-ae9d93ff2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB4BB7970>]}
[0m22:59:39.989990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ebe7988-94f5-4846-8ced-ae9d93ff2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB4403580>]}
[0m22:59:39.992001 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:59:40.012656 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:59:40.253528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:59:40.254532 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m22:59:40.607727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ebe7988-94f5-4846-8ced-ae9d93ff2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD0654130>]}
[0m22:59:40.726297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ebe7988-94f5-4846-8ced-ae9d93ff2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD0656410>]}
[0m22:59:40.726297 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:59:40.727361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ebe7988-94f5-4846-8ced-ae9d93ff2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD02E0C40>]}
[0m22:59:40.729371 [info ] [MainThread]: 
[0m22:59:40.730374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:59:40.734390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:59:40.747572 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:59:40.748576 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:59:40.748576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:41.374155 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.625 seconds
[0m22:59:41.375161 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:59:41.497985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ebe7988-94f5-4846-8ced-ae9d93ff2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACFDD2D10>]}
[0m22:59:41.497985 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:59:41.498990 [info ] [MainThread]: 
[0m22:59:41.501012 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:59:41.502021 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:59:41.502021 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:59:41.503026 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:59:41.503026 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:59:41.504030 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:59:41.504030 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:59:41.505034 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:59:41.519193 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:59:41.524419 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:59:41.525424 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:59:41.526435 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:59:41.542805 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:59:41.544812 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:59:41.546832 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:59:41.546832 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:59:41.547839 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:59:41.547839 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:59:41.548845 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:59:41.548845 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:59:42.086459 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m22:59:42.093467 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:59:42.213510 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.71s]
[0m22:59:42.214514 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:59:43.090547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.542 seconds
[0m22:59:43.092558 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:59:43.207945 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.70s]
[0m22:59:43.208950 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:59:43.209955 [info ] [MainThread]: 
[0m22:59:43.211038 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:59:43.231656 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:59:43.236665 [debug] [MainThread]: Using snowflake connection "master"
[0m22:59:43.237666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:59:43.237666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:44.291501 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.053 seconds
[0m22:59:44.304753 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:59:44.308270 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:59:44.312303 [debug] [MainThread]: Using snowflake connection "master"
[0m22:59:44.312303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7094800472259521'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.704918384552002'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:59:44.856567 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.543 seconds
[0m22:59:44.856567 [debug] [MainThread]: Using snowflake connection "master"
[0m22:59:44.857573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m22:59:45.288026 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.430 seconds
[0m22:59:45.289030 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.98s]
[0m22:59:45.290033 [info ] [MainThread]: 
[0m22:59:45.290033 [debug] [MainThread]: On master: Close
[0m22:59:45.421981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:45.423105 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:59:45.423105 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:59:45.423105 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:59:45.424109 [info ] [MainThread]: 
[0m22:59:45.425115 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m22:59:45.426118 [debug] [MainThread]: Command end result
[0m22:59:45.523291 [info ] [MainThread]: 
[0m22:59:45.524301 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:59:45.524301 [info ] [MainThread]: 
[0m22:59:45.525301 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:59:45.526302 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:59:45.526302 [info ] [MainThread]: 
[0m22:59:45.527362 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:59:45.527362 [info ] [MainThread]: 
[0m22:59:45.527362 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:59:45.529990 [debug] [MainThread]: Command `dbt test` failed at 22:59:45.528785 after 6.43 seconds
[0m22:59:45.529990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB492E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB37644C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB36F7CA0>]}
[0m22:59:45.530994 [debug] [MainThread]: Flushing usage events
[0m23:01:16.715187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021138F9A8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113BB9E5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113BB9E3E0>]}


============================== 23:01:16.719386 | 17c5c765-6896-4dbb-bf41-257a08447eb8 ==============================
[0m23:01:16.719386 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:01:16.719386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:17.468982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17c5c765-6896-4dbb-bf41-257a08447eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021154492D40>]}
[0m23:01:17.512629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17c5c765-6896-4dbb-bf41-257a08447eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113AFDB730>]}
[0m23:01:17.513630 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:01:17.535146 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:01:17.783389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:01:17.784395 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_second_dbt_model.sql
[0m23:01:17.784395 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_first_dbt_model.sql
[0m23:01:18.172666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17c5c765-6896-4dbb-bf41-257a08447eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021154C0C130>]}
[0m23:01:18.299325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17c5c765-6896-4dbb-bf41-257a08447eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021154C0F6D0>]}
[0m23:01:18.300326 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m23:01:18.301701 [info ] [MainThread]: 
[0m23:01:18.302705 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:01:18.303708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m23:01:18.316041 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m23:01:18.316041 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m23:01:18.317084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:18.959903 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.643 seconds
[0m23:01:18.960907 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m23:01:19.089740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:01:19.098502 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:01:19.099506 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:01:19.099506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:19.686003 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.586 seconds
[0m23:01:19.687006 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:01:19.806444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17c5c765-6896-4dbb-bf41-257a08447eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021154C0F5B0>]}
[0m23:01:19.806444 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:01:19.807447 [info ] [MainThread]: 
[0m23:01:19.810456 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m23:01:19.810456 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m23:01:19.811466 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m23:01:19.812473 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m23:01:19.818492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m23:01:19.821825 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m23:01:19.846067 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m23:01:19.847070 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m23:01:19.848074 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data;
[0m23:01:19.849077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:01:20.358799 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba805b-3201-727e-000b-f692000191ee
[0m23:01:20.359305 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 24 at position 16 unexpected ';'.
[0m23:01:20.359305 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m23:01:20.519583 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 16 unexpected ';'.
  compiled code at target\run\dbt_dataops\models\example\my_first_dbt_model.sql
[0m23:01:20.521602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c5c765-6896-4dbb-bf41-257a08447eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113AF7D330>]}
[0m23:01:20.521602 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model compute_wh.my_first_dbt_model ............ [[31mERROR[0m in 0.71s]
[0m23:01:20.522609 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m23:01:20.523615 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:01:20.524621 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:01:20.525623 [info ] [Thread-3 (]: 2 of 3 SKIP test not_null_my_first_dbt_model_id ................................ [[33mSKIP[0m]
[0m23:01:20.526639 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:01:20.525623 [info ] [Thread-4 (]: 3 of 3 SKIP test unique_my_first_dbt_model_id .................................. [[33mSKIP[0m]
[0m23:01:20.527644 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:01:20.528649 [info ] [MainThread]: 
[0m23:01:20.529886 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:01:20.554394 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:01:20.559401 [debug] [MainThread]: Using snowflake connection "master"
[0m23:01:20.560538 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:01:20.561555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:21.584975 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.023 seconds
[0m23:01:21.598029 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:01:21.602108 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:01:21.606119 [debug] [MainThread]: Using snowflake connection "master"
[0m23:01:21.606119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0'::text as execution_time_seconds,
            'skipped'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'None'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0'::text as execution_time_seconds,
            'skipped'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'None'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m23:01:22.084226 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.477 seconds
[0m23:01:22.084226 [debug] [MainThread]: Using snowflake connection "master"
[0m23:01:22.085233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'None'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'None'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:01:22.509432 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.424 seconds
[0m23:01:22.510437 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.91s]
[0m23:01:22.511565 [info ] [MainThread]: 
[0m23:01:22.512640 [debug] [MainThread]: On master: Close
[0m23:01:22.643766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:22.643766 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m23:01:22.644770 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:01:22.644770 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m23:01:22.645780 [info ] [MainThread]: 
[0m23:01:22.645780 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m23:01:22.646793 [debug] [MainThread]: Command end result
[0m23:01:22.742324 [info ] [MainThread]: 
[0m23:01:22.742324 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:01:22.743430 [info ] [MainThread]: 
[0m23:01:22.744429 [error] [MainThread]:   Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 16 unexpected ';'.
  compiled code at target\run\dbt_dataops\models\example\my_first_dbt_model.sql
[0m23:01:22.744429 [info ] [MainThread]: 
[0m23:01:22.745764 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m23:01:22.746768 [debug] [MainThread]: Command `dbt build` failed at 23:01:22.746768 after 6.09 seconds
[0m23:01:22.746768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021138F9A8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211550F07C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211550F0D90>]}
[0m23:01:22.747773 [debug] [MainThread]: Flushing usage events
[0m23:02:07.054723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092EA9E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020931662680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209316624A0>]}


============================== 23:02:07.058151 | 7411b70f-1bad-4a6d-bcc8-770bf20fd3e2 ==============================
[0m23:02:07.058151 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:02:07.059364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_1', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:02:07.766483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7411b70f-1bad-4a6d-bcc8-770bf20fd3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092ED27DC0>]}
[0m23:02:07.810056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7411b70f-1bad-4a6d-bcc8-770bf20fd3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092E59F550>]}
[0m23:02:07.811066 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:02:07.831866 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:02:08.090651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:02:08.090651 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_first_dbt_model.sql
[0m23:02:08.483709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7411b70f-1bad-4a6d-bcc8-770bf20fd3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A710130>]}
[0m23:02:08.605378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7411b70f-1bad-4a6d-bcc8-770bf20fd3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A711270>]}
[0m23:02:08.605378 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m23:02:08.607413 [info ] [MainThread]: 
[0m23:02:08.608421 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:02:08.610429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m23:02:08.622331 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m23:02:08.622331 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m23:02:08.623339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:09.255675 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.633 seconds
[0m23:02:09.258904 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m23:02:09.384368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:02:09.392444 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:02:09.393447 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:02:09.393447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:09.985441 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.592 seconds
[0m23:02:09.986450 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:02:10.106640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7411b70f-1bad-4a6d-bcc8-770bf20fd3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A7112D0>]}
[0m23:02:10.106640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:02:10.107648 [info ] [MainThread]: 
[0m23:02:10.109886 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m23:02:10.110890 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m23:02:10.111896 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m23:02:10.111896 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m23:02:10.118959 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m23:02:10.119964 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m23:02:10.143351 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m23:02:10.144354 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m23:02:10.145358 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:02:10.145358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:02:11.101033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.955 seconds
[0m23:02:11.117343 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m23:02:11.234752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7411b70f-1bad-4a6d-bcc8-770bf20fd3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020949F3FBE0>]}
[0m23:02:11.235755 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.12s]
[0m23:02:11.236759 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m23:02:11.237763 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:02:11.237763 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:02:11.238767 [info ] [Thread-3 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:02:11.238767 [info ] [Thread-4 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:02:11.239771 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:02:11.239771 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m23:02:11.240775 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:02:11.240775 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:02:11.251910 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:02:11.256955 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:02:11.257959 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:02:11.258963 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:02:11.271519 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:02:11.273526 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:02:11.275548 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:02:11.275548 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:02:11.276557 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:02:11.276557 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:02:11.277710 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:02:11.278715 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:02:11.956385 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m23:02:11.960417 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:02:12.085721 [error] [Thread-3 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.85s]
[0m23:02:12.086824 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:02:12.824275 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.545 seconds
[0m23:02:12.826362 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:02:12.972276 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.73s]
[0m23:02:12.973286 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:02:12.974691 [info ] [MainThread]: 
[0m23:02:12.975702 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:02:12.997654 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:02:13.003744 [debug] [MainThread]: Using snowflake connection "master"
[0m23:02:13.004747 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:02:13.004747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:02:14.087297 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.082 seconds
[0m23:02:14.100918 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:02:14.104934 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:02:14.167045 [debug] [MainThread]: Using snowflake connection "master"
[0m23:02:14.167045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.845949649810791'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7325050830841064'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m23:02:14.728892 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.560 seconds
[0m23:02:14.728892 [debug] [MainThread]: Using snowflake connection "master"
[0m23:02:14.729898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:02:15.178834 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.448 seconds
[0m23:02:15.179838 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 1.07s]
[0m23:02:15.179838 [info ] [MainThread]: 
[0m23:02:15.180840 [debug] [MainThread]: On master: Close
[0m23:02:15.295751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:15.295751 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m23:02:15.296760 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:02:15.296760 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m23:02:15.297764 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:02:15.297764 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:02:15.297764 [info ] [MainThread]: 
[0m23:02:15.298841 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 6.69 seconds (6.69s).
[0m23:02:15.299845 [debug] [MainThread]: Command end result
[0m23:02:15.336681 [info ] [MainThread]: 
[0m23:02:15.336681 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:02:15.337688 [info ] [MainThread]: 
[0m23:02:15.338690 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:02:15.339703 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:02:15.339703 [info ] [MainThread]: 
[0m23:02:15.340717 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:02:15.340717 [info ] [MainThread]: 
[0m23:02:15.341722 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:02:15.342752 [debug] [MainThread]: Command `dbt build` failed at 23:02:15.342752 after 8.34 seconds
[0m23:02:15.342752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092EA9E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A538100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A538A30>]}
[0m23:02:15.343757 [debug] [MainThread]: Flushing usage events
[0m23:04:48.771650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F8A9E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1FB65A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1FB65A320>]}


============================== 23:04:48.774662 | 3e77a54a-802a-42f3-bc16-d4d478907758 ==============================
[0m23:04:48.774662 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:04:48.775678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:04:49.482023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e77a54a-802a-42f3-bc16-d4d478907758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F8D2BA90>]}
[0m23:04:49.526035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e77a54a-802a-42f3-bc16-d4d478907758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F8583520>]}
[0m23:04:49.528047 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:04:49.548255 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:04:49.789523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:04:49.790553 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m23:04:50.162485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e77a54a-802a-42f3-bc16-d4d478907758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C194868130>]}
[0m23:04:50.283734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e77a54a-802a-42f3-bc16-d4d478907758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C194869150>]}
[0m23:04:50.284737 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m23:04:50.284737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e77a54a-802a-42f3-bc16-d4d478907758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19434ECE0>]}
[0m23:04:50.286105 [info ] [MainThread]: 
[0m23:04:50.287108 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:04:50.292203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:04:50.305442 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:04:50.305442 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:04:50.306451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:50.984351 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.678 seconds
[0m23:04:50.985354 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:04:51.109757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e77a54a-802a-42f3-bc16-d4d478907758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19486A710>]}
[0m23:04:51.110761 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:04:51.111765 [info ] [MainThread]: 
[0m23:04:51.113776 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:04:51.114784 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:04:51.114784 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:04:51.115794 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:04:51.115794 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:04:51.116798 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:04:51.116798 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m23:04:51.117803 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:04:51.118810 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:04:51.119896 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:04:51.119896 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m23:04:51.120901 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:04:51.120901 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:04:51.121907 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:04:51.121907 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:04:51.122906 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:04:51.135453 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:04:51.139593 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:04:51.143611 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:04:51.146644 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:04:51.148656 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:04:51.148656 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:04:51.163806 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:04:51.163806 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:04:51.166828 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:04:51.166828 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:04:51.171033 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:04:51.171033 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:04:51.174046 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:04:51.174046 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:04:51.175051 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:04:51.176070 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:04:51.176070 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:04:51.177077 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:04:51.177077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:04:51.178083 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m23:04:51.178083 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:04:51.179090 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:04:51.180111 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:04:51.182121 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:04:51.862248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m23:04:51.869413 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:04:51.870418 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m23:04:51.872425 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m23:04:51.995281 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.87s]
[0m23:04:51.996295 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:04:51.995281 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.88s]
[0m23:04:51.997310 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:04:51.998314 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:04:51.998314 [info ] [Thread-3 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:04:51.999317 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m23:04:51.999317 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:04:52.005578 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:04:52.006579 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:04:52.009582 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:04:52.010583 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:04:52.010583 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:04:52.011584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:04:52.576475 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m23:04:52.577824 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:04:52.700553 [info ] [Thread-3 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.70s]
[0m23:04:52.701558 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:04:52.760760 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.579 seconds
[0m23:04:52.762792 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:04:52.882874 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.76s]
[0m23:04:52.883879 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:04:53.878748 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.700 seconds
[0m23:04:53.880764 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:04:54.001470 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 2.88s]
[0m23:04:54.002190 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:04:54.003230 [info ] [MainThread]: 
[0m23:04:54.004251 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:04:54.026227 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:04:54.031361 [debug] [MainThread]: Using snowflake connection "master"
[0m23:04:54.032364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:04:54.032364 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:55.058717 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.026 seconds
[0m23:04:55.073939 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:04:55.077961 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:04:55.083073 [debug] [MainThread]: Using snowflake connection "master"
[0m23:04:55.084076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8743650913238525'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8764705657958984'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7012357711791992'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7619729042053223'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.881648540496826'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m23:04:55.480033 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.395 seconds
[0m23:04:55.480033 [debug] [MainThread]: Using snowflake connection "master"
[0m23:04:55.481051 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:04:55.760959 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.280 seconds
[0m23:04:55.761966 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.68s]
[0m23:04:55.762972 [info ] [MainThread]: 
[0m23:04:55.763976 [debug] [MainThread]: On master: Close
[0m23:04:55.885292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:55.885292 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:04:55.886312 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m23:04:55.886312 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:04:55.886312 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:04:55.887316 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:04:55.887316 [info ] [MainThread]: 
[0m23:04:55.888325 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 5.60 seconds (5.60s).
[0m23:04:55.889331 [debug] [MainThread]: Command end result
[0m23:04:55.928299 [info ] [MainThread]: 
[0m23:04:55.929303 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:04:55.930449 [info ] [MainThread]: 
[0m23:04:55.930449 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:04:55.931470 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:04:55.932474 [info ] [MainThread]: 
[0m23:04:55.932474 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:04:55.933479 [info ] [MainThread]: 
[0m23:04:55.933479 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:04:55.935489 [debug] [MainThread]: Command `dbt test` failed at 23:04:55.935489 after 7.22 seconds
[0m23:04:55.935489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F8A9E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C194621BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C194620550>]}
[0m23:04:55.936520 [debug] [MainThread]: Flushing usage events
[0m23:05:25.684574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBBFE2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBEB9A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBEB9A230>]}


============================== 23:05:25.687951 | e8814e36-024a-4890-9135-e77affb55113 ==============================
[0m23:05:25.687951 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:05:25.688959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:05:26.414927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8814e36-024a-4890-9135-e77affb55113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBC26B760>]}
[0m23:05:26.458661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8814e36-024a-4890-9135-e77affb55113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBE01B700>]}
[0m23:05:26.460670 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:05:26.482262 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:05:26.728160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:26.729164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:26.775662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8814e36-024a-4890-9135-e77affb55113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD79F3FA0>]}
[0m23:05:26.943524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8814e36-024a-4890-9135-e77affb55113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD74D10C0>]}
[0m23:05:26.944529 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m23:05:26.945533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8814e36-024a-4890-9135-e77affb55113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD799CE80>]}
[0m23:05:26.946536 [info ] [MainThread]: 
[0m23:05:26.947542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:05:26.951634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:05:26.966344 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:05:26.967357 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:05:26.967357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:27.598651 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.631 seconds
[0m23:05:27.600669 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:05:27.729584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8814e36-024a-4890-9135-e77affb55113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD79F02E0>]}
[0m23:05:27.729584 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:27.730593 [info ] [MainThread]: 
[0m23:05:27.733674 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:05:27.733674 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:05:27.734680 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:05:27.734680 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:05:27.734680 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:05:27.736765 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:05:27.736765 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m23:05:27.737767 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:05:27.737767 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:05:27.738863 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:05:27.739867 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m23:05:27.739867 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:05:27.740872 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:05:27.740872 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:05:27.741877 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:05:27.741877 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:05:27.755165 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:05:27.759173 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:05:27.763605 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:05:27.767641 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:05:27.768900 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:05:27.769912 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:05:27.786276 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:05:27.787285 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:05:27.789767 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:05:27.790786 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:05:27.793883 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:05:27.793883 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:05:27.796912 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:05:27.797915 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:05:27.797915 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:05:27.799293 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:05:27.799293 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:05:27.800626 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:05:27.800626 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:05:27.800626 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m23:05:27.800626 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:05:27.802129 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:05:27.803569 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:05:27.804654 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:05:28.370291 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m23:05:28.377346 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:05:28.405338 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.605 seconds
[0m23:05:28.406354 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:05:28.498604 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m23:05:28.499614 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:05:28.500638 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:05:28.500638 [info ] [Thread-4 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:05:28.501641 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m23:05:28.501641 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:05:28.507942 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:05:28.508949 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:05:28.510978 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:05:28.511982 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:05:28.512984 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:05:28.512984 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:05:28.534834 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.80s]
[0m23:05:28.536058 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:05:29.004837 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m23:05:29.006848 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:05:29.132851 [info ] [Thread-4 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.63s]
[0m23:05:29.133864 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:05:29.387826 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.587 seconds
[0m23:05:29.389833 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:05:29.392287 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.589 seconds
[0m23:05:29.393510 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m23:05:29.509157 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.77s]
[0m23:05:29.510161 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:05:29.519379 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 1.78s]
[0m23:05:29.520380 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:05:29.521648 [info ] [MainThread]: 
[0m23:05:29.521648 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:05:29.543133 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:05:29.549161 [debug] [MainThread]: Using snowflake connection "master"
[0m23:05:29.549161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:05:29.550164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:30.557981 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.008 seconds
[0m23:05:30.572278 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:05:30.577307 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:05:30.581412 [debug] [MainThread]: Using snowflake connection "master"
[0m23:05:30.582415 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7587368488311768'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7970669269561768'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6312093734741211'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.770293951034546'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.780515432357788'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m23:05:31.089601 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.507 seconds
[0m23:05:31.090741 [debug] [MainThread]: Using snowflake connection "master"
[0m23:05:31.090741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:05:31.373374 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.282 seconds
[0m23:05:31.374399 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.80s]
[0m23:05:31.375421 [info ] [MainThread]: 
[0m23:05:31.376432 [debug] [MainThread]: On master: Close
[0m23:05:31.516716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:31.516716 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:05:31.517726 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m23:05:31.517726 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:05:31.517726 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m23:05:31.518731 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:05:31.518731 [info ] [MainThread]: 
[0m23:05:31.519735 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m23:05:31.520738 [debug] [MainThread]: Command end result
[0m23:05:31.558727 [info ] [MainThread]: 
[0m23:05:31.559732 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:05:31.559732 [info ] [MainThread]: 
[0m23:05:31.560736 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:05:31.561739 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:05:31.561739 [info ] [MainThread]: 
[0m23:05:31.562742 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:05:31.562742 [info ] [MainThread]: 
[0m23:05:31.563745 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:05:31.564749 [debug] [MainThread]: Command `dbt test` failed at 23:05:31.564749 after 5.94 seconds
[0m23:05:31.564749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBBFE2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBE01B700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD7DC5D20>]}
[0m23:05:31.565753 [debug] [MainThread]: Flushing usage events
[0m23:06:58.262950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222D7029B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222302BA530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222302BA350>]}


============================== 23:06:58.266396 | 6efefc91-0222-4269-9083-42e896c77cd4 ==============================
[0m23:06:58.266396 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:06:58.267474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:06:59.037658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6efefc91-0222-4269-9083-42e896c77cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222D987970>]}
[0m23:06:59.083742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6efefc91-0222-4269-9083-42e896c77cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222D1D3580>]}
[0m23:06:59.084747 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:06:59.108324 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:06:59.345820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:06:59.346824 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m23:06:59.725913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6efefc91-0222-4269-9083-42e896c77cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022249420130>]}
[0m23:06:59.854001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6efefc91-0222-4269-9083-42e896c77cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222494230A0>]}
[0m23:06:59.855003 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m23:06:59.855003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6efefc91-0222-4269-9083-42e896c77cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222490C0370>]}
[0m23:06:59.857334 [info ] [MainThread]: 
[0m23:06:59.858338 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:06:59.864530 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:06:59.877442 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:06:59.878449 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:06:59.878449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:00.536491 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.658 seconds
[0m23:07:00.538493 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:07:00.679442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6efefc91-0222-4269-9083-42e896c77cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022249420370>]}
[0m23:07:00.680445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:00.681448 [info ] [MainThread]: 
[0m23:07:00.685359 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:00.685359 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:00.685874 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:00.686396 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:00.686913 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:07:00.687428 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:07:00.688460 [info ] [Thread-3 (]: 3 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:07:00.688978 [info ] [Thread-4 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:07:00.689490 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:07:00.690529 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:07:00.691044 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:07:00.691559 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m23:07:00.692077 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:00.692591 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:00.693108 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:00.693621 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:00.708122 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:07:00.711132 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:07:00.715240 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:07:00.721280 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:07:00.722283 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:00.723287 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:00.724293 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:00.740449 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:07:00.740449 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:00.743471 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:07:00.746559 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:07:00.749578 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:07:00.749578 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:07:00.750583 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:07:00.751588 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:07:00.752593 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:07:00.752593 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:07:00.753599 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:07:00.754603 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:07:00.754603 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:07:00.755604 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:07:00.755604 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:07:00.756604 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:07:00.760340 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:07:01.295183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.540 seconds
[0m23:07:01.302434 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:07:01.347783 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m23:07:01.349794 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:07:01.419305 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.73s]
[0m23:07:01.421482 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:01.473001 [error] [Thread-3 (]: 3 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m23:07:01.474004 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:02.348636 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.593 seconds
[0m23:07:02.350743 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:07:02.469886 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.78s]
[0m23:07:02.470897 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:02.473021 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.713 seconds
[0m23:07:02.475178 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:07:02.598939 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.91s]
[0m23:07:02.599942 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:02.601949 [info ] [MainThread]: 
[0m23:07:02.601949 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:07:02.623225 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:07:02.628331 [debug] [MainThread]: Using snowflake connection "master"
[0m23:07:02.629335 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:07:02.629335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:03.696126 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.066 seconds
[0m23:07:03.771600 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:07:03.776991 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:07:03.781012 [debug] [MainThread]: Using snowflake connection "master"
[0m23:07:03.782017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7298152446746826'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7809545993804932'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7785532474517822'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.907379388809204'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m23:07:04.236775 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.455 seconds
[0m23:07:04.237881 [debug] [MainThread]: Using snowflake connection "master"
[0m23:07:04.238882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:07:04.710611 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.471 seconds
[0m23:07:04.711785 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.93s]
[0m23:07:04.711785 [info ] [MainThread]: 
[0m23:07:04.712789 [debug] [MainThread]: On master: Close
[0m23:07:04.834411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:04.835548 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:07:04.835548 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m23:07:04.835548 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:07:04.836550 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:07:04.836550 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:07:04.837630 [info ] [MainThread]: 
[0m23:07:04.837630 [info ] [MainThread]: Finished running 4 data tests, 1 project hook in 0 hours 0 minutes and 4.98 seconds (4.98s).
[0m23:07:04.839640 [debug] [MainThread]: Command end result
[0m23:07:04.877527 [info ] [MainThread]: 
[0m23:07:04.878534 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:07:04.878534 [info ] [MainThread]: 
[0m23:07:04.879537 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:07:04.880751 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:07:04.880751 [info ] [MainThread]: 
[0m23:07:04.881863 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:07:04.881863 [info ] [MainThread]: 
[0m23:07:04.882926 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:07:04.884006 [debug] [MainThread]: Command `dbt test` failed at 23:07:04.884006 after 6.68 seconds
[0m23:07:04.885007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222D7029B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022249301150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222496675B0>]}
[0m23:07:04.885007 [debug] [MainThread]: Flushing usage events
[0m23:07:23.838224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C219BCE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C21C78E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C21C78E230>]}


============================== 23:07:23.841354 | c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e ==============================
[0m23:07:23.841354 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:07:23.842467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:07:24.625111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C219E5BCD0>]}
[0m23:07:24.669817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C21BC0B760>]}
[0m23:07:24.670818 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:07:24.693060 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:07:24.942464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:07:24.943754 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m23:07:24.944760 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m23:07:25.341286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2358FD630>]}
[0m23:07:25.465810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23535CB50>]}
[0m23:07:25.466856 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m23:07:25.468077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23558C700>]}
[0m23:07:25.469228 [info ] [MainThread]: 
[0m23:07:25.470233 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:07:25.475513 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:07:25.490612 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:07:25.491699 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:07:25.491699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:26.135051 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.643 seconds
[0m23:07:26.136055 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:07:26.255549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23535D720>]}
[0m23:07:26.256552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:26.257753 [info ] [MainThread]: 
[0m23:07:26.259855 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:26.260932 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:26.260932 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:07:26.260932 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:26.261938 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:07:26.261938 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:07:26.262943 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m23:07:26.263947 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:07:26.263947 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:07:26.264951 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:07:26.264951 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m23:07:26.265957 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:07:26.265957 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:26.266957 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:26.266957 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:07:26.268199 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:26.281590 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:07:26.285593 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:07:26.291079 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:07:26.294097 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:07:26.295108 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:26.304237 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:07:26.312531 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:07:26.312531 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:26.315547 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:07:26.315547 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:26.317559 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:07:26.318564 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:07:26.321819 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:07:26.322826 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:07:26.322826 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:07:26.323833 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:07:26.324838 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m23:07:26.324838 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:07:26.325841 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:07:26.325841 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:07:26.326842 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:07:26.326842 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:07:26.328253 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:07:26.330263 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:07:26.912420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.587 seconds
[0m23:07:26.919109 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:07:26.949609 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m23:07:26.951625 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m23:07:26.967958 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m23:07:26.969973 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:07:27.037539 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.77s]
[0m23:07:27.038113 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:27.039119 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:27.040120 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:07:27.040120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m23:07:27.041166 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:27.106208 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:07:27.108413 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:27.112435 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:07:27.109419 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.84s]
[0m23:07:27.113439 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:07:27.109419 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.84s]
[0m23:07:27.114444 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:07:27.114444 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:27.115452 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:07:27.116618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:27.657257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m23:07:27.659264 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:07:27.784633 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.74s]
[0m23:07:27.785640 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:27.876232 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.547 seconds
[0m23:07:27.877236 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:07:27.990788 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.73s]
[0m23:07:27.991802 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:27.992814 [info ] [MainThread]: 
[0m23:07:27.993818 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:07:28.015317 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:07:28.020348 [debug] [MainThread]: Using snowflake connection "master"
[0m23:07:28.021357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:07:28.021357 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:29.029654 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.008 seconds
[0m23:07:29.044917 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:07:29.049249 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:07:29.054365 [debug] [MainThread]: Using snowflake connection "master"
[0m23:07:29.054365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.773592472076416'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8434619903564453'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8434619903564453'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7445132732391357'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.725837230682373'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m23:07:29.527214 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.472 seconds
[0m23:07:29.528218 [debug] [MainThread]: Using snowflake connection "master"
[0m23:07:29.528218 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:07:29.812287 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.283 seconds
[0m23:07:29.813293 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.76s]
[0m23:07:29.814296 [info ] [MainThread]: 
[0m23:07:29.814296 [debug] [MainThread]: On master: Close
[0m23:07:29.930585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:29.930585 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:07:29.931966 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:07:29.931966 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:07:29.931966 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m23:07:29.932970 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:07:29.932970 [info ] [MainThread]: 
[0m23:07:29.933973 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m23:07:29.934980 [debug] [MainThread]: Command end result
[0m23:07:29.971427 [info ] [MainThread]: 
[0m23:07:29.972431 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:07:29.973435 [info ] [MainThread]: 
[0m23:07:29.974439 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:07:29.974439 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:07:29.975447 [info ] [MainThread]: 
[0m23:07:29.976525 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:07:29.976525 [info ] [MainThread]: 
[0m23:07:29.977529 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:07:29.978532 [debug] [MainThread]: Command `dbt test` failed at 23:07:29.978532 after 6.20 seconds
[0m23:07:29.979535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C219BCE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C21C0C1AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23560A530>]}
[0m23:07:29.979535 [debug] [MainThread]: Flushing usage events
[0m23:09:37.299343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204B50B2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204B7C6E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204B7C6E320>]}


============================== 23:09:37.302360 | 5bc68fe2-554b-4a71-ab8d-4ef9609b6916 ==============================
[0m23:09:37.302360 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:09:37.303363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:09:38.043350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bc68fe2-554b-4a71-ab8d-4ef9609b6916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204B533BEB0>]}
[0m23:09:38.087793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bc68fe2-554b-4a71-ab8d-4ef9609b6916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D05797E0>]}
[0m23:09:38.088798 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:09:38.109461 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:09:38.347549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:09:38.347549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:09:38.395019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bc68fe2-554b-4a71-ab8d-4ef9609b6916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D0AC3E50>]}
[0m23:09:38.566864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bc68fe2-554b-4a71-ab8d-4ef9609b6916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D0AC2F20>]}
[0m23:09:38.567878 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m23:09:38.567878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc68fe2-554b-4a71-ab8d-4ef9609b6916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D0A71300>]}
[0m23:09:38.569886 [info ] [MainThread]: 
[0m23:09:38.570889 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:09:38.574903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:09:38.588989 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:09:38.589993 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:09:38.589993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:39.265623 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.675 seconds
[0m23:09:39.266630 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:09:39.394449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc68fe2-554b-4a71-ab8d-4ef9609b6916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D0AC0490>]}
[0m23:09:39.394449 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:39.395520 [info ] [MainThread]: 
[0m23:09:39.398538 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:09:39.398538 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:09:39.399539 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:09:39.399539 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:09:39.400540 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:09:39.400540 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:09:39.401541 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m23:09:39.402542 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:09:39.402542 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:09:39.403543 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:09:39.403543 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m23:09:39.404636 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:09:39.404636 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:09:39.405640 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:09:39.405640 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:09:39.406645 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:09:39.420423 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:09:39.424580 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:09:39.428602 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:09:39.431715 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:09:39.432720 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:09:39.433725 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:09:39.445942 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:09:39.450061 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:09:39.451068 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:09:39.454081 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:09:39.456096 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:09:39.459114 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:09:39.460118 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:09:39.461119 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:09:39.462120 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:09:39.462120 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:09:39.462120 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:09:39.463414 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:09:39.463414 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:09:39.464419 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m23:09:39.464419 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:09:39.465425 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:09:39.467433 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:09:39.469447 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:09:40.037659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m23:09:40.044686 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:09:40.088985 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m23:09:40.091008 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m23:09:40.092012 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.627 seconds
[0m23:09:40.094184 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:09:40.163107 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.76s]
[0m23:09:40.164328 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:09:40.164328 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:09:40.165331 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:09:40.165331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m23:09:40.166338 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:09:40.172474 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:09:40.173480 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:09:40.175499 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:09:40.176505 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:09:40.177510 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:09:40.177510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:40.219455 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.82s]
[0m23:09:40.221463 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:09:40.224477 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.82s]
[0m23:09:40.225482 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:09:40.728402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m23:09:40.729405 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:09:40.853606 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.69s]
[0m23:09:40.855039 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:09:41.004175 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.535 seconds
[0m23:09:41.005181 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:09:41.131930 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.73s]
[0m23:09:41.133937 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:09:41.134960 [info ] [MainThread]: 
[0m23:09:41.134960 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:09:41.157677 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:09:41.163705 [debug] [MainThread]: Using snowflake connection "master"
[0m23:09:41.163705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:09:41.164710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:09:42.214305 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.050 seconds
[0m23:09:42.230268 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:09:42.234390 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:09:42.238591 [debug] [MainThread]: Using snowflake connection "master"
[0m23:09:42.239655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7605652809143066'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8159122467041016'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8209342956542969'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6882753372192383'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7272937297821045'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m23:09:42.685350 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.444 seconds
[0m23:09:42.685350 [debug] [MainThread]: Using snowflake connection "master"
[0m23:09:42.686351 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:09:42.965057 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.278 seconds
[0m23:09:42.966064 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.73s]
[0m23:09:42.967108 [info ] [MainThread]: 
[0m23:09:42.968114 [debug] [MainThread]: On master: Close
[0m23:09:43.090804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:43.090804 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:09:43.091895 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:09:43.091895 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:09:43.092901 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m23:09:43.092901 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:09:43.092901 [info ] [MainThread]: 
[0m23:09:43.093906 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m23:09:43.094911 [debug] [MainThread]: Command end result
[0m23:09:43.134830 [info ] [MainThread]: 
[0m23:09:43.135851 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:09:43.135851 [info ] [MainThread]: 
[0m23:09:43.136875 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:09:43.138009 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:09:43.138009 [info ] [MainThread]: 
[0m23:09:43.139088 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:09:43.139088 [info ] [MainThread]: 
[0m23:09:43.140384 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:09:43.141451 [debug] [MainThread]: Command `dbt test` failed at 23:09:43.141451 after 5.90 seconds
[0m23:09:43.142474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204B50B2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204B4B834F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D0E96230>]}
[0m23:09:43.142474 [debug] [MainThread]: Flushing usage events
[0m23:10:05.624979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026029D3E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602C8DE560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602C8DE380>]}


============================== 23:10:05.628082 | 0922541d-117b-4a0a-aaa5-ebcee8f02669 ==============================
[0m23:10:05.628082 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:10:05.629085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:10:06.327851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0922541d-117b-4a0a-aaa5-ebcee8f02669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602A5B4820>]}
[0m23:10:06.372777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0922541d-117b-4a0a-aaa5-ebcee8f02669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602BD21720>]}
[0m23:10:06.373781 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:10:06.395014 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:10:06.627887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:06.627887 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m23:10:06.770765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0922541d-117b-4a0a-aaa5-ebcee8f02669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604573C130>]}
[0m23:10:06.891783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0922541d-117b-4a0a-aaa5-ebcee8f02669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604536F340>]}
[0m23:10:06.891783 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m23:10:06.892787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0922541d-117b-4a0a-aaa5-ebcee8f02669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602A0C9300>]}
[0m23:10:06.894790 [info ] [MainThread]: 
[0m23:10:06.895879 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:10:06.899895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:10:06.914457 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:10:06.914457 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:10:06.915462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:07.592563 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.677 seconds
[0m23:10:07.594571 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:10:07.717715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0922541d-117b-4a0a-aaa5-ebcee8f02669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604573E7D0>]}
[0m23:10:07.717715 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:10:07.719190 [info ] [MainThread]: 
[0m23:10:07.722299 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:07.722299 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:07.723424 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:07.723424 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:07.723424 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:10:07.724430 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:10:07.725434 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m23:10:07.725434 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:10:07.726438 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:10:07.727520 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:10:07.727520 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m23:10:07.728526 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:10:07.728526 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:07.729531 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:07.729531 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:07.730539 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:07.743312 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:07.747328 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:07.751358 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:10:07.754380 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:07.755385 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:07.756400 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:07.771559 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:07.771559 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:07.775111 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:07.776116 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:07.779135 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:10:07.779135 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:07.782167 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:07.783177 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:07.784202 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:10:07.785209 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:10:07.785209 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:10:07.786704 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:07.786704 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:10:07.787711 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m23:10:07.787711 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:10:07.788716 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:10:07.790800 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:10:07.791805 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:10:08.314801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m23:10:08.321332 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:10:08.443993 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.72s]
[0m23:10:08.445072 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:08.446076 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:08.446076 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:10:08.447080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m23:10:08.448084 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:08.453781 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:08.453781 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:08.456973 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:08.457977 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:08.458980 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:10:08.458980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:08.979819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m23:10:08.981832 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:10:09.150594 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.70s]
[0m23:10:09.151597 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:09.353795 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.564 seconds
[0m23:10:09.355812 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m23:10:09.475518 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 1.75s]
[0m23:10:09.477537 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:10.621805 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.834 seconds
[0m23:10:10.623835 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:10:10.630400 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.838 seconds
[0m23:10:10.631416 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:10:10.740737 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 3.01s]
[0m23:10:10.742744 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:10.748503 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 3.02s]
[0m23:10:10.749503 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:10.750007 [info ] [MainThread]: 
[0m23:10:10.751010 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:10:10.773959 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:10:10.779967 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:10.780968 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:10:10.780968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:11.813943 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.032 seconds
[0m23:10:11.828193 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:10:11.832213 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:10:11.837352 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:11.838354 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7175557613372803'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7035138607025146'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7479979991912842'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.013216972351074'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.018955945968628'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched and target.is_active = 'Y' then
      update set TIMESTAMP = source.TIMESTAMP
    when matched and target.is_active = 'N' then
      update set 
        is_active = 'Y',
        deactivated_timestamp = null,
        TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m23:10:12.350150 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.511 seconds
[0m23:10:12.350150 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:12.351153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:10:12.739472 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.388 seconds
[0m23:10:12.741008 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.91s]
[0m23:10:12.741519 [info ] [MainThread]: 
[0m23:10:12.742551 [debug] [MainThread]: On master: Close
[0m23:10:12.857144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:12.858165 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:10:12.858165 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:10:12.859169 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:10:12.859169 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m23:10:12.860172 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:10:12.860172 [info ] [MainThread]: 
[0m23:10:12.860172 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 5.97 seconds (5.97s).
[0m23:10:12.862477 [debug] [MainThread]: Command end result
[0m23:10:12.900774 [info ] [MainThread]: 
[0m23:10:12.900774 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:10:12.901777 [info ] [MainThread]: 
[0m23:10:12.902780 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:10:12.903862 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:10:12.903862 [info ] [MainThread]: 
[0m23:10:12.904894 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:10:12.904894 [info ] [MainThread]: 
[0m23:10:12.905899 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:10:12.906902 [debug] [MainThread]: Command `dbt test` failed at 23:10:12.906902 after 7.34 seconds
[0m23:10:12.908036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026029D3E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026045272B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026045C61810>]}
[0m23:10:12.908036 [debug] [MainThread]: Flushing usage events
[0m23:10:25.007912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD54F9E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD57B4A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD57B4A320>]}


============================== 23:10:25.010992 | a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31 ==============================
[0m23:10:25.010992 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:10:25.011995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m23:10:25.723806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD55227A90>]}
[0m23:10:25.768867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD54A93520>]}
[0m23:10:25.769870 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:10:25.791140 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:10:26.041803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:26.042809 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m23:10:26.414114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD70CB0130>]}
[0m23:10:26.539861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD70CB0640>]}
[0m23:10:26.539861 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m23:10:26.540866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD709504C0>]}
[0m23:10:26.542869 [info ] [MainThread]: 
[0m23:10:26.543871 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:10:26.549074 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:10:26.561138 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:10:26.562374 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:10:26.562374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:27.216238 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.654 seconds
[0m23:10:27.218247 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:10:27.350285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD70CB0910>]}
[0m23:10:27.350285 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:10:27.351553 [info ] [MainThread]: 
[0m23:10:27.354564 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:27.354564 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:27.355583 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:27.355583 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:27.356589 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:10:27.356589 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:10:27.357604 [info ] [Thread-3 (]: 3 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:10:27.357604 [info ] [Thread-4 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:10:27.358610 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:10:27.358610 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:10:27.359618 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:10:27.360623 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m23:10:27.360623 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:27.360623 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:27.361628 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:27.361628 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:27.374829 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:27.378866 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:27.382961 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:27.389014 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:27.390023 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:27.395067 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:27.395067 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:27.406422 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:27.408431 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:27.409434 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:27.412545 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:27.414556 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:27.415571 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:27.416576 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:27.417587 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:27.417587 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:10:27.418590 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:10:27.418590 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:27.418590 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:10:27.419671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:10:27.419671 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:10:27.420681 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:10:27.420681 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:10:27.424709 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:10:27.984663 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m23:10:27.992730 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:10:28.112256 [error] [Thread-3 (]: 3 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.75s]
[0m23:10:28.114283 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:29.004932 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.581 seconds
[0m23:10:29.007176 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:10:29.133961 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.77s]
[0m23:10:29.134963 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:29.155142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.736 seconds
[0m23:10:29.157311 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:10:29.279971 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 1.92s]
[0m23:10:29.282009 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:30.168050 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.747 seconds
[0m23:10:30.171074 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:10:30.296087 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 2.94s]
[0m23:10:30.297092 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:30.299100 [info ] [MainThread]: 
[0m23:10:30.299100 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:10:30.325060 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:10:30.334090 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:30.335281 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:10:30.335281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:31.338938 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.003 seconds
[0m23:10:31.414784 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:10:31.418970 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:10:31.424001 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:31.425007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7526371479034424'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7743422985076904'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9213614463806152'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.9374773502349854'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched and target.is_active = 'Y' then
      update set TIMESTAMP = source.TIMESTAMP
    when matched and target.is_active = 'N' then
      update set 
        is_active = 'Y',
        deactivated_timestamp = null,
        TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m23:10:31.872584 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.447 seconds
[0m23:10:31.873589 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:31.873589 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:10:32.281613 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.407 seconds
[0m23:10:32.282617 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.86s]
[0m23:10:32.283620 [info ] [MainThread]: 
[0m23:10:32.283620 [debug] [MainThread]: On master: Close
[0m23:10:32.414124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:32.415134 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:10:32.415134 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m23:10:32.415134 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:10:32.416139 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:10:32.416139 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:10:32.417146 [info ] [MainThread]: 
[0m23:10:32.417146 [info ] [MainThread]: Finished running 4 data tests, 1 project hook in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m23:10:32.419154 [debug] [MainThread]: Command end result
[0m23:10:32.454805 [info ] [MainThread]: 
[0m23:10:32.455823 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:10:32.456982 [info ] [MainThread]: 
[0m23:10:32.458018 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:10:32.458018 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:10:32.459310 [info ] [MainThread]: 
[0m23:10:32.459310 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:10:32.460313 [info ] [MainThread]: 
[0m23:10:32.460313 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:10:32.461319 [debug] [MainThread]: Command `dbt test` failed at 23:10:32.461319 after 7.51 seconds
[0m23:10:32.462327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD54F9E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD70BC1F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD710E40A0>]}
[0m23:10:32.462327 [debug] [MainThread]: Flushing usage events
[0m23:10:43.626189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678488E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678741A4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678741A2F0>]}


============================== 23:10:43.629207 | 82f52b82-9559-4f9a-a997-42c9a55357ec ==============================
[0m23:10:43.629207 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:10:43.630235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m23:10:44.364689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82f52b82-9559-4f9a-a997-42c9a55357ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267873D6980>]}
[0m23:10:44.408582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82f52b82-9559-4f9a-a997-42c9a55357ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678513C7C0>]}
[0m23:10:44.409585 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:10:44.430808 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:10:44.663363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:44.664366 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m23:10:45.019182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82f52b82-9559-4f9a-a997-42c9a55357ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A0588130>]}
[0m23:10:45.136183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82f52b82-9559-4f9a-a997-42c9a55357ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A05880D0>]}
[0m23:10:45.137301 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m23:10:45.138306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f52b82-9559-4f9a-a997-42c9a55357ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A0220D30>]}
[0m23:10:45.139311 [info ] [MainThread]: 
[0m23:10:45.140315 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:10:45.145357 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:10:45.158584 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:10:45.158584 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:10:45.159588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:45.798626 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.639 seconds
[0m23:10:45.799632 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:10:45.923162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f52b82-9559-4f9a-a997-42c9a55357ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A0588070>]}
[0m23:10:45.924168 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:10:45.924168 [info ] [MainThread]: 
[0m23:10:45.927348 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:45.928352 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:45.928352 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:45.928352 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:45.929356 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:10:45.929356 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:10:45.930359 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m23:10:45.930359 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:10:45.931360 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:10:45.931360 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:10:45.932630 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m23:10:45.932630 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:10:45.933635 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:45.933635 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:45.934641 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:45.934641 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:45.948043 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:45.951051 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:45.955112 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:10:45.958283 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:45.959286 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:45.960291 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:45.970453 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:45.976847 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:45.980870 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:45.980870 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:45.982878 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:10:45.985928 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:45.987057 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:45.988062 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:45.988062 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:10:45.989073 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:10:45.989073 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:10:45.990076 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:45.990076 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:10:45.991205 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m23:10:45.991205 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:10:45.992209 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:10:45.994221 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:10:45.995226 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:10:46.598197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m23:10:46.605235 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:10:46.606240 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m23:10:46.608359 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:10:46.747836 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.82s]
[0m23:10:46.748841 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:46.749846 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:46.750856 [info ] [Thread-4 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:10:46.751861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m23:10:46.751861 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:46.750856 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.82s]
[0m23:10:46.757883 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:46.758888 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:46.759893 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:46.820202 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:46.822232 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:46.822232 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:10:46.823343 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:10:47.351589 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.529 seconds
[0m23:10:47.353598 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:10:47.480169 [info ] [Thread-4 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.73s]
[0m23:10:47.482119 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:47.516344 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.525 seconds
[0m23:10:47.518247 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:10:47.636985 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.70s]
[0m23:10:47.637989 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:48.746526 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.752 seconds
[0m23:10:48.747535 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m23:10:48.876709 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 2.94s]
[0m23:10:48.877712 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:48.879102 [info ] [MainThread]: 
[0m23:10:48.880104 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:10:48.902904 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:10:48.908990 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:48.908990 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:10:48.909995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:49.887380 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.977 seconds
[0m23:10:49.902573 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:10:49.906703 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:10:49.911726 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:49.912732 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8152055740356445'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8194959163665771'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7293133735656738'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7046194076538086'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.943072557449341'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched and target.is_active = 'Y' then
      update set TIMESTAMP = source.TIMESTAMP
    when matched and target.is_active = 'N' then
      update set 
        is_active = 'Y',
        deactivated_timestamp = null,
        TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m23:10:50.353496 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.441 seconds
[0m23:10:50.354521 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:50.354521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:10:50.647702 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.292 seconds
[0m23:10:50.648706 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.74s]
[0m23:10:50.649712 [info ] [MainThread]: 
[0m23:10:50.649712 [debug] [MainThread]: On master: Close
[0m23:10:50.770788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:50.771804 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:10:50.771804 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m23:10:50.771804 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:10:50.772808 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m23:10:50.772808 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:10:50.773812 [info ] [MainThread]: 
[0m23:10:50.773812 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 5.63 seconds (5.63s).
[0m23:10:50.775905 [debug] [MainThread]: Command end result
[0m23:10:50.813321 [info ] [MainThread]: 
[0m23:10:50.814322 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:10:50.815323 [info ] [MainThread]: 
[0m23:10:50.816324 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:10:50.817325 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:10:50.817325 [info ] [MainThread]: 
[0m23:10:50.818326 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:10:50.818326 [info ] [MainThread]: 
[0m23:10:50.819326 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:10:50.821352 [debug] [MainThread]: Command `dbt test` failed at 23:10:50.820328 after 7.25 seconds
[0m23:10:50.821352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678488E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267850F4B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A02822F0>]}
[0m23:10:50.822383 [debug] [MainThread]: Flushing usage events
[0m08:22:06.462470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063B33E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063DEFE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063DEFE320>]}


============================== 08:22:06.467794 | 1a0eac3e-e3a9-43e8-9689-751ea6b8895d ==============================
[0m08:22:06.467794 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:22:06.468802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:22:07.628495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a0eac3e-e3a9-43e8-9689-751ea6b8895d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063B5C7DC0>]}
[0m08:22:07.672090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a0eac3e-e3a9-43e8-9689-751ea6b8895d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063D926E00>]}
[0m08:22:07.673096 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:22:07.695372 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:22:07.984306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:22:07.985323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:22:08.033122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a0eac3e-e3a9-43e8-9689-751ea6b8895d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020656D53E50>]}
[0m08:22:08.205661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a0eac3e-e3a9-43e8-9689-751ea6b8895d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020656D53CA0>]}
[0m08:22:08.206840 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:22:08.206840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a0eac3e-e3a9-43e8-9689-751ea6b8895d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020656CFCE80>]}
[0m08:22:08.209004 [info ] [MainThread]: 
[0m08:22:08.209004 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:22:08.215001 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:22:08.230487 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:22:08.231493 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:22:08.231493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:22:08.888225 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.657 seconds
[0m08:22:08.890245 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:22:09.014302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a0eac3e-e3a9-43e8-9689-751ea6b8895d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020656D3B160>]}
[0m08:22:09.014302 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:22:09.015309 [info ] [MainThread]: 
[0m08:22:09.019351 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:22:09.019351 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:22:09.020370 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:22:09.020370 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:22:09.020370 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:22:09.021375 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:22:09.022379 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:22:09.022379 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:22:09.023379 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:22:09.023379 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:22:09.024548 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:22:09.024548 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:22:09.025554 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:22:09.025554 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:22:09.026559 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:22:09.026559 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:22:09.041351 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:22:09.044373 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:22:09.048400 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:22:09.051554 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:22:09.052558 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:22:09.064872 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:22:09.069974 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:22:09.070980 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:22:09.074027 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:22:09.074027 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:22:09.077042 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:22:09.077042 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:22:09.080056 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:22:09.081204 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:22:09.081204 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:22:09.082212 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:22:09.083216 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:22:09.083216 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:22:09.084469 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:22:09.084469 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:22:09.085474 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:22:09.085474 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:22:09.087494 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:22:09.089506 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:22:09.718388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m08:22:09.719395 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m08:22:09.727233 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:22:09.728715 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:22:09.861467 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.84s]
[0m08:22:09.863478 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:22:09.862473 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.84s]
[0m08:22:09.864483 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:22:09.864483 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:22:09.865488 [info ] [Thread-4 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:22:09.866493 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:22:09.866493 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:22:09.872622 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:22:09.873625 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:22:09.876643 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:22:09.877646 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:22:09.878652 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:22:09.878652 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:22:10.470221 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m08:22:10.472249 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:22:10.596239 [info ] [Thread-4 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.73s]
[0m08:22:10.597264 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:22:10.872855 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.788 seconds
[0m08:22:10.874903 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:22:10.998574 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 1.97s]
[0m08:22:10.999579 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:22:11.760997 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.674 seconds
[0m08:22:11.763004 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:22:11.887350 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 2.86s]
[0m08:22:11.887939 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:22:11.888969 [info ] [MainThread]: 
[0m08:22:11.889975 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:22:11.911210 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:22:11.916394 [debug] [MainThread]: Using snowflake connection "master"
[0m08:22:11.917401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:22:11.917401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:22:13.301020 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.383 seconds
[0m08:22:13.315192 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:22:13.320004 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:22:13.325023 [debug] [MainThread]: Using snowflake connection "master"
[0m08:22:13.326028 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8369193077087402'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8390932083129883'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7307515144348145'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9730193614959717'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.862515687942505'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched and target.is_active = 'Y' then
      update set TIMESTAMP = source.TIMESTAMP
    when matched and target.is_active = 'N' then
      update set 
        is_active = 'Y',
        deactivated_timestamp = null,
        TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:22:14.079571 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.753 seconds
[0m08:22:14.080607 [debug] [MainThread]: Using snowflake connection "master"
[0m08:22:14.080607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:22:14.540639 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.459 seconds
[0m08:22:14.542654 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.22s]
[0m08:22:14.542654 [info ] [MainThread]: 
[0m08:22:14.543660 [debug] [MainThread]: On master: Close
[0m08:22:14.669278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:22:14.670282 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:22:14.670282 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:22:14.671286 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:22:14.671286 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:22:14.671286 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:22:14.672296 [info ] [MainThread]: 
[0m08:22:14.672296 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 6.46 seconds (6.46s).
[0m08:22:14.674689 [debug] [MainThread]: Command end result
[0m08:22:14.712588 [info ] [MainThread]: 
[0m08:22:14.713917 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:22:14.715122 [info ] [MainThread]: 
[0m08:22:14.715122 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:22:14.716127 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:22:14.717213 [info ] [MainThread]: 
[0m08:22:14.717213 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:22:14.718217 [info ] [MainThread]: 
[0m08:22:14.718217 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:22:14.720274 [debug] [MainThread]: Command `dbt test` failed at 08:22:14.720274 after 8.32 seconds
[0m08:22:14.720274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063B33E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063D31F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206571EC4C0>]}
[0m08:22:14.721275 [debug] [MainThread]: Flushing usage events
[0m08:23:43.491880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB0E6E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB3A2A4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB3A2A2C0>]}


============================== 08:23:43.495005 | 62e59b94-8320-42dc-821c-2e4aa9bcf9ba ==============================
[0m08:23:43.495005 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:23:43.495005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:23:44.190398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62e59b94-8320-42dc-821c-2e4aa9bcf9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB10F7A90>]}
[0m08:23:44.234977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62e59b94-8320-42dc-821c-2e4aa9bcf9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCC3397E0>]}
[0m08:23:44.235982 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:23:44.256283 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:23:44.484201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:23:44.485204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:23:44.532265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62e59b94-8320-42dc-821c-2e4aa9bcf9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCC883E50>]}
[0m08:23:44.690560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62e59b94-8320-42dc-821c-2e4aa9bcf9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCC362350>]}
[0m08:23:44.691566 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:23:44.692571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62e59b94-8320-42dc-821c-2e4aa9bcf9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCC82D360>]}
[0m08:23:44.693576 [info ] [MainThread]: 
[0m08:23:44.694703 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:23:44.698915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:23:44.713122 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:23:44.713122 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:23:44.713122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:45.365664 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.653 seconds
[0m08:23:45.367854 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:23:45.488773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62e59b94-8320-42dc-821c-2e4aa9bcf9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCC360460>]}
[0m08:23:45.488773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:23:45.489783 [info ] [MainThread]: 
[0m08:23:45.492809 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:23:45.493840 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:23:45.493840 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:23:45.493840 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:23:45.493840 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:23:45.495198 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:23:45.495198 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:23:45.496324 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:23:45.497328 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:23:45.497328 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:23:45.498487 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:23:45.498487 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:23:45.499674 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:23:45.499674 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:23:45.500680 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:23:45.500680 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:23:45.515878 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:23:45.519881 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:23:45.523885 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:23:45.526888 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:23:45.527888 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:23:45.528889 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:23:45.545169 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:23:45.544166 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:23:45.548256 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:23:45.548256 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:23:45.550266 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:23:45.552281 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:23:45.554751 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:23:45.554751 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:23:45.555757 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:23:45.556760 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:23:45.556760 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:23:45.557816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:23:45.557816 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:23:45.558864 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:23:45.558864 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:23:45.560880 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:23:45.560880 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:23:45.563070 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:23:46.117994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m08:23:46.125299 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:23:46.186543 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m08:23:46.187999 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:23:46.201092 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m08:23:46.203109 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:23:46.239584 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.74s]
[0m08:23:46.240590 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:23:46.241601 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:23:46.241601 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:23:46.242683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:23:46.242683 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:23:46.248710 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:23:46.249737 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:23:46.252751 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:23:46.253756 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:23:46.253756 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:23:46.254765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:46.307080 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.81s]
[0m08:23:46.309094 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:23:46.316130 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.82s]
[0m08:23:46.317151 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:23:46.721780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m08:23:46.723797 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:23:46.841563 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.60s]
[0m08:23:46.842591 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:23:47.092741 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.534 seconds
[0m08:23:47.094843 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:23:47.215944 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.72s]
[0m08:23:47.216955 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:23:47.218062 [info ] [MainThread]: 
[0m08:23:47.219066 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:23:47.240302 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:23:47.246309 [debug] [MainThread]: Using snowflake connection "master"
[0m08:23:47.247310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:23:47.247310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:23:48.394282 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.147 seconds
[0m08:23:48.412301 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:23:48.417868 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:23:48.422328 [debug] [MainThread]: Using snowflake connection "master"
[0m08:23:48.422328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7422552108764648'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8085932731628418'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8176431655883789'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.5988805294036865'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.718616008758545'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched and target.is_active = 'Y' then
      update set TIMESTAMP = source.TIMESTAMP
    when matched and target.is_active = 'N' then
      update set 
        is_active = 'Y',
        deactivated_timestamp = null,
        TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:23:49.006738 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.583 seconds
[0m08:23:49.006738 [debug] [MainThread]: Using snowflake connection "master"
[0m08:23:49.007739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:23:49.572042 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.564 seconds
[0m08:23:49.573053 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.16s]
[0m08:23:49.574114 [info ] [MainThread]: 
[0m08:23:49.574114 [debug] [MainThread]: On master: Close
[0m08:23:49.692368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:23:49.693382 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:23:49.693382 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:23:49.693382 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:23:49.694388 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:23:49.694388 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:23:49.695479 [info ] [MainThread]: 
[0m08:23:49.695479 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m08:23:49.697566 [debug] [MainThread]: Command end result
[0m08:23:49.733545 [info ] [MainThread]: 
[0m08:23:49.733545 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:23:49.734550 [info ] [MainThread]: 
[0m08:23:49.735555 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:23:49.736560 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:23:49.736560 [info ] [MainThread]: 
[0m08:23:49.738576 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:23:49.738576 [info ] [MainThread]: 
[0m08:23:49.739582 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:23:49.740586 [debug] [MainThread]: Command `dbt test` failed at 08:23:49.740586 after 6.31 seconds
[0m08:23:49.741589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB0E6E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCCBEBDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCCD55C60>]}
[0m08:23:49.741589 [debug] [MainThread]: Flushing usage events
[0m08:25:45.144009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BD60E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C01CA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C01CA2F0>]}


============================== 08:25:45.147041 | 73606e42-4869-44c0-8e5d-6efa4ddd0533 ==============================
[0m08:25:45.147041 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:25:45.147041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:25:45.868377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73606e42-4869-44c0-8e5d-6efa4ddd0533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C0186980>]}
[0m08:25:45.913397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73606e42-4869-44c0-8e5d-6efa4ddd0533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BDEC62C0>]}
[0m08:25:45.914406 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:25:45.935069 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:25:46.174291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:25:46.174291 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m08:25:46.175294 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m08:25:46.565228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73606e42-4869-44c0-8e5d-6efa4ddd0533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D9335420>]}
[0m08:25:46.687661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73606e42-4869-44c0-8e5d-6efa4ddd0533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D8D9FEE0>]}
[0m08:25:46.688706 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m08:25:46.688706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73606e42-4869-44c0-8e5d-6efa4ddd0533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D8FD0340>]}
[0m08:25:46.690711 [info ] [MainThread]: 
[0m08:25:46.691869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:25:46.696303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:25:46.708169 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:25:46.708169 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:25:46.709174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:47.414669 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.705 seconds
[0m08:25:47.415685 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:25:47.533787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73606e42-4869-44c0-8e5d-6efa4ddd0533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D8D9F310>]}
[0m08:25:47.533787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:25:47.534924 [info ] [MainThread]: 
[0m08:25:47.538171 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:25:47.538171 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:25:47.539214 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:25:47.539214 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:25:47.540220 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:25:47.540220 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:25:47.541225 [info ] [Thread-3 (]: 3 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:25:47.541225 [info ] [Thread-4 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:25:47.542231 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:25:47.542231 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:25:47.543238 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:25:47.544246 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m08:25:47.544246 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:25:47.544246 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:25:47.545254 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:25:47.545254 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:25:47.560433 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:25:47.564468 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:25:47.568610 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:25:47.574647 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:25:47.575653 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:25:47.576658 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:25:47.583353 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:25:47.592532 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:25:47.595547 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:25:47.595547 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:25:47.598562 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:25:47.600719 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:25:47.601720 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:25:47.602845 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:25:47.602845 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:25:47.603863 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:25:47.603863 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:25:47.604868 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:25:47.604868 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:25:47.605873 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:25:47.605873 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:25:47.606877 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:25:47.607888 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:25:47.609903 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:25:48.211184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m08:25:48.218232 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:25:48.220245 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m08:25:48.222377 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:25:48.336837 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.79s]
[0m08:25:48.338147 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:25:48.340156 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.80s]
[0m08:25:48.341159 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:25:49.311470 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.701 seconds
[0m08:25:49.313471 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:25:49.435526 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.89s]
[0m08:25:49.436530 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:25:51.328387 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.720 seconds
[0m08:25:51.329405 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:25:51.453159 [error] [Thread-3 (]: 3 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 3.91s]
[0m08:25:51.454160 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:25:51.456346 [info ] [MainThread]: 
[0m08:25:51.456346 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:25:51.550203 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:25:51.556898 [debug] [MainThread]: Using snowflake connection "master"
[0m08:25:51.557899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:25:51.557899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:25:52.546814 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.988 seconds
[0m08:25:52.561040 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:25:52.566062 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:25:52.570098 [debug] [MainThread]: Using snowflake connection "master"
[0m08:25:52.570098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7946052551269531'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7979245185852051'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8922877311706543'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.9099202156066895'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:25:53.026777 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.455 seconds
[0m08:25:53.026777 [debug] [MainThread]: Using snowflake connection "master"
[0m08:25:53.027780 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:25:53.421113 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.393 seconds
[0m08:25:53.422118 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.86s]
[0m08:25:53.423123 [info ] [MainThread]: 
[0m08:25:53.423123 [debug] [MainThread]: On master: Close
[0m08:25:53.547797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:25:53.548797 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:25:53.548797 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:25:53.548797 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:25:53.549881 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:25:53.549881 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:25:53.550887 [info ] [MainThread]: 
[0m08:25:53.550887 [info ] [MainThread]: Finished running 4 data tests, 1 project hook in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m08:25:53.552897 [debug] [MainThread]: Command end result
[0m08:25:53.591557 [info ] [MainThread]: 
[0m08:25:53.592571 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:25:53.592571 [info ] [MainThread]: 
[0m08:25:53.593575 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:25:53.594579 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:25:53.594579 [info ] [MainThread]: 
[0m08:25:53.595751 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:25:53.595751 [info ] [MainThread]: 
[0m08:25:53.596756 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:25:53.597784 [debug] [MainThread]: Command `dbt test` failed at 08:25:53.597784 after 8.51 seconds
[0m08:25:53.598789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BD60E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D97AE0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D97AE590>]}
[0m08:25:53.598789 [debug] [MainThread]: Flushing usage events
[0m08:27:05.927745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B4342950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B6F36500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B6F36320>]}


============================== 08:27:05.929996 | 1121374e-64a1-4e1c-9722-507a736270d4 ==============================
[0m08:27:05.929996 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:27:05.930998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:27:06.669762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1121374e-64a1-4e1c-9722-507a736270d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B45C7A90>]}
[0m08:27:06.714781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1121374e-64a1-4e1c-9722-507a736270d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B3E13520>]}
[0m08:27:06.715785 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:27:06.736149 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:27:06.976564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:27:06.976564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:27:07.024327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1121374e-64a1-4e1c-9722-507a736270d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289CFD4C6A0>]}
[0m08:27:07.189832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1121374e-64a1-4e1c-9722-507a736270d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289CFD4C340>]}
[0m08:27:07.190839 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m08:27:07.190839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1121374e-64a1-4e1c-9722-507a736270d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289CFCFC940>]}
[0m08:27:07.192848 [info ] [MainThread]: 
[0m08:27:07.193853 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:27:07.197873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:27:07.212444 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:27:07.212444 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:27:07.212444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:07.846523 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.633 seconds
[0m08:27:07.848525 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:27:07.970649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1121374e-64a1-4e1c-9722-507a736270d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289CFD4D510>]}
[0m08:27:07.971655 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:27:07.972660 [info ] [MainThread]: 
[0m08:27:07.974676 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:27:07.975846 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:27:07.975846 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:27:07.976850 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:27:07.976850 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:27:07.977859 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:27:07.977859 [info ] [Thread-3 (]: 3 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:27:07.979053 [info ] [Thread-4 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:27:07.979053 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:27:07.979053 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:27:07.980257 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:27:07.981260 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m08:27:07.981260 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:27:07.981260 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:27:07.982557 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:27:07.982557 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:27:07.996058 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:27:08.000076 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:27:08.004082 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:27:08.008578 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:27:08.009581 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:27:08.020899 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:27:08.020899 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:27:08.026976 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:27:08.029501 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:27:08.030505 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:27:08.032508 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:27:08.035606 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:27:08.036609 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:27:08.036609 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:27:08.037747 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:27:08.037747 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:27:08.039110 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:27:08.039110 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:27:08.040222 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:27:08.040222 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:27:08.041225 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:27:08.041225 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:27:08.041225 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:27:08.043670 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:27:08.651599 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m08:27:08.659007 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:27:08.678075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m08:27:08.680091 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:27:08.682110 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m08:27:08.683115 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:27:08.777778 [error] [Thread-3 (]: 3 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.80s]
[0m08:27:08.778787 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:27:08.799672 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.82s]
[0m08:27:08.800824 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:27:08.800824 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.82s]
[0m08:27:08.801828 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:27:09.771544 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.728 seconds
[0m08:27:09.773551 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:27:09.893051 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.91s]
[0m08:27:09.894056 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:27:09.896174 [info ] [MainThread]: 
[0m08:27:09.896174 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:27:09.916401 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:27:09.922428 [debug] [MainThread]: Using snowflake connection "master"
[0m08:27:09.923440 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:27:09.923440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:27:11.097088 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.173 seconds
[0m08:27:11.111407 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:27:11.115493 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:27:11.119526 [debug] [MainThread]: Using snowflake connection "master"
[0m08:27:11.120616 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.797520637512207'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8206188678741455'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8206188678741455'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9127938747406006'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:27:11.591201 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.470 seconds
[0m08:27:11.591201 [debug] [MainThread]: Using snowflake connection "master"
[0m08:27:11.592320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:27:11.854126 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.261 seconds
[0m08:27:11.855135 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.74s]
[0m08:27:11.856139 [info ] [MainThread]: 
[0m08:27:11.856139 [debug] [MainThread]: On master: Close
[0m08:27:11.982299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:27:11.983302 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:27:11.983302 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:27:11.984306 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:27:11.984306 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:27:11.985310 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:27:11.985310 [info ] [MainThread]: 
[0m08:27:11.986314 [info ] [MainThread]: Finished running 4 data tests, 1 project hook in 0 hours 0 minutes and 4.79 seconds (4.79s).
[0m08:27:11.987326 [debug] [MainThread]: Command end result
[0m08:27:12.022264 [info ] [MainThread]: 
[0m08:27:12.023270 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:27:12.024276 [info ] [MainThread]: 
[0m08:27:12.025279 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:27:12.025279 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:27:12.026283 [info ] [MainThread]: 
[0m08:27:12.026283 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:27:12.027296 [info ] [MainThread]: 
[0m08:27:12.027296 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:27:12.028452 [debug] [MainThread]: Command `dbt test` failed at 08:27:12.028452 after 6.16 seconds
[0m08:27:12.029456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B4342950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B3E13520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289CFBF4430>]}
[0m08:27:12.029456 [debug] [MainThread]: Flushing usage events
[0m08:29:37.191309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165DD97E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165E053E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165E053E320>]}


============================== 08:29:37.193322 | 33f0e4c1-83c7-420d-a7dc-36564ac795de ==============================
[0m08:29:37.193322 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:29:37.194326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:29:37.900865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33f0e4c1-83c7-420d-a7dc-36564ac795de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165DDC07DC0>]}
[0m08:29:37.944374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33f0e4c1-83c7-420d-a7dc-36564ac795de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165DFF6AE00>]}
[0m08:29:37.945377 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:29:37.965006 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:29:38.195021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:29:38.196026 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m08:29:38.345288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33f0e4c1-83c7-420d-a7dc-36564ac795de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F9398130>]}
[0m08:29:38.466698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33f0e4c1-83c7-420d-a7dc-36564ac795de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F931B4C0>]}
[0m08:29:38.467708 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m08:29:38.468713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33f0e4c1-83c7-420d-a7dc-36564ac795de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F8F10BB0>]}
[0m08:29:38.469717 [info ] [MainThread]: 
[0m08:29:38.470722 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:29:38.475241 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:29:38.489321 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:29:38.489321 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:29:38.490468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:39.130161 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.640 seconds
[0m08:29:39.132175 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:29:39.251915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33f0e4c1-83c7-420d-a7dc-36564ac795de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F9398460>]}
[0m08:29:39.253153 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:29:39.253153 [info ] [MainThread]: 
[0m08:29:39.256184 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:29:39.256184 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:29:39.257189 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:29:39.257189 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:29:39.258200 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:29:39.258200 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:29:39.259503 [info ] [Thread-3 (]: 3 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:29:39.259503 [info ] [Thread-4 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:29:39.260507 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:29:39.260507 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:29:39.261518 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:29:39.261518 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m08:29:39.262523 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:29:39.262523 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:29:39.263530 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:29:39.263530 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:29:39.277803 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:29:39.280925 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:29:39.284953 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:29:39.289491 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:29:39.290771 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:29:39.291778 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:29:39.291778 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:29:39.307200 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:29:39.310218 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:29:39.311222 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:29:39.313243 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:29:39.316258 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:29:39.317262 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:29:39.318268 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:29:39.318268 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:29:39.319274 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:29:39.319274 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:29:39.320283 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:29:39.320283 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:29:39.321418 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:29:39.321418 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:29:39.322423 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:29:39.323429 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:29:39.325439 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:29:39.861434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m08:29:39.868446 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:29:39.919634 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m08:29:39.920662 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:29:39.937324 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m08:29:39.938326 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:29:39.986401 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.73s]
[0m08:29:39.987410 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:29:40.040556 [error] [Thread-3 (]: 3 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m08:29:40.041560 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:29:40.062849 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.80s]
[0m08:29:40.063854 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:29:40.887818 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.565 seconds
[0m08:29:40.888837 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:29:41.008913 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.75s]
[0m08:29:41.009925 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:29:41.010933 [info ] [MainThread]: 
[0m08:29:41.012437 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:29:41.032553 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:29:41.038877 [debug] [MainThread]: Using snowflake connection "master"
[0m08:29:41.038877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:29:41.039883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:29:42.053112 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.013 seconds
[0m08:29:42.067239 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:29:42.071720 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:29:42.075742 [debug] [MainThread]: Using snowflake connection "master"
[0m08:29:42.076744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7258942127227783'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7790384292602539'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8013308048248291'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7484056949615479'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:29:42.528804 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.451 seconds
[0m08:29:42.528804 [debug] [MainThread]: Using snowflake connection "master"
[0m08:29:42.529805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:29:42.745724 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.215 seconds
[0m08:29:42.746858 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.67s]
[0m08:29:42.746858 [info ] [MainThread]: 
[0m08:29:42.748208 [debug] [MainThread]: On master: Close
[0m08:29:42.870582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:42.871608 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:29:42.871608 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:29:42.872708 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:29:42.872708 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:29:42.872708 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:29:42.873712 [info ] [MainThread]: 
[0m08:29:42.873712 [info ] [MainThread]: Finished running 4 data tests, 1 project hook in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m08:29:42.875718 [debug] [MainThread]: Command end result
[0m08:29:42.912075 [info ] [MainThread]: 
[0m08:29:42.913078 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:29:42.914081 [info ] [MainThread]: 
[0m08:29:42.914081 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:29:42.915084 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:29:42.915084 [info ] [MainThread]: 
[0m08:29:42.916086 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:29:42.916086 [info ] [MainThread]: 
[0m08:29:42.917089 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:29:42.918197 [debug] [MainThread]: Command `dbt test` failed at 08:29:42.918197 after 5.78 seconds
[0m08:29:42.919201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165DD97E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165DFF6AE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F96974C0>]}
[0m08:29:42.919201 [debug] [MainThread]: Flushing usage events
[0m08:30:08.468551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24D5C2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E25017A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E25017A320>]}


============================== 08:30:08.471561 | b0192a82-9e35-458a-9d80-a034adbc4346 ==============================
[0m08:30:08.471561 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:30:08.472571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m08:30:09.193904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0192a82-9e35-458a-9d80-a034adbc4346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24D84BEB0>]}
[0m08:30:09.238932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0192a82-9e35-458a-9d80-a034adbc4346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E268A897E0>]}
[0m08:30:09.239952 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:30:09.259109 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:30:09.494318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:30:09.495322 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m08:30:09.852592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0192a82-9e35-458a-9d80-a034adbc4346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2692E8130>]}
[0m08:30:09.970382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0192a82-9e35-458a-9d80-a034adbc4346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2692E81F0>]}
[0m08:30:09.971387 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:30:09.971387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0192a82-9e35-458a-9d80-a034adbc4346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E268F7CE80>]}
[0m08:30:09.973644 [info ] [MainThread]: 
[0m08:30:09.973644 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:30:09.977900 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:30:09.991330 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:30:09.992336 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:30:09.992336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:30:10.624232 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.632 seconds
[0m08:30:10.625233 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:30:10.751442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0192a82-9e35-458a-9d80-a034adbc4346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2692EA260>]}
[0m08:30:10.751442 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:30:10.752594 [info ] [MainThread]: 
[0m08:30:10.755775 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:30:10.755775 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:30:10.756897 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:30:10.756897 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:30:10.757906 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:30:10.757906 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:30:10.758912 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:30:10.759916 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:30:10.760923 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:30:10.760923 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:30:10.761930 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:30:10.761930 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:30:10.762936 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:30:10.762936 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:30:10.763940 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:30:10.763940 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:30:10.779213 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:30:10.783727 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:30:10.787843 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:30:10.791925 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:30:10.792934 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:30:10.793941 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:30:10.802041 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:30:10.813693 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:30:10.816920 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:30:10.816920 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:30:10.820061 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:30:10.823079 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:30:10.824085 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:30:10.825090 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:30:10.825090 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:30:10.825090 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:30:10.826593 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:30:10.826593 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:30:10.827614 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:30:10.827614 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:30:10.828618 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:30:10.828618 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:30:10.830631 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:30:10.831638 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:30:11.375047 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m08:30:11.382060 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:30:11.496429 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.73s]
[0m08:30:11.497435 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:30:11.497435 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:30:11.498439 [info ] [Thread-2 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:30:11.498439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:30:11.499443 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:30:11.505469 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:30:11.505469 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:30:11.568324 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:30:11.569332 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:30:11.570339 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:30:11.570339 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:30:12.064245 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.493 seconds
[0m08:30:12.065381 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:30:12.276571 [info ] [Thread-2 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.78s]
[0m08:30:12.277572 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:30:12.630674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.803 seconds
[0m08:30:12.632057 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:30:12.645159 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.814 seconds
[0m08:30:12.646162 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:30:12.673486 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.842 seconds
[0m08:30:12.675499 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:30:12.756382 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 2.00s]
[0m08:30:12.757389 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:30:12.763081 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 2.00s]
[0m08:30:12.764539 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:30:12.795413 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.03s]
[0m08:30:12.796414 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:30:12.797567 [info ] [MainThread]: 
[0m08:30:12.798803 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:30:12.820174 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:30:12.826327 [debug] [MainThread]: Using snowflake connection "master"
[0m08:30:12.826327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:30:12.827336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:30:13.785259 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.958 seconds
[0m08:30:13.800960 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:30:13.805205 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:30:13.811405 [debug] [MainThread]: Using snowflake connection "master"
[0m08:30:13.811405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7345066070556641'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7771313190460205'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9964654445648193'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.0011513233184814'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.0334832668304443'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:30:14.232006 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.419 seconds
[0m08:30:14.232006 [debug] [MainThread]: Using snowflake connection "master"
[0m08:30:14.233020 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:30:14.515971 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.282 seconds
[0m08:30:14.516981 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.71s]
[0m08:30:14.517984 [info ] [MainThread]: 
[0m08:30:14.517984 [debug] [MainThread]: On master: Close
[0m08:30:14.637608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:14.638612 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:30:14.638612 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:30:14.639617 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:30:14.639617 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:30:14.639617 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:30:14.640621 [info ] [MainThread]: 
[0m08:30:14.640621 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m08:30:14.642760 [debug] [MainThread]: Command end result
[0m08:30:14.678583 [info ] [MainThread]: 
[0m08:30:14.679588 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:30:14.680593 [info ] [MainThread]: 
[0m08:30:14.680593 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:30:14.681595 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:30:14.681595 [info ] [MainThread]: 
[0m08:30:14.682611 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:30:14.682611 [info ] [MainThread]: 
[0m08:30:14.683775 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:30:14.684779 [debug] [MainThread]: Command `dbt test` failed at 08:30:14.684779 after 6.27 seconds
[0m08:30:14.685782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24D5C2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2690F1660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2690F2D40>]}
[0m08:30:14.685782 [debug] [MainThread]: Flushing usage events
[0m08:31:12.981122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263E802950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226413B6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226413B6290>]}


============================== 08:31:12.984099 | eefa3fdf-cdcc-405d-ab8c-21e024af463e ==============================
[0m08:31:12.984099 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:31:12.984099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:31:15.213525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eefa3fdf-cdcc-405d-ab8c-21e024af463e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263F0B5180>]}
[0m08:31:15.261180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eefa3fdf-cdcc-405d-ab8c-21e024af463e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264083B7C0>]}
[0m08:31:15.263191 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:31:15.311490 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:31:16.723621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:31:16.724624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:31:16.771887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eefa3fdf-cdcc-405d-ab8c-21e024af463e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002265A213EE0>]}
[0m08:31:16.961399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eefa3fdf-cdcc-405d-ab8c-21e024af463e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022659E012D0>]}
[0m08:31:16.962415 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:31:16.962415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eefa3fdf-cdcc-405d-ab8c-21e024af463e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022659D9A0E0>]}
[0m08:31:16.964521 [info ] [MainThread]: 
[0m08:31:16.965526 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:31:16.969539 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:31:16.983617 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:31:16.984618 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:31:16.984618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:17.631806 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.647 seconds
[0m08:31:17.633808 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:31:17.763883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eefa3fdf-cdcc-405d-ab8c-21e024af463e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022659E4ED10>]}
[0m08:31:17.763883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:31:17.764887 [info ] [MainThread]: 
[0m08:31:17.768327 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:17.768327 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:17.769332 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:17.769332 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:17.769332 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:31:17.770336 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:31:17.771340 [info ] [Thread-3 (]: 3 of 6 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:31:17.771340 [info ] [Thread-4 (]: 4 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:31:17.772352 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:31:17.772352 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:31:17.773727 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:31:17.773727 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:31:17.774737 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:17.774737 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:17.775743 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:17.775743 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:17.791127 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:31:17.795661 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:31:17.798673 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:31:17.801687 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:31:17.803703 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:17.819167 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:17.820344 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:31:17.821347 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:17.823355 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:31:17.823355 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:17.826390 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:31:17.827395 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:31:17.829403 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:31:17.830405 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:31:17.830405 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:31:17.831415 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:31:17.832431 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:31:17.833436 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:31:17.833436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:31:17.833436 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:31:17.834441 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:31:17.834441 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:31:17.836556 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:31:17.838570 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:31:18.421504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m08:31:18.428629 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:31:18.455321 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m08:31:18.456324 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:31:18.547173 [info ] [Thread-1 (]: 1 of 6 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.77s]
[0m08:31:18.548174 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:18.549248 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:18.549248 [info ] [Thread-1 (]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:31:18.550253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:31:18.551256 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:18.556434 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:31:18.557438 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:18.560451 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:31:18.561454 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:31:18.561454 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:31:18.562460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:31:18.581274 [info ] [Thread-2 (]: 2 of 6 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.81s]
[0m08:31:18.582288 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:18.583292 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:31:18.583292 [info ] [Thread-2 (]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m08:31:18.584297 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672, now test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493)
[0m08:31:18.584297 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:31:18.588319 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:31:18.589321 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:31:18.593356 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:31:18.594360 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:31:18.594360 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:31:18.595684 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:31:19.095378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m08:31:19.097390 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:31:19.123689 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m08:31:19.124691 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m08:31:19.216445 [info ] [Thread-1 (]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.67s]
[0m08:31:19.217450 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:19.243525 [info ] [Thread-2 (]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.66s]
[0m08:31:19.244528 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:31:19.333401 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.495 seconds
[0m08:31:19.335471 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:31:19.451585 [error] [Thread-4 (]: 4 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.68s]
[0m08:31:19.452682 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:20.624791 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.788 seconds
[0m08:31:20.627793 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:31:20.751066 [info ] [Thread-3 (]: 3 of 6 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 2.98s]
[0m08:31:20.752070 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:20.754079 [info ] [MainThread]: 
[0m08:31:20.754079 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:31:20.777437 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:31:20.783658 [debug] [MainThread]: Using snowflake connection "master"
[0m08:31:20.784658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:31:20.784658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:31:21.799999 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.015 seconds
[0m08:31:21.818017 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:31:21.823022 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:31:21.830805 [debug] [MainThread]: Using snowflake connection "master"
[0m08:31:21.831833 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7748215198516846'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8089218139648438'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6661927700042725'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6592273712158203'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.6778583526611328'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.977339267730713'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:31:22.402369 [debug] [MainThread]: SQL status: SUCCESS 6 in 0.569 seconds
[0m08:31:22.402369 [debug] [MainThread]: Using snowflake connection "master"
[0m08:31:22.403375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:31:22.689859 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.285 seconds
[0m08:31:22.690860 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.87s]
[0m08:31:22.692349 [info ] [MainThread]: 
[0m08:31:22.692349 [debug] [MainThread]: On master: Close
[0m08:31:22.814978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:31:22.815984 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:31:22.815984 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:31:22.816988 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:31:22.816988 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:31:22.816988 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:31:22.817992 [info ] [MainThread]: 
[0m08:31:22.817992 [info ] [MainThread]: Finished running 6 data tests, 1 project hook in 0 hours 0 minutes and 5.85 seconds (5.85s).
[0m08:31:22.820002 [debug] [MainThread]: Command end result
[0m08:31:22.858074 [info ] [MainThread]: 
[0m08:31:22.859077 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:31:22.859077 [info ] [MainThread]: 
[0m08:31:22.860130 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:31:22.861136 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:31:22.861136 [info ] [MainThread]: 
[0m08:31:22.862139 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:31:22.863375 [info ] [MainThread]: 
[0m08:31:22.863375 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:31:22.864632 [debug] [MainThread]: Command `dbt test` failed at 08:31:22.864632 after 9.96 seconds
[0m08:31:22.865633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263E802950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226407DAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022659E4EF20>]}
[0m08:31:22.865633 [debug] [MainThread]: Flushing usage events
[0m08:31:37.364367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E238BD28F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23B78A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23B78A230>]}


============================== 08:31:37.367550 | 1970e064-63f5-4a3d-9b65-19e85fb0065b ==============================
[0m08:31:37.367550 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:31:37.369042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:31:38.087766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1970e064-63f5-4a3d-9b65-19e85fb0065b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2540F7BB0>]}
[0m08:31:38.134818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1970e064-63f5-4a3d-9b65-19e85fb0065b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23AC0B760>]}
[0m08:31:38.135821 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:31:38.156982 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:31:38.385703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:31:38.385703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:31:38.433069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1970e064-63f5-4a3d-9b65-19e85fb0065b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2545E3FD0>]}
[0m08:31:38.592601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1970e064-63f5-4a3d-9b65-19e85fb0065b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2545E2AA0>]}
[0m08:31:38.593724 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:31:38.594728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1970e064-63f5-4a3d-9b65-19e85fb0065b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E254590D60>]}
[0m08:31:38.595731 [info ] [MainThread]: 
[0m08:31:38.596734 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:31:38.601752 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:31:38.614945 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:31:38.615949 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:31:38.615949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:39.280810 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.664 seconds
[0m08:31:39.281810 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:31:39.400870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1970e064-63f5-4a3d-9b65-19e85fb0065b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2545E03D0>]}
[0m08:31:39.402191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:31:39.402191 [info ] [MainThread]: 
[0m08:31:39.405307 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:39.406313 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:39.406313 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:39.406313 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:39.407324 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:31:39.407324 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:31:39.408343 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:31:39.409348 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:31:39.409348 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:31:39.410354 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:31:39.410354 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:31:39.411360 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:31:39.411360 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:39.412367 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:39.412367 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:39.413475 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:39.426564 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:31:39.430763 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:31:39.433793 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:31:39.437812 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:31:39.438853 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:39.438853 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:39.456352 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:31:39.459501 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:31:39.459501 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:39.459501 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:39.462525 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:31:39.463532 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:31:39.465545 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:31:39.466549 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:31:39.466549 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:31:39.467667 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:31:39.468674 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:31:39.468674 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:31:39.469699 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:31:39.469699 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:31:39.469699 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:31:39.471711 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:31:39.472715 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:31:39.473722 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:31:40.081593 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m08:31:40.088665 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:31:40.089698 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m08:31:40.092730 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:31:40.099518 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m08:31:40.100526 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:31:40.104368 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m08:31:40.106375 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:31:40.210097 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.80s]
[0m08:31:40.212110 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:40.212110 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:40.213117 [info ] [Thread-3 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:31:40.213117 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:31:40.214120 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:40.219204 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:31:40.221210 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:40.225232 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:31:40.222215 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.81s]
[0m08:31:40.227249 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:40.222215 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.81s]
[0m08:31:40.228254 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:31:40.227249 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.82s]
[0m08:31:40.229257 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:40.230258 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:31:40.230258 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:40.231747 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:31:40.736217 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m08:31:40.737217 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:31:40.869492 [info ] [Thread-3 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.66s]
[0m08:31:40.870556 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:40.871948 [info ] [MainThread]: 
[0m08:31:40.871948 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:31:40.893875 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:31:40.898891 [debug] [MainThread]: Using snowflake connection "master"
[0m08:31:40.899894 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:31:40.899894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:31:41.881103 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.980 seconds
[0m08:31:41.895564 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:31:41.899158 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:31:41.905180 [debug] [MainThread]: Using snowflake connection "master"
[0m08:31:41.905180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7997438907623291'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8098509311676025'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8128671646118164'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8179013729095459'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6563758850097656'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:31:42.390585 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.484 seconds
[0m08:31:42.390585 [debug] [MainThread]: Using snowflake connection "master"
[0m08:31:42.391586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:31:42.811214 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.420 seconds
[0m08:31:42.812315 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.91s]
[0m08:31:42.813319 [info ] [MainThread]: 
[0m08:31:42.814323 [debug] [MainThread]: On master: Close
[0m08:31:43.012824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:31:43.012824 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:31:43.013829 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:31:43.013829 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:31:43.015009 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:31:43.015009 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:31:43.015009 [info ] [MainThread]: 
[0m08:31:43.016298 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.42 seconds (4.42s).
[0m08:31:43.017311 [debug] [MainThread]: Command end result
[0m08:31:43.053743 [info ] [MainThread]: 
[0m08:31:43.054747 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:31:43.054747 [info ] [MainThread]: 
[0m08:31:43.055752 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:31:43.056949 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:31:43.056949 [info ] [MainThread]: 
[0m08:31:43.057955 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:31:43.057955 [info ] [MainThread]: 
[0m08:31:43.058960 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:31:43.059965 [debug] [MainThread]: Command `dbt test` failed at 08:31:43.059965 after 5.75 seconds
[0m08:31:43.060971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E238BD28F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E238F2F6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E254AB3A60>]}
[0m08:31:43.060971 [debug] [MainThread]: Flushing usage events
[0m08:35:30.629606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F96E5BE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F97117A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F97117A320>]}


============================== 08:35:30.632616 | 3a85214e-55ed-4edd-a9da-f5da0d02a5af ==============================
[0m08:35:30.632616 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:35:30.633620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:35:31.328692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a85214e-55ed-4edd-a9da-f5da0d02a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F96E847DC0>]}
[0m08:35:31.373246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a85214e-55ed-4edd-a9da-f5da0d02a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F970BAAE00>]}
[0m08:35:31.374371 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:35:31.395086 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:35:31.616898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:35:31.617901 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:35:31.663594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a85214e-55ed-4edd-a9da-f5da0d02a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90A053E50>]}
[0m08:35:31.827930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a85214e-55ed-4edd-a9da-f5da0d02a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90A053CA0>]}
[0m08:35:31.828951 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:35:31.828951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a85214e-55ed-4edd-a9da-f5da0d02a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90A000E80>]}
[0m08:35:31.830960 [info ] [MainThread]: 
[0m08:35:31.830960 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:35:31.836198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:35:31.851304 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:35:31.851304 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:35:31.851304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:32.492955 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.641 seconds
[0m08:35:32.494964 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:35:32.613925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a85214e-55ed-4edd-a9da-f5da0d02a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90A02CEB0>]}
[0m08:35:32.615023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:35:32.616022 [info ] [MainThread]: 
[0m08:35:32.618539 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:35:32.618539 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:35:32.618539 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:35:32.619546 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:35:32.619546 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:35:32.619546 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:35:32.620785 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:35:32.621898 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:35:32.620785 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:35:32.621898 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:35:32.622978 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:35:32.622978 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:35:32.623983 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:35:32.623983 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:35:32.624989 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:35:32.638224 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:35:32.639228 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:35:32.642254 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:35:32.646548 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:35:32.649570 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:35:32.650575 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:35:32.651579 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:35:32.651579 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:35:32.667846 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:35:32.669855 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:35:32.670870 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:35:32.672877 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:35:32.674971 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:35:32.676975 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:35:32.678360 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:35:32.678360 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:35:32.679363 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:35:32.679363 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:35:32.679363 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:35:32.680839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:35:32.680839 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:35:32.682049 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:35:32.682049 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:35:32.684066 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:35:32.686072 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:35:33.296431 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m08:35:33.297528 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m08:35:33.303554 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:35:33.305585 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:35:33.306592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m08:35:33.310614 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:35:33.423415 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.80s]
[0m08:35:33.424419 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:35:33.425430 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:35:33.425430 [info ] [Thread-3 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:35:33.426437 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:35:33.426437 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:35:33.432984 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:35:33.427941 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.81s]
[0m08:35:33.433990 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:35:33.434993 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:35:33.434993 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.81s]
[0m08:35:33.439079 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:35:33.439079 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:35:33.440083 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:35:33.441201 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:35:33.441201 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:35:33.990432 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m08:35:33.991446 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:35:34.112074 [info ] [Thread-3 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.69s]
[0m08:35:34.113080 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:35:34.246052 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.561 seconds
[0m08:35:34.248067 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:35:34.371708 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.75s]
[0m08:35:34.372722 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:35:34.373726 [info ] [MainThread]: 
[0m08:35:34.374729 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:35:34.396307 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:35:34.401412 [debug] [MainThread]: Using snowflake connection "master"
[0m08:35:34.402420 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:35:34.402420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:35:35.418040 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.015 seconds
[0m08:35:35.433054 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:35:35.437268 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:35:35.441663 [debug] [MainThread]: Using snowflake connection "master"
[0m08:35:35.442676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8004374504089355'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8060431480407715'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8130948543548584'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6856365203857422'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7477242946624756'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:35:35.892779 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.449 seconds
[0m08:35:35.892779 [debug] [MainThread]: Using snowflake connection "master"
[0m08:35:35.893792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:35:36.182199 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.288 seconds
[0m08:35:36.183205 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.74s]
[0m08:35:36.183205 [info ] [MainThread]: 
[0m08:35:36.184209 [debug] [MainThread]: On master: Close
[0m08:35:36.305386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:35:36.305386 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:35:36.306386 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:35:36.306386 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:35:36.307387 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:35:36.307387 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:35:36.307387 [info ] [MainThread]: 
[0m08:35:36.308416 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m08:35:36.309600 [debug] [MainThread]: Command end result
[0m08:35:36.346065 [info ] [MainThread]: 
[0m08:35:36.347486 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:35:36.347486 [info ] [MainThread]: 
[0m08:35:36.348491 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:35:36.349496 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:35:36.349496 [info ] [MainThread]: 
[0m08:35:36.350501 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:35:36.350501 [info ] [MainThread]: 
[0m08:35:36.351539 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:35:36.352543 [debug] [MainThread]: Command `dbt test` failed at 08:35:36.352543 after 5.78 seconds
[0m08:35:36.353550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F96E5BE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F97059ED40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90A04B700>]}
[0m08:35:36.353550 [debug] [MainThread]: Flushing usage events
[0m08:35:58.602890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A92C2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4ABE7A470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4ABE7A290>]}


============================== 08:35:58.605902 | 661659d8-48c4-4c91-bd94-3e412d3c8ec1 ==============================
[0m08:35:58.605902 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:35:58.606904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:35:59.306418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '661659d8-48c4-4c91-bd94-3e412d3c8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A9B77E20>]}
[0m08:35:59.349291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '661659d8-48c4-4c91-bd94-3e412d3c8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4AB2FB7C0>]}
[0m08:35:59.350295 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:35:59.370504 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:35:59.614286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:35:59.615289 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m08:35:59.758855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '661659d8-48c4-4c91-bd94-3e412d3c8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C4CDC130>]}
[0m08:35:59.878791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '661659d8-48c4-4c91-bd94-3e412d3c8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C4CDE4D0>]}
[0m08:35:59.878791 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:35:59.879795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '661659d8-48c4-4c91-bd94-3e412d3c8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C4C80970>]}
[0m08:35:59.881804 [info ] [MainThread]: 
[0m08:35:59.881804 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:35:59.886821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:35:59.900071 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:35:59.901074 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:35:59.901074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:00.593396 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.692 seconds
[0m08:36:00.595398 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:36:00.718285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '661659d8-48c4-4c91-bd94-3e412d3c8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C4CDC3D0>]}
[0m08:36:00.719296 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:36:00.719296 [info ] [MainThread]: 
[0m08:36:00.722323 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:36:00.723328 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:36:00.723328 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:36:00.724333 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:36:00.724333 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:36:00.725392 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:36:00.725392 [info ] [Thread-3 (]: 3 of 6 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:36:00.726431 [info ] [Thread-4 (]: 4 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:36:00.727563 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:36:00.728567 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:36:00.728567 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:36:00.729574 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:36:00.729574 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:36:00.730723 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:36:00.730723 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:36:00.731727 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:36:00.746080 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:36:00.750588 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:36:00.753986 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:36:00.757992 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:36:00.758993 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:36:00.760058 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:36:00.761073 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:36:00.776247 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:36:00.778517 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:36:00.779521 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:36:00.781621 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:36:00.782811 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:36:00.784832 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:36:00.786159 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:36:00.786159 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:36:00.787167 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:36:00.787167 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:36:00.788171 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:36:00.788171 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:36:00.789174 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:36:00.789174 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:36:00.791529 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:36:00.792563 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:36:00.793563 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:36:01.291898 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.500 seconds
[0m08:36:01.298948 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:36:01.421733 [info ] [Thread-3 (]: 3 of 6 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.69s]
[0m08:36:01.422745 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:36:01.423752 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:36:01.423752 [info ] [Thread-3 (]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:36:01.424764 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:36:01.424764 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:36:01.429900 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:36:01.430906 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:36:01.433912 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:36:01.434921 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:36:01.435926 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:36:01.435926 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:36:01.938643 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m08:36:01.940652 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:36:02.065293 [info ] [Thread-3 (]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.64s]
[0m08:36:02.066296 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:36:02.066296 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:36:02.067307 [info ] [Thread-3 (]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m08:36:02.068312 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321, now test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493)
[0m08:36:02.068312 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:36:02.072336 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:36:02.073344 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:36:02.076595 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:36:02.077600 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:36:02.077600 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:36:02.078606 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:36:02.309265 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.519 seconds
[0m08:36:02.311278 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:36:02.431773 [info ] [Thread-2 (]: 2 of 6 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.70s]
[0m08:36:02.432779 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:36:02.861018 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m08:36:02.862033 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m08:36:02.983360 [info ] [Thread-3 (]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.92s]
[0m08:36:02.984361 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:36:03.601452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.814 seconds
[0m08:36:03.603464 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:36:03.605477 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.812 seconds
[0m08:36:03.607488 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:36:03.728956 [error] [Thread-4 (]: 4 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 3.00s]
[0m08:36:03.729962 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:36:03.730966 [info ] [Thread-1 (]: 1 of 6 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 3.00s]
[0m08:36:03.731975 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:36:03.732978 [info ] [MainThread]: 
[0m08:36:03.732978 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:36:03.754391 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:36:03.760452 [debug] [MainThread]: Using snowflake connection "master"
[0m08:36:03.760452 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:36:03.761459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:36:04.797458 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.036 seconds
[0m08:36:04.812685 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:36:04.815751 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:36:04.823354 [debug] [MainThread]: Using snowflake connection "master"
[0m08:36:04.824358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6931660175323486'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.640528678894043'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7042100429534912'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9150476455688477'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.9993820190429688'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.0034029483795166'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:36:05.385815 [debug] [MainThread]: SQL status: SUCCESS 6 in 0.561 seconds
[0m08:36:05.385815 [debug] [MainThread]: Using snowflake connection "master"
[0m08:36:05.386816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Modified deactivation logic to only affect tests for current models
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          )
      select * from current_test_runs
    ) as current_tests
      where regexp_like(dqm.dq_dbt_test_results_central.model_refs, '.*' || current_tests.model_refs || '.*')
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:36:05.734329 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.347 seconds
[0m08:36:05.735335 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.92s]
[0m08:36:05.736341 [info ] [MainThread]: 
[0m08:36:05.736341 [debug] [MainThread]: On master: Close
[0m08:36:05.856391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:05.857398 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:36:05.857398 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:36:05.857398 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:36:05.858402 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:36:05.858402 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:36:05.859414 [info ] [MainThread]: 
[0m08:36:05.859414 [info ] [MainThread]: Finished running 6 data tests, 1 project hook in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m08:36:05.861421 [debug] [MainThread]: Command end result
[0m08:36:05.896355 [info ] [MainThread]: 
[0m08:36:05.897360 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:36:05.898367 [info ] [MainThread]: 
[0m08:36:05.898367 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:36:05.899371 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:36:05.900480 [info ] [MainThread]: 
[0m08:36:05.900480 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:36:05.901483 [info ] [MainThread]: 
[0m08:36:05.901483 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:36:05.903492 [debug] [MainThread]: Command `dbt test` failed at 08:36:05.903492 after 7.36 seconds
[0m08:36:05.903492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A92C2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4AB2FB7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A9B363B0>]}
[0m08:36:05.904495 [debug] [MainThread]: Flushing usage events
[0m08:37:03.574120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7D82EA980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DAEAE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DAEAE320>]}


============================== 08:37:03.576628 | 86b26879-bc54-471d-9c27-cff4122aa84a ==============================
[0m08:37:03.576628 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:37:03.577631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:37:04.273465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86b26879-bc54-471d-9c27-cff4122aa84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7D8577DC0>]}
[0m08:37:04.317333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86b26879-bc54-471d-9c27-cff4122aa84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DA8DEE00>]}
[0m08:37:04.318336 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:37:04.339826 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:37:04.571124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:37:04.572133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:37:04.618043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86b26879-bc54-471d-9c27-cff4122aa84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F3D03E50>]}
[0m08:37:04.777544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86b26879-bc54-471d-9c27-cff4122aa84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F3D03CA0>]}
[0m08:37:04.777544 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:37:04.778551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b26879-bc54-471d-9c27-cff4122aa84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F3CACE80>]}
[0m08:37:04.780557 [info ] [MainThread]: 
[0m08:37:04.780557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:37:04.785579 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:37:04.798769 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:37:04.799772 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:37:04.799772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:05.429767 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.630 seconds
[0m08:37:05.431781 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:37:05.550765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b26879-bc54-471d-9c27-cff4122aa84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F3CE0EB0>]}
[0m08:37:05.550765 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:37:05.551909 [info ] [MainThread]: 
[0m08:37:05.554942 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:37:05.554942 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:37:05.554942 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:37:05.555948 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:37:05.555948 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:37:05.556953 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:37:05.556953 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:37:05.557963 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:37:05.557963 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:37:05.558968 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:37:05.559974 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:37:05.559974 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:37:05.560980 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:37:05.560980 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:37:05.560980 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:37:05.575015 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:37:05.575015 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:37:05.579397 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:37:05.582408 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:37:05.585925 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:37:05.586934 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:37:05.586934 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:37:05.587941 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:37:05.603211 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:37:05.604214 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:37:05.606222 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:37:05.609247 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:37:05.612335 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:37:05.613340 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:37:05.614345 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:37:05.614345 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:37:05.615350 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:37:05.615350 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:37:05.616380 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:37:05.616380 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:37:05.617384 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:37:05.617384 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:37:05.618389 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:37:05.620401 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:37:05.621405 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:37:06.191538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m08:37:06.192548 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m08:37:06.198659 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:37:06.200690 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:37:06.211505 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m08:37:06.213512 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:37:06.320901 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.76s]
[0m08:37:06.321905 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:37:06.322935 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:37:06.322935 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:37:06.323995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:37:06.323995 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:37:06.330023 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:37:06.331049 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:37:06.334067 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:37:06.332056 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.77s]
[0m08:37:06.336077 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:37:06.337083 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:37:06.337083 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:37:06.336077 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.78s]
[0m08:37:06.338087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:06.338087 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:37:06.835047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m08:37:06.837060 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:37:06.962362 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.64s]
[0m08:37:06.963367 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:37:07.306236 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.686 seconds
[0m08:37:07.307243 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:37:07.433299 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 1.87s]
[0m08:37:07.434304 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:37:07.435327 [info ] [MainThread]: 
[0m08:37:07.436331 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:37:07.458454 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:37:07.464559 [debug] [MainThread]: Using snowflake connection "master"
[0m08:37:07.464559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:37:07.465570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:37:08.449527 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.984 seconds
[0m08:37:08.463752 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:37:08.467767 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:37:08.474009 [debug] [MainThread]: Using snowflake connection "master"
[0m08:37:08.474009 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7629387378692627'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7720820903778076'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.777108907699585'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6383664608001709'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8743312358856201'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:37:08.965649 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.490 seconds
[0m08:37:08.965649 [debug] [MainThread]: Using snowflake connection "master"
[0m08:37:08.966652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Modified deactivation logic to only affect tests for current models
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          )
      select * from current_test_runs
    ) as current_tests
      where regexp_like(dqm.dq_dbt_test_results_central.model_refs, '.*' || current_tests.model_refs || '.*')
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:37:09.405521 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.439 seconds
[0m08:37:09.406530 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.94s]
[0m08:37:09.407545 [info ] [MainThread]: 
[0m08:37:09.408627 [debug] [MainThread]: On master: Close
[0m08:37:09.526230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:09.527233 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:37:09.527233 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:37:09.527233 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:37:09.528237 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:37:09.528237 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:37:09.528237 [info ] [MainThread]: 
[0m08:37:09.529240 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m08:37:09.531248 [debug] [MainThread]: Command end result
[0m08:37:09.566833 [info ] [MainThread]: 
[0m08:37:09.567844 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:37:09.568847 [info ] [MainThread]: 
[0m08:37:09.569850 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:37:09.569850 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:37:09.571007 [info ] [MainThread]: 
[0m08:37:09.571007 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:37:09.572011 [info ] [MainThread]: 
[0m08:37:09.572011 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:37:09.573015 [debug] [MainThread]: Command `dbt test` failed at 08:37:09.573015 after 6.06 seconds
[0m08:37:09.574018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7D82EA980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F41204F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F4059990>]}
[0m08:37:09.574018 [debug] [MainThread]: Flushing usage events
[0m08:38:42.048094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7477E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7730A470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7730A290>]}


============================== 08:38:42.050616 | fbc8248e-951f-487a-9c6e-95429ac06396 ==============================
[0m08:38:42.050616 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:38:42.051618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:38:42.870965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbc8248e-951f-487a-9c6e-95429ac06396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7502BE20>]}
[0m08:38:42.916881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbc8248e-951f-487a-9c6e-95429ac06396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7678B7C0>]}
[0m08:38:42.918882 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:38:42.939814 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:38:43.191565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:38:43.192568 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m08:38:43.349459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbc8248e-951f-487a-9c6e-95429ac06396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0FDFD6F0>]}
[0m08:38:43.475055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbc8248e-951f-487a-9c6e-95429ac06396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0FE8FA60>]}
[0m08:38:43.475055 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:38:43.476060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc8248e-951f-487a-9c6e-95429ac06396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F102008E0>]}
[0m08:38:43.478173 [info ] [MainThread]: 
[0m08:38:43.479413 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:38:43.483436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:38:43.498919 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:38:43.498919 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:38:43.499928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:44.144909 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.645 seconds
[0m08:38:44.146911 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:38:44.275571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc8248e-951f-487a-9c6e-95429ac06396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0FE8FC70>]}
[0m08:38:44.275571 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:38:44.276574 [info ] [MainThread]: 
[0m08:38:44.279713 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:44.279713 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:44.279713 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:44.280752 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:44.280752 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:38:44.281758 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:38:44.281758 [info ] [Thread-3 (]: 3 of 6 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:38:44.283768 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:38:44.282763 [info ] [Thread-4 (]: 4 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:38:44.283768 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:38:44.284777 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:38:44.284777 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:44.285800 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:38:44.285800 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:44.286804 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:44.300257 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:38:44.301262 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:44.304276 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:38:44.308467 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:38:44.312497 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:38:44.313504 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:44.313504 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:44.329801 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:38:44.329801 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:44.332817 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:38:44.332817 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:44.335937 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:38:44.335937 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:38:44.338982 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:38:44.338982 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:38:44.339988 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:38:44.340993 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:38:44.340993 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:38:44.341998 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:38:44.343002 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:38:44.343002 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:38:44.344007 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:38:44.345012 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:38:44.346017 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:38:44.348033 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:38:44.932463 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m08:38:44.939658 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:38:44.966096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m08:38:44.967159 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:38:45.063851 [error] [Thread-4 (]: 4 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m08:38:45.064855 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:45.065859 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:45.065859 [info ] [Thread-4 (]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:38:45.066861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:38:45.066861 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:45.073366 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:38:45.074374 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:45.077532 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:38:45.078538 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:38:45.078538 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:38:45.079544 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:38:45.084448 [info ] [Thread-1 (]: 1 of 6 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.80s]
[0m08:38:45.085707 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:45.085707 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:38:45.086712 [info ] [Thread-1 (]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m08:38:45.086712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493)
[0m08:38:45.087725 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:38:45.090800 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:38:45.091808 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:38:45.094900 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:38:45.095905 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:38:45.095905 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:38:45.096911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:45.687991 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m08:38:45.690180 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:38:45.726014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m08:38:45.728528 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m08:38:45.832338 [info ] [Thread-4 (]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.77s]
[0m08:38:45.833560 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:45.853445 [info ] [Thread-1 (]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.77s]
[0m08:38:45.854450 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:38:45.938900 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.592 seconds
[0m08:38:45.939907 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:38:45.964629 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.621 seconds
[0m08:38:45.966804 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:38:46.059689 [info ] [Thread-3 (]: 3 of 6 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 1.77s]
[0m08:38:46.060696 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:46.093900 [info ] [Thread-2 (]: 2 of 6 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.81s]
[0m08:38:46.095069 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:46.096078 [info ] [MainThread]: 
[0m08:38:46.097083 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:38:46.120184 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:38:46.125539 [debug] [MainThread]: Using snowflake connection "master"
[0m08:38:46.126548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:38:46.126548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:38:47.114741 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.988 seconds
[0m08:38:47.130372 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:38:47.134532 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:38:47.140553 [debug] [MainThread]: Using snowflake connection "master"
[0m08:38:47.141701 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7770466804504395'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8016848564147949'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7654762268066406'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7667331695556641'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7749125957489014'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8101325035095215'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:38:47.550992 [debug] [MainThread]: SQL status: SUCCESS 6 in 0.408 seconds
[0m08:38:47.551995 [debug] [MainThread]: Using snowflake connection "master"
[0m08:38:47.551995 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_second_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          )
      select distinct regexp_split_to_table(model_refs, ',') as model_name 
      from current_models 
      where model_refs != ''
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:38:47.744352 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba829c-3201-72e6-000b-f6920001d116
[0m08:38:47.744352 [debug] [MainThread]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function REGEXP_SPLIT_TO_TABLE
[0m08:38:47.745353 [info ] [MainThread]: Database error while running on-run-end
[0m08:38:47.746357 [debug] [MainThread]: On master: Close
[0m08:38:47.864708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:47.865709 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:38:47.865709 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:38:47.865709 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:38:47.866710 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:38:47.866710 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:38:47.868038 [info ] [MainThread]: 
[0m08:38:47.868542 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m08:38:47.869549 [debug] [MainThread]: Command end result
[0m08:38:47.907729 [info ] [MainThread]: 
[0m08:38:47.908731 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:38:47.909736 [info ] [MainThread]: 
[0m08:38:47.910743 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:38:47.911747 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:38:47.912761 [info ] [MainThread]: 
[0m08:38:47.913771 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:38:47.913771 [info ] [MainThread]: 
[0m08:38:47.914891 [error] [MainThread]:   on-run-end failed, error:
 002140 (42601): SQL compilation error:
Unknown function REGEXP_SPLIT_TO_TABLE
[0m08:38:47.914891 [info ] [MainThread]: 
[0m08:38:47.915897 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m08:38:47.916905 [debug] [MainThread]: Command `dbt test` failed at 08:38:47.916905 after 5.93 seconds
[0m08:38:47.916905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7477E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0FE68E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0FE8CAF0>]}
[0m08:38:47.917908 [debug] [MainThread]: Flushing usage events
[0m08:38:55.385705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA6E22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA99DA4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA99DA2C0>]}


============================== 08:38:55.389992 | 5003d24c-81ca-4626-a1f5-f451d3aa4d44 ==============================
[0m08:38:55.389992 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:38:55.391010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:38:56.148585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5003d24c-81ca-4626-a1f5-f451d3aa4d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA70A7A90>]}
[0m08:38:56.194554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5003d24c-81ca-4626-a1f5-f451d3aa4d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC22E97E0>]}
[0m08:38:56.195560 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:38:56.218261 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:38:56.460933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:38:56.461974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:38:56.509889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5003d24c-81ca-4626-a1f5-f451d3aa4d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC2833E50>]}
[0m08:38:56.673221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5003d24c-81ca-4626-a1f5-f451d3aa4d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC2312350>]}
[0m08:38:56.674227 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:38:56.675231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5003d24c-81ca-4626-a1f5-f451d3aa4d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC27DD360>]}
[0m08:38:56.676235 [info ] [MainThread]: 
[0m08:38:56.677239 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:38:56.681276 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:38:56.695689 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:38:56.696695 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:38:56.696695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:57.298196 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.602 seconds
[0m08:38:57.300209 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:38:57.429303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5003d24c-81ca-4626-a1f5-f451d3aa4d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC23101F0>]}
[0m08:38:57.430321 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:38:57.430321 [info ] [MainThread]: 
[0m08:38:57.433338 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:57.434379 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:57.434379 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:57.434379 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:57.435384 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:38:57.435384 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:38:57.436389 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:38:57.436389 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:38:57.437395 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:38:57.437395 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:38:57.438399 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:38:57.439402 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:38:57.439402 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:57.439402 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:57.440423 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:57.440423 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:57.455363 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:38:57.458375 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:38:57.461808 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:38:57.465831 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:38:57.466837 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:57.467927 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:57.467927 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:57.483131 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:38:57.486149 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:38:57.486149 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:57.489163 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:38:57.492398 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:38:57.493402 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:38:57.493402 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:38:57.494750 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:38:57.495756 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:38:57.495756 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:38:57.496761 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:38:57.496761 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:38:57.497764 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:38:57.497764 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:38:57.498769 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:38:57.498769 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:38:57.500781 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:38:58.085353 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m08:38:58.092360 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:38:58.093687 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m08:38:58.095728 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:38:58.213996 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.78s]
[0m08:38:58.216010 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:58.216010 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:58.216010 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.78s]
[0m08:38:58.217014 [info ] [Thread-2 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:38:58.218117 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:58.218117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:38:58.219122 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:58.224143 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:38:58.225150 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:58.227166 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:38:58.228170 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:38:58.229175 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:38:58.229175 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:58.734497 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m08:38:58.736503 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:38:58.855923 [info ] [Thread-2 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.64s]
[0m08:38:58.857942 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:59.005073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.508 seconds
[0m08:38:59.007088 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:38:59.126926 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 1.69s]
[0m08:38:59.128043 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:39:00.260988 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.761 seconds
[0m08:39:00.263008 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:39:00.385333 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.95s]
[0m08:39:00.386337 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:39:00.388459 [info ] [MainThread]: 
[0m08:39:00.388459 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:39:00.416201 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:39:00.423648 [debug] [MainThread]: Using snowflake connection "master"
[0m08:39:00.424651 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:39:00.424651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:39:01.454472 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.029 seconds
[0m08:39:01.469573 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:39:01.473615 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:39:01.478745 [debug] [MainThread]: Using snowflake connection "master"
[0m08:39:01.479750 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7766005992889404'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.777611255645752'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6378059387207031'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.689530611038208'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.946934700012207'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:39:02.024087 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.544 seconds
[0m08:39:02.025118 [debug] [MainThread]: Using snowflake connection "master"
[0m08:39:02.026124 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          )
      select distinct regexp_split_to_table(model_refs, ',') as model_name 
      from current_models 
      where model_refs != ''
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:39:02.120083 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba829d-3201-72f1-000b-f6920001c1b2
[0m08:39:02.120083 [debug] [MainThread]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function REGEXP_SPLIT_TO_TABLE
[0m08:39:02.121583 [info ] [MainThread]: Database error while running on-run-end
[0m08:39:02.121583 [debug] [MainThread]: On master: Close
[0m08:39:02.243778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:02.244779 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:39:02.244779 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:39:02.244779 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:39:02.244779 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:39:02.246205 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:39:02.246205 [info ] [MainThread]: 
[0m08:39:02.247491 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m08:39:02.248495 [debug] [MainThread]: Command end result
[0m08:39:02.285361 [info ] [MainThread]: 
[0m08:39:02.285361 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:39:02.286367 [info ] [MainThread]: 
[0m08:39:02.287371 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:39:02.287371 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:39:02.288374 [info ] [MainThread]: 
[0m08:39:02.289375 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:39:02.289375 [info ] [MainThread]: 
[0m08:39:02.290376 [error] [MainThread]:   on-run-end failed, error:
 002140 (42601): SQL compilation error:
Unknown function REGEXP_SPLIT_TO_TABLE
[0m08:39:02.290376 [info ] [MainThread]: 
[0m08:39:02.291377 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m08:39:02.291377 [debug] [MainThread]: Command `dbt test` failed at 08:39:02.291377 after 6.96 seconds
[0m08:39:02.292880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA6E22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA8DFF490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC2CC68F0>]}
[0m08:39:02.293881 [debug] [MainThread]: Flushing usage events
[0m08:39:19.736613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D771128F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D79CD25C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D79CD23E0>]}


============================== 08:39:19.739634 | 4825d648-622f-48d2-8a2c-be2bed630fcc ==============================
[0m08:39:19.739634 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:39:19.740637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_2', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:39:20.461292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4825d648-622f-48d2-8a2c-be2bed630fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D12662D40>]}
[0m08:39:20.504897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4825d648-622f-48d2-8a2c-be2bed630fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7914B760>]}
[0m08:39:20.506904 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:39:20.527099 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:39:20.753790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:39:20.753790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:39:20.802660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4825d648-622f-48d2-8a2c-be2bed630fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D12B78A60>]}
[0m08:39:20.973994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4825d648-622f-48d2-8a2c-be2bed630fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D12B7ADA0>]}
[0m08:39:20.975092 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:39:20.977101 [info ] [MainThread]: 
[0m08:39:20.978106 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:39:20.979110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m08:39:20.991516 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m08:39:20.992521 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m08:39:20.992521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:21.612066 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.619 seconds
[0m08:39:21.614080 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m08:39:21.734904 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:39:21.742431 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:39:21.743436 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:39:21.743436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:22.275235 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.531 seconds
[0m08:39:22.276239 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:39:22.399200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4825d648-622f-48d2-8a2c-be2bed630fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D12B6AB90>]}
[0m08:39:22.399200 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:39:22.400204 [info ] [MainThread]: 
[0m08:39:22.402211 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m08:39:22.403240 [info ] [Thread-1 (]: 1 of 2 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m08:39:22.404247 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m08:39:22.404247 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m08:39:22.411299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m08:39:22.412467 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m08:39:22.435887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m08:39:22.437911 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m08:39:22.437911 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m08:39:22.438919 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:39:23.523824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.085 seconds
[0m08:39:23.540956 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m08:39:23.655647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4825d648-622f-48d2-8a2c-be2bed630fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D790EC820>]}
[0m08:39:23.655647 [info ] [Thread-1 (]: 1 of 2 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.25s]
[0m08:39:23.656719 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m08:39:23.657724 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:39:23.658729 [info ] [Thread-3 (]: 2 of 2 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m08:39:23.658729 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m08:39:23.659757 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:39:23.667818 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:39:23.668976 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:39:23.682189 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:39:23.683193 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:39:23.684289 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:39:23.684289 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:39:24.335278 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m08:39:24.338290 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m08:39:24.454375 [info ] [Thread-3 (]: 2 of 2 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.80s]
[0m08:39:24.455380 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:39:24.456385 [info ] [MainThread]: 
[0m08:39:24.457391 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:39:24.480721 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:39:24.485847 [debug] [MainThread]: Using snowflake connection "master"
[0m08:39:24.486852 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:39:24.486852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:39:25.500069 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.013 seconds
[0m08:39:25.513128 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:39:25.517390 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:39:25.519398 [debug] [MainThread]: Using snowflake connection "master"
[0m08:39:25.520401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7956461906433105'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:39:25.926604 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.405 seconds
[0m08:39:25.926604 [debug] [MainThread]: Using snowflake connection "master"
[0m08:39:25.927605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          )
      select distinct regexp_split_to_table(model_refs, ',') as model_name 
      from current_models 
      where model_refs != ''
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:39:26.019700 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba829d-3201-72d0-000b-f692000175e2
[0m08:39:26.020701 [debug] [MainThread]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function REGEXP_SPLIT_TO_TABLE
[0m08:39:26.020701 [info ] [MainThread]: Database error while running on-run-end
[0m08:39:26.021702 [debug] [MainThread]: On master: Close
[0m08:39:26.140130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:26.141136 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m08:39:26.141136 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:39:26.142147 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m08:39:26.142147 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:39:26.143150 [info ] [MainThread]: 
[0m08:39:26.143150 [info ] [MainThread]: Finished running 1 table model, 1 test in 0 hours 0 minutes and 5.17 seconds (5.17s).
[0m08:39:26.144152 [debug] [MainThread]: Command end result
[0m08:39:26.180108 [info ] [MainThread]: 
[0m08:39:26.181111 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:39:26.182116 [info ] [MainThread]: 
[0m08:39:26.183121 [error] [MainThread]:   on-run-end failed, error:
 002140 (42601): SQL compilation error:
Unknown function REGEXP_SPLIT_TO_TABLE
[0m08:39:26.183121 [info ] [MainThread]: 
[0m08:39:26.184125 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:39:26.185128 [debug] [MainThread]: Command `dbt build` failed at 08:39:26.185128 after 6.51 seconds
[0m08:39:26.186131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D771128F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7914B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D12F27F70>]}
[0m08:39:26.186131 [debug] [MainThread]: Flushing usage events
[0m08:44:07.210835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D6C6E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D982E620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D982E440>]}


============================== 08:44:07.213909 | 4ac4bc92-e200-44a4-88ff-e5f56ed82d2e ==============================
[0m08:44:07.213909 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:44:07.214912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_2', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:44:07.931634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ac4bc92-e200-44a4-88ff-e5f56ed82d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D6EF7DC0>]}
[0m08:44:07.976053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ac4bc92-e200-44a4-88ff-e5f56ed82d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F21615D0>]}
[0m08:44:07.978065 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:44:07.999288 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:44:08.237690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:44:08.238695 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m08:44:08.388910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ac4bc92-e200-44a4-88ff-e5f56ed82d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F2690130>]}
[0m08:44:08.511149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ac4bc92-e200-44a4-88ff-e5f56ed82d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F22C7D90>]}
[0m08:44:08.512154 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:44:08.513158 [info ] [MainThread]: 
[0m08:44:08.514161 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:44:08.515164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m08:44:08.527308 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m08:44:08.528311 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m08:44:08.528311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:09.191577 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.664 seconds
[0m08:44:09.193621 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m08:44:09.317537 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:44:09.325078 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:44:09.326077 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:44:09.326077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:09.873234 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.547 seconds
[0m08:44:09.875248 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:44:09.998550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ac4bc92-e200-44a4-88ff-e5f56ed82d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F26AA920>]}
[0m08:44:09.999556 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:44:09.999556 [info ] [MainThread]: 
[0m08:44:10.001586 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m08:44:10.002903 [info ] [Thread-1 (]: 1 of 2 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m08:44:10.003908 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m08:44:10.003908 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m08:44:10.012103 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m08:44:10.013110 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m08:44:10.034829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m08:44:10.035835 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m08:44:10.036839 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m08:44:10.036839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:44:11.042236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.005 seconds
[0m08:44:11.058441 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m08:44:11.185754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac4bc92-e200-44a4-88ff-e5f56ed82d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F210FBB0>]}
[0m08:44:11.185754 [info ] [Thread-1 (]: 1 of 2 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.18s]
[0m08:44:11.186757 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m08:44:11.187767 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:11.188774 [info ] [Thread-3 (]: 2 of 2 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m08:44:11.188774 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m08:44:11.189781 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:11.197808 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:44:11.198811 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:11.211943 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:44:11.212947 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:44:11.212947 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:44:11.213951 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:44:11.845580 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m08:44:11.848588 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m08:44:11.978846 [info ] [Thread-3 (]: 2 of 2 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.79s]
[0m08:44:11.979963 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:11.981215 [info ] [MainThread]: 
[0m08:44:11.981215 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:44:12.004716 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:44:12.010739 [debug] [MainThread]: Using snowflake connection "master"
[0m08:44:12.010739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:44:12.011742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:44:12.981023 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.969 seconds
[0m08:44:12.994233 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:44:12.998315 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:44:13.001326 [debug] [MainThread]: Using snowflake connection "master"
[0m08:44:13.001326 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7900722026824951'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:44:13.454959 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.452 seconds
[0m08:44:13.454959 [debug] [MainThread]: Using snowflake connection "master"
[0m08:44:13.455963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:44:14.093024 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.637 seconds
[0m08:44:14.094042 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.10s]
[0m08:44:14.095052 [info ] [MainThread]: 
[0m08:44:14.095052 [debug] [MainThread]: On master: Close
[0m08:44:14.209916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:14.210917 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m08:44:14.210917 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:44:14.210917 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m08:44:14.210917 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:44:14.212411 [info ] [MainThread]: 
[0m08:44:14.212411 [info ] [MainThread]: Finished running 1 table model, 1 test, 1 project hook in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m08:44:14.213672 [debug] [MainThread]: Command end result
[0m08:44:14.249171 [info ] [MainThread]: 
[0m08:44:14.250175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:44:14.251178 [info ] [MainThread]: 
[0m08:44:14.251178 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:44:14.253241 [debug] [MainThread]: Command `dbt build` succeeded at 08:44:14.252237 after 7.10 seconds
[0m08:44:14.253241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D6C6E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F21C3B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F210E3B0>]}
[0m08:44:14.254246 [debug] [MainThread]: Flushing usage events
[0m08:44:29.660850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC6CDE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC98DA650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC98DA470>]}


============================== 08:44:29.663861 | 1177147d-34c8-4022-9983-c156ebd31ddd ==============================
[0m08:44:29.663861 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:44:29.664864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_2', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:44:30.367244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1177147d-34c8-4022-9983-c156ebd31ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE21AE230>]}
[0m08:44:30.411525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1177147d-34c8-4022-9983-c156ebd31ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE21AF3A0>]}
[0m08:44:30.413535 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:44:30.433919 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:44:30.667634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:44:30.668638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:44:30.714572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1177147d-34c8-4022-9983-c156ebd31ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE26E8B20>]}
[0m08:44:30.881808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1177147d-34c8-4022-9983-c156ebd31ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE26CDC30>]}
[0m08:44:30.881808 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:44:30.883822 [info ] [MainThread]: 
[0m08:44:30.885130 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:44:30.886134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m08:44:30.898629 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m08:44:30.899634 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m08:44:30.899634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:31.544087 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.645 seconds
[0m08:44:31.546089 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m08:44:31.696079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:44:31.704126 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:44:31.704126 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:44:31.704126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:32.274074 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.570 seconds
[0m08:44:32.276081 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:44:32.399848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1177147d-34c8-4022-9983-c156ebd31ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE26CC1F0>]}
[0m08:44:32.400861 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:44:32.401865 [info ] [MainThread]: 
[0m08:44:32.403872 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m08:44:32.404938 [info ] [Thread-1 (]: 1 of 2 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m08:44:32.406096 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m08:44:32.406096 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m08:44:32.413132 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m08:44:32.414240 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m08:44:32.436623 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m08:44:32.437631 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m08:44:32.438636 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m08:44:32.438636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:44:33.548287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.109 seconds
[0m08:44:33.565560 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m08:44:33.685473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1177147d-34c8-4022-9983-c156ebd31ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE217FBE0>]}
[0m08:44:33.686476 [info ] [Thread-1 (]: 1 of 2 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.28s]
[0m08:44:33.687489 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m08:44:33.688496 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:33.688496 [info ] [Thread-3 (]: 2 of 2 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m08:44:33.689499 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m08:44:33.690502 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:33.699094 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:44:33.700097 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:33.714426 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:44:33.715430 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:44:33.716433 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:44:33.716433 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:44:34.308273 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m08:44:34.312413 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m08:44:34.439422 [info ] [Thread-3 (]: 2 of 2 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.75s]
[0m08:44:34.440427 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:34.441432 [info ] [MainThread]: 
[0m08:44:34.441432 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:44:34.465611 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:44:34.471861 [debug] [MainThread]: Using snowflake connection "master"
[0m08:44:34.471861 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:44:34.472868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:44:35.560935 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.088 seconds
[0m08:44:35.574127 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:44:35.578221 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:44:35.581239 [debug] [MainThread]: Using snowflake connection "master"
[0m08:44:35.581239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7489063739776611'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:44:36.023196 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.442 seconds
[0m08:44:36.024554 [debug] [MainThread]: Using snowflake connection "master"
[0m08:44:36.025557 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:44:36.361429 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.336 seconds
[0m08:44:36.362432 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.78s]
[0m08:44:36.363475 [info ] [MainThread]: 
[0m08:44:36.364479 [debug] [MainThread]: On master: Close
[0m08:44:36.490287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:36.491293 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m08:44:36.491293 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:44:36.492307 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m08:44:36.492307 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:44:36.492307 [info ] [MainThread]: 
[0m08:44:36.493310 [info ] [MainThread]: Finished running 1 table model, 1 test, 1 project hook in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m08:44:36.495488 [debug] [MainThread]: Command end result
[0m08:44:36.538266 [info ] [MainThread]: 
[0m08:44:36.538266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:44:36.539705 [info ] [MainThread]: 
[0m08:44:36.540709 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:44:36.542782 [debug] [MainThread]: Command `dbt build` succeeded at 08:44:36.542782 after 6.94 seconds
[0m08:44:36.542782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC6CDE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE236A080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE2AABFD0>]}
[0m08:44:36.543787 [debug] [MainThread]: Flushing usage events
[0m08:45:18.833864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002103652E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210390EE620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210390EE440>]}


============================== 08:45:18.836894 | 217ea278-dd92-4051-b6ef-aaedd9eaa667 ==============================
[0m08:45:18.836894 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:45:18.837898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --select tag:example_2', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:45:19.566228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '217ea278-dd92-4051-b6ef-aaedd9eaa667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210367B7DC0>]}
[0m08:45:19.611505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '217ea278-dd92-4051-b6ef-aaedd9eaa667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021051A215D0>]}
[0m08:45:19.612508 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:45:19.632800 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:45:19.872047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:45:19.873052 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m08:45:20.181575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '217ea278-dd92-4051-b6ef-aaedd9eaa667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021052180130>]}
[0m08:45:20.303777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '217ea278-dd92-4051-b6ef-aaedd9eaa667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021051B59F60>]}
[0m08:45:20.303777 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m08:45:20.306144 [info ] [MainThread]: 
[0m08:45:20.306144 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:45:20.308161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m08:45:20.318265 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m08:45:20.319267 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m08:45:20.319267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:20.951289 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.631 seconds
[0m08:45:20.952290 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m08:45:21.081017 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:45:21.088173 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:45:21.089179 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:45:21.089179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:21.677303 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.588 seconds
[0m08:45:21.678309 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:45:21.807935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '217ea278-dd92-4051-b6ef-aaedd9eaa667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021051EF0910>]}
[0m08:45:21.807935 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:21.808939 [info ] [MainThread]: 
[0m08:45:21.812056 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m08:45:21.812056 [info ] [Thread-1 (]: 1 of 1 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m08:45:21.813058 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m08:45:21.814152 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m08:45:21.821180 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m08:45:21.821180 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m08:45:21.843749 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m08:45:21.844754 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m08:45:21.845759 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m08:45:21.845759 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:45:22.783658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.937 seconds
[0m08:45:22.800782 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m08:45:22.921246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '217ea278-dd92-4051-b6ef-aaedd9eaa667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210519CFBB0>]}
[0m08:45:22.922253 [info ] [Thread-1 (]: 1 of 1 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.11s]
[0m08:45:22.923259 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m08:45:22.924261 [info ] [MainThread]: 
[0m08:45:22.924261 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:45:22.944605 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:45:22.947639 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:45:22.948646 [debug] [MainThread]: Using snowflake connection "master"
[0m08:45:22.949652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select 1
[0m08:45:22.949652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:23.441540 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.492 seconds
[0m08:45:23.442546 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.49s]
[0m08:45:23.443546 [info ] [MainThread]: 
[0m08:45:23.444781 [debug] [MainThread]: On master: Close
[0m08:45:23.574664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:23.575665 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m08:45:23.575665 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:45:23.575665 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m08:45:23.576666 [info ] [MainThread]: 
[0m08:45:23.576666 [info ] [MainThread]: Finished running 1 table model, 1 project hook in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m08:45:23.577895 [debug] [MainThread]: Command end result
[0m08:45:23.614787 [info ] [MainThread]: 
[0m08:45:23.615792 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:23.616791 [info ] [MainThread]: 
[0m08:45:23.616791 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:23.617856 [debug] [MainThread]: Command `dbt build` succeeded at 08:45:23.617856 after 4.84 seconds
[0m08:45:23.618860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002103652E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021051F426B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021051A63730>]}
[0m08:45:23.618860 [debug] [MainThread]: Flushing usage events
[0m08:45:38.649467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023717ECE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371AA9A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371AA9A320>]}


============================== 08:45:38.652487 | 72b64932-361f-4fde-8c43-7f18a57eadce ==============================
[0m08:45:38.652487 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:45:38.653490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_2', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:45:39.386386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72b64932-361f-4fde-8c43-7f18a57eadce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023718157DC0>]}
[0m08:45:39.433513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72b64932-361f-4fde-8c43-7f18a57eadce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371A4B6E00>]}
[0m08:45:39.434514 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:45:39.455878 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:45:39.692930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:39.692930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:39.743663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72b64932-361f-4fde-8c43-7f18a57eadce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237338F3DC0>]}
[0m08:45:39.926075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72b64932-361f-4fde-8c43-7f18a57eadce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237338F0EE0>]}
[0m08:45:39.927087 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m08:45:39.928091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72b64932-361f-4fde-8c43-7f18a57eadce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373389CB80>]}
[0m08:45:39.929289 [info ] [MainThread]: 
[0m08:45:39.930295 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:39.932305 [debug] [MainThread]: Command end result
[0m08:45:39.968792 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:39.967785 after 1.38 seconds
[0m08:45:39.968792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023717ECE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237338EA710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237338EBE50>]}
[0m08:45:39.969798 [debug] [MainThread]: Flushing usage events
[0m08:46:01.960825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A624DE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A6508E5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A6508E3E0>]}


============================== 08:46:01.962840 | 2735cd6d-7ae9-442e-9c35-1a198ad64a04 ==============================
[0m08:46:01.962840 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:46:01.964095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:46:02.672304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2735cd6d-7ae9-442e-9c35-1a198ad64a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A62767EB0>]}
[0m08:46:02.716380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2735cd6d-7ae9-442e-9c35-1a198ad64a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A61FD34C0>]}
[0m08:46:02.717383 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:46:02.737781 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:46:02.969578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:46:02.970585 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m08:46:03.336870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2735cd6d-7ae9-442e-9c35-1a198ad64a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A7E1EC130>]}
[0m08:46:03.458581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2735cd6d-7ae9-442e-9c35-1a198ad64a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A7E1EEC50>]}
[0m08:46:03.459588 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m08:46:03.460592 [info ] [MainThread]: 
[0m08:46:03.461596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:46:03.462616 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m08:46:03.473776 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m08:46:03.473776 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m08:46:03.474787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:04.208288 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.734 seconds
[0m08:46:04.209289 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m08:46:04.333852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:46:04.340976 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:46:04.341979 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:46:04.341979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:04.899202 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.557 seconds
[0m08:46:04.901212 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:46:05.019241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2735cd6d-7ae9-442e-9c35-1a198ad64a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A7E1EDC00>]}
[0m08:46:05.020267 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:46:05.021272 [info ] [MainThread]: 
[0m08:46:05.023287 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m08:46:05.024346 [info ] [Thread-1 (]: 1 of 5 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m08:46:05.024346 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m08:46:05.025680 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m08:46:05.031916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m08:46:05.033936 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m08:46:05.056269 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m08:46:05.057369 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m08:46:05.058373 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m08:46:05.058373 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:46:06.144986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.086 seconds
[0m08:46:06.162161 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m08:46:06.344830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2735cd6d-7ae9-442e-9c35-1a198ad64a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A7D96FB50>]}
[0m08:46:06.345837 [info ] [Thread-1 (]: 1 of 5 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.32s]
[0m08:46:06.346843 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m08:46:06.347846 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:46:06.347846 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:46:06.348859 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:46:06.348859 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:46:06.348859 [info ] [Thread-3 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:46:06.349863 [info ] [Thread-4 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:46:06.350978 [info ] [Thread-2 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:46:06.350978 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:46:06.351983 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:46:06.351983 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:46:06.352987 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:46:06.352987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_first_dbt_model, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:46:06.353991 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:46:06.353991 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:46:06.354996 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:46:06.354996 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:46:06.365277 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:46:06.368384 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:46:06.372421 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:46:06.377442 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:46:06.378447 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:46:06.379454 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:46:06.391711 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:46:06.392715 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:46:06.392715 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:46:06.395726 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:46:06.453841 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:46:06.456855 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:46:06.456855 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:46:06.458918 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:46:06.458918 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:46:06.459923 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:46:06.459923 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:46:06.460929 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:46:06.460929 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:46:06.461942 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:46:06.461942 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:46:06.462950 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:46:06.463955 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:46:06.465964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:46:07.083770 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m08:46:07.087803 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:46:07.132902 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m08:46:07.134916 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:46:07.140993 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m08:46:07.143007 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:46:07.213860 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.86s]
[0m08:46:07.214873 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:46:07.257640 [info ] [Thread-4 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.91s]
[0m08:46:07.258653 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:46:07.260760 [info ] [Thread-3 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.91s]
[0m08:46:07.261885 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:46:08.032044 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.568 seconds
[0m08:46:08.034054 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:46:08.186667 [error] [Thread-2 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.83s]
[0m08:46:08.187785 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:46:08.189801 [info ] [MainThread]: 
[0m08:46:08.189801 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:46:08.213762 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:46:08.219960 [debug] [MainThread]: Using snowflake connection "master"
[0m08:46:08.220474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:46:08.220987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:46:09.171266 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.950 seconds
[0m08:46:09.186279 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:46:09.190310 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:46:09.194922 [debug] [MainThread]: Using snowflake connection "master"
[0m08:46:09.195926 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8608729839324951'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9056580066680908'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9087774753570557'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.83367919921875'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:46:09.682833 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.486 seconds
[0m08:46:09.682833 [debug] [MainThread]: Using snowflake connection "master"
[0m08:46:09.683837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:46:10.140790 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.456 seconds
[0m08:46:10.141791 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.95s]
[0m08:46:10.142922 [info ] [MainThread]: 
[0m08:46:10.142922 [debug] [MainThread]: On master: Close
[0m08:46:10.260981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:46:10.260981 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m08:46:10.261982 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:46:10.261982 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:46:10.262983 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:46:10.262983 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:46:10.263995 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:46:10.263995 [info ] [MainThread]: 
[0m08:46:10.265069 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 project hook in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m08:46:10.266074 [debug] [MainThread]: Command end result
[0m08:46:10.301072 [info ] [MainThread]: 
[0m08:46:10.302171 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:46:10.303199 [info ] [MainThread]: 
[0m08:46:10.303199 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:46:10.304203 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:46:10.305206 [info ] [MainThread]: 
[0m08:46:10.305206 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:46:10.306294 [info ] [MainThread]: 
[0m08:46:10.306294 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:46:10.307298 [debug] [MainThread]: Command `dbt build` failed at 08:46:10.307298 after 8.40 seconds
[0m08:46:10.308301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A624DE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A61FD0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A61FD34C0>]}
[0m08:46:10.308301 [debug] [MainThread]: Flushing usage events
[0m09:04:02.545841 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475896E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475B53E680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475B53E4A0>]}


============================== 09:04:02.549685 | 1fce2a29-1a2a-49cc-8dfb-6ae30cb9ab9a ==============================
[0m09:04:02.549685 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:04:02.550806 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m09:04:04.638307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1fce2a29-1a2a-49cc-8dfb-6ae30cb9ab9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024758BF7DC0>]}
[0m09:04:04.682174 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1fce2a29-1a2a-49cc-8dfb-6ae30cb9ab9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024758493550>]}
[0m09:04:04.683178 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m09:04:04.716262 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:04:05.765169 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:04:05.766174 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m09:04:05.920141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1fce2a29-1a2a-49cc-8dfb-6ae30cb9ab9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024773FCFCA0>]}
[0m09:04:06.066427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1fce2a29-1a2a-49cc-8dfb-6ae30cb9ab9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477435C1F0>]}
[0m09:04:06.066427 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m09:04:06.068439 [info ] [MainThread]: 
[0m09:04:06.069445 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:04:06.070449 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m09:04:06.083576 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m09:04:06.083576 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m09:04:06.084582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:04:06.797172 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.713 seconds
[0m09:04:06.798173 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m09:04:06.922617 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m09:04:06.930654 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m09:04:06.930654 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m09:04:06.931658 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:04:07.540263 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.609 seconds
[0m09:04:07.542369 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m09:04:07.669071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1fce2a29-1a2a-49cc-8dfb-6ae30cb9ab9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002477435F0D0>]}
[0m09:04:07.670078 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:04:07.671082 [info ] [MainThread]: 
[0m09:04:07.674212 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m09:04:07.675216 [info ] [Thread-1 (]: 1 of 5 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m09:04:07.675216 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m09:04:07.676321 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m09:04:07.683366 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m09:04:07.684370 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m09:04:07.705284 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m09:04:07.707426 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m09:04:07.707426 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m09:04:07.708443 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:04:09.174151 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.465 seconds
[0m09:04:09.190324 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m09:04:09.319063 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1fce2a29-1a2a-49cc-8dfb-6ae30cb9ab9a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024773DDFBE0>]}
[0m09:04:09.320141 [info ] [Thread-1 (]: 1 of 5 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.64s]
[0m09:04:09.321146 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m09:04:09.322154 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m09:04:09.322154 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m09:04:09.323159 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:04:09.323159 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m09:04:09.323159 [info ] [Thread-3 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m09:04:09.324164 [info ] [Thread-4 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m09:04:09.324164 [info ] [Thread-2 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m09:04:09.325169 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m09:04:09.326173 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m09:04:09.326173 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m09:04:09.327177 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m09:04:09.327177 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_first_dbt_model, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m09:04:09.328188 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m09:04:09.328188 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m09:04:09.329192 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:04:09.329192 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m09:04:09.340369 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m09:04:09.344511 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m09:04:09.348679 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m09:04:09.354025 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m09:04:09.355029 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m09:04:09.356041 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m09:04:09.356041 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:04:09.371133 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m09:04:09.374160 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m09:04:09.374160 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m09:04:09.377179 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m09:04:09.379238 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m09:04:09.380244 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m09:04:09.381249 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m09:04:09.381249 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m09:04:09.382473 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m09:04:09.383524 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m09:04:09.383524 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m09:04:09.384532 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:04:09.384532 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m09:04:09.385539 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:04:09.385539 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:04:09.387551 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:04:09.390575 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:04:10.292084 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.908 seconds
[0m09:04:10.295199 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m09:04:10.303475 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.916 seconds
[0m09:04:10.304481 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m09:04:10.420587 [info ] [Thread-3 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.10s]
[0m09:04:10.421591 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m09:04:10.423639 [error] [Thread-2 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.10s]
[0m09:04:10.424659 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:04:11.249239 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.863 seconds
[0m09:04:11.250245 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m09:04:11.279622 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.889 seconds
[0m09:04:11.280626 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m09:04:11.373617 [info ] [Thread-4 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 2.05s]
[0m09:04:11.375085 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m09:04:11.409155 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.08s]
[0m09:04:11.410159 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m09:04:11.411162 [info ] [MainThread]: 
[0m09:04:11.411162 [info ] [MainThread]: Running 1 on-run-end hook
[0m09:04:11.436391 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m09:04:11.442554 [debug] [MainThread]: Using snowflake connection "master"
[0m09:04:11.442554 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m09:04:11.443566 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:04:12.582784 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.139 seconds
[0m09:04:12.597402 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m09:04:12.601638 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m09:04:12.606694 [debug] [MainThread]: Using snowflake connection "master"
[0m09:04:12.606694 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.0954174995422363'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.0974657535552979'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.0474436283111572'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.0809171199798584'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m09:04:13.096404 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.489 seconds
[0m09:04:13.096404 [debug] [MainThread]: Using snowflake connection "master"
[0m09:04:13.097405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m09:04:13.539798 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.442 seconds
[0m09:04:13.540802 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.94s]
[0m09:04:13.541806 [info ] [MainThread]: 
[0m09:04:13.542822 [debug] [MainThread]: On master: Close
[0m09:04:13.662141 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:04:13.662141 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m09:04:13.663141 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m09:04:13.663141 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m09:04:13.663141 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m09:04:13.664221 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m09:04:13.664221 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m09:04:13.665232 [info ] [MainThread]: 
[0m09:04:13.665232 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 project hook in 0 hours 0 minutes and 7.59 seconds (7.59s).
[0m09:04:13.667373 [debug] [MainThread]: Command end result
[0m09:04:13.705792 [info ] [MainThread]: 
[0m09:04:13.706797 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:04:13.707803 [info ] [MainThread]: 
[0m09:04:13.707803 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m09:04:13.709142 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m09:04:13.709142 [info ] [MainThread]: 
[0m09:04:13.710149 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m09:04:13.712160 [info ] [MainThread]: 
[0m09:04:13.713161 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m09:04:13.714162 [debug] [MainThread]: Command `dbt build` failed at 09:04:13.714162 after 11.23 seconds
[0m09:04:13.715163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002475896E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024758493550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000247742EDD20>]}
[0m09:04:13.716163 [debug] [MainThread]: Flushing usage events
[0m09:04:18.086464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B02C24E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B02EE0A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B02EE0A350>]}


============================== 09:04:18.089839 | ada60a39-1d2c-4665-a50a-bf980e81d578 ==============================
[0m09:04:18.089839 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:04:18.091075 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example_2', 'send_anonymous_usage_stats': 'True'}
[0m09:04:18.807471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ada60a39-1d2c-4665-a50a-bf980e81d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B02C4D7970>]}
[0m09:04:18.853788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ada60a39-1d2c-4665-a50a-bf980e81d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B02BD23580>]}
[0m09:04:18.855799 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m09:04:18.876541 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:04:19.113912 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:04:19.114915 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:04:19.161997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ada60a39-1d2c-4665-a50a-bf980e81d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B047C54460>]}
[0m09:04:19.337583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ada60a39-1d2c-4665-a50a-bf980e81d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B047C546D0>]}
[0m09:04:19.338592 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m09:04:19.339596 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ada60a39-1d2c-4665-a50a-bf980e81d578', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B047C047F0>]}
[0m09:04:19.340615 [info ] [MainThread]: 
[0m09:04:19.340615 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:04:19.342738 [debug] [MainThread]: Command end result
[0m09:04:19.378275 [debug] [MainThread]: Command `dbt test` succeeded at 09:04:19.378275 after 1.35 seconds
[0m09:04:19.379393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B02C24E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B04777FF70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B04777D0C0>]}
[0m09:04:19.379393 [debug] [MainThread]: Flushing usage events
[0m09:04:52.379745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEB212E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEB4CEE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEB4CEE320>]}


============================== 09:04:52.383265 | 279bfd5d-c04a-4841-a0e7-2e4decf6fbb8 ==============================
[0m09:04:52.383265 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:04:52.383265 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example_2', 'send_anonymous_usage_stats': 'True'}
[0m09:04:53.094126 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '279bfd5d-c04a-4841-a0e7-2e4decf6fbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEB23B7A90>]}
[0m09:04:53.143375 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '279bfd5d-c04a-4841-a0e7-2e4decf6fbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEB1C03520>]}
[0m09:04:53.145489 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m09:04:53.165951 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:04:53.399545 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m09:04:53.400549 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m09:04:53.780397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '279bfd5d-c04a-4841-a0e7-2e4decf6fbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AECDE58130>]}
[0m09:04:53.899624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '279bfd5d-c04a-4841-a0e7-2e4decf6fbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AECD93E170>]}
[0m09:04:53.899624 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m09:04:53.899624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '279bfd5d-c04a-4841-a0e7-2e4decf6fbb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AECD8136A0>]}
[0m09:04:53.901928 [info ] [MainThread]: 
[0m09:04:53.902933 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m09:04:53.902933 [debug] [MainThread]: Command end result
[0m09:04:53.942123 [debug] [MainThread]: Command `dbt test` succeeded at 09:04:53.942123 after 1.62 seconds
[0m09:04:53.943124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEB212E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AEB410F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002AECD5D3BB0>]}
[0m09:04:53.943124 [debug] [MainThread]: Flushing usage events
[0m09:05:02.997770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215887FE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158B3FDF30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002158B3FE110>]}


============================== 09:05:03.000790 | c5d74fea-eba4-4ec4-a857-e4f6dc96da5d ==============================
[0m09:05:03.000790 [info ] [MainThread]: Running with dbt=1.8.7
[0m09:05:03.001795 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_1', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m09:05:03.705769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c5d74fea-eba4-4ec4-a857-e4f6dc96da5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021588A87970>]}
[0m09:05:03.749661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c5d74fea-eba4-4ec4-a857-e4f6dc96da5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215882FDC00>]}
[0m09:05:03.750707 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m09:05:03.771911 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m09:05:04.005489 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m09:05:04.006492 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m09:05:04.053425 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c5d74fea-eba4-4ec4-a857-e4f6dc96da5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A420FFA0>]}
[0m09:05:04.218616 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c5d74fea-eba4-4ec4-a857-e4f6dc96da5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A420CDC0>]}
[0m09:05:04.219622 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m09:05:04.220626 [info ] [MainThread]: 
[0m09:05:04.221629 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:05:04.222632 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m09:05:04.235781 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m09:05:04.235781 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m09:05:04.235781 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:04.879525 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.643 seconds
[0m09:05:04.880539 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m09:05:05.017362 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m09:05:05.024368 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m09:05:05.025369 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m09:05:05.025369 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:05:05.585065 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.559 seconds
[0m09:05:05.586073 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m09:05:05.708399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c5d74fea-eba4-4ec4-a857-e4f6dc96da5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A420EE30>]}
[0m09:05:05.709403 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m09:05:05.710406 [info ] [MainThread]: 
[0m09:05:05.712416 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m09:05:05.713424 [info ] [Thread-1 (]: 1 of 6 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m09:05:05.714427 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m09:05:05.714427 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m09:05:05.722594 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m09:05:05.722594 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m09:05:05.745171 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m09:05:05.746176 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m09:05:05.747182 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m09:05:05.747182 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m09:05:06.809937 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.062 seconds
[0m09:05:06.827262 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m09:05:06.951343 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c5d74fea-eba4-4ec4-a857-e4f6dc96da5d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021589114B20>]}
[0m09:05:06.952348 [info ] [Thread-1 (]: 1 of 6 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.24s]
[0m09:05:06.953359 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m09:05:06.953359 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m09:05:06.954366 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m09:05:06.954366 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m09:05:06.955372 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:05:06.955372 [info ] [Thread-3 (]: 2 of 6 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m09:05:06.956375 [info ] [Thread-4 (]: 3 of 6 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m09:05:06.956375 [info ] [Thread-2 (]: 4 of 6 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m09:05:06.957380 [info ] [Thread-1 (]: 5 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m09:05:06.957380 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m09:05:06.958395 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m09:05:06.958395 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m09:05:06.959402 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_first_dbt_model, now test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710)
[0m09:05:06.959402 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m09:05:06.960407 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m09:05:06.960407 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m09:05:06.961543 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:05:06.971013 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m09:05:06.974039 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m09:05:06.977634 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m09:05:06.982154 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m09:05:06.983165 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m09:05:06.984167 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m09:05:06.996743 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m09:05:06.996743 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m09:05:06.999757 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m09:05:06.999757 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:05:07.001768 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m09:05:07.002773 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m09:05:07.005866 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m09:05:07.007004 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m09:05:07.008011 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m09:05:07.008011 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m09:05:07.009016 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m09:05:07.009016 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m09:05:07.010021 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m09:05:07.010021 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m09:05:07.011027 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m09:05:07.011027 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m09:05:07.013034 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m09:05:07.014037 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:05:07.655898 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m09:05:07.659054 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m09:05:07.661067 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m09:05:07.662071 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m09:05:07.664083 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.655 seconds
[0m09:05:07.666089 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m09:05:07.780380 [error] [Thread-1 (]: 5 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.82s]
[0m09:05:07.781385 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m09:05:07.782477 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m09:05:07.782477 [info ] [Thread-1 (]: 6 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m09:05:07.783491 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m09:05:07.784496 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m09:05:07.790017 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m09:05:07.791021 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m09:05:07.795042 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m09:05:07.792027 [info ] [Thread-4 (]: 3 of 6 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.83s]
[0m09:05:07.796045 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m09:05:07.796045 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m09:05:07.792027 [info ] [Thread-3 (]: 2 of 6 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.83s]
[0m09:05:07.797075 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m09:05:07.798191 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m09:05:07.799196 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:05:08.357112 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.558 seconds
[0m09:05:08.359126 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m09:05:08.715679 [info ] [Thread-1 (]: 6 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.93s]
[0m09:05:08.716950 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m09:05:08.855009 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.842 seconds
[0m09:05:08.856016 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m09:05:08.981053 [info ] [Thread-2 (]: 4 of 6 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 2.02s]
[0m09:05:08.982379 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m09:05:08.983420 [info ] [MainThread]: 
[0m09:05:08.984427 [info ] [MainThread]: Running 1 on-run-end hook
[0m09:05:09.010203 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m09:05:09.015233 [debug] [MainThread]: Using snowflake connection "master"
[0m09:05:09.015233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m09:05:09.016237 [debug] [MainThread]: Opening a new connection, currently in state init
[0m09:05:10.024622 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.009 seconds
[0m09:05:10.039831 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m09:05:10.044289 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m09:05:10.049320 [debug] [MainThread]: Using snowflake connection "master"
[0m09:05:10.049320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8209779262542725'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8336315155029297'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8346469402313232'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9321873188018799'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.0226571559906006'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m09:05:10.590638 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.540 seconds
[0m09:05:10.590638 [debug] [MainThread]: Using snowflake connection "master"
[0m09:05:10.591639 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m09:05:10.916344 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.324 seconds
[0m09:05:10.917345 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.87s]
[0m09:05:10.918402 [info ] [MainThread]: 
[0m09:05:10.918402 [debug] [MainThread]: On master: Close
[0m09:05:11.037692 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:05:11.037692 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m09:05:11.038693 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m09:05:11.038693 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m09:05:11.039694 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m09:05:11.039694 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m09:05:11.039694 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m09:05:11.039694 [info ] [MainThread]: 
[0m09:05:11.041044 [info ] [MainThread]: Finished running 1 table model, 5 data tests, 1 project hook in 0 hours 0 minutes and 6.82 seconds (6.82s).
[0m09:05:11.043134 [debug] [MainThread]: Command end result
[0m09:05:11.080215 [info ] [MainThread]: 
[0m09:05:11.080215 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m09:05:11.081219 [info ] [MainThread]: 
[0m09:05:11.082223 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m09:05:11.083238 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m09:05:11.083238 [info ] [MainThread]: 
[0m09:05:11.084350 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m09:05:11.084350 [info ] [MainThread]: 
[0m09:05:11.085357 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m09:05:11.086360 [debug] [MainThread]: Command `dbt build` failed at 09:05:11.086360 after 8.14 seconds
[0m09:05:11.087484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215887FE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A465B310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215A4660370>]}
[0m09:05:11.087484 [debug] [MainThread]: Flushing usage events
[0m16:26:27.716502 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3F8A2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE42462590>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE424623B0>]}


============================== 16:26:27.721331 | 14543b5e-dd98-4654-a8a8-5be5027871bc ==============================
[0m16:26:27.721331 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:26:27.721331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:26:30.434110 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '14543b5e-dd98-4654-a8a8-5be5027871bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3FB2B760>]}
[0m16:26:30.477724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '14543b5e-dd98-4654-a8a8-5be5027871bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3F373460>]}
[0m16:26:30.478729 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:26:30.530860 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:26:31.998759 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:26:31.998759 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m16:26:32.366673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '14543b5e-dd98-4654-a8a8-5be5027871bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5B5BC130>]}
[0m16:26:32.523320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '14543b5e-dd98-4654-a8a8-5be5027871bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5B5BEBF0>]}
[0m16:26:32.524478 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m16:26:32.526515 [info ] [MainThread]: 
[0m16:26:32.526515 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:26:32.527521 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m16:26:32.538786 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m16:26:32.538786 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m16:26:32.539787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:33.223665 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.685 seconds
[0m16:26:33.225677 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m16:26:33.349446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m16:26:33.357552 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m16:26:33.357552 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m16:26:33.357552 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:26:33.913485 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.556 seconds
[0m16:26:33.915497 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m16:26:34.029582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '14543b5e-dd98-4654-a8a8-5be5027871bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5B5BDBA0>]}
[0m16:26:34.030587 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:26:34.031593 [info ] [MainThread]: 
[0m16:26:34.034696 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m16:26:34.035717 [info ] [Thread-1 (]: 1 of 5 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m16:26:34.035717 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m16:26:34.036722 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m16:26:34.043747 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m16:26:34.044750 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m16:26:34.067238 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m16:26:34.068733 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m16:26:34.069737 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m16:26:34.069737 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:26:35.061529 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.991 seconds
[0m16:26:35.078781 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m16:26:35.208156 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '14543b5e-dd98-4654-a8a8-5be5027871bc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5AD3FAF0>]}
[0m16:26:35.209162 [info ] [Thread-1 (]: 1 of 5 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.17s]
[0m16:26:35.210168 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m16:26:35.211171 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m16:26:35.211171 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m16:26:35.212175 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:26:35.212175 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m16:26:35.212175 [info ] [Thread-3 (]: 2 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m16:26:35.213264 [info ] [Thread-4 (]: 3 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m16:26:35.213264 [info ] [Thread-2 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m16:26:35.214268 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m16:26:35.215295 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m16:26:35.215295 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m16:26:35.216299 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m16:26:35.216299 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_first_dbt_model, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m16:26:35.216299 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m16:26:35.217310 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m16:26:35.217310 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:26:35.218314 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m16:26:35.228500 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m16:26:35.232554 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m16:26:35.236729 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:26:35.241759 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m16:26:35.242769 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m16:26:35.256300 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m16:26:35.257307 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m16:26:35.257307 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:26:35.258313 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m16:26:35.260753 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m16:26:35.324201 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m16:26:35.326212 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:26:35.328220 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m16:26:35.329228 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m16:26:35.330235 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m16:26:35.330235 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:26:35.331241 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m16:26:35.332246 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:26:35.333251 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m16:26:35.334256 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:26:35.335262 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m16:26:35.335262 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:26:35.337373 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:26:35.338378 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:26:36.049648 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.719 seconds
[0m16:26:36.053692 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m16:26:36.175003 [info ] [Thread-3 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.96s]
[0m16:26:36.176489 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m16:26:36.207739 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.870 seconds
[0m16:26:36.208740 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m16:26:36.216693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.879 seconds
[0m16:26:36.218704 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m16:26:36.302937 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.969 seconds
[0m16:26:36.304953 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m16:26:36.329601 [error] [Thread-2 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.11s]
[0m16:26:36.330604 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:26:36.344576 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.13s]
[0m16:26:36.345581 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m16:26:36.496943 [info ] [Thread-4 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.28s]
[0m16:26:36.497948 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m16:26:36.498952 [info ] [MainThread]: 
[0m16:26:36.499957 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:26:36.527772 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m16:26:36.533915 [debug] [MainThread]: Using snowflake connection "master"
[0m16:26:36.533915 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:26:36.534925 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:26:37.767307 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.232 seconds
[0m16:26:37.783321 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:26:37.787679 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:26:37.793419 [debug] [MainThread]: Using snowflake connection "master"
[0m16:26:37.793936 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9607348442077637'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.1143064498901367'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.1282768249511719'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.281648874282837'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:26:38.314239 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.520 seconds
[0m16:26:38.315329 [debug] [MainThread]: Using snowflake connection "master"
[0m16:26:38.315329 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:26:39.300596 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.984 seconds
[0m16:26:39.301841 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 1.51s]
[0m16:26:39.301841 [info ] [MainThread]: 
[0m16:26:39.301841 [debug] [MainThread]: On master: Close
[0m16:26:39.419874 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:26:39.420875 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m16:26:39.420875 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m16:26:39.420875 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m16:26:39.421876 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m16:26:39.421876 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m16:26:39.421876 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m16:26:39.422945 [info ] [MainThread]: 
[0m16:26:39.422945 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 project hook in 0 hours 0 minutes and 6.90 seconds (6.90s).
[0m16:26:39.425287 [debug] [MainThread]: Command end result
[0m16:26:39.461947 [info ] [MainThread]: 
[0m16:26:39.462948 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:26:39.462948 [info ] [MainThread]: 
[0m16:26:39.463949 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m16:26:39.464949 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m16:26:39.465951 [info ] [MainThread]: 
[0m16:26:39.465951 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m16:26:39.466951 [info ] [MainThread]: 
[0m16:26:39.466951 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m16:26:39.468409 [debug] [MainThread]: Command `dbt build` failed at 16:26:39.468409 after 11.82 seconds
[0m16:26:39.469540 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3F8A2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE3FC69810>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CE5B09BD90>]}
[0m16:26:39.469540 [debug] [MainThread]: Flushing usage events
[0m16:27:58.110836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A6610E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A68CB25C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A68CB23E0>]}


============================== 16:27:58.114984 | 0252a5bd-3682-412a-b580-4f2b79cb7729 ==============================
[0m16:27:58.114984 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:27:58.115989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:27:58.900712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0252a5bd-3682-412a-b580-4f2b79cb7729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A66397EB0>]}
[0m16:27:58.945474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0252a5bd-3682-412a-b580-4f2b79cb7729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A65C034C0>]}
[0m16:27:58.947995 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:27:58.968288 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:27:59.218797 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:27:59.219802 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m16:27:59.611970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0252a5bd-3682-412a-b580-4f2b79cb7729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A01E64130>]}
[0m16:27:59.738974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0252a5bd-3682-412a-b580-4f2b79cb7729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A01E66110>]}
[0m16:27:59.739979 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m16:27:59.741985 [info ] [MainThread]: 
[0m16:27:59.741985 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:27:59.743476 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m16:27:59.754266 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m16:27:59.755273 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m16:27:59.755273 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:00.447469 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.692 seconds
[0m16:28:00.449479 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m16:28:00.586805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m16:28:00.594861 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m16:28:00.594861 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m16:28:00.594861 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:01.209381 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.614 seconds
[0m16:28:01.210387 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m16:28:01.327954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0252a5bd-3682-412a-b580-4f2b79cb7729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A01E64520>]}
[0m16:28:01.327954 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:28:01.328958 [info ] [MainThread]: 
[0m16:28:01.331983 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m16:28:01.332989 [info ] [Thread-1 (]: 1 of 6 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m16:28:01.333995 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m16:28:01.333995 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m16:28:01.341186 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m16:28:01.342189 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m16:28:01.365047 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m16:28:01.367210 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m16:28:01.367210 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m16:28:01.368219 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:28:02.493954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.126 seconds
[0m16:28:02.512376 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m16:28:02.634466 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0252a5bd-3682-412a-b580-4f2b79cb7729', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A015DFB50>]}
[0m16:28:02.635472 [info ] [Thread-1 (]: 1 of 6 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.30s]
[0m16:28:02.636482 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m16:28:02.637570 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m16:28:02.637570 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m16:28:02.638574 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m16:28:02.638574 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:28:02.638574 [info ] [Thread-3 (]: 2 of 6 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m16:28:02.639579 [info ] [Thread-4 (]: 3 of 6 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m16:28:02.639579 [info ] [Thread-2 (]: 4 of 6 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m16:28:02.640584 [info ] [Thread-1 (]: 5 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m16:28:02.641585 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m16:28:02.641585 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m16:28:02.642586 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m16:28:02.642586 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_first_dbt_model, now test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710)
[0m16:28:02.643587 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m16:28:02.644588 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m16:28:02.644588 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m16:28:02.644588 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:28:02.655961 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m16:28:02.660487 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m16:28:02.663504 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m16:28:02.667572 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:28:02.668715 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m16:28:02.681805 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m16:28:02.681805 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m16:28:02.682809 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m16:28:02.749307 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:28:02.750346 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m16:28:02.753363 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m16:28:02.754369 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m16:28:02.756379 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:28:02.757380 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m16:28:02.758616 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m16:28:02.759622 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m16:28:02.759622 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m16:28:02.760782 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m16:28:02.760782 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m16:28:02.761789 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m16:28:02.761789 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m16:28:02.762793 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m16:28:02.763812 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:28:02.765826 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m16:28:03.478352 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.714 seconds
[0m16:28:03.482378 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m16:28:03.500792 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.740 seconds
[0m16:28:03.501801 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m16:28:03.608094 [info ] [Thread-2 (]: 4 of 6 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.97s]
[0m16:28:03.609100 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m16:28:03.610104 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m16:28:03.610104 [info ] [Thread-2 (]: 6 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m16:28:03.611109 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m16:28:03.612234 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m16:28:03.618285 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m16:28:03.619287 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m16:28:03.621302 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m16:28:03.622306 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m16:28:03.622306 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:28:03.623316 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m16:28:03.628541 [info ] [Thread-3 (]: 2 of 6 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.99s]
[0m16:28:03.629546 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m16:28:03.676384 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.914 seconds
[0m16:28:03.677390 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m16:28:03.801946 [info ] [Thread-4 (]: 3 of 6 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.16s]
[0m16:28:03.803962 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m16:28:04.194015 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m16:28:04.196029 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m16:28:04.322298 [info ] [Thread-2 (]: 6 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.71s]
[0m16:28:04.324367 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m16:28:04.442752 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.676 seconds
[0m16:28:04.443753 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m16:28:04.564627 [error] [Thread-1 (]: 5 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.92s]
[0m16:28:04.565631 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m16:28:04.567641 [info ] [MainThread]: 
[0m16:28:04.567641 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:28:04.592952 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m16:28:04.598092 [debug] [MainThread]: Using snowflake connection "master"
[0m16:28:04.599095 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:28:04.599095 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:05.774972 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.176 seconds
[0m16:28:05.791232 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:28:05.795366 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:28:05.800771 [debug] [MainThread]: Using snowflake connection "master"
[0m16:28:05.801775 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.965507984161377'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9869561195373535'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.1603612899780273'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.711188554763794'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9220409393310547'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:28:06.446221 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.644 seconds
[0m16:28:06.447365 [debug] [MainThread]: Using snowflake connection "master"
[0m16:28:06.447365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:28:06.869182 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.421 seconds
[0m16:28:06.870183 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.07s]
[0m16:28:06.871310 [info ] [MainThread]: 
[0m16:28:06.871310 [debug] [MainThread]: On master: Close
[0m16:28:06.999934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:07.000941 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m16:28:07.000941 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m16:28:07.001958 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m16:28:07.001958 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m16:28:07.001958 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m16:28:07.003062 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m16:28:07.003062 [info ] [MainThread]: 
[0m16:28:07.004066 [info ] [MainThread]: Finished running 1 table model, 5 data tests, 1 project hook in 0 hours 0 minutes and 7.26 seconds (7.26s).
[0m16:28:07.006085 [debug] [MainThread]: Command end result
[0m16:28:07.046851 [info ] [MainThread]: 
[0m16:28:07.047856 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:28:07.048860 [info ] [MainThread]: 
[0m16:28:07.049977 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m16:28:07.050980 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m16:28:07.050980 [info ] [MainThread]: 
[0m16:28:07.052057 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m16:28:07.053169 [info ] [MainThread]: 
[0m16:28:07.053169 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m16:28:07.055188 [debug] [MainThread]: Command `dbt build` failed at 16:28:07.055188 after 9.00 seconds
[0m16:28:07.055188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A6610E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A65C2CCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021A65C2E260>]}
[0m16:28:07.056194 [debug] [MainThread]: Flushing usage events
[0m16:28:21.951380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E3115E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E33D1E440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E33D1E260>]}


============================== 16:28:21.954391 | edc9c972-0ce3-44ad-9af7-c2f2f80d92e6 ==============================
[0m16:28:21.954391 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:28:21.954391 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example_2', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:28:22.677592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'edc9c972-0ce3-44ad-9af7-c2f2f80d92e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E31A1BF10>]}
[0m16:28:22.723216 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'edc9c972-0ce3-44ad-9af7-c2f2f80d92e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E3313C9A0>]}
[0m16:28:22.724220 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:28:22.745401 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:28:22.986560 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:28:22.987563 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:28:23.034071 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'edc9c972-0ce3-44ad-9af7-c2f2f80d92e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E4CB73EE0>]}
[0m16:28:23.203125 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'edc9c972-0ce3-44ad-9af7-c2f2f80d92e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E4CB70F40>]}
[0m16:28:23.203125 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m16:28:23.204131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edc9c972-0ce3-44ad-9af7-c2f2f80d92e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E4C6F8220>]}
[0m16:28:23.205135 [info ] [MainThread]: 
[0m16:28:23.206141 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:28:23.210291 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m16:28:23.225632 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m16:28:23.225632 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m16:28:23.226637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:28:23.869832 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.643 seconds
[0m16:28:23.870836 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m16:28:23.993640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'edc9c972-0ce3-44ad-9af7-c2f2f80d92e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E4CB70160>]}
[0m16:28:23.993640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:28:23.993640 [info ] [MainThread]: 
[0m16:28:23.997146 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:28:23.998218 [info ] [Thread-1 (]: 1 of 1 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m16:28:23.999226 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m16:28:23.999226 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:28:24.013639 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:28:24.014640 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:28:24.030213 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:28:24.031231 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:28:24.032237 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m16:28:24.032237 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:28:24.875031 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.842 seconds
[0m16:28:24.882253 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m16:28:25.024051 [info ] [Thread-1 (]: 1 of 1 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.03s]
[0m16:28:25.025057 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:28:25.027068 [info ] [MainThread]: 
[0m16:28:25.027068 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:28:25.052843 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m16:28:25.057891 [debug] [MainThread]: Using snowflake connection "master"
[0m16:28:25.058894 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:28:25.058894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:28:26.299499 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.240 seconds
[0m16:28:26.312705 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:28:26.316812 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:28:26.319824 [debug] [MainThread]: Using snowflake connection "master"
[0m16:28:26.319824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.0258328914642334'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:28:26.779918 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.459 seconds
[0m16:28:26.779918 [debug] [MainThread]: Using snowflake connection "master"
[0m16:28:26.781040 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:28:27.192218 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.410 seconds
[0m16:28:27.193221 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.88s]
[0m16:28:27.194424 [info ] [MainThread]: 
[0m16:28:27.194424 [debug] [MainThread]: On master: Close
[0m16:28:27.315058 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:28:27.315058 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m16:28:27.316070 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m16:28:27.316070 [info ] [MainThread]: 
[0m16:28:27.317076 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 4.11 seconds (4.11s).
[0m16:28:27.318177 [debug] [MainThread]: Command end result
[0m16:28:27.353987 [info ] [MainThread]: 
[0m16:28:27.354992 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:28:27.355995 [info ] [MainThread]: 
[0m16:28:27.355995 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:28:27.357039 [debug] [MainThread]: Command `dbt test` succeeded at 16:28:27.357039 after 5.46 seconds
[0m16:28:27.358542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E3115E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E3313ECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014E3313F4C0>]}
[0m16:28:27.358542 [debug] [MainThread]: Flushing usage events
[0m16:29:27.772416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270DC3FE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270DEFBA4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270DEFBA2C0>]}


============================== 16:29:27.775426 | 17593ba0-b993-4e95-a581-626485b350da ==============================
[0m16:29:27.775426 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:29:27.776429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_2', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:29:28.507856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17593ba0-b993-4e95-a581-626485b350da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270DC68BA90>]}
[0m16:29:28.552738 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17593ba0-b993-4e95-a581-626485b350da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270F78CF0A0>]}
[0m16:29:28.554744 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:29:28.574937 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:29:28.796931 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:29:28.797934 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m16:29:29.158510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17593ba0-b993-4e95-a581-626485b350da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270F8120280>]}
[0m16:29:29.279472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17593ba0-b993-4e95-a581-626485b350da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270F8121E10>]}
[0m16:29:29.279472 [info ] [MainThread]: Found 1 operation, 2 models, 7 data tests, 840 macros
[0m16:29:29.279472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17593ba0-b993-4e95-a581-626485b350da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270F7DC0220>]}
[0m16:29:29.281901 [info ] [MainThread]: 
[0m16:29:29.282904 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:29:29.286982 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m16:29:29.300147 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m16:29:29.300147 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m16:29:29.301152 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:29:29.940792 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.640 seconds
[0m16:29:29.942956 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m16:29:30.070581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17593ba0-b993-4e95-a581-626485b350da', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270F8122A40>]}
[0m16:29:30.070581 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:29:30.071655 [info ] [MainThread]: 
[0m16:29:30.074682 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:29:30.074682 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:29:30.075760 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m16:29:30.075760 [info ] [Thread-2 (]: 2 of 2 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m16:29:30.076764 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m16:29:30.076764 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m16:29:30.077789 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:29:30.077789 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:29:30.092016 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:29:30.097038 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:29:30.098050 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:29:30.114303 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:29:30.114303 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:29:30.118459 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:29:30.119464 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:29:30.119464 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m16:29:30.120493 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:29:30.120493 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:29:30.122673 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:29:30.123677 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:29:30.720275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m16:29:30.728428 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m16:29:30.848233 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.725 seconds
[0m16:29:30.850294 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m16:29:30.861166 [info ] [Thread-1 (]: 1 of 2 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.78s]
[0m16:29:30.862169 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:29:30.975066 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.90s]
[0m16:29:30.976075 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:29:30.978141 [info ] [MainThread]: 
[0m16:29:30.978141 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:29:31.003405 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m16:29:31.008512 [debug] [MainThread]: Using snowflake connection "master"
[0m16:29:31.009518 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:29:31.009518 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:29:31.976575 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.966 seconds
[0m16:29:31.989826 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:29:31.993847 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:29:31.997973 [debug] [MainThread]: Using snowflake connection "master"
[0m16:29:31.998978 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7844018936157227'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8983020782470703'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:29:32.474366 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.475 seconds
[0m16:29:32.474366 [debug] [MainThread]: Using snowflake connection "master"
[0m16:29:32.475370 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          union all select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:29:33.068914 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.593 seconds
[0m16:29:33.069919 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.07s]
[0m16:29:33.071151 [info ] [MainThread]: 
[0m16:29:33.071151 [debug] [MainThread]: On master: Close
[0m16:29:33.197550 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:29:33.198553 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m16:29:33.198553 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m16:29:33.198553 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:29:33.199914 [info ] [MainThread]: 
[0m16:29:33.200918 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 3.92 seconds (3.92s).
[0m16:29:33.201923 [debug] [MainThread]: Command end result
[0m16:29:33.298297 [info ] [MainThread]: 
[0m16:29:33.299303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:29:33.300306 [info ] [MainThread]: 
[0m16:29:33.301330 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:29:33.302498 [debug] [MainThread]: Command `dbt test` succeeded at 16:29:33.302498 after 5.59 seconds
[0m16:29:33.302498 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270DC3FE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270DB27C4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000270DB22FB50>]}
[0m16:29:33.303503 [debug] [MainThread]: Flushing usage events
[0m16:29:45.704156 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F7482980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FA076500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211FA076320>]}


============================== 16:29:45.708073 | 746ee180-e23a-4648-a936-478a662e72c3 ==============================
[0m16:29:45.708073 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:29:45.709077 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_2', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:29:46.426754 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '746ee180-e23a-4648-a936-478a662e72c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F7707DC0>]}
[0m16:29:46.471853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '746ee180-e23a-4648-a936-478a662e72c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F9A6EE00>]}
[0m16:29:46.472856 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:29:46.495006 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:29:46.727601 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:29:46.728627 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m16:29:47.016620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '746ee180-e23a-4648-a936-478a662e72c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211931D8130>]}
[0m16:29:47.139313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '746ee180-e23a-4648-a936-478a662e72c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211931D9D80>]}
[0m16:29:47.139313 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m16:29:47.140316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '746ee180-e23a-4648-a936-478a662e72c3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F781BA90>]}
[0m16:29:47.141335 [info ] [MainThread]: 
[0m16:29:47.141335 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:29:47.142718 [debug] [MainThread]: Command end result
[0m16:29:47.177524 [debug] [MainThread]: Command `dbt test` succeeded at 16:29:47.177524 after 1.53 seconds
[0m16:29:47.178529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F7482980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211F9484C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021192B9A5F0>]}
[0m16:29:47.178529 [debug] [MainThread]: Flushing usage events
[0m16:31:22.827766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261801D2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026182E5E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026182E5E320>]}


============================== 16:31:22.830776 | 1ab86aa2-20b6-47a2-917e-9fefaa133c1c ==============================
[0m16:31:22.830776 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:31:22.830776 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select tag:example_2', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:31:23.536892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ab86aa2-20b6-47a2-917e-9fefaa133c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002618045BA90>]}
[0m16:31:23.582939 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ab86aa2-20b6-47a2-917e-9fefaa133c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026182C73520>]}
[0m16:31:23.584470 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:31:23.605382 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:31:23.840573 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:31:23.841574 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:31:23.887660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ab86aa2-20b6-47a2-917e-9fefaa133c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BCB3DC0>]}
[0m16:31:24.043597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ab86aa2-20b6-47a2-917e-9fefaa133c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BC4C460>]}
[0m16:31:24.043597 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m16:31:24.044602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ab86aa2-20b6-47a2-917e-9fefaa133c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BC4C1C0>]}
[0m16:31:24.045664 [info ] [MainThread]: 
[0m16:31:24.046668 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:31:24.047674 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m16:31:24.059721 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m16:31:24.059721 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m16:31:24.060725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:25.061499 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.001 seconds
[0m16:31:25.063501 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m16:31:25.192644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m16:31:25.200154 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m16:31:25.201157 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m16:31:25.201157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:31:25.755171 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.554 seconds
[0m16:31:25.756708 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m16:31:25.879811 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ab86aa2-20b6-47a2-917e-9fefaa133c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619BC4E3E0>]}
[0m16:31:25.880815 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:31:25.881838 [info ] [MainThread]: 
[0m16:31:25.883904 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m16:31:25.884908 [info ] [Thread-1 (]: 1 of 1 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m16:31:25.884908 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m16:31:25.886138 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m16:31:25.893267 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m16:31:25.894271 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m16:31:25.917828 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m16:31:25.919600 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m16:31:25.920619 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m16:31:25.920619 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:31:26.943965 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.023 seconds
[0m16:31:26.961166 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m16:31:27.079057 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1ab86aa2-20b6-47a2-917e-9fefaa133c1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B743A30>]}
[0m16:31:27.080060 [info ] [Thread-1 (]: 1 of 1 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.19s]
[0m16:31:27.081066 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m16:31:27.082071 [info ] [MainThread]: 
[0m16:31:27.083075 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:31:27.104324 [debug] [MainThread]: Using snowflake connection "master"
[0m16:31:27.105327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
update dqm.dq_dbt_test_results_central
        set is_active = 'N',
            deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
        where is_active = 'Y'
        and (model_refs like '%my_second_dbt_model%')
[0m16:31:27.105327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:31:28.085321 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.979 seconds
[0m16:31:28.086322 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:31:28.090326 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:31:28.091500 [debug] [MainThread]: Using snowflake connection "master"
[0m16:31:28.091500 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select 1
[0m16:31:28.182314 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.090 seconds
[0m16:31:28.183357 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.09s]
[0m16:31:28.184021 [info ] [MainThread]: 
[0m16:31:28.185053 [debug] [MainThread]: On master: Close
[0m16:31:28.304337 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:31:28.304337 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m16:31:28.305338 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m16:31:28.305338 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m16:31:28.306339 [info ] [MainThread]: 
[0m16:31:28.306339 [info ] [MainThread]: Finished running 1 table model, 1 project hook in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m16:31:28.307607 [debug] [MainThread]: Command end result
[0m16:31:28.342848 [info ] [MainThread]: 
[0m16:31:28.343852 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:31:28.343852 [info ] [MainThread]: 
[0m16:31:28.344857 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:31:28.345883 [debug] [MainThread]: Command `dbt run` succeeded at 16:31:28.345883 after 5.58 seconds
[0m16:31:28.346896 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000261801D2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026182C73520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002619B92F190>]}
[0m16:31:28.346896 [debug] [MainThread]: Flushing usage events
[0m16:32:00.408448 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1D7AF2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1DA6AE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1DA6AE320>]}


============================== 16:32:00.411563 | 54dc1dd9-7025-4797-a0ec-46d605f30561 ==============================
[0m16:32:00.411563 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:32:00.412566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select tag:example_2', 'send_anonymous_usage_stats': 'True'}
[0m16:32:01.128949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '54dc1dd9-7025-4797-a0ec-46d605f30561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1D7D7BEB0>]}
[0m16:32:01.173080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '54dc1dd9-7025-4797-a0ec-46d605f30561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F2FBF0A0>]}
[0m16:32:01.174087 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:32:01.194789 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:32:01.420927 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:32:01.421935 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m16:32:01.776244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '54dc1dd9-7025-4797-a0ec-46d605f30561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F3818280>]}
[0m16:32:01.884606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '54dc1dd9-7025-4797-a0ec-46d605f30561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F349D360>]}
[0m16:32:01.885613 [info ] [MainThread]: Found 1 operation, 2 models, 7 data tests, 840 macros
[0m16:32:01.885613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54dc1dd9-7025-4797-a0ec-46d605f30561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F349E9E0>]}
[0m16:32:01.887891 [info ] [MainThread]: 
[0m16:32:01.887891 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:32:01.889901 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m16:32:01.900089 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m16:32:01.900089 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m16:32:01.901594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:02.688541 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.787 seconds
[0m16:32:02.690543 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m16:32:02.814257 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m16:32:02.822317 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m16:32:02.823321 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m16:32:02.823321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:03.385925 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.562 seconds
[0m16:32:03.386940 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m16:32:03.549623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '54dc1dd9-7025-4797-a0ec-46d605f30561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F349E1A0>]}
[0m16:32:03.550628 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:32:03.550628 [info ] [MainThread]: 
[0m16:32:03.552781 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m16:32:03.554135 [info ] [Thread-1 (]: 1 of 1 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m16:32:03.555142 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m16:32:03.555142 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m16:32:03.563176 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m16:32:03.564181 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m16:32:03.586595 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m16:32:03.588604 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m16:32:03.588604 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m16:32:03.589609 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:32:04.580218 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.990 seconds
[0m16:32:04.596941 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m16:32:04.721393 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '54dc1dd9-7025-4797-a0ec-46d605f30561', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1D8376A40>]}
[0m16:32:04.722394 [info ] [Thread-1 (]: 1 of 1 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.17s]
[0m16:32:04.723274 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m16:32:04.725394 [info ] [MainThread]: 
[0m16:32:04.725394 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:32:04.748846 [debug] [MainThread]: Using snowflake connection "master"
[0m16:32:04.748846 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
update dqm.dq_dbt_test_results_central
        set is_active = 'N',
            deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
        where is_active = 'Y'
        and (model_refs like '%my_second_dbt_model%')
[0m16:32:04.749847 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:05.432185 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.682 seconds
[0m16:32:05.433189 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:32:05.437202 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:32:05.438204 [debug] [MainThread]: Using snowflake connection "master"
[0m16:32:05.438204 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select 1
[0m16:32:05.518259 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.079 seconds
[0m16:32:05.519265 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.08s]
[0m16:32:05.520621 [info ] [MainThread]: 
[0m16:32:05.520621 [debug] [MainThread]: On master: Close
[0m16:32:05.638933 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:05.638933 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m16:32:05.639934 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m16:32:05.639934 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m16:32:05.640987 [info ] [MainThread]: 
[0m16:32:05.640987 [info ] [MainThread]: Finished running 1 table model, 1 project hook in 0 hours 0 minutes and 3.75 seconds (3.75s).
[0m16:32:05.642036 [debug] [MainThread]: Command end result
[0m16:32:05.680257 [info ] [MainThread]: 
[0m16:32:05.680257 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:05.681261 [info ] [MainThread]: 
[0m16:32:05.682403 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:32:05.683410 [debug] [MainThread]: Command `dbt run` succeeded at 16:32:05.683410 after 5.33 seconds
[0m16:32:05.683410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1D7AF2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1F3040EB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B1D7E16140>]}
[0m16:32:05.684416 [debug] [MainThread]: Flushing usage events
[0m16:32:13.340331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE5EEE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE8AAA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE8AAA320>]}


============================== 16:32:13.343464 | 549a794c-fc7c-44ad-bc33-de943d7e22c7 ==============================
[0m16:32:13.343464 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:32:13.344467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_2', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:32:14.102897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '549a794c-fc7c-44ad-bc33-de943d7e22c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE6177EB0>]}
[0m16:32:14.155391 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '549a794c-fc7c-44ad-bc33-de943d7e22c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB8140F0A0>]}
[0m16:32:14.157454 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:32:14.178829 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:32:14.413366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:32:14.414369 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:32:14.462307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '549a794c-fc7c-44ad-bc33-de943d7e22c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB81944BE0>]}
[0m16:32:14.622731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '549a794c-fc7c-44ad-bc33-de943d7e22c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB8192C370>]}
[0m16:32:14.623735 [info ] [MainThread]: Found 1 operation, 2 models, 7 data tests, 840 macros
[0m16:32:14.623735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '549a794c-fc7c-44ad-bc33-de943d7e22c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB81945C30>]}
[0m16:32:14.625743 [info ] [MainThread]: 
[0m16:32:14.626748 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:32:14.630971 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m16:32:14.645093 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m16:32:14.645093 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m16:32:14.646098 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:32:15.243764 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.598 seconds
[0m16:32:15.245766 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m16:32:15.364349 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '549a794c-fc7c-44ad-bc33-de943d7e22c7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AB8192D930>]}
[0m16:32:15.365775 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:32:15.365775 [info ] [MainThread]: 
[0m16:32:15.368790 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:32:15.369794 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:32:15.369794 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m16:32:15.370804 [info ] [Thread-2 (]: 2 of 2 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m16:32:15.370804 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m16:32:15.371920 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m16:32:15.371920 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:32:15.372926 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:32:15.386016 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:32:15.391509 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:32:15.392521 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:32:15.401840 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:32:15.408999 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:32:15.412016 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:32:15.413021 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:32:15.414028 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m16:32:15.414028 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:32:15.415033 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:32:15.415033 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:32:15.417053 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:32:16.089474 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.673 seconds
[0m16:32:16.098212 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m16:32:16.225221 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.85s]
[0m16:32:16.227236 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:32:17.278544 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.864 seconds
[0m16:32:17.280565 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m16:32:17.405641 [info ] [Thread-1 (]: 1 of 2 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 2.03s]
[0m16:32:17.406646 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:32:17.407650 [info ] [MainThread]: 
[0m16:32:17.408654 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:32:17.431952 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m16:32:17.436999 [debug] [MainThread]: Using snowflake connection "master"
[0m16:32:17.438002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:32:17.438002 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:32:18.607368 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.169 seconds
[0m16:32:18.622889 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:32:18.626913 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:32:18.630017 [debug] [MainThread]: Using snowflake connection "master"
[0m16:32:18.631020 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8533005714416504'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.034837484359741'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:32:19.174790 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.543 seconds
[0m16:32:19.175791 [debug] [MainThread]: Using snowflake connection "master"
[0m16:32:19.175791 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          union all select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:32:19.475765 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.299 seconds
[0m16:32:19.476766 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.85s]
[0m16:32:19.476766 [info ] [MainThread]: 
[0m16:32:19.478225 [debug] [MainThread]: On master: Close
[0m16:32:19.601495 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:32:19.602496 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m16:32:19.602496 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m16:32:19.603520 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:32:19.603520 [info ] [MainThread]: 
[0m16:32:19.604525 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.98 seconds (4.98s).
[0m16:32:19.605530 [debug] [MainThread]: Command end result
[0m16:32:19.643308 [info ] [MainThread]: 
[0m16:32:19.643308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:32:19.644313 [info ] [MainThread]: 
[0m16:32:19.645318 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:32:19.646324 [debug] [MainThread]: Command `dbt test` succeeded at 16:32:19.646324 after 6.36 seconds
[0m16:32:19.646324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE5EEE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE59C34F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ABE7ECECE0>]}
[0m16:32:19.647356 [debug] [MainThread]: Flushing usage events
[0m16:40:11.452576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217009CE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170368E530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170368E350>]}


============================== 16:40:11.455864 | 710a1e43-3968-44d8-b9ea-829275782457 ==============================
[0m16:40:11.455864 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:40:11.456875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_2', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:40:12.161183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '710a1e43-3968-44d8-b9ea-829275782457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021700C57940>]}
[0m16:40:12.204851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '710a1e43-3968-44d8-b9ea-829275782457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217034A3580>]}
[0m16:40:12.205857 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:40:12.226116 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:40:12.452721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:40:12.453726 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m16:40:12.608868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '710a1e43-3968-44d8-b9ea-829275782457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002171C524130>]}
[0m16:40:12.731034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '710a1e43-3968-44d8-b9ea-829275782457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002171C50B220>]}
[0m16:40:12.731034 [info ] [MainThread]: Found 1 operation, 2 models, 7 data tests, 840 macros
[0m16:40:12.732046 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '710a1e43-3968-44d8-b9ea-829275782457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002171C4D03A0>]}
[0m16:40:12.733051 [info ] [MainThread]: 
[0m16:40:12.734054 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:40:12.738475 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m16:40:12.752789 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m16:40:12.752789 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m16:40:12.753796 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:40:13.415466 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.662 seconds
[0m16:40:13.416469 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m16:40:13.546265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '710a1e43-3968-44d8-b9ea-829275782457', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002171C526EF0>]}
[0m16:40:13.547556 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:40:13.547556 [info ] [MainThread]: 
[0m16:40:13.550574 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:40:13.551578 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:40:13.551578 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m16:40:13.552583 [info ] [Thread-2 (]: 2 of 2 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m16:40:13.552583 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m16:40:13.553586 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m16:40:13.553586 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:40:13.554587 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:40:13.568160 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:40:13.573327 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:40:13.574331 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:40:13.587450 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:40:13.589630 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:40:13.592652 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:40:13.593656 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:40:13.593656 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m16:40:13.594702 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:40:13.594702 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:40:13.595706 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:40:13.597715 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:40:14.190257 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m16:40:14.196760 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m16:40:14.327463 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.77s]
[0m16:40:14.328475 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:40:15.351671 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.757 seconds
[0m16:40:15.353686 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m16:40:15.473001 [info ] [Thread-1 (]: 1 of 2 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.92s]
[0m16:40:15.474006 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:40:15.475231 [info ] [MainThread]: 
[0m16:40:15.475231 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:40:15.502025 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m16:40:15.509188 [debug] [MainThread]: Using snowflake connection "master"
[0m16:40:15.509188 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:40:15.510189 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:40:16.534015 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.023 seconds
[0m16:40:16.547027 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:40:16.551030 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:40:16.555447 [debug] [MainThread]: Using snowflake connection "master"
[0m16:40:16.556660 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7738761901855469'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'::varchar(4000) as unique_id,
            
            'None'::varchar(4000) as relation_name,
            
            
            0::number as rows_affected,
            
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9204182624816895'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'::varchar(4000) as unique_id,
            
            'None'::varchar(4000) as relation_name,
            
            
            0::number as rows_affected,
            
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:40:17.004427 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.447 seconds
[0m16:40:17.004427 [debug] [MainThread]: Using snowflake connection "master"
[0m16:40:17.005433 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          union all select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:40:17.313884 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.308 seconds
[0m16:40:17.314885 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.76s]
[0m16:40:17.315985 [info ] [MainThread]: 
[0m16:40:17.315985 [debug] [MainThread]: On master: Close
[0m16:40:17.447970 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:40:17.448974 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m16:40:17.448974 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m16:40:17.450049 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:40:17.450049 [info ] [MainThread]: 
[0m16:40:17.451053 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.72 seconds (4.72s).
[0m16:40:17.452059 [debug] [MainThread]: Command end result
[0m16:40:17.489422 [info ] [MainThread]: 
[0m16:40:17.489422 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:40:17.490425 [info ] [MainThread]: 
[0m16:40:17.491428 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:40:17.492434 [debug] [MainThread]: Command `dbt test` succeeded at 16:40:17.492434 after 6.10 seconds
[0m16:40:17.492434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217009CE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217034A3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002171C5099C0>]}
[0m16:40:17.493437 [debug] [MainThread]: Flushing usage events
[0m16:41:50.928531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E802F2E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E805ABA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E805ABA2F0>]}


============================== 16:41:50.931839 | efdd4178-2540-49bb-a9cd-965cf087b388 ==============================
[0m16:41:50.931839 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:41:50.932869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_2', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:41:51.681066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'efdd4178-2540-49bb-a9cd-965cf087b388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E805A76980>]}
[0m16:41:51.730911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'efdd4178-2540-49bb-a9cd-965cf087b388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E8037DB730>]}
[0m16:41:51.731913 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:41:51.761016 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:41:52.027950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:41:52.028465 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:41:52.077136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'efdd4178-2540-49bb-a9cd-965cf087b388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81E904C40>]}
[0m16:41:52.248563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'efdd4178-2540-49bb-a9cd-965cf087b388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81E905690>]}
[0m16:41:52.248563 [info ] [MainThread]: Found 1 operation, 2 models, 7 data tests, 840 macros
[0m16:41:52.249567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efdd4178-2540-49bb-a9cd-965cf087b388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81E766E60>]}
[0m16:41:52.251838 [info ] [MainThread]: 
[0m16:41:52.252842 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:41:52.257260 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m16:41:52.279571 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m16:41:52.280641 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m16:41:52.280641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:41:52.954002 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.673 seconds
[0m16:41:52.956273 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m16:41:53.083442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'efdd4178-2540-49bb-a9cd-965cf087b388', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E81E907D00>]}
[0m16:41:53.084454 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:41:53.085458 [info ] [MainThread]: 
[0m16:41:53.089485 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:41:53.089485 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:41:53.089485 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m16:41:53.090989 [info ] [Thread-2 (]: 2 of 2 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m16:41:53.091998 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m16:41:53.091998 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m16:41:53.093002 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:41:53.093002 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:41:53.108549 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:41:53.114558 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:41:53.115559 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:41:53.116806 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:41:53.134343 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:41:53.138698 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:41:53.140701 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:41:53.140701 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:41:53.140701 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m16:41:53.142176 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:41:53.142176 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:41:53.143197 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:41:53.661498 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m16:41:53.668526 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m16:41:53.793170 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.70s]
[0m16:41:53.795316 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:41:54.735204 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.592 seconds
[0m16:41:54.737221 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m16:41:54.857121 [info ] [Thread-1 (]: 1 of 2 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.77s]
[0m16:41:54.858125 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:41:54.860211 [info ] [MainThread]: 
[0m16:41:54.860211 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:41:54.889088 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m16:41:54.895214 [debug] [MainThread]: Using snowflake connection "master"
[0m16:41:54.896248 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:41:54.896248 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:41:55.970562 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.074 seconds
[0m16:41:55.984575 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:41:55.988579 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:41:55.993051 [debug] [MainThread]: Using snowflake connection "master"
[0m16:41:55.993051 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7011721134185791'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'::varchar(4000) as unique_id,
            
            'None'::varchar(4000) as relation_name,
            
            
            0::number as rows_affected,
            
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.765122413635254'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'::varchar(4000) as unique_id,
            
            'None'::varchar(4000) as relation_name,
            
            
            0::number as rows_affected,
            
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:41:56.408703 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.415 seconds
[0m16:41:56.409732 [debug] [MainThread]: Using snowflake connection "master"
[0m16:41:56.410244 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          union all select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:41:56.866051 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.456 seconds
[0m16:41:56.867071 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.88s]
[0m16:41:56.868086 [info ] [MainThread]: 
[0m16:41:56.869092 [debug] [MainThread]: On master: Close
[0m16:41:56.991426 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:41:56.991426 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m16:41:56.992430 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m16:41:56.992430 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:41:56.993434 [info ] [MainThread]: 
[0m16:41:56.993434 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m16:41:56.994439 [debug] [MainThread]: Command end result
[0m16:41:57.032000 [info ] [MainThread]: 
[0m16:41:57.033003 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:41:57.033003 [info ] [MainThread]: 
[0m16:41:57.034479 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:41:57.035531 [debug] [MainThread]: Command `dbt test` succeeded at 16:41:57.035531 after 6.17 seconds
[0m16:41:57.035531 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E802F2E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E804EE6D40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E803794F70>]}
[0m16:41:57.036878 [debug] [MainThread]: Flushing usage events
[0m16:43:26.838386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D20C53E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D20F0FA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D20F0FA230>]}


============================== 16:43:26.841537 | ab8f9275-42c6-40d8-a7fa-b7050bf80d4e ==============================
[0m16:43:26.841537 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:43:26.842543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_2', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:43:27.538584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ab8f9275-42c6-40d8-a7fa-b7050bf80d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D227A67BB0>]}
[0m16:43:27.582603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ab8f9275-42c6-40d8-a7fa-b7050bf80d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D20E57B760>]}
[0m16:43:27.583606 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:43:27.603797 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:43:27.840950 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:43:27.840950 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m16:43:28.013996 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ab8f9275-42c6-40d8-a7fa-b7050bf80d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D227F440A0>]}
[0m16:43:28.138511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ab8f9275-42c6-40d8-a7fa-b7050bf80d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D227F46260>]}
[0m16:43:28.138511 [info ] [MainThread]: Found 1 operation, 2 models, 7 data tests, 840 macros
[0m16:43:28.139516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab8f9275-42c6-40d8-a7fa-b7050bf80d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D227A93A00>]}
[0m16:43:28.140753 [info ] [MainThread]: 
[0m16:43:28.141756 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:43:28.145781 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m16:43:28.160395 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m16:43:28.160395 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m16:43:28.161399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:43:28.806237 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.645 seconds
[0m16:43:28.808247 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m16:43:28.935233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ab8f9275-42c6-40d8-a7fa-b7050bf80d4e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D227F44A30>]}
[0m16:43:28.935233 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:43:28.936238 [info ] [MainThread]: 
[0m16:43:28.939655 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:43:28.939655 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:43:28.939655 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m16:43:28.940683 [info ] [Thread-2 (]: 2 of 2 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m16:43:28.941688 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m16:43:28.941688 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m16:43:28.942692 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:43:28.942692 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:43:28.956937 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:43:28.961459 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:43:28.962475 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:43:28.963481 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:43:28.979537 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:43:28.983018 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:43:28.984022 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m16:43:28.984022 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m16:43:28.985152 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m16:43:28.985152 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:43:28.986156 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m16:43:28.987182 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m16:43:29.558304 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m16:43:29.565127 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m16:43:29.692617 [info ] [Thread-1 (]: 1 of 2 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.75s]
[0m16:43:29.693889 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m16:43:30.564586 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.577 seconds
[0m16:43:30.565587 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m16:43:30.685958 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.74s]
[0m16:43:30.686971 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m16:43:30.688211 [info ] [MainThread]: 
[0m16:43:30.689227 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:43:30.715977 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m16:43:30.721102 [debug] [MainThread]: Using snowflake connection "master"
[0m16:43:30.722109 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:43:30.722109 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:43:31.788128 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.065 seconds
[0m16:43:31.801269 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:43:31.805462 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:43:31.809478 [debug] [MainThread]: Using snowflake connection "master"
[0m16:43:31.809478 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7519340515136719'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'::varchar(4000) as unique_id,
            
            'None'::varchar(4000) as relation_name,
            
            
            0::number as rows_affected,
            
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.744269609451294'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'::varchar(4000) as unique_id,
            
            'None'::varchar(4000) as relation_name,
            
            
            0::number as rows_affected,
            
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, unique_id,
        relation_name, rows_affected, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.unique_id,
        source.relation_name, source.rows_affected, source.TIMESTAMP,
        'Y', null
      );
[0m16:43:32.312934 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.502 seconds
[0m16:43:32.312934 [debug] [MainThread]: Using snowflake connection "master"
[0m16:43:32.313935 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          union all select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:43:32.634913 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.320 seconds
[0m16:43:32.635920 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.83s]
[0m16:43:32.636931 [info ] [MainThread]: 
[0m16:43:32.636931 [debug] [MainThread]: On master: Close
[0m16:43:32.756882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:43:32.757897 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m16:43:32.757897 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m16:43:32.757897 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m16:43:32.758903 [info ] [MainThread]: 
[0m16:43:32.759907 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m16:43:32.760990 [debug] [MainThread]: Command end result
[0m16:43:32.798077 [info ] [MainThread]: 
[0m16:43:32.799083 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:43:32.799083 [info ] [MainThread]: 
[0m16:43:32.800086 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m16:43:32.801200 [debug] [MainThread]: Command `dbt test` succeeded at 16:43:32.801200 after 6.02 seconds
[0m16:43:32.802210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D20C53E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D20E51C820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D227A326E0>]}
[0m16:43:32.802210 [debug] [MainThread]: Flushing usage events
[0m17:59:29.360550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3A91C2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3ABDBE620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3ABDBE440>]}


============================== 17:59:29.363571 | be968288-c085-4ed0-89ad-9582e921de2e ==============================
[0m17:59:29.363571 [info ] [MainThread]: Running with dbt=1.8.7
[0m17:59:29.364574 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m17:59:30.205860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be968288-c085-4ed0-89ad-9582e921de2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3A944BA90>]}
[0m17:59:30.249786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be968288-c085-4ed0-89ad-9582e921de2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3C465F670>]}
[0m17:59:30.250789 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m17:59:30.273134 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m17:59:30.539425 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:59:30.539425 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m17:59:30.701743 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be968288-c085-4ed0-89ad-9582e921de2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3C4BBC100>]}
[0m17:59:30.827904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be968288-c085-4ed0-89ad-9582e921de2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3C4BBE5C0>]}
[0m17:59:30.827904 [info ] [MainThread]: Found 1 operation, 2 models, 7 data tests, 840 macros
[0m17:59:30.830039 [info ] [MainThread]: 
[0m17:59:30.831051 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:59:30.832054 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m17:59:30.847261 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m17:59:30.847261 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m17:59:30.848263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:31.518111 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.670 seconds
[0m17:59:31.520123 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m17:59:31.648544 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m17:59:31.657624 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m17:59:31.657624 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m17:59:31.659027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:59:32.223139 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.564 seconds
[0m17:59:32.224143 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m17:59:32.347610 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be968288-c085-4ed0-89ad-9582e921de2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3C4BF6350>]}
[0m17:59:32.347610 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m17:59:32.348614 [info ] [MainThread]: 
[0m17:59:32.350663 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m17:59:32.351705 [info ] [Thread-1 (]: 1 of 6 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m17:59:32.352711 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m17:59:32.352711 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m17:59:32.359979 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m17:59:32.360997 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m17:59:32.382870 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m17:59:32.383875 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m17:59:32.384980 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m17:59:32.384980 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m17:59:33.310762 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.925 seconds
[0m17:59:33.327473 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m17:59:33.469182 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'be968288-c085-4ed0-89ad-9582e921de2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3C465FBB0>]}
[0m17:59:33.470188 [info ] [Thread-1 (]: 1 of 6 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.12s]
[0m17:59:33.471201 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m17:59:33.472224 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m17:59:33.472224 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m17:59:33.473229 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m17:59:33.473229 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:59:33.473229 [info ] [Thread-3 (]: 2 of 6 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m17:59:33.474234 [info ] [Thread-4 (]: 3 of 6 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m17:59:33.474234 [info ] [Thread-2 (]: 4 of 6 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m17:59:33.475239 [info ] [Thread-1 (]: 5 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m17:59:33.476243 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m17:59:33.476243 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m17:59:33.476243 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m17:59:33.477610 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_first_dbt_model, now test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710)
[0m17:59:33.478615 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m17:59:33.478615 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m17:59:33.478615 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m17:59:33.479618 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:59:33.489755 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m17:59:33.492788 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m17:59:33.495804 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m17:59:33.500070 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:59:33.501083 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m17:59:33.501083 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m17:59:33.514399 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m17:59:33.514399 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m17:59:33.517424 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m17:59:33.517424 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:59:33.520437 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m17:59:33.520437 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m17:59:33.523455 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:59:33.523455 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m17:59:33.524460 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m17:59:33.524460 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m17:59:33.525461 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m17:59:33.526480 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m17:59:33.526480 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:59:33.526480 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m17:59:33.527503 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:59:33.527503 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m17:59:33.529689 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:59:33.531708 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:59:34.139428 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.613 seconds
[0m17:59:34.142453 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m17:59:34.265081 [info ] [Thread-3 (]: 2 of 6 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.79s]
[0m17:59:34.266097 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m17:59:34.267104 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m17:59:34.267104 [info ] [Thread-3 (]: 6 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m17:59:34.268326 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m17:59:34.268326 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m17:59:34.274351 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m17:59:34.275354 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m17:59:34.277399 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m17:59:34.278402 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m17:59:34.279406 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m17:59:34.279406 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:59:34.324064 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.794 seconds
[0m17:59:34.326065 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m17:59:34.444983 [info ] [Thread-2 (]: 4 of 6 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.97s]
[0m17:59:34.445993 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m17:59:35.050891 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.772 seconds
[0m17:59:35.052913 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m17:59:35.107251 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.580 seconds
[0m17:59:35.109267 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m17:59:35.178672 [info ] [Thread-3 (]: 6 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.91s]
[0m17:59:35.179679 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m17:59:35.237214 [info ] [Thread-4 (]: 3 of 6 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.76s]
[0m17:59:35.238220 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m17:59:35.278691 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.747 seconds
[0m17:59:35.280859 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m17:59:35.398447 [error] [Thread-1 (]: 5 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.92s]
[0m17:59:35.399452 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m17:59:35.401461 [info ] [MainThread]: 
[0m17:59:35.401461 [info ] [MainThread]: Running 1 on-run-end hook
[0m17:59:35.427371 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m17:59:35.432486 [debug] [MainThread]: Using snowflake connection "master"
[0m17:59:35.433489 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m17:59:35.433489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:59:36.602662 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.169 seconds
[0m17:59:36.619826 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m17:59:36.623887 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m17:59:36.630497 [debug] [MainThread]: Using snowflake connection "master"
[0m17:59:36.630497 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7898421287536621'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9677367210388184'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9103453159332275'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7609715461730957'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9208366870880127'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m17:59:37.068493 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.437 seconds
[0m17:59:37.069497 [debug] [MainThread]: Using snowflake connection "master"
[0m17:59:37.070515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m17:59:37.454550 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.383 seconds
[0m17:59:37.455556 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.83s]
[0m17:59:37.456566 [info ] [MainThread]: 
[0m17:59:37.457573 [debug] [MainThread]: On master: Close
[0m17:59:37.572511 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:59:37.573512 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m17:59:37.573512 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m17:59:37.573512 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m17:59:37.574513 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m17:59:37.574513 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m17:59:37.575513 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m17:59:37.575513 [info ] [MainThread]: 
[0m17:59:37.576983 [info ] [MainThread]: Finished running 1 table model, 5 data tests, 1 project hook in 0 hours 0 minutes and 6.74 seconds (6.74s).
[0m17:59:37.577990 [debug] [MainThread]: Command end result
[0m17:59:37.618230 [info ] [MainThread]: 
[0m17:59:37.619234 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m17:59:37.620237 [info ] [MainThread]: 
[0m17:59:37.621320 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m17:59:37.621320 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m17:59:37.622325 [info ] [MainThread]: 
[0m17:59:37.622325 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m17:59:37.623328 [info ] [MainThread]: 
[0m17:59:37.623328 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m17:59:37.625683 [debug] [MainThread]: Command `dbt build` failed at 17:59:37.625683 after 8.32 seconds
[0m17:59:37.625683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3A91C2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3AB19B490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B3C465F640>]}
[0m17:59:37.626696 [debug] [MainThread]: Flushing usage events
[0m18:01:31.495949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA9F3E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFACADE5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFACADE410>]}


============================== 18:01:31.499185 | 1b6704a9-550b-4569-9ba6-42a991687451 ==============================
[0m18:01:31.499185 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:01:31.500186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m18:01:32.266557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b6704a9-550b-4569-9ba6-42a991687451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFAA1CBEB0>]}
[0m18:01:32.310990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b6704a9-550b-4569-9ba6-42a991687451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFABF5B790>]}
[0m18:01:32.312036 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:01:32.334158 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:01:32.570187 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:01:32.570187 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:01:32.622149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b6704a9-550b-4569-9ba6-42a991687451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC5920D60>]}
[0m18:01:32.851433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b6704a9-550b-4569-9ba6-42a991687451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC5921870>]}
[0m18:01:32.851433 [info ] [MainThread]: Found 1 operation, 2 models, 7 data tests, 840 macros
[0m18:01:32.854532 [info ] [MainThread]: 
[0m18:01:32.855533 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:01:32.857887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m18:01:32.871115 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m18:01:32.871115 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m18:01:32.871115 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:33.492159 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.620 seconds
[0m18:01:33.494160 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m18:01:33.619179 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m18:01:33.627216 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m18:01:33.628220 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m18:01:33.628220 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:01:34.189630 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.562 seconds
[0m18:01:34.191679 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m18:01:34.318439 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b6704a9-550b-4569-9ba6-42a991687451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC59201F0>]}
[0m18:01:34.319445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:01:34.319445 [info ] [MainThread]: 
[0m18:01:34.322809 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m18:01:34.323814 [info ] [Thread-1 (]: 1 of 6 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m18:01:34.323814 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m18:01:34.324821 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m18:01:34.331838 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m18:01:34.332840 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m18:01:34.356415 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m18:01:34.357987 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m18:01:34.358490 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m18:01:34.359005 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:01:35.289311 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.930 seconds
[0m18:01:35.307123 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m18:01:35.428289 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1b6704a9-550b-4569-9ba6-42a991687451', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC53BFB80>]}
[0m18:01:35.429295 [info ] [Thread-1 (]: 1 of 6 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.10s]
[0m18:01:35.430303 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m18:01:35.431307 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m18:01:35.431307 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m18:01:35.431307 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m18:01:35.432311 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:01:35.432311 [info ] [Thread-3 (]: 2 of 6 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m18:01:35.433315 [info ] [Thread-4 (]: 3 of 6 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m18:01:35.433315 [info ] [Thread-2 (]: 4 of 6 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m18:01:35.434319 [info ] [Thread-1 (]: 5 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m18:01:35.435323 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m18:01:35.435323 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m18:01:35.436334 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m18:01:35.436334 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_first_dbt_model, now test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710)
[0m18:01:35.437341 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m18:01:35.437341 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m18:01:35.437341 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m18:01:35.438347 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:01:35.447607 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m18:01:35.451647 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m18:01:35.455665 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m18:01:35.458780 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:01:35.459783 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m18:01:35.460790 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m18:01:35.461796 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m18:01:35.473138 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m18:01:35.476159 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m18:01:35.476159 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:01:35.479181 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m18:01:35.482201 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:01:35.483205 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m18:01:35.483205 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m18:01:35.484210 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m18:01:35.485214 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m18:01:35.485214 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m18:01:35.486218 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m18:01:35.486218 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m18:01:35.486218 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:01:35.487390 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:01:35.487390 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m18:01:35.488398 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:01:35.491416 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:01:36.140186 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m18:01:36.143223 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m18:01:36.264498 [info ] [Thread-4 (]: 3 of 6 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.83s]
[0m18:01:36.265502 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m18:01:36.265502 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m18:01:36.266516 [info ] [Thread-4 (]: 6 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:01:36.266516 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m18:01:36.267520 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m18:01:36.272541 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m18:01:36.273544 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m18:01:36.276656 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m18:01:36.277656 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m18:01:36.277656 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:01:36.278658 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m18:01:36.854624 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m18:01:36.856640 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:01:36.988968 [info ] [Thread-4 (]: 6 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.72s]
[0m18:01:36.989971 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m18:01:37.175504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.684 seconds
[0m18:01:37.176519 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m18:01:37.296219 [error] [Thread-1 (]: 5 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.86s]
[0m18:01:37.297232 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m18:01:37.505592 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.019 seconds
[0m18:01:37.507823 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m18:01:37.634259 [info ] [Thread-3 (]: 2 of 6 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 2.20s]
[0m18:01:37.635265 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m18:01:38.249796 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.762 seconds
[0m18:01:38.251884 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m18:01:38.374797 [info ] [Thread-2 (]: 4 of 6 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 2.94s]
[0m18:01:38.375808 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m18:01:38.376829 [info ] [MainThread]: 
[0m18:01:38.377914 [info ] [MainThread]: Running 1 on-run-end hook
[0m18:01:38.404209 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m18:01:38.410258 [debug] [MainThread]: Using snowflake connection "master"
[0m18:01:38.411302 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m18:01:38.412401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:01:39.433397 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.021 seconds
[0m18:01:39.448628 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m18:01:39.453648 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m18:01:39.458776 [debug] [MainThread]: Using snowflake connection "master"
[0m18:01:39.459779 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8291749954223633'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7224516868591309'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8598849773406982'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.199939489364624'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.9394736289978027'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m18:01:39.859810 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.400 seconds
[0m18:01:39.860989 [debug] [MainThread]: Using snowflake connection "master"
[0m18:01:39.862010 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m18:01:40.181863 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.319 seconds
[0m18:01:40.182864 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.73s]
[0m18:01:40.183936 [info ] [MainThread]: 
[0m18:01:40.183936 [debug] [MainThread]: On master: Close
[0m18:01:40.300482 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:01:40.301483 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m18:01:40.301483 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m18:01:40.302484 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m18:01:40.302484 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m18:01:40.302484 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m18:01:40.303485 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m18:01:40.303485 [info ] [MainThread]: 
[0m18:01:40.304938 [info ] [MainThread]: Finished running 1 table model, 5 data tests, 1 project hook in 0 hours 0 minutes and 7.45 seconds (7.45s).
[0m18:01:40.305956 [debug] [MainThread]: Command end result
[0m18:01:40.343952 [info ] [MainThread]: 
[0m18:01:40.343952 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m18:01:40.345393 [info ] [MainThread]: 
[0m18:01:40.346398 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m18:01:40.346398 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m18:01:40.347403 [info ] [MainThread]: 
[0m18:01:40.348406 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m18:01:40.348406 [info ] [MainThread]: 
[0m18:01:40.349410 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m18:01:40.350414 [debug] [MainThread]: Command `dbt build` failed at 18:01:40.350414 after 8.91 seconds
[0m18:01:40.351417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFA9F3E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFABF26830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFC5E6AFB0>]}
[0m18:01:40.352420 [debug] [MainThread]: Flushing usage events
[0m18:12:34.970953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A238952920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A23B50E5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A23B50E410>]}


============================== 18:12:34.973965 | b5655339-162f-4678-87de-5a329e82407b ==============================
[0m18:12:34.973965 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:12:34.974969 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_2', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:12:35.713965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5655339-162f-4678-87de-5a329e82407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A238BDBEB0>]}
[0m18:12:35.759618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5655339-162f-4678-87de-5a329e82407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A23A98B790>]}
[0m18:12:35.760620 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:12:35.782573 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:12:36.011244 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:12:36.012250 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:12:36.060070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5655339-162f-4678-87de-5a329e82407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A254350D60>]}
[0m18:12:36.232221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5655339-162f-4678-87de-5a329e82407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A254351870>]}
[0m18:12:36.233356 [info ] [MainThread]: Found 1 operation, 2 models, 7 data tests, 840 macros
[0m18:12:36.235508 [info ] [MainThread]: 
[0m18:12:36.236514 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:12:36.237798 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m18:12:36.250217 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m18:12:36.251223 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m18:12:36.251223 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:36.988994 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.738 seconds
[0m18:12:36.991341 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m18:12:37.127632 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m18:12:37.135751 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m18:12:37.136755 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m18:12:37.136755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:12:37.698521 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.562 seconds
[0m18:12:37.701009 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m18:12:37.819575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5655339-162f-4678-87de-5a329e82407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A254350AF0>]}
[0m18:12:37.819575 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:12:37.820593 [info ] [MainThread]: 
[0m18:12:37.823806 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m18:12:37.824851 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m18:12:37.826083 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m18:12:37.826083 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m18:12:37.837552 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m18:12:37.838563 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m18:12:37.865426 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m18:12:37.866441 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m18:12:37.867448 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m18:12:37.867448 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:12:39.145498 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.277 seconds
[0m18:12:39.162707 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m18:12:39.285351 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5655339-162f-4678-87de-5a329e82407b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A253DEFB80>]}
[0m18:12:39.286354 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.46s]
[0m18:12:39.287367 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m18:12:39.288385 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:39.288385 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:39.289389 [info ] [Thread-3 (]: 2 of 3 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m18:12:39.289389 [info ] [Thread-4 (]: 3 of 3 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m18:12:39.290393 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m18:12:39.290393 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m18:12:39.291404 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:39.291404 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:39.301758 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m18:12:39.307809 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:12:39.308814 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:39.308814 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:39.320990 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m18:12:39.325007 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:12:39.327099 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m18:12:39.327099 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:12:39.327099 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m18:12:39.328334 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:12:39.328334 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:12:39.329339 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:12:40.172825 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.843 seconds
[0m18:12:40.175887 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m18:12:40.294430 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.00s]
[0m18:12:40.295433 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m18:12:41.368775 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.040 seconds
[0m18:12:41.370787 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m18:12:41.490996 [info ] [Thread-3 (]: 2 of 3 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 2.20s]
[0m18:12:41.492000 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m18:12:41.494006 [info ] [MainThread]: 
[0m18:12:41.494006 [info ] [MainThread]: Running 1 on-run-end hook
[0m18:12:41.519335 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m18:12:41.524356 [debug] [MainThread]: Using snowflake connection "master"
[0m18:12:41.525360 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m18:12:41.525360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:12:42.531435 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.006 seconds
[0m18:12:42.545448 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m18:12:42.549452 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m18:12:42.552928 [debug] [MainThread]: Using snowflake connection "master"
[0m18:12:42.553933 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.0040371417999268'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.200603485107422'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m18:12:43.056186 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.502 seconds
[0m18:12:43.057189 [debug] [MainThread]: Using snowflake connection "master"
[0m18:12:43.057189 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          union all select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m18:12:43.342108 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.284 seconds
[0m18:12:43.343109 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.79s]
[0m18:12:43.344212 [info ] [MainThread]: 
[0m18:12:43.344212 [debug] [MainThread]: On master: Close
[0m18:12:43.457735 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:12:43.458748 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m18:12:43.458748 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m18:12:43.459753 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m18:12:43.459753 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m18:12:43.459753 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:12:43.460765 [info ] [MainThread]: 
[0m18:12:43.461769 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 7.22 seconds (7.22s).
[0m18:12:43.462779 [debug] [MainThread]: Command end result
[0m18:12:43.500411 [info ] [MainThread]: 
[0m18:12:43.500411 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:12:43.501782 [info ] [MainThread]: 
[0m18:12:43.502787 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:12:43.503802 [debug] [MainThread]: Command `dbt build` succeeded at 18:12:43.503802 after 8.59 seconds
[0m18:12:43.503802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A238952920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A23A98B790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A253EE1720>]}
[0m18:12:43.505185 [debug] [MainThread]: Flushing usage events
[0m18:14:14.907019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F05BE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F31AE650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F31AE470>]}


============================== 18:14:14.910044 | 562d85f4-bf76-4576-92f4-60b8cb5fcf91 ==============================
[0m18:14:14.910044 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:14:14.910044 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_2', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:14:15.662241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '562d85f4-bf76-4576-92f4-60b8cb5fcf91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F0847970>]}
[0m18:14:15.709875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '562d85f4-bf76-4576-92f4-60b8cb5fcf91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F00E1C00>]}
[0m18:14:15.710887 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:14:15.734239 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:14:15.966826 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:14:15.966826 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m18:14:16.118335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '562d85f4-bf76-4576-92f4-60b8cb5fcf91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378C03C130>]}
[0m18:14:16.241983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '562d85f4-bf76-4576-92f4-60b8cb5fcf91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378C03E200>]}
[0m18:14:16.242987 [info ] [MainThread]: Found 1 operation, 2 models, 7 data tests, 840 macros
[0m18:14:16.244997 [info ] [MainThread]: 
[0m18:14:16.244997 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:14:16.247005 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m18:14:16.259350 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m18:14:16.260357 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m18:14:16.260357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:16.935793 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.675 seconds
[0m18:14:16.937799 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m18:14:17.074708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m18:14:17.082742 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m18:14:17.083749 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m18:14:17.083749 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:14:17.635335 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.551 seconds
[0m18:14:17.637365 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m18:14:17.760441 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '562d85f4-bf76-4576-92f4-60b8cb5fcf91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378C041420>]}
[0m18:14:17.760441 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:14:17.761444 [info ] [MainThread]: 
[0m18:14:17.764547 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m18:14:17.764547 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m18:14:17.765550 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m18:14:17.765550 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m18:14:17.773584 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m18:14:17.773584 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m18:14:17.795894 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m18:14:17.796897 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m18:14:17.797903 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m18:14:17.797903 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:14:18.907352 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.109 seconds
[0m18:14:18.923852 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m18:14:19.050111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '562d85f4-bf76-4576-92f4-60b8cb5fcf91', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378BADFC10>]}
[0m18:14:19.051118 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.28s]
[0m18:14:19.052125 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m18:14:19.053136 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m18:14:19.053136 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m18:14:19.053136 [info ] [Thread-3 (]: 2 of 3 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m18:14:19.054141 [info ] [Thread-4 (]: 3 of 3 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m18:14:19.055145 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m18:14:19.055145 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m18:14:19.056157 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m18:14:19.056157 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m18:14:19.066329 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m18:14:19.072498 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:14:19.072498 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m18:14:19.084907 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m18:14:19.085926 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m18:14:19.088001 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:14:19.089005 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m18:14:19.090010 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m18:14:19.091017 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m18:14:19.091017 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:14:19.092023 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:14:19.093031 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:14:19.725364 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m18:14:19.728376 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m18:14:19.820038 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.729 seconds
[0m18:14:19.821561 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m18:14:19.844896 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.79s]
[0m18:14:19.845902 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m18:14:19.959585 [info ] [Thread-3 (]: 2 of 3 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.90s]
[0m18:14:19.960588 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m18:14:19.962595 [info ] [MainThread]: 
[0m18:14:19.962595 [info ] [MainThread]: Running 1 on-run-end hook
[0m18:14:19.988454 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m18:14:19.993474 [debug] [MainThread]: Using snowflake connection "master"
[0m18:14:19.994477 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m18:14:19.994477 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:14:20.995206 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.001 seconds
[0m18:14:21.008360 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m18:14:21.012371 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m18:14:21.016600 [debug] [MainThread]: Using snowflake connection "master"
[0m18:14:21.016600 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7897510528564453'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9044404029846191'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        model_schema, model_table, source_refs, test_severity_config, 
        execution_time_seconds, test_result, file_test_defined, 
        compiled_sql, TIMESTAMP, is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.model_schema,
        source.model_table, source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m18:14:21.413548 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.396 seconds
[0m18:14:21.413548 [debug] [MainThread]: Using snowflake connection "master"
[0m18:14:21.414549 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          union all select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m18:14:21.736385 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.321 seconds
[0m18:14:21.737388 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.72s]
[0m18:14:21.738391 [info ] [MainThread]: 
[0m18:14:21.738391 [debug] [MainThread]: On master: Close
[0m18:14:21.855911 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:14:21.857022 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m18:14:21.857022 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m18:14:21.857022 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m18:14:21.858027 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m18:14:21.858027 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m18:14:21.859047 [info ] [MainThread]: 
[0m18:14:21.859047 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m18:14:21.861062 [debug] [MainThread]: Command end result
[0m18:14:21.897285 [info ] [MainThread]: 
[0m18:14:21.897285 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:14:21.898294 [info ] [MainThread]: 
[0m18:14:21.899297 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:14:21.900409 [debug] [MainThread]: Command `dbt build` succeeded at 18:14:21.900409 after 7.05 seconds
[0m18:14:21.901416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F05BE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237F0EC4B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002378BC90280>]}
[0m18:14:21.901416 [debug] [MainThread]: Flushing usage events
[0m18:20:30.169623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FECB29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021581A62650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021581A62470>]}


============================== 18:20:30.174251 | aab90e82-ecc3-452d-80e2-ec4ba51c1804 ==============================
[0m18:20:30.174251 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:20:30.174251 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:20:30.947034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aab90e82-ecc3-452d-80e2-ec4ba51c1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FEF37970>]}
[0m18:20:30.993105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aab90e82-ecc3-452d-80e2-ec4ba51c1804', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215818A5C00>]}
[0m18:20:30.994106 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:20:31.015633 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:20:31.268318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:20:31.269321 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://macros\test_not_null_columns.sql
[0m18:20:31.269321 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m18:20:31.487222 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\example\schema.yml @ models: {'name': 'my_first_dbt_model', 'description': 'A starter dbt model', 'columns': None, 'data_tests': [{'test_not_null_columns': {'columns': ['id', 'column_1', 'column_2']}}, {'name': 'id', 'description': 'The primary key for this table', 'data_tests': ['unique']}], 'original_file_path': 'models\\example\\schema.yml', 'yaml_key': 'models', 'package_name': 'dbt_dataops'} - at path ['columns']: None is not of type 'array'
[0m18:20:31.489253 [debug] [MainThread]: Command `dbt build` failed at 18:20:31.489253 after 1.38 seconds
[0m18:20:31.490258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215FECB29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159A8C07C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002159A8C23B0>]}
[0m18:20:31.490258 [debug] [MainThread]: Flushing usage events
[0m18:21:19.365728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D20CBE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D23882680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D238824A0>]}


============================== 18:21:19.369247 | 9b50b023-45eb-44f7-b2ed-2c6d6c12521b ==============================
[0m18:21:19.369247 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:21:19.370478 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:21:20.111511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b50b023-45eb-44f7-b2ed-2c6d6c12521b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D20F47DC0>]}
[0m18:21:20.166082 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b50b023-45eb-44f7-b2ed-2c6d6c12521b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D207C3550>]}
[0m18:21:20.168083 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:21:20.192249 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:21:20.431837 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:21:20.432869 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://macros\test_not_null_columns.sql
[0m18:21:20.433887 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m18:21:20.663734 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\example\schema.yml @ models: {'name': 'my_first_dbt_model', 'description': 'A starter dbt model', 'columns': None, 'tests': [{'test_not_null_columns': {'columns': ['id', 'column_1', 'column_2']}}, {'name': 'id', 'description': 'The primary key for this table', 'data_tests': ['unique']}], 'original_file_path': 'models\\example\\schema.yml', 'yaml_key': 'models', 'package_name': 'dbt_dataops'} - at path ['columns']: None is not of type 'array'
[0m18:21:20.665761 [debug] [MainThread]: Command `dbt build` failed at 18:21:20.665761 after 1.36 seconds
[0m18:21:20.665761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D20CBE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D3C2BF7F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021D3C6E9A80>]}
[0m18:21:20.666782 [debug] [MainThread]: Flushing usage events
[0m18:21:45.040759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFC2C2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFEE7A620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFEE7A440>]}


============================== 18:21:45.043779 | 05b4671e-a0ae-4a17-b0d8-4e2edd126eda ==============================
[0m18:21:45.043779 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:21:45.043779 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:21:45.748443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05b4671e-a0ae-4a17-b0d8-4e2edd126eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFC54BA90>]}
[0m18:21:45.794432 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05b4671e-a0ae-4a17-b0d8-4e2edd126eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F977DF670>]}
[0m18:21:45.795433 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:21:45.817967 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:21:46.043043 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m18:21:46.044047 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://macros\test_not_null_columns.sql
[0m18:21:46.044047 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m18:21:46.265930 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality
The `tests` config has been renamed to `data_tests`. Please see
https://docs.getdbt.com/docs/build/data-tests#new-data_tests-syntax for more
information.
[0m18:21:46.266936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'deprecation', 'label': '05b4671e-a0ae-4a17-b0d8-4e2edd126eda', 'property_': 'warn', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F978906D0>]}
[0m18:21:46.420043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05b4671e-a0ae-4a17-b0d8-4e2edd126eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9806D000>]}
[0m18:21:46.542173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05b4671e-a0ae-4a17-b0d8-4e2edd126eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9806C9A0>]}
[0m18:21:46.542173 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 841 macros
[0m18:21:46.544181 [info ] [MainThread]: 
[0m18:21:46.545185 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:21:46.546192 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m18:21:46.556741 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m18:21:46.558019 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m18:21:46.558019 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:47.236009 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.678 seconds
[0m18:21:47.237015 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m18:21:47.360625 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m18:21:47.368176 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m18:21:47.368176 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m18:21:47.368176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:21:47.973327 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.604 seconds
[0m18:21:47.974334 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m18:21:48.695481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05b4671e-a0ae-4a17-b0d8-4e2edd126eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F9806EEF0>]}
[0m18:21:48.695481 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:21:48.696491 [info ] [MainThread]: 
[0m18:21:48.699737 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m18:21:48.699737 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m18:21:48.700746 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m18:21:48.700746 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m18:21:48.707854 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m18:21:48.708857 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m18:21:48.731416 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m18:21:48.733499 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m18:21:48.733499 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m18:21:48.733499 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:21:49.589605 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.855 seconds
[0m18:21:49.607008 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m18:21:49.723563 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '05b4671e-a0ae-4a17-b0d8-4e2edd126eda', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F977DFBB0>]}
[0m18:21:49.724569 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.02s]
[0m18:21:49.725573 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m18:21:49.726581 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m18:21:49.727587 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m18:21:49.727587 [info ] [Thread-3 (]: 2 of 3 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m18:21:49.728597 [info ] [Thread-4 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:21:49.728597 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m18:21:49.729601 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m18:21:49.729601 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m18:21:49.730606 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m18:21:49.734633 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m18:21:49.739887 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m18:21:49.741899 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m18:21:49.741899 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m18:21:49.756420 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m18:21:49.759446 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m18:21:49.761471 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m18:21:49.761471 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m18:21:49.762476 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m18:21:49.763480 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:21:49.763480 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:21:49.765494 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:21:50.429059 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.666 seconds
[0m18:21:50.432068 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m18:21:50.552659 [info ] [Thread-3 (]: 2 of 3 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 0.82s]
[0m18:21:50.554728 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m18:21:51.344061 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.578 seconds
[0m18:21:51.345066 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:21:51.465698 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.74s]
[0m18:21:51.466704 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m18:21:51.468711 [info ] [MainThread]: 
[0m18:21:51.468711 [info ] [MainThread]: Running 1 on-run-end hook
[0m18:21:51.494513 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m18:21:51.499532 [debug] [MainThread]: Using snowflake connection "master"
[0m18:21:51.500535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m18:21:51.500535 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:21:52.572947 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.072 seconds
[0m18:21:52.587085 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m18:21:52.591115 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m18:21:52.595156 [debug] [MainThread]: Using snowflake connection "master"
[0m18:21:52.596354 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8240616321563721'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7360966205596924'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        model_schema, model_table, source_refs, test_severity_config, 
        execution_time_seconds, test_result, file_test_defined, 
        compiled_sql, TIMESTAMP, is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.model_schema,
        source.model_table, source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m18:21:53.098966 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.502 seconds
[0m18:21:53.098966 [debug] [MainThread]: Using snowflake connection "master"
[0m18:21:53.099969 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m18:21:53.427833 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.327 seconds
[0m18:21:53.428839 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.84s]
[0m18:21:53.428839 [info ] [MainThread]: 
[0m18:21:53.430408 [debug] [MainThread]: On master: Close
[0m18:21:53.547355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:21:53.548362 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m18:21:53.548362 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m18:21:53.548362 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m18:21:53.549367 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m18:21:53.549367 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m18:21:53.550371 [info ] [MainThread]: 
[0m18:21:53.551376 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 7.01 seconds (7.01s).
[0m18:21:53.552402 [debug] [MainThread]: Command end result
[0m18:21:53.590142 [info ] [MainThread]: 
[0m18:21:53.591149 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:21:53.592189 [info ] [MainThread]: 
[0m18:21:53.592189 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m18:21:53.594199 [debug] [MainThread]: Command `dbt build` succeeded at 18:21:53.594199 after 8.61 seconds
[0m18:21:53.594199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027FFC2C2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F97E52FE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027F97E52E90>]}
[0m18:21:53.595204 [debug] [MainThread]: Flushing usage events
[0m18:24:24.278462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0EC5E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1184E5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B1184E3E0>]}


============================== 18:24:24.282005 | b4f7a3e0-ba4e-42da-91fd-ec29b159c64c ==============================
[0m18:24:24.282005 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:24:24.283172 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:24:25.020687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b4f7a3e0-ba4e-42da-91fd-ec29b159c64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0E780C10>]}
[0m18:24:25.063297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b4f7a3e0-ba4e-42da-91fd-ec29b159c64c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0E7534C0>]}
[0m18:24:25.064371 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:24:25.084907 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:24:25.322887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:24:25.323888 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m18:24:25.551562 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\example\schema.yml @ models: {'name': 'my_first_dbt_model', 'description': 'A starter dbt model', 'data_tests': None, 'columns': [{'name': 'id', 'description': 'The primary key for this table', 'data_tests': ['unique']}], 'original_file_path': 'models\\example\\schema.yml', 'yaml_key': 'models', 'package_name': 'dbt_dataops'} - at path ['data_tests']: None is not of type 'array'
[0m18:24:25.553015 [debug] [MainThread]: Command `dbt build` failed at 18:24:25.553015 after 1.33 seconds
[0m18:24:25.554020 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B0EC5E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2A1A0850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023B2A1A0EE0>]}
[0m18:24:25.554020 [debug] [MainThread]: Flushing usage events
[0m18:24:46.973147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002895CF4E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002895FB0E620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002895FB0E440>]}


============================== 18:24:46.976226 | c675a456-e48f-4e48-9ea6-0e7a1c11e6d4 ==============================
[0m18:24:46.976226 [info ] [MainThread]: Running with dbt=1.8.7
[0m18:24:46.977232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:24:47.690761 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c675a456-e48f-4e48-9ea6-0e7a1c11e6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002895D1D7DC0>]}
[0m18:24:47.734373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c675a456-e48f-4e48-9ea6-0e7a1c11e6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289784415D0>]}
[0m18:24:47.735374 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m18:24:47.757532 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m18:24:47.979964 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:24:47.980970 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m18:24:48.328416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c675a456-e48f-4e48-9ea6-0e7a1c11e6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028978BC0130>]}
[0m18:24:48.445289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c675a456-e48f-4e48-9ea6-0e7a1c11e6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028978BC3970>]}
[0m18:24:48.445289 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 841 macros
[0m18:24:48.447297 [info ] [MainThread]: 
[0m18:24:48.448543 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m18:24:48.450545 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m18:24:48.461423 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m18:24:48.461423 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m18:24:48.462429 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:49.092274 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.630 seconds
[0m18:24:49.093278 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m18:24:49.219426 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m18:24:49.226478 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m18:24:49.226478 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m18:24:49.227484 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:24:49.800773 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.573 seconds
[0m18:24:49.802775 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m18:24:49.924466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c675a456-e48f-4e48-9ea6-0e7a1c11e6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028978BC24D0>]}
[0m18:24:49.925476 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:24:49.926487 [info ] [MainThread]: 
[0m18:24:49.929619 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m18:24:49.930622 [info ] [Thread-1 (]: 1 of 2 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m18:24:49.930622 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m18:24:49.931827 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m18:24:49.939003 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m18:24:49.940031 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m18:24:49.962886 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m18:24:49.963900 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m18:24:49.965403 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m18:24:49.965403 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m18:24:50.859097 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.893 seconds
[0m18:24:50.875615 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m18:24:50.997088 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c675a456-e48f-4e48-9ea6-0e7a1c11e6d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289783EFBB0>]}
[0m18:24:50.998092 [info ] [Thread-1 (]: 1 of 2 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.07s]
[0m18:24:50.999416 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m18:24:51.000421 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m18:24:51.000421 [info ] [Thread-3 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m18:24:51.001453 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m18:24:51.002460 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m18:24:51.010616 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m18:24:51.012008 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m18:24:51.025560 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m18:24:51.027569 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m18:24:51.027569 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m18:24:51.028721 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:24:51.611592 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m18:24:51.615613 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m18:24:51.754176 [info ] [Thread-3 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.75s]
[0m18:24:51.756193 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m18:24:51.757202 [info ] [MainThread]: 
[0m18:24:51.757202 [info ] [MainThread]: Running 1 on-run-end hook
[0m18:24:51.783341 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m18:24:51.789491 [debug] [MainThread]: Using snowflake connection "master"
[0m18:24:51.789491 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m18:24:51.790495 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:24:52.768441 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.978 seconds
[0m18:24:52.781457 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m18:24:52.785966 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m18:24:52.788403 [debug] [MainThread]: Using snowflake connection "master"
[0m18:24:52.789426 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7527234554290771'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        model_schema, model_table, source_refs, test_severity_config, 
        execution_time_seconds, test_result, file_test_defined, 
        compiled_sql, TIMESTAMP, is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.model_schema,
        source.model_table, source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m18:24:53.233184 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.443 seconds
[0m18:24:53.233184 [debug] [MainThread]: Using snowflake connection "master"
[0m18:24:53.234189 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m18:24:53.674268 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.439 seconds
[0m18:24:53.675271 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.89s]
[0m18:24:53.676376 [info ] [MainThread]: 
[0m18:24:53.676376 [debug] [MainThread]: On master: Close
[0m18:24:53.797022 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:24:53.797022 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m18:24:53.798176 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m18:24:53.798176 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m18:24:53.798176 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m18:24:53.799209 [info ] [MainThread]: 
[0m18:24:53.800213 [info ] [MainThread]: Finished running 1 table model, 1 test, 1 project hook in 0 hours 0 minutes and 5.35 seconds (5.35s).
[0m18:24:53.801219 [debug] [MainThread]: Command end result
[0m18:24:53.896200 [info ] [MainThread]: 
[0m18:24:53.897203 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:24:53.898233 [info ] [MainThread]: 
[0m18:24:53.898233 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m18:24:53.899236 [debug] [MainThread]: Command `dbt build` succeeded at 18:24:53.899236 after 6.99 seconds
[0m18:24:53.900242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002895CF4E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002897908CFD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002897908CEB0>]}
[0m18:24:53.900242 [debug] [MainThread]: Flushing usage events
[0m19:13:02.765620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C857CE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8838E620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8838E440>]}


============================== 19:13:02.769293 | 8aa8bf40-4cac-45fa-b909-f6381cdf03e8 ==============================
[0m19:13:02.769293 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:13:02.770294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m19:13:03.533854 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8aa8bf40-4cac-45fa-b909-f6381cdf03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C85A5BA90>]}
[0m19:13:03.581997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8aa8bf40-4cac-45fa-b909-f6381cdf03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA0C6F670>]}
[0m19:13:03.583048 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:13:03.606718 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:13:03.848869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:13:03.848869 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m19:13:03.999225 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8aa8bf40-4cac-45fa-b909-f6381cdf03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA11EC130>]}
[0m19:13:04.120816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8aa8bf40-4cac-45fa-b909-f6381cdf03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA11AC550>]}
[0m19:13:04.120816 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 841 macros
[0m19:13:04.122827 [info ] [MainThread]: 
[0m19:13:04.123831 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:13:04.124835 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:13:04.136867 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:13:04.137868 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:13:04.137868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:05.192281 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 1.054 seconds
[0m19:13:05.193288 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:13:05.323780 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:13:05.331839 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:13:05.331839 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:13:05.331839 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:05.965650 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.634 seconds
[0m19:13:05.967677 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:13:06.101016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aa8bf40-4cac-45fa-b909-f6381cdf03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA0F67B20>]}
[0m19:13:06.101016 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:13:06.102073 [info ] [MainThread]: 
[0m19:13:06.104096 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m19:13:06.105100 [info ] [Thread-1 (]: 1 of 2 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m19:13:06.106216 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m19:13:06.106216 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m19:13:06.113302 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m19:13:06.114306 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m19:13:06.134570 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m19:13:06.136651 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m19:13:06.136651 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:13:06.136651 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:13:07.392338 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.255 seconds
[0m19:13:07.409251 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m19:13:07.559486 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aa8bf40-4cac-45fa-b909-f6381cdf03e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028CA0C6FBB0>]}
[0m19:13:07.560496 [info ] [Thread-1 (]: 1 of 2 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.45s]
[0m19:13:07.561646 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m19:13:07.561646 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:13:07.562651 [info ] [Thread-3 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:13:07.563656 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m19:13:07.563656 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:13:07.571713 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:13:07.572716 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:13:07.587089 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:13:07.588091 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:13:07.589096 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:13:07.589096 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:13:08.188996 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m19:13:08.193009 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:13:08.306896 [info ] [Thread-3 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.74s]
[0m19:13:08.307901 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:13:08.309908 [info ] [MainThread]: 
[0m19:13:08.309908 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:13:08.340263 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m19:13:08.346482 [debug] [MainThread]: Using snowflake connection "master"
[0m19:13:08.347484 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m19:13:08.347484 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:13:09.345198 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.998 seconds
[0m19:13:09.359994 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:13:09.364034 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:13:09.368303 [debug] [MainThread]: Using snowflake connection "master"
[0m19:13:09.368303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7432405948638916'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m19:13:10.040300 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.671 seconds
[0m19:13:10.040300 [debug] [MainThread]: Using snowflake connection "master"
[0m19:13:10.041311 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m19:13:10.390360 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.348 seconds
[0m19:13:10.391368 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.03s]
[0m19:13:10.392373 [info ] [MainThread]: 
[0m19:13:10.393419 [debug] [MainThread]: On master: Close
[0m19:13:10.508834 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:10.510270 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:13:10.510270 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:13:10.511397 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m19:13:10.511397 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:13:10.512754 [info ] [MainThread]: 
[0m19:13:10.513755 [info ] [MainThread]: Finished running 1 table model, 1 test, 1 project hook in 0 hours 0 minutes and 6.39 seconds (6.39s).
[0m19:13:10.513755 [debug] [MainThread]: Command end result
[0m19:13:10.569303 [info ] [MainThread]: 
[0m19:13:10.571490 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:13:10.572491 [info ] [MainThread]: 
[0m19:13:10.572491 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:13:10.574625 [debug] [MainThread]: Command `dbt build` succeeded at 19:13:10.574625 after 7.87 seconds
[0m19:13:10.575626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C857CE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C877B3490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028C8603EA10>]}
[0m19:13:10.576627 [debug] [MainThread]: Flushing usage events
[0m19:13:32.743907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F374FDE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F377B9E620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F377B9E440>]}


============================== 19:13:32.747032 | d12635c6-c841-4c8a-851f-488ac1116494 ==============================
[0m19:13:32.747032 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:13:32.748038 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_2', 'send_anonymous_usage_stats': 'True'}
[0m19:13:33.519864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd12635c6-c841-4c8a-851f-488ac1116494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F37526BA90>]}
[0m19:13:33.565300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd12635c6-c841-4c8a-851f-488ac1116494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31050F670>]}
[0m19:13:33.566302 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:13:33.586690 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:13:33.824715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:13:33.825719 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:13:33.871238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd12635c6-c841-4c8a-851f-488ac1116494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F310A70550>]}
[0m19:13:34.041348 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd12635c6-c841-4c8a-851f-488ac1116494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F310A70A60>]}
[0m19:13:34.042352 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 841 macros
[0m19:13:34.043359 [info ] [MainThread]: 
[0m19:13:34.044363 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:13:34.045365 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:13:34.057580 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:13:34.058583 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:13:34.058583 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:34.707994 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.649 seconds
[0m19:13:34.710032 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:13:34.834623 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:13:34.842782 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:13:34.842782 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:13:34.843854 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:13:35.395728 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.552 seconds
[0m19:13:35.396733 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:13:35.515093 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd12635c6-c841-4c8a-851f-488ac1116494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F310A5D840>]}
[0m19:13:35.515093 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:13:35.516131 [info ] [MainThread]: 
[0m19:13:35.519171 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m19:13:35.519171 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m19:13:35.520175 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m19:13:35.520175 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m19:13:35.528233 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m19:13:35.529336 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m19:13:35.551560 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m19:13:35.552569 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m19:13:35.552569 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m19:13:35.553576 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:13:36.533322 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.980 seconds
[0m19:13:36.550481 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m19:13:37.107933 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd12635c6-c841-4c8a-851f-488ac1116494', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F31050FBB0>]}
[0m19:13:37.108935 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.59s]
[0m19:13:37.109935 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m19:13:37.111032 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m19:13:37.111032 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m19:13:37.112038 [info ] [Thread-3 (]: 2 of 3 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m19:13:37.112038 [info ] [Thread-4 (]: 3 of 3 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m19:13:37.113298 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m19:13:37.114313 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m19:13:37.114313 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m19:13:37.115318 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m19:13:37.124359 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m19:13:37.130739 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:13:37.131746 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m19:13:37.140777 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m19:13:37.145781 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m19:13:37.149785 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:13:37.150786 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m19:13:37.151787 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:13:37.151787 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m19:13:37.152788 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:13:37.153789 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:13:37.153789 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:13:37.714620 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m19:13:37.717647 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m19:13:37.837037 [info ] [Thread-3 (]: 2 of 3 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.72s]
[0m19:13:37.838037 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m19:13:38.675269 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.522 seconds
[0m19:13:38.678379 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m19:13:38.804469 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.69s]
[0m19:13:38.805474 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m19:13:38.806481 [info ] [MainThread]: 
[0m19:13:38.807487 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:13:38.838081 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m19:13:38.843282 [debug] [MainThread]: Using snowflake connection "master"
[0m19:13:38.844289 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m19:13:38.844289 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:13:39.922801 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.079 seconds
[0m19:13:39.937031 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:13:39.941035 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:13:39.945402 [debug] [MainThread]: Using snowflake connection "master"
[0m19:13:39.945402 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7237393856048584'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.690155267715454'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m19:13:41.105013 [debug] [MainThread]: SQL status: SUCCESS 2 in 1.159 seconds
[0m19:13:41.105013 [debug] [MainThread]: Using snowflake connection "master"
[0m19:13:41.106014 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          union all select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m19:13:41.426266 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.319 seconds
[0m19:13:41.427267 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.49s]
[0m19:13:41.427267 [info ] [MainThread]: 
[0m19:13:41.428656 [debug] [MainThread]: On master: Close
[0m19:13:41.548564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:13:41.548564 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:13:41.549904 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:13:41.549904 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m19:13:41.549904 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m19:13:41.550967 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:13:41.550967 [info ] [MainThread]: 
[0m19:13:41.551971 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 7.51 seconds (7.51s).
[0m19:13:41.552974 [debug] [MainThread]: Command end result
[0m19:13:41.588899 [info ] [MainThread]: 
[0m19:13:41.588899 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:13:41.589902 [info ] [MainThread]: 
[0m19:13:41.591068 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:13:41.592106 [debug] [MainThread]: Command `dbt build` succeeded at 19:13:41.592106 after 8.91 seconds
[0m19:13:41.592106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F374FDE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F376FBF490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F310A19540>]}
[0m19:13:41.593528 [debug] [MainThread]: Flushing usage events
[0m19:14:11.373954 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC8381E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC863DE650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC863DE470>]}


============================== 19:14:11.377675 | 15a7fe60-3a9d-4ff3-9910-dbf1e1f04634 ==============================
[0m19:14:11.377675 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:14:11.378682 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_2', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:14:12.093072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15a7fe60-3a9d-4ff3-9910-dbf1e1f04634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC83AA7970>]}
[0m19:14:12.136621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15a7fe60-3a9d-4ff3-9910-dbf1e1f04634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC8331DC00>]}
[0m19:14:12.137624 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:14:12.157862 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:14:12.381123 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:14:12.381123 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m19:14:12.740662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15a7fe60-3a9d-4ff3-9910-dbf1e1f04634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC9F541090>]}
[0m19:14:12.862258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15a7fe60-3a9d-4ff3-9910-dbf1e1f04634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC9F542860>]}
[0m19:14:12.863263 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 841 macros
[0m19:14:12.865273 [info ] [MainThread]: 
[0m19:14:12.865273 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:12.867305 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:14:12.879761 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:14:12.880765 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:14:12.880765 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:13.520407 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.640 seconds
[0m19:14:13.522412 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:14:13.656290 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:14:13.664370 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:14:13.665378 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:14:13.665378 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:14.216172 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.551 seconds
[0m19:14:14.218186 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:14:14.336061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15a7fe60-3a9d-4ff3-9910-dbf1e1f04634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC9F5431F0>]}
[0m19:14:14.337065 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:14:14.338073 [info ] [MainThread]: 
[0m19:14:14.340083 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m19:14:14.341133 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m19:14:14.342182 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m19:14:14.342182 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m19:14:14.350231 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m19:14:14.351240 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m19:14:14.374258 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m19:14:14.375262 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m19:14:14.375262 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m19:14:14.376270 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:14:15.316467 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.940 seconds
[0m19:14:15.332664 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m19:14:15.451937 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15a7fe60-3a9d-4ff3-9910-dbf1e1f04634', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC9ECBFC10>]}
[0m19:14:15.451937 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.11s]
[0m19:14:15.452942 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m19:14:15.453968 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m19:14:15.455015 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m19:14:15.455015 [info ] [Thread-3 (]: 2 of 3 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m19:14:15.456026 [info ] [Thread-4 (]: 3 of 3 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m19:14:15.456026 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m19:14:15.457038 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m19:14:15.457038 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m19:14:15.458042 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m19:14:15.465076 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m19:14:15.470081 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:14:15.471364 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m19:14:15.472365 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m19:14:15.485099 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m19:14:15.488261 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:14:15.489263 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m19:14:15.490357 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m19:14:15.490357 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m19:14:15.491404 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:14:15.491404 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:14:15.491404 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:14:16.063215 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.572 seconds
[0m19:14:16.067241 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m19:14:16.181996 [info ] [Thread-3 (]: 2 of 3 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.73s]
[0m19:14:16.183011 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m19:14:17.103253 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.611 seconds
[0m19:14:17.105280 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m19:14:17.228257 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.77s]
[0m19:14:17.229577 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m19:14:17.230582 [info ] [MainThread]: 
[0m19:14:17.231585 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:14:17.326991 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m19:14:17.332018 [debug] [MainThread]: Using snowflake connection "master"
[0m19:14:17.333020 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m19:14:17.333020 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:18.371451 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.038 seconds
[0m19:14:18.384462 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:14:18.388466 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:14:18.391973 [debug] [MainThread]: Using snowflake connection "master"
[0m19:14:18.392977 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7259707450866699'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7712194919586182'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m19:14:18.861262 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.468 seconds
[0m19:14:18.862262 [debug] [MainThread]: Using snowflake connection "master"
[0m19:14:18.862262 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          union all select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m19:14:19.143116 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.280 seconds
[0m19:14:19.144131 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.76s]
[0m19:14:19.145150 [info ] [MainThread]: 
[0m19:14:19.146156 [debug] [MainThread]: On master: Close
[0m19:14:19.259714 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:19.260720 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:14:19.260720 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:14:19.261726 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m19:14:19.261726 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m19:14:19.261726 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m19:14:19.262733 [info ] [MainThread]: 
[0m19:14:19.263743 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 6.40 seconds (6.40s).
[0m19:14:19.264756 [debug] [MainThread]: Command end result
[0m19:14:19.301176 [info ] [MainThread]: 
[0m19:14:19.302181 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:19.302181 [info ] [MainThread]: 
[0m19:14:19.303322 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:14:19.304330 [debug] [MainThread]: Command `dbt build` succeeded at 19:14:19.304330 after 7.99 seconds
[0m19:14:19.305333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC8381E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC836A1990>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AC9F450220>]}
[0m19:14:19.305333 [debug] [MainThread]: Flushing usage events
[0m19:14:29.183723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A84D042980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A84FBFE680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A84FBFE4A0>]}


============================== 19:14:29.186735 | 343af43c-cac4-4181-afd2-436ddd809caa ==============================
[0m19:14:29.186735 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:14:29.187738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m19:14:29.890097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '343af43c-cac4-4181-afd2-436ddd809caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A84D2C7DC0>]}
[0m19:14:29.934872 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '343af43c-cac4-4181-afd2-436ddd809caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A84CB43550>]}
[0m19:14:29.936881 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:14:29.957128 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:14:30.200767 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:14:30.200767 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:14:30.251137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '343af43c-cac4-4181-afd2-436ddd809caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A868A47F10>]}
[0m19:14:30.435687 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '343af43c-cac4-4181-afd2-436ddd809caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A868692620>]}
[0m19:14:30.436691 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 841 macros
[0m19:14:30.438851 [info ] [MainThread]: 
[0m19:14:30.438851 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:14:30.440869 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:14:30.453164 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:14:30.454176 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:14:30.454176 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:31.110793 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.657 seconds
[0m19:14:31.112801 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:14:31.246450 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:14:31.253502 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:14:31.254508 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:14:31.254508 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:14:31.900705 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.646 seconds
[0m19:14:31.902718 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:14:32.047283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '343af43c-cac4-4181-afd2-436ddd809caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A868A447C0>]}
[0m19:14:32.047283 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:14:32.048288 [info ] [MainThread]: 
[0m19:14:32.050345 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m19:14:32.051699 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m19:14:32.052707 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m19:14:32.052707 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m19:14:32.059753 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m19:14:32.060783 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m19:14:32.082434 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m19:14:32.084469 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m19:14:32.084469 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:14:32.085474 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:14:32.985397 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.900 seconds
[0m19:14:33.002686 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m19:14:33.121254 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '343af43c-cac4-4181-afd2-436ddd809caa', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A84F01ED40>]}
[0m19:14:33.122259 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.07s]
[0m19:14:33.123263 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m19:14:33.124276 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:14:33.124276 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:14:33.125281 [info ] [Thread-3 (]: 2 of 3 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m19:14:33.126347 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m19:14:33.125281 [info ] [Thread-4 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:14:33.126347 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:14:33.127671 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m19:14:33.139792 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:14:33.139792 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:14:33.146201 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:14:33.147243 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:14:33.160566 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:14:33.161570 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:14:33.164753 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:14:33.165756 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:14:33.166759 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m19:14:33.167764 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:14:33.167764 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:14:33.169796 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:14:33.170802 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:14:33.773159 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m19:14:33.776351 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:14:33.903417 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.78s]
[0m19:14:33.904429 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:14:35.221201 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.053 seconds
[0m19:14:35.222207 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m19:14:35.902739 [info ] [Thread-3 (]: 2 of 3 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 2.78s]
[0m19:14:35.904252 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:14:35.905302 [info ] [MainThread]: 
[0m19:14:35.906310 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:14:35.937003 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m19:14:35.943111 [debug] [MainThread]: Using snowflake connection "master"
[0m19:14:35.943111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m19:14:35.944125 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:14:37.023939 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.080 seconds
[0m19:14:37.037109 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:14:37.040124 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:14:37.045147 [debug] [MainThread]: Using snowflake connection "master"
[0m19:14:37.045147 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7757463455200195'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.7763919830322266'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m19:14:37.636034 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.590 seconds
[0m19:14:37.636034 [debug] [MainThread]: Using snowflake connection "master"
[0m19:14:37.637035 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m19:14:37.977531 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.340 seconds
[0m19:14:37.978815 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.94s]
[0m19:14:37.979865 [info ] [MainThread]: 
[0m19:14:37.979865 [debug] [MainThread]: On master: Close
[0m19:14:38.102666 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:14:38.103681 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:14:38.103681 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:14:38.104703 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m19:14:38.104703 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m19:14:38.105718 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:14:38.105718 [info ] [MainThread]: 
[0m19:14:38.106724 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 7.67 seconds (7.67s).
[0m19:14:38.107727 [debug] [MainThread]: Command end result
[0m19:14:38.143122 [info ] [MainThread]: 
[0m19:14:38.144125 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:14:38.144125 [info ] [MainThread]: 
[0m19:14:38.145202 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:14:38.147211 [debug] [MainThread]: Command `dbt build` succeeded at 19:14:38.146206 after 9.02 seconds
[0m19:14:38.147211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A84D042980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A84CB43550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A868692A40>]}
[0m19:14:38.148215 [debug] [MainThread]: Flushing usage events
[0m19:16:47.485033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234916AE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002349426A620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002349426A440>]}


============================== 19:16:47.487420 | f18a020b-65db-4b43-bc44-53db7e6b65fc ==============================
[0m19:16:47.487420 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:16:47.488423 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m19:16:48.239250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f18a020b-65db-4b43-bc44-53db7e6b65fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002349193BA90>]}
[0m19:16:48.283137 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f18a020b-65db-4b43-bc44-53db7e6b65fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234ACB4F670>]}
[0m19:16:48.285219 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:16:48.314212 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:16:48.559567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:16:48.559567 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m19:16:48.728312 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f18a020b-65db-4b43-bc44-53db7e6b65fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234AD0CC130>]}
[0m19:16:48.853786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f18a020b-65db-4b43-bc44-53db7e6b65fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234ACE454E0>]}
[0m19:16:48.853786 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 841 macros
[0m19:16:48.855830 [info ] [MainThread]: 
[0m19:16:48.857335 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:16:48.858352 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:16:48.870941 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:16:48.871945 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:16:48.871945 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:49.511870 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.640 seconds
[0m19:16:49.513214 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:16:49.649196 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:16:49.657817 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:16:49.657817 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:16:49.657817 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:50.174139 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.516 seconds
[0m19:16:50.176161 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:16:50.291280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f18a020b-65db-4b43-bc44-53db7e6b65fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234AD0AB190>]}
[0m19:16:50.292492 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:16:50.292492 [info ] [MainThread]: 
[0m19:16:50.296013 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m19:16:50.296013 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m19:16:50.297018 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m19:16:50.298024 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m19:16:50.305396 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m19:16:50.306403 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m19:16:50.327830 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m19:16:50.329215 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m19:16:50.330223 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:16:50.330223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:16:51.169856 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.839 seconds
[0m19:16:51.188042 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m19:16:51.340011 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f18a020b-65db-4b43-bc44-53db7e6b65fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234ACB4FBB0>]}
[0m19:16:51.341012 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.04s]
[0m19:16:51.343014 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m19:16:51.344015 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:16:51.344015 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:16:51.345348 [info ] [Thread-3 (]: 2 of 3 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m19:16:51.346362 [info ] [Thread-4 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:16:51.346362 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m19:16:51.347367 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m19:16:51.347367 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:16:51.348372 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:16:51.359948 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:16:51.365367 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:16:51.366383 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:16:51.367391 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:16:51.383083 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:16:51.386599 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:16:51.388675 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:16:51.389681 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:16:51.389681 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m19:16:51.390687 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:16:51.390687 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:16:51.391694 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:16:51.995158 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.605 seconds
[0m19:16:51.999555 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m19:16:52.121033 [info ] [Thread-3 (]: 2 of 3 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 0.77s]
[0m19:16:52.122039 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:16:53.346067 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.955 seconds
[0m19:16:53.348078 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:16:53.476158 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.13s]
[0m19:16:53.478183 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:16:53.479192 [info ] [MainThread]: 
[0m19:16:53.479192 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:16:53.515421 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m19:16:53.520441 [debug] [MainThread]: Using snowflake connection "master"
[0m19:16:53.520441 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m19:16:53.521445 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:16:54.743906 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.223 seconds
[0m19:16:54.757435 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:16:54.761870 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:16:54.765392 [debug] [MainThread]: Using snowflake connection "master"
[0m19:16:54.766844 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7746710777282715'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.1287906169891357'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m19:16:55.227010 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.459 seconds
[0m19:16:55.227010 [debug] [MainThread]: Using snowflake connection "master"
[0m19:16:55.228011 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m19:16:55.628258 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.400 seconds
[0m19:16:55.629264 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.87s]
[0m19:16:55.630686 [info ] [MainThread]: 
[0m19:16:55.630686 [debug] [MainThread]: On master: Close
[0m19:16:55.883976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:55.885749 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:16:55.885749 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:16:55.886771 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m19:16:55.886771 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m19:16:55.887776 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:16:55.887776 [info ] [MainThread]: 
[0m19:16:55.888779 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 7.03 seconds (7.03s).
[0m19:16:55.889783 [debug] [MainThread]: Command end result
[0m19:16:55.925119 [info ] [MainThread]: 
[0m19:16:55.926122 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:16:55.926122 [info ] [MainThread]: 
[0m19:16:55.927154 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:16:55.929164 [debug] [MainThread]: Command `dbt build` succeeded at 19:16:55.928159 after 8.50 seconds
[0m19:16:55.929164 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234916AE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234936B5C90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023491F263B0>]}
[0m19:16:55.929164 [debug] [MainThread]: Flushing usage events
[0m19:19:07.206496 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255C77A2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CA35E620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255CA35E440>]}


============================== 19:19:07.209506 | c8554620-82e3-4386-bc4b-99c3f6d63a08 ==============================
[0m19:19:07.209506 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:19:07.210509 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:19:07.934711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8554620-82e3-4386-bc4b-99c3f6d63a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255C7A27DC0>]}
[0m19:19:07.978212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8554620-82e3-4386-bc4b-99c3f6d63a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E2C915D0>]}
[0m19:19:07.979214 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:19:07.999450 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:19:08.233941 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:19:08.234944 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m19:19:08.390378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8554620-82e3-4386-bc4b-99c3f6d63a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E31BC130>]}
[0m19:19:08.515230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8554620-82e3-4386-bc4b-99c3f6d63a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E31BEA10>]}
[0m19:19:08.515230 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 841 macros
[0m19:19:08.517240 [info ] [MainThread]: 
[0m19:19:08.518242 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:19:08.519245 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:19:08.532367 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:19:08.532367 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:19:08.533370 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:09.161020 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.628 seconds
[0m19:19:09.162024 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:19:09.293673 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:19:09.301883 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:19:09.301883 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:19:09.302897 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:09.871514 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.569 seconds
[0m19:19:09.873587 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:19:09.989070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8554620-82e3-4386-bc4b-99c3f6d63a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E2DF31C0>]}
[0m19:19:09.989070 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:19:09.990075 [info ] [MainThread]: 
[0m19:19:09.992296 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m19:19:09.993321 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m19:19:09.993321 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m19:19:09.994339 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m19:19:10.002074 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m19:19:10.003468 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m19:19:10.025802 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m19:19:10.026806 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m19:19:10.027810 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:19:10.027810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:19:11.157082 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.129 seconds
[0m19:19:11.174333 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m19:19:11.293607 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c8554620-82e3-4386-bc4b-99c3f6d63a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E2C3FBB0>]}
[0m19:19:11.294613 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.30s]
[0m19:19:11.295615 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m19:19:11.296618 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:19:11.296618 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:19:11.297621 [info ] [Thread-3 (]: 2 of 3 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m19:19:11.297621 [info ] [Thread-4 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:19:11.298624 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m19:19:11.298624 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m19:19:11.299634 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:19:11.299634 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:19:11.311809 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:19:11.317845 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:19:11.318848 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:19:11.318848 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:19:11.331976 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:19:11.335997 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:19:11.338162 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:19:11.339166 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:19:11.339166 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m19:19:11.340172 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:19:11.340172 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:19:11.341186 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:19:11.911826 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m19:19:11.916079 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:19:12.034899 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.74s]
[0m19:19:12.035922 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:19:13.639952 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.299 seconds
[0m19:19:13.641954 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m19:19:13.759614 [info ] [Thread-3 (]: 2 of 3 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 2.46s]
[0m19:19:13.761633 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:19:13.762998 [info ] [MainThread]: 
[0m19:19:13.762998 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:19:13.799747 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m19:19:13.806512 [debug] [MainThread]: Using snowflake connection "master"
[0m19:19:13.807517 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m19:19:13.807517 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:14.869560 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.062 seconds
[0m19:19:14.883576 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:19:14.887580 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:19:14.892000 [debug] [MainThread]: Using snowflake connection "master"
[0m19:19:14.893004 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7356481552124023'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.4619925022125244'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m19:19:15.329444 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.436 seconds
[0m19:19:15.329444 [debug] [MainThread]: Using snowflake connection "master"
[0m19:19:15.330445 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m19:19:15.624749 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.293 seconds
[0m19:19:15.625761 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.74s]
[0m19:19:15.626766 [info ] [MainThread]: 
[0m19:19:15.626766 [debug] [MainThread]: On master: Close
[0m19:19:15.793040 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:15.794041 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:19:15.794041 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:19:15.795042 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m19:19:15.795042 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m19:19:15.795042 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:19:15.796254 [info ] [MainThread]: 
[0m19:19:15.796254 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 7.28 seconds (7.28s).
[0m19:19:15.797568 [debug] [MainThread]: Command end result
[0m19:19:15.834317 [info ] [MainThread]: 
[0m19:19:15.835323 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:15.836333 [info ] [MainThread]: 
[0m19:19:15.836333 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:19:15.838343 [debug] [MainThread]: Command `dbt build` succeeded at 19:19:15.838343 after 8.69 seconds
[0m19:19:15.838343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255C77A2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255C97A4C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000255E2CF3B20>]}
[0m19:19:15.839350 [debug] [MainThread]: Flushing usage events
[0m19:19:29.493984 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD7082950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD9C125F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD9C12410>]}


============================== 19:19:29.497553 | 11c03d68-791d-4082-8cb0-b07def96c3f5 ==============================
[0m19:19:29.497553 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:19:29.498069 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m19:19:30.215912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '11c03d68-791d-4082-8cb0-b07def96c3f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD730BA90>]}
[0m19:19:30.258545 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '11c03d68-791d-4082-8cb0-b07def96c3f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD908B7C0>]}
[0m19:19:30.259556 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:19:30.279722 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:19:30.512776 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:19:30.512776 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:19:30.559321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '11c03d68-791d-4082-8cb0-b07def96c3f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF2A57EB0>]}
[0m19:19:30.733889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '11c03d68-791d-4082-8cb0-b07def96c3f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF26A2EF0>]}
[0m19:19:30.735312 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 841 macros
[0m19:19:30.737376 [info ] [MainThread]: 
[0m19:19:30.737376 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:19:30.738381 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:19:30.751643 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:19:30.751643 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:19:30.752646 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:31.371278 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.618 seconds
[0m19:19:31.372279 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:19:31.491529 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:19:31.499582 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:19:31.499582 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:19:31.499582 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:19:32.041750 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.542 seconds
[0m19:19:32.043906 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:19:32.161109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '11c03d68-791d-4082-8cb0-b07def96c3f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF2A558A0>]}
[0m19:19:32.162114 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:19:32.163117 [info ] [MainThread]: 
[0m19:19:32.165315 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m19:19:32.166319 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m19:19:32.166319 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m19:19:32.167456 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m19:19:32.174498 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m19:19:32.175502 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m19:19:32.196848 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m19:19:32.199305 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m19:19:32.199305 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:19:32.199305 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:19:33.073357 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.873 seconds
[0m19:19:33.090622 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m19:19:33.208574 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '11c03d68-791d-4082-8cb0-b07def96c3f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD9032D10>]}
[0m19:19:33.209575 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.04s]
[0m19:19:33.209575 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m19:19:33.210912 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:19:33.211916 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:19:33.211916 [info ] [Thread-3 (]: 2 of 3 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m19:19:33.212922 [info ] [Thread-4 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:19:33.212922 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m19:19:33.213934 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m19:19:33.213934 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:19:33.214937 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:19:33.225205 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:19:33.231247 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:19:33.232254 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:19:33.245266 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:19:33.246267 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:19:33.249742 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:19:33.250810 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:19:33.251816 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m19:19:33.251816 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:19:33.253005 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:19:33.254451 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:19:33.255476 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:19:33.880489 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m19:19:33.883492 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:19:33.884707 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m19:19:33.886987 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m19:19:34.002814 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.79s]
[0m19:19:34.003819 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:19:34.008021 [info ] [Thread-3 (]: 2 of 3 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 0.80s]
[0m19:19:34.009032 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:19:34.010055 [info ] [MainThread]: 
[0m19:19:34.010055 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:19:34.046537 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m19:19:34.052668 [debug] [MainThread]: Using snowflake connection "master"
[0m19:19:34.053672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m19:19:34.053672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:19:35.032656 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.979 seconds
[0m19:19:35.045779 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:19:35.049902 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:19:35.053959 [debug] [MainThread]: Using snowflake connection "master"
[0m19:19:35.055103 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7888803482055664'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7950994968414307'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m19:19:35.476272 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.420 seconds
[0m19:19:35.476272 [debug] [MainThread]: Using snowflake connection "master"
[0m19:19:35.477579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m19:19:35.851767 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.373 seconds
[0m19:19:35.852770 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.80s]
[0m19:19:35.853971 [info ] [MainThread]: 
[0m19:19:35.853971 [debug] [MainThread]: On master: Close
[0m19:19:35.967786 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:19:35.968789 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:19:35.968789 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:19:35.969793 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m19:19:35.969793 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m19:19:35.969793 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:19:35.970797 [info ] [MainThread]: 
[0m19:19:35.971801 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 5.23 seconds (5.23s).
[0m19:19:35.972808 [debug] [MainThread]: Command end result
[0m19:19:36.010622 [info ] [MainThread]: 
[0m19:19:36.011626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:19:36.012771 [info ] [MainThread]: 
[0m19:19:36.013775 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:19:36.014780 [debug] [MainThread]: Command `dbt build` succeeded at 19:19:36.014780 after 6.58 seconds
[0m19:19:36.014780 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD7082950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDD908B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDF26A2F80>]}
[0m19:19:36.016041 [debug] [MainThread]: Flushing usage events
[0m19:20:20.554316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA97129B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DAC2CE650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DAC2CE470>]}


============================== 19:20:20.557328 | 212c2a33-aaf0-40c6-b444-4ab638d473dd ==============================
[0m19:20:20.557328 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:20:20.558331 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:20:21.270474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '212c2a33-aaf0-40c6-b444-4ab638d473dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC4BDA230>]}
[0m19:20:21.313339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '212c2a33-aaf0-40c6-b444-4ab638d473dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC4BDB3A0>]}
[0m19:20:21.314408 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:20:21.334731 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:20:21.559491 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:20:21.560493 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m19:20:21.928547 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '212c2a33-aaf0-40c6-b444-4ab638d473dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC542CD90>]}
[0m19:20:22.049027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '212c2a33-aaf0-40c6-b444-4ab638d473dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC542DCC0>]}
[0m19:20:22.049027 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 841 macros
[0m19:20:22.051039 [info ] [MainThread]: 
[0m19:20:22.052043 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:20:22.053047 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:20:22.064069 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:20:22.064069 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:20:22.065384 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:22.677731 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.612 seconds
[0m19:20:22.679207 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:20:22.803619 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:20:22.811883 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:20:22.811883 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:20:22.812887 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:23.384521 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.571 seconds
[0m19:20:23.385524 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:20:23.507231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '212c2a33-aaf0-40c6-b444-4ab638d473dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC542EFB0>]}
[0m19:20:23.507231 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:20:23.508295 [info ] [MainThread]: 
[0m19:20:23.511317 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m19:20:23.511317 [info ] [Thread-1 (]: 1 of 2 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m19:20:23.512320 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m19:20:23.512320 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m19:20:23.519346 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m19:20:23.520351 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m19:20:23.542662 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m19:20:23.544671 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m19:20:23.544671 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:20:23.545675 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:20:24.435781 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.890 seconds
[0m19:20:24.452942 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m19:20:24.579521 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '212c2a33-aaf0-40c6-b444-4ab638d473dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC4BAFBE0>]}
[0m19:20:24.580528 [info ] [Thread-1 (]: 1 of 2 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.07s]
[0m19:20:24.581530 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m19:20:24.582574 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:20:24.582574 [info ] [Thread-3 (]: 2 of 2 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m19:20:24.583594 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m19:20:24.584599 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:20:24.587623 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:20:24.588755 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:20:24.602844 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:20:24.605045 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:20:24.605045 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m19:20:24.606053 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:20:25.183537 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.577 seconds
[0m19:20:25.186557 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m19:20:25.305291 [info ] [Thread-3 (]: 2 of 2 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 0.72s]
[0m19:20:25.306295 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:20:25.307301 [info ] [MainThread]: 
[0m19:20:25.308305 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:20:25.343860 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m19:20:25.348893 [debug] [MainThread]: Using snowflake connection "master"
[0m19:20:25.348893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m19:20:25.349903 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:26.396694 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.047 seconds
[0m19:20:26.409874 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:20:26.414279 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:20:26.417352 [debug] [MainThread]: Using snowflake connection "master"
[0m19:20:26.418356 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7216973304748535'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m19:20:26.840394 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.421 seconds
[0m19:20:26.840394 [debug] [MainThread]: Using snowflake connection "master"
[0m19:20:26.841397 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m19:20:27.290491 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.448 seconds
[0m19:20:27.291492 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.88s]
[0m19:20:27.292583 [info ] [MainThread]: 
[0m19:20:27.292583 [debug] [MainThread]: On master: Close
[0m19:20:27.412989 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:27.412989 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:20:27.414220 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:20:27.414220 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m19:20:27.414220 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m19:20:27.415225 [info ] [MainThread]: 
[0m19:20:27.416230 [info ] [MainThread]: Finished running 1 table model, 1 test, 1 project hook in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m19:20:27.417235 [debug] [MainThread]: Command end result
[0m19:20:27.514258 [info ] [MainThread]: 
[0m19:20:27.515263 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:27.516268 [info ] [MainThread]: 
[0m19:20:27.516268 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m19:20:27.517273 [debug] [MainThread]: Command `dbt build` succeeded at 19:20:27.517273 after 7.02 seconds
[0m19:20:27.518506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DA97129B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC4F33D90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021DC4F339D0>]}
[0m19:20:27.518506 [debug] [MainThread]: Flushing usage events
[0m19:20:52.377648 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016357BEE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001635A7B65C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001635A7B63E0>]}


============================== 19:20:52.381116 | 9d5d8632-88a3-45cc-8a32-19e3bd0c3b32 ==============================
[0m19:20:52.381116 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:20:52.381116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:20:53.085461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9d5d8632-88a3-45cc-8a32-19e3bd0c3b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016357E7BEB0>]}
[0m19:20:53.129017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9d5d8632-88a3-45cc-8a32-19e3bd0c3b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163576C34C0>]}
[0m19:20:53.130018 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:20:53.152636 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:20:53.390144 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:20:53.391145 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m19:20:53.685857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9d5d8632-88a3-45cc-8a32-19e3bd0c3b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016373860130>]}
[0m19:20:53.808284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9d5d8632-88a3-45cc-8a32-19e3bd0c3b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016373876920>]}
[0m19:20:53.809515 [info ] [MainThread]: Found 1 operation, 2 models, 2 data tests, 841 macros
[0m19:20:53.810521 [info ] [MainThread]: 
[0m19:20:53.811523 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:20:53.812611 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:20:53.823954 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:20:53.823954 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:20:53.824958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:54.447098 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.623 seconds
[0m19:20:54.448098 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:20:54.578392 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:20:54.585739 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:20:54.586769 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:20:54.586769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:55.114550 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.528 seconds
[0m19:20:55.116591 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:20:55.231422 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9d5d8632-88a3-45cc-8a32-19e3bd0c3b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016373863A60>]}
[0m19:20:55.232426 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:20:55.233475 [info ] [MainThread]: 
[0m19:20:55.235535 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m19:20:55.236539 [info ] [Thread-1 (]: 1 of 1 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m19:20:55.236539 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m19:20:55.237543 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m19:20:55.244568 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m19:20:55.245571 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m19:20:55.267046 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m19:20:55.269065 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m19:20:55.270073 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:20:55.270073 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:20:56.379380 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.109 seconds
[0m19:20:56.396396 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m19:20:56.521111 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '9d5d8632-88a3-45cc-8a32-19e3bd0c3b32', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001637308FB50>]}
[0m19:20:56.522114 [info ] [Thread-1 (]: 1 of 1 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.28s]
[0m19:20:56.523118 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m19:20:56.524136 [info ] [MainThread]: 
[0m19:20:56.525139 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:20:56.557171 [debug] [MainThread]: Using snowflake connection "master"
[0m19:20:56.557171 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
update dqm.dq_dbt_test_results_central
        set is_active = 'N',
            deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
        where is_active = 'Y'
        and (model_refs like '%my_first_dbt_model%')
[0m19:20:56.558365 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:57.335887 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.777 seconds
[0m19:20:57.336887 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:20:57.341064 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:20:57.341064 [debug] [MainThread]: Using snowflake connection "master"
[0m19:20:57.342424 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select 1
[0m19:20:57.424526 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.082 seconds
[0m19:20:57.425556 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.08s]
[0m19:20:57.426892 [info ] [MainThread]: 
[0m19:20:57.426892 [debug] [MainThread]: On master: Close
[0m19:20:57.548574 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:57.548574 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:20:57.549605 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:20:57.549605 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m19:20:57.550642 [info ] [MainThread]: 
[0m19:20:57.550642 [info ] [MainThread]: Finished running 1 table model, 1 project hook in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m19:20:57.551657 [debug] [MainThread]: Command end result
[0m19:20:57.587485 [info ] [MainThread]: 
[0m19:20:57.588491 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:20:57.589505 [info ] [MainThread]: 
[0m19:20:57.589505 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:20:57.591513 [debug] [MainThread]: Command `dbt build` succeeded at 19:20:57.591513 after 5.27 seconds
[0m19:20:57.591513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016357BEE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163576C34C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016359BCF460>]}
[0m19:20:57.592517 [debug] [MainThread]: Flushing usage events
[0m19:23:00.284884 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016355E4E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016358A125C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016358A123E0>]}


============================== 19:23:00.287901 | 2993fcc2-b281-4322-9185-c152bf08048f ==============================
[0m19:23:00.287901 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:23:00.288912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m19:23:01.005895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2993fcc2-b281-4322-9185-c152bf08048f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163560DBEB0>]}
[0m19:23:01.052551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2993fcc2-b281-4322-9185-c152bf08048f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163559234C0>]}
[0m19:23:01.053554 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:23:01.074245 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:23:01.314795 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:23:01.315800 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m19:23:01.498234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2993fcc2-b281-4322-9185-c152bf08048f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016371848130>]}
[0m19:23:01.624029 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2993fcc2-b281-4322-9185-c152bf08048f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001637184AF50>]}
[0m19:23:01.625035 [info ] [MainThread]: Found 1 operation, 2 models, 2 data tests, 841 macros
[0m19:23:01.627044 [info ] [MainThread]: 
[0m19:23:01.627044 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:01.629051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:23:01.641433 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:23:01.641433 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:23:01.642436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:02.273732 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.632 seconds
[0m19:23:02.275786 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:23:02.423446 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:23:02.431508 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:23:02.432509 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:23:02.432509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:02.990329 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.557 seconds
[0m19:23:02.991338 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:23:03.124930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2993fcc2-b281-4322-9185-c152bf08048f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016371848400>]}
[0m19:23:03.125941 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:23:03.126945 [info ] [MainThread]: 
[0m19:23:03.129962 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m19:23:03.129962 [info ] [Thread-1 (]: 1 of 1 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m19:23:03.130971 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m19:23:03.130971 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m19:23:03.138679 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m19:23:03.139695 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m19:23:03.160934 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m19:23:03.162942 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m19:23:03.162942 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:23:03.163946 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:04.351636 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.188 seconds
[0m19:23:04.370894 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m19:23:04.501349 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2993fcc2-b281-4322-9185-c152bf08048f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016357E2F4C0>]}
[0m19:23:04.502353 [info ] [Thread-1 (]: 1 of 1 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.37s]
[0m19:23:04.504383 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m19:23:04.505387 [info ] [MainThread]: 
[0m19:23:04.505387 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:23:04.550183 [debug] [MainThread]: Using snowflake connection "master"
[0m19:23:04.551187 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
update dqm.dq_dbt_test_results_central
        set is_active = 'N',
            deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
        where is_active = 'Y'
        and (model_refs like '%my_first_dbt_model%')
[0m19:23:04.551187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:05.243723 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.693 seconds
[0m19:23:05.245729 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:23:05.249733 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:23:05.249733 [debug] [MainThread]: Using snowflake connection "master"
[0m19:23:05.251125 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select 1
[0m19:23:05.346844 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.095 seconds
[0m19:23:05.347848 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.10s]
[0m19:23:05.348854 [info ] [MainThread]: 
[0m19:23:05.349860 [debug] [MainThread]: On master: Close
[0m19:23:05.482894 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:05.482894 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:23:05.483898 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:23:05.483898 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m19:23:05.485140 [info ] [MainThread]: 
[0m19:23:05.486145 [info ] [MainThread]: Finished running 1 table model, 1 project hook in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m19:23:05.486145 [debug] [MainThread]: Command end result
[0m19:23:05.524838 [info ] [MainThread]: 
[0m19:23:05.525864 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:05.526379 [info ] [MainThread]: 
[0m19:23:05.526891 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m19:23:05.528433 [debug] [MainThread]: Command `dbt build` succeeded at 19:23:05.528433 after 5.30 seconds
[0m19:23:05.528950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016355E4E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016357E4A830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000163713A05B0>]}
[0m19:23:05.529462 [debug] [MainThread]: Flushing usage events
[0m19:23:10.048560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D182E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D442A650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D442A470>]}


============================== 19:23:10.051574 | d6bd7661-f743-469e-aab9-5bf7f99ecfc6 ==============================
[0m19:23:10.051574 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:23:10.052580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m19:23:10.801410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd6bd7661-f743-469e-aab9-5bf7f99ecfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149ECCFE230>]}
[0m19:23:10.845833 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd6bd7661-f743-469e-aab9-5bf7f99ecfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149ECCFF3A0>]}
[0m19:23:10.847838 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:23:10.871190 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:23:11.109167 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:23:11.110170 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m19:23:11.479291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd6bd7661-f743-469e-aab9-5bf7f99ecfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149ED554FA0>]}
[0m19:23:11.608598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd6bd7661-f743-469e-aab9-5bf7f99ecfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149ED556AD0>]}
[0m19:23:11.608598 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 841 macros
[0m19:23:11.610606 [info ] [MainThread]: 
[0m19:23:11.611731 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:11.612738 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:23:11.623849 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:23:11.623849 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:23:11.623849 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:12.138766 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.514 seconds
[0m19:23:12.139776 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:23:12.267301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:23:12.275335 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:23:12.275335 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:23:12.275335 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:12.792812 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.517 seconds
[0m19:23:12.793815 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:23:12.908842 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd6bd7661-f743-469e-aab9-5bf7f99ecfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149ED554220>]}
[0m19:23:12.909848 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:23:12.909848 [info ] [MainThread]: 
[0m19:23:12.912860 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m19:23:12.912860 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m19:23:12.913869 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m19:23:12.914873 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m19:23:12.921013 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m19:23:12.922017 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m19:23:12.944511 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m19:23:12.946519 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m19:23:12.946519 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:23:12.947522 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:13.870349 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.923 seconds
[0m19:23:13.887490 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m19:23:14.038328 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd6bd7661-f743-469e-aab9-5bf7f99ecfc6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149ECCCFBE0>]}
[0m19:23:14.039332 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.12s]
[0m19:23:14.040338 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m19:23:14.040338 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:23:14.041341 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:23:14.041341 [info ] [Thread-3 (]: 2 of 3 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m19:23:14.042345 [info ] [Thread-4 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:23:14.042345 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m19:23:14.043350 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m19:23:14.043350 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:23:14.044361 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:23:14.048376 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:23:14.053592 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:23:14.054595 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:23:14.055600 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:23:14.069800 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:23:14.071810 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:23:14.073828 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:23:14.074831 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m19:23:14.075835 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:23:14.075835 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:23:14.076838 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:23:14.077841 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:23:14.756031 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.677 seconds
[0m19:23:14.760054 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:23:14.764216 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.688 seconds
[0m19:23:14.765503 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m19:23:14.882860 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.84s]
[0m19:23:14.883861 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:23:14.888361 [info ] [Thread-3 (]: 2 of 3 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 0.85s]
[0m19:23:14.889366 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:23:14.890371 [info ] [MainThread]: 
[0m19:23:14.890371 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:23:14.997859 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m19:23:15.002874 [debug] [MainThread]: Using snowflake connection "master"
[0m19:23:15.003885 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m19:23:15.003885 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:15.959863 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.955 seconds
[0m19:23:15.972874 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:23:15.976878 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:23:15.980979 [debug] [MainThread]: Using snowflake connection "master"
[0m19:23:15.981982 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8395102024078369'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8460161685943604'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m19:23:16.472261 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.490 seconds
[0m19:23:16.473763 [debug] [MainThread]: Using snowflake connection "master"
[0m19:23:16.474788 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m19:23:16.778145 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.303 seconds
[0m19:23:16.779149 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.80s]
[0m19:23:16.780153 [info ] [MainThread]: 
[0m19:23:16.781156 [debug] [MainThread]: On master: Close
[0m19:23:16.898672 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:16.898672 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:23:16.899675 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:23:16.899675 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m19:23:16.900705 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m19:23:16.900705 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:23:16.900705 [info ] [MainThread]: 
[0m19:23:16.901724 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m19:23:16.902730 [debug] [MainThread]: Command end result
[0m19:23:16.941674 [info ] [MainThread]: 
[0m19:23:16.941674 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:16.942684 [info ] [MainThread]: 
[0m19:23:16.943688 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:23:16.944692 [debug] [MainThread]: Command `dbt build` succeeded at 19:23:16.944692 after 6.96 seconds
[0m19:23:16.944692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149D182E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149ED23C340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149ED23D120>]}
[0m19:23:16.945696 [debug] [MainThread]: Flushing usage events
[0m19:23:28.864287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBA8502980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBAB0BE620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBAB0BE440>]}


============================== 19:23:28.867314 | ba0420b6-703b-41cb-943e-cf1e03273101 ==============================
[0m19:23:28.867314 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:23:28.868320 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:23:29.647369 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ba0420b6-703b-41cb-943e-cf1e03273101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBA8787DC0>]}
[0m19:23:29.696621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ba0420b6-703b-41cb-943e-cf1e03273101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC39F15D0>]}
[0m19:23:29.697624 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:23:29.722299 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:23:29.985843 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:23:29.985843 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:23:30.035314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ba0420b6-703b-41cb-943e-cf1e03273101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC3F07EE0>]}
[0m19:23:30.228206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ba0420b6-703b-41cb-943e-cf1e03273101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC3F05180>]}
[0m19:23:30.228206 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 841 macros
[0m19:23:30.230349 [info ] [MainThread]: 
[0m19:23:30.231353 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:23:30.232361 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:23:30.245170 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:23:30.245170 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:23:30.246174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:30.901382 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.655 seconds
[0m19:23:30.903508 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:23:31.030448 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:23:31.038681 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:23:31.038681 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:23:31.040013 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:23:31.628281 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.588 seconds
[0m19:23:31.629291 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:23:31.754720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ba0420b6-703b-41cb-943e-cf1e03273101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC3F05120>]}
[0m19:23:31.755816 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:23:31.755816 [info ] [MainThread]: 
[0m19:23:31.758827 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m19:23:31.758827 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m19:23:31.759832 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m19:23:31.760844 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m19:23:31.766886 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m19:23:31.767887 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m19:23:31.790639 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m19:23:31.792654 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m19:23:31.792654 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:23:31.793658 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:23:32.653074 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.860 seconds
[0m19:23:32.671236 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m19:23:32.784940 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ba0420b6-703b-41cb-943e-cf1e03273101', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBC399FBB0>]}
[0m19:23:32.785950 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.02s]
[0m19:23:32.786955 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m19:23:32.787958 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:23:32.787958 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:23:32.789012 [info ] [Thread-3 (]: 2 of 3 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m19:23:32.790018 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m19:23:32.789012 [info ] [Thread-4 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:23:32.790018 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:23:32.791024 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m19:23:32.802179 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:23:32.802179 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:23:32.808396 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:23:32.809409 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:23:32.822486 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:23:32.823611 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:23:32.826654 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:23:32.828668 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:23:32.828668 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:23:32.829676 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m19:23:32.829676 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:23:32.830681 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:23:32.830681 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:23:33.434342 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m19:23:33.437772 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m19:23:33.557373 [info ] [Thread-3 (]: 2 of 3 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 0.77s]
[0m19:23:33.558378 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:23:34.693756 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.863 seconds
[0m19:23:34.695758 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:23:34.822018 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.03s]
[0m19:23:34.823023 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:23:34.824029 [info ] [MainThread]: 
[0m19:23:34.825034 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:23:34.869366 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m19:23:34.875410 [debug] [MainThread]: Using snowflake connection "master"
[0m19:23:34.875410 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m19:23:34.876496 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:23:35.861798 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.985 seconds
[0m19:23:35.874947 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:23:35.879089 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:23:35.884129 [debug] [MainThread]: Using snowflake connection "master"
[0m19:23:35.884129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7683603763580322'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.030994176864624'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m19:23:36.278396 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.393 seconds
[0m19:23:36.278396 [debug] [MainThread]: Using snowflake connection "master"
[0m19:23:36.279406 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m19:23:36.612887 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.333 seconds
[0m19:23:36.613909 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.73s]
[0m19:23:36.614909 [info ] [MainThread]: 
[0m19:23:36.615915 [debug] [MainThread]: On master: Close
[0m19:23:36.736224 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:23:36.737227 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:23:36.737227 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:23:36.738231 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m19:23:36.738231 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m19:23:36.738231 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:23:36.739243 [info ] [MainThread]: 
[0m19:23:36.740246 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 6.51 seconds (6.51s).
[0m19:23:36.741249 [debug] [MainThread]: Command end result
[0m19:23:36.776589 [info ] [MainThread]: 
[0m19:23:36.777706 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:23:36.777706 [info ] [MainThread]: 
[0m19:23:36.778718 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:23:36.779721 [debug] [MainThread]: Command `dbt build` succeeded at 19:23:36.779721 after 7.97 seconds
[0m19:23:36.780900 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBA8502980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBAA4DF100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BBA8D74F70>]}
[0m19:23:36.780900 [debug] [MainThread]: Flushing usage events
[0m19:53:37.890945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBAC0A980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBD80E680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBD80E4A0>]}


============================== 19:53:37.894992 | 3e75d3fe-c867-44b9-a77d-ad5b95ba4a08 ==============================
[0m19:53:37.894992 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:53:37.896000 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_1', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:53:38.642334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e75d3fe-c867-44b9-a77d-ad5b95ba4a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBAE97DC0>]}
[0m19:53:38.686758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e75d3fe-c867-44b9-a77d-ad5b95ba4a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBA713550>]}
[0m19:53:38.688773 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:53:38.709960 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:53:38.956546 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:53:38.957549 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://tests\tabel1__unique_check.sql
[0m19:53:38.957549 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m19:53:39.198707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e75d3fe-c867-44b9-a77d-ad5b95ba4a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED620D7E0>]}
[0m19:53:39.341122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e75d3fe-c867-44b9-a77d-ad5b95ba4a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED639D240>]}
[0m19:53:39.341122 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 841 macros
[0m19:53:39.343284 [info ] [MainThread]: 
[0m19:53:39.344288 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:53:39.345292 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:53:39.356425 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:53:39.356425 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:53:39.357431 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:40.013502 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.656 seconds
[0m19:53:40.014503 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:53:40.148181 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:53:40.156213 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:53:40.157214 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:53:40.157214 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:53:40.667292 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.510 seconds
[0m19:53:40.669329 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:53:40.783949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e75d3fe-c867-44b9-a77d-ad5b95ba4a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED639D000>]}
[0m19:53:40.784953 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:53:40.785956 [info ] [MainThread]: 
[0m19:53:40.788991 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m19:53:40.788991 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m19:53:40.789995 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m19:53:40.789995 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m19:53:40.797252 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m19:53:40.798257 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m19:53:40.821957 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m19:53:40.823443 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m19:53:40.824752 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:53:40.824752 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:53:42.100664 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.275 seconds
[0m19:53:42.117679 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m19:53:42.235583 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3e75d3fe-c867-44b9-a77d-ad5b95ba4a08', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023ED60AFBE0>]}
[0m19:53:42.236587 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.44s]
[0m19:53:42.237612 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m19:53:42.238616 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:53:42.238616 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:53:42.239621 [info ] [Thread-3 (]: 2 of 3 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m19:53:42.239621 [info ] [Thread-4 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:53:42.240625 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m19:53:42.240625 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m19:53:42.241631 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:53:42.241631 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:53:42.253474 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:53:42.259482 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:53:42.260593 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:53:42.260593 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:53:42.273812 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:53:42.277218 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:53:42.279253 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:53:42.280257 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:53:42.280257 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m19:53:42.281265 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:53:42.281265 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:53:42.282273 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:53:43.141887 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.860 seconds
[0m19:53:43.144904 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m19:53:43.263316 [info ] [Thread-3 (]: 2 of 3 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 1.02s]
[0m19:53:43.264321 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:53:43.849288 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.567 seconds
[0m19:53:43.851312 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:53:43.971778 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.73s]
[0m19:53:43.972796 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:53:43.973802 [info ] [MainThread]: 
[0m19:53:43.974807 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:53:44.014290 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m19:53:44.020716 [debug] [MainThread]: Using snowflake connection "master"
[0m19:53:44.020716 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m19:53:44.021720 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:53:44.988539 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.967 seconds
[0m19:53:45.002421 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:53:45.007436 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:53:45.011708 [debug] [MainThread]: Using snowflake connection "master"
[0m19:53:45.011708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.022691011428833'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7296726703643799'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m19:53:45.484894 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.472 seconds
[0m19:53:45.484894 [debug] [MainThread]: Using snowflake connection "master"
[0m19:53:45.486111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m19:53:45.834336 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.347 seconds
[0m19:53:45.835508 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.83s]
[0m19:53:45.835508 [info ] [MainThread]: 
[0m19:53:45.836885 [debug] [MainThread]: On master: Close
[0m19:53:45.958052 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:53:45.958052 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:53:45.959056 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:53:45.959056 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m19:53:45.959056 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m19:53:45.960061 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:53:45.960061 [info ] [MainThread]: 
[0m19:53:45.961067 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 6.62 seconds (6.62s).
[0m19:53:45.962071 [debug] [MainThread]: Command end result
[0m19:53:45.999579 [info ] [MainThread]: 
[0m19:53:46.000626 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:53:46.000626 [info ] [MainThread]: 
[0m19:53:46.001630 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m19:53:46.002633 [debug] [MainThread]: Command `dbt build` succeeded at 19:53:46.002633 after 8.18 seconds
[0m19:53:46.003724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBAC0A980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBB484F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023EBAFABA90>]}
[0m19:53:46.003724 [debug] [MainThread]: Flushing usage events
[0m19:54:49.818350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3D12E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3FCFE5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3FCFE410>]}


============================== 19:54:49.821503 | 39f3a80b-9070-47c0-b704-d8c37ed7baea ==============================
[0m19:54:49.821503 [info ] [MainThread]: Running with dbt=1.8.7
[0m19:54:49.821503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m19:54:50.520901 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '39f3a80b-9070-47c0-b704-d8c37ed7baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3D3B7EB0>]}
[0m19:54:50.564257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '39f3a80b-9070-47c0-b704-d8c37ed7baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3F16B790>]}
[0m19:54:50.565262 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m19:54:50.585575 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m19:54:50.829495 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m19:54:50.829495 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m19:54:51.196521 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '39f3a80b-9070-47c0-b704-d8c37ed7baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE58E85B40>]}
[0m19:54:51.328877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '39f3a80b-9070-47c0-b704-d8c37ed7baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE589993F0>]}
[0m19:54:51.328877 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m19:54:51.330895 [info ] [MainThread]: 
[0m19:54:51.331899 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m19:54:51.332909 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m19:54:51.344499 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m19:54:51.345502 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m19:54:51.345502 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:51.944889 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.599 seconds
[0m19:54:51.945899 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m19:54:52.083693 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m19:54:52.091881 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m19:54:52.091881 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m19:54:52.092885 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:54:52.641305 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.548 seconds
[0m19:54:52.642309 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m19:54:52.762493 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '39f3a80b-9070-47c0-b704-d8c37ed7baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE589985B0>]}
[0m19:54:52.763542 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:54:52.764547 [info ] [MainThread]: 
[0m19:54:52.766559 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m19:54:52.767614 [info ] [Thread-1 (]: 1 of 4 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m19:54:52.767614 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m19:54:52.768625 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m19:54:52.775656 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m19:54:52.776659 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m19:54:52.799500 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m19:54:52.800505 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m19:54:52.800505 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m19:54:52.801510 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m19:54:53.909038 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.107 seconds
[0m19:54:53.925182 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m19:54:54.046206 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '39f3a80b-9070-47c0-b704-d8c37ed7baea', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE585DFB80>]}
[0m19:54:54.047209 [info ] [Thread-1 (]: 1 of 4 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.28s]
[0m19:54:54.048219 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m19:54:54.049225 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:54:54.049225 [debug] [Thread-4 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:54:54.050228 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:54:54.050228 [info ] [Thread-3 (]: 2 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m19:54:54.051409 [info ] [Thread-4 (]: 3 of 4 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m19:54:54.051409 [info ] [Thread-2 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m19:54:54.052413 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m19:54:54.052413 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m19:54:54.053416 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m19:54:54.053416 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:54:54.054419 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:54:54.054419 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:54:54.061441 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:54:54.064456 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:54:54.070675 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:54:54.071678 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:54:54.084835 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:54:54.084835 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:54:54.085841 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:54:54.087851 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:54:54.088854 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m19:54:54.091869 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:54:54.092885 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m19:54:54.093896 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m19:54:54.094902 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:54:54.095907 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m19:54:54.095907 [debug] [Thread-4 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m19:54:54.151715 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m19:54:54.152727 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:54:54.152727 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:54:54.795228 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.701 seconds
[0m19:54:54.799237 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m19:54:54.803223 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m19:54:54.805558 [debug] [Thread-4 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m19:54:54.931623 [error] [Thread-3 (]: 2 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.88s]
[0m19:54:54.932630 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m19:54:54.931623 [info ] [Thread-4 (]: 3 of 4 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 0.88s]
[0m19:54:54.933665 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m19:54:55.785203 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.633 seconds
[0m19:54:55.787785 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m19:54:55.912431 [info ] [Thread-2 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.86s]
[0m19:54:55.913435 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m19:54:55.914470 [info ] [MainThread]: 
[0m19:54:55.915481 [info ] [MainThread]: Running 1 on-run-end hook
[0m19:54:55.953709 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m19:54:55.958824 [debug] [MainThread]: Using snowflake connection "master"
[0m19:54:55.959827 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m19:54:55.959827 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:54:56.977277 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.017 seconds
[0m19:54:56.991469 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m19:54:56.995493 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m19:54:57.000593 [debug] [MainThread]: Using snowflake connection "master"
[0m19:54:57.000593 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8782029151916504'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8792102336883545'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8590154647827148'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m19:54:57.475440 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.473 seconds
[0m19:54:57.475440 [debug] [MainThread]: Using snowflake connection "master"
[0m19:54:57.476614 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m19:54:57.834450 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.357 seconds
[0m19:54:57.835457 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.84s]
[0m19:54:57.836462 [info ] [MainThread]: 
[0m19:54:57.836462 [debug] [MainThread]: On master: Close
[0m19:54:57.952410 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:54:57.953415 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m19:54:57.953415 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m19:54:57.953415 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m19:54:57.954411 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m19:54:57.954411 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m19:54:57.954411 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m19:54:57.955412 [info ] [MainThread]: 
[0m19:54:57.955412 [info ] [MainThread]: Finished running 1 table model, 3 data tests, 1 project hook in 0 hours 0 minutes and 6.62 seconds (6.62s).
[0m19:54:57.957501 [debug] [MainThread]: Command end result
[0m19:54:57.993050 [info ] [MainThread]: 
[0m19:54:57.994051 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m19:54:57.995052 [info ] [MainThread]: 
[0m19:54:57.995052 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m19:54:57.996053 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m19:54:57.997054 [info ] [MainThread]: 
[0m19:54:57.997054 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m19:54:57.998055 [info ] [MainThread]: 
[0m19:54:57.999056 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m19:54:58.000057 [debug] [MainThread]: Command `dbt build` failed at 19:54:58.000057 after 8.24 seconds
[0m19:54:58.001058 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3D12E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3CC00C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BE3F16A410>]}
[0m19:54:58.001058 [debug] [MainThread]: Flushing usage events
[0m20:11:58.451276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFD3592980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFD614E680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFD614E4A0>]}


============================== 20:11:58.453801 | 0eb1ca2e-ef1c-4050-a89b-b99342530a36 ==============================
[0m20:11:58.453801 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:11:58.454808 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_1', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:11:59.170006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0eb1ca2e-ef1c-4050-a89b-b99342530a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFD3817DC0>]}
[0m20:11:59.213710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0eb1ca2e-ef1c-4050-a89b-b99342530a36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFD3093550>]}
[0m20:11:59.215731 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:11:59.238096 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:11:59.484327 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:11:59.484327 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://tests\tabel1__unique_check.sql
[0m20:11:59.624803 [error] [MainThread]: Encountered an error:
Parsing Error
  at path []: A test must have a materialized value of 'test'
[0m20:11:59.626307 [debug] [MainThread]: Command `dbt build` failed at 20:11:59.626307 after 1.23 seconds
[0m20:11:59.627310 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFD3592980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFEEFC3460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EFEEFC0C70>]}
[0m20:11:59.627310 [debug] [MainThread]: Flushing usage events
[0m20:12:09.784501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E06D2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E32925F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E3292410>]}


============================== 20:12:09.788025 | 8aba2693-9e04-4742-a8ba-014f2106c3bd ==============================
[0m20:12:09.788025 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:12:09.789231 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:12:10.483324 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8aba2693-9e04-4742-a8ba-014f2106c3bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E095BEB0>]}
[0m20:12:10.526581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8aba2693-9e04-4742-a8ba-014f2106c3bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E270B790>]}
[0m20:12:10.527585 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:12:10.547917 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:12:10.808005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:12:10.809008 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://tests\tabel1__unique_check.sql
[0m20:12:11.018163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8aba2693-9e04-4742-a8ba-014f2106c3bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC1EDD80>]}
[0m20:12:11.149584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8aba2693-9e04-4742-a8ba-014f2106c3bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FBDB4BB0>]}
[0m20:12:11.149584 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m20:12:11.151593 [info ] [MainThread]: 
[0m20:12:11.152886 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:12:11.153889 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m20:12:11.164403 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m20:12:11.164403 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m20:12:11.165907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:11.807987 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.643 seconds
[0m20:12:11.810004 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m20:12:11.931781 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m20:12:11.939430 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m20:12:11.940435 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m20:12:11.940435 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:12:12.605097 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.665 seconds
[0m20:12:12.607230 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m20:12:12.728358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8aba2693-9e04-4742-a8ba-014f2106c3bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FBDB4F70>]}
[0m20:12:12.729379 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:12:12.730369 [info ] [MainThread]: 
[0m20:12:12.732535 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m20:12:12.733578 [debug] [Thread-2 (]: Began running node test.dbt_dataops.tabel1__unique_check
[0m20:12:12.733578 [info ] [Thread-1 (]: 1 of 5 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m20:12:12.734584 [info ] [Thread-2 (]: 2 of 5 START test tabel1__unique_check ......................................... [RUN]
[0m20:12:12.734584 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m20:12:12.735588 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.tabel1__unique_check'
[0m20:12:12.735588 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m20:12:12.736593 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.tabel1__unique_check
[0m20:12:12.743649 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m20:12:12.746661 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.tabel1__unique_check"
[0m20:12:12.747665 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m20:12:12.770533 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m20:12:12.771537 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.tabel1__unique_check
[0m20:12:12.784125 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.tabel1__unique_check"
[0m20:12:12.785615 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m20:12:12.786618 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:12:12.787619 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:12:12.790297 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.tabel1__unique_check"
[0m20:12:12.791303 [debug] [Thread-2 (]: On test.dbt_dataops.tabel1__unique_check: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.tabel1__unique_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select
    count(*) as failures,
    count(*) != 0 as should_warn,
    count(*) != 0 as should_error
from
    (
        with
            null_counts as (
                select
                    sum(
                        case
                            when id is null then 1
                            else 0
                        end
                    ) as id_null_count,
                    sum(
                        case
                            when column_1 is null then 1
                            else 0
                        end
                    ) as column_1_null_count,
                    sum(
                        case
                            when column_2 is null then 1
                            else 0
                        end
                    ) as column_2_null_count
                from
                    dev_dwdb.compute_wh.my_first_dbt_model
            )
        select
            'column_name' as column_name,
            case
                when id_null_count > 0 then 'id'
                else null
            end as id_result,
            case
                when column_1_null_count > 0 then 'column_1'
                else null
            end as column_1_result,
            case
                when column_2_null_count > 0 then 'column_2'
                else null
            end as column_2_result
        from
            null_counts
        where
            id_null_count > 0
            AND column_1_null_count > 0
            AND column_2_null_count > 0
    ) dbt_internal_test
      
    ) dbt_internal_test
[0m20:12:12.792308 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:12:13.686814 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.895 seconds
[0m20:12:13.694240 [debug] [Thread-2 (]: On test.dbt_dataops.tabel1__unique_check: Close
[0m20:12:13.843297 [error] [Thread-2 (]: 2 of 5 FAIL 1 tabel1__unique_check ............................................. [[31mFAIL 1[0m in 1.11s]
[0m20:12:13.844340 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.tabel1__unique_check
[0m20:12:14.665692 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.878 seconds
[0m20:12:14.678836 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m20:12:14.801434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8aba2693-9e04-4742-a8ba-014f2106c3bd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E09C2AD0>]}
[0m20:12:14.802437 [info ] [Thread-1 (]: 1 of 5 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 2.07s]
[0m20:12:14.803440 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m20:12:14.804446 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:12:14.804446 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:12:14.804446 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:12:14.805454 [info ] [Thread-4 (]: 3 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:12:14.806461 [info ] [Thread-3 (]: 4 of 5 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m20:12:14.806461 [info ] [Thread-2 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:12:14.807539 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:12:14.808553 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m20:12:14.808553 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.tabel1__unique_check, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m20:12:14.809563 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:12:14.809563 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:12:14.810568 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:12:14.818600 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:12:14.826831 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:12:14.832851 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:12:14.833856 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:12:14.835869 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:12:14.835869 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:12:14.837371 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:12:14.839776 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:12:14.842789 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:12:14.843795 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:12:14.844801 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:12:14.845817 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:12:14.845817 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:12:14.846822 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:12:14.846822 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m20:12:14.848829 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:12:14.849832 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:12:14.849832 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m20:12:15.605569 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.755 seconds
[0m20:12:15.607593 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:12:15.608601 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.762 seconds
[0m20:12:15.610611 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:12:15.735001 [info ] [Thread-2 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.93s]
[0m20:12:15.736012 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:12:15.735001 [error] [Thread-4 (]: 3 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.93s]
[0m20:12:15.737015 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:12:16.433306 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.583 seconds
[0m20:12:16.434310 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m20:12:16.610952 [info ] [Thread-3 (]: 4 of 5 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 1.80s]
[0m20:12:16.610952 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:12:16.612436 [info ] [MainThread]: 
[0m20:12:16.613774 [info ] [MainThread]: Running 1 on-run-end hook
[0m20:12:16.651687 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m20:12:16.658713 [debug] [MainThread]: Using snowflake connection "master"
[0m20:12:16.658713 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m20:12:16.659725 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:12:17.662090 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.002 seconds
[0m20:12:17.676235 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m20:12:17.680247 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m20:12:17.686824 [debug] [MainThread]: Using snowflake connection "master"
[0m20:12:17.686824 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('tabel1__unique_check' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'tabel1__unique_check'::varchar(4000) as test_name,
            'tabel1__unique_check'::varchar(10000) as test_name_long,
            'singular'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            ''::varchar(10000) as model_refs,
            split_part('', '.', 1)::varchar(255) as model_schema,
            split_part('', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.1067073345184326'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'tests\tabel1__unique_check.sql'::varchar(4000) as file_test_defined,
            'select     count(*) as failures,     count(*) != 0 as should_warn,     count(*) != 0 as should_error from     (         with             null_counts as (                 select                     sum(                         case                             when id is null then 1                             else 0                         end                     ) as id_null_count,                     sum(                         case                             when column_1 is null then 1                             else 0                         end                     ) as column_1_null_count,                     sum(                         case                             when column_2 is null then 1                             else 0                         end                     ) as column_2_null_count                 from                     dev_dwdb.compute_wh.my_first_dbt_model             )         select             ''column_name'' as column_name,             case                 when id_null_count > 0 then ''id''                 else null             end as id_result,             case                 when column_1_null_count > 0 then ''column_1''                 else null             end as column_1_result,             case                 when column_2_null_count > 0 then ''column_2''                 else null             end as column_2_result         from             null_counts         where             id_null_count > 0             AND column_1_null_count > 0             AND column_2_null_count > 0     ) dbt_internal_test'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9254472255706787'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9274616241455078'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8024122714996338'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m20:12:18.388222 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.700 seconds
[0m20:12:18.388222 [debug] [MainThread]: Using snowflake connection "master"
[0m20:12:18.389223 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select '' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'tabel1__unique_check'::varchar(4000) as test_name,
            'select     count(*) as failures,     count(*) != 0 as should_warn,     count(*) != 0 as should_error from     (         with             null_counts as (                 select                     sum(                         case                             when id is null then 1                             else 0                         end                     ) as id_null_count,                     sum(                         case                             when column_1 is null then 1                             else 0                         end                     ) as column_1_null_count,                     sum(                         case                             when column_2 is null then 1                             else 0                         end                     ) as column_2_null_count                 from                     dev_dwdb.compute_wh.my_first_dbt_model             )         select             ''column_name'' as column_name,             case                 when id_null_count > 0 then ''id''                 else null             end as id_result,             case                 when column_1_null_count > 0 then ''column_1''                 else null             end as column_1_result,             case                 when column_2_null_count > 0 then ''column_2''                 else null             end as column_2_result         from             null_counts         where             id_null_count > 0             AND column_1_null_count > 0             AND column_2_null_count > 0     ) dbt_internal_test'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m20:12:18.707699 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.317 seconds
[0m20:12:18.708703 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.03s]
[0m20:12:18.709710 [info ] [MainThread]: 
[0m20:12:18.710720 [debug] [MainThread]: On master: Close
[0m20:12:18.833073 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:12:18.833073 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m20:12:18.834577 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m20:12:18.834577 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m20:12:18.834577 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:12:18.835591 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m20:12:18.835591 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m20:12:18.836595 [info ] [MainThread]: 
[0m20:12:18.836595 [info ] [MainThread]: Finished running 4 data tests, 1 table model, 1 project hook in 0 hours 0 minutes and 7.68 seconds (7.68s).
[0m20:12:18.838600 [debug] [MainThread]: Command end result
[0m20:12:18.872947 [info ] [MainThread]: 
[0m20:12:18.874451 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:12:18.875472 [info ] [MainThread]: 
[0m20:12:18.876476 [error] [MainThread]: [31mFailure in test tabel1__unique_check (tests\tabel1__unique_check.sql)[0m
[0m20:12:18.876476 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:12:18.877479 [info ] [MainThread]: 
[0m20:12:18.877479 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\tests\tabel1__unique_check.sql
[0m20:12:18.878482 [info ] [MainThread]: 
[0m20:12:18.878482 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m20:12:18.879485 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:12:18.880489 [info ] [MainThread]: 
[0m20:12:18.880489 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m20:12:18.881494 [info ] [MainThread]: 
[0m20:12:18.881494 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m20:12:18.882497 [debug] [MainThread]: Command `dbt build` failed at 20:12:18.882497 after 9.15 seconds
[0m20:12:18.883499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E06D2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254E26AF460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000254FC762950>]}
[0m20:12:18.883499 [debug] [MainThread]: Flushing usage events
[0m20:18:42.192717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203FBE5E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203FEA1E650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203FEA1E470>]}


============================== 20:18:42.195803 | d580bdc9-6cc3-4d1e-bc8e-677a803ce7f2 ==============================
[0m20:18:42.195803 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:18:42.196811 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_1', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:18:42.952586 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd580bdc9-6cc3-4d1e-bc8e-677a803ce7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203FC0E7970>]}
[0m20:18:42.997991 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd580bdc9-6cc3-4d1e-bc8e-677a803ce7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203FB961C00>]}
[0m20:18:43.000074 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:18:43.020820 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:18:43.304570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:18:43.305572 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m20:18:43.482000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd580bdc9-6cc3-4d1e-bc8e-677a803ce7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020397970130>]}
[0m20:18:43.623951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd580bdc9-6cc3-4d1e-bc8e-677a803ce7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020397591C00>]}
[0m20:18:43.625009 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m20:18:43.627031 [info ] [MainThread]: 
[0m20:18:43.628031 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:18:43.629099 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m20:18:43.641176 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m20:18:43.642177 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m20:18:43.642177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:44.346895 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.704 seconds
[0m20:18:44.347897 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m20:18:44.474051 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m20:18:44.482574 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m20:18:44.483575 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m20:18:44.483575 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:18:45.043264 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.559 seconds
[0m20:18:45.044273 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m20:18:45.173103 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd580bdc9-6cc3-4d1e-bc8e-677a803ce7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203976DD3C0>]}
[0m20:18:45.173103 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:18:45.174117 [info ] [MainThread]: 
[0m20:18:45.177159 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m20:18:45.177159 [debug] [Thread-2 (]: Began running node test.dbt_dataops.tabel1__unique_check
[0m20:18:45.178158 [info ] [Thread-1 (]: 1 of 5 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m20:18:45.178158 [info ] [Thread-2 (]: 2 of 5 START test tabel1__unique_check ......................................... [RUN]
[0m20:18:45.178158 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m20:18:45.179654 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.tabel1__unique_check'
[0m20:18:45.179654 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m20:18:45.181059 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.tabel1__unique_check
[0m20:18:45.188219 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m20:18:45.191747 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.tabel1__unique_check"
[0m20:18:45.192756 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m20:18:45.202430 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.tabel1__unique_check
[0m20:18:45.221286 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m20:18:45.236848 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.tabel1__unique_check"
[0m20:18:45.238921 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m20:18:45.240022 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.tabel1__unique_check"
[0m20:18:45.240022 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:18:45.241312 [debug] [Thread-2 (]: On test.dbt_dataops.tabel1__unique_check: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.tabel1__unique_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select
    count(*) as failures,
    count(*) != 0 as should_warn,
    count(*) != 0 as should_error
from
    (
        with
            null_counts as (
                select
                    sum(
                        case
                            when id is null then 1
                            else 0
                        end
                    ) as id_null_count,
                    sum(
                        case
                            when column_1 is null then 1
                            else 0
                        end
                    ) as column_1_null_count,
                    sum(
                        case
                            when column_2 is null then 1
                            else 0
                        end
                    ) as column_2_null_count
                from
                    dev_dwdb.compute_wh.my_first_dbt_model
            )
        select
            'column_name' as column_name,
            case
                when id_null_count > 0 then 'id'
                else null
            end as id_result,
            case
                when column_1_null_count > 0 then 'column_1'
                else null
            end as column_1_result,
            case
                when column_2_null_count > 0 then 'column_2'
                else null
            end as column_2_result
        from
            null_counts
        where
            id_null_count > 0
            AND column_1_null_count > 0
            AND column_2_null_count > 0
    ) dbt_internal_test
      
    ) dbt_internal_test
[0m20:18:45.242314 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:18:45.243315 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:18:46.141303 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.899 seconds
[0m20:18:46.159173 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m20:18:46.281310 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd580bdc9-6cc3-4d1e-bc8e-677a803ce7f2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020397D26680>]}
[0m20:18:46.282323 [info ] [Thread-1 (]: 1 of 5 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.10s]
[0m20:18:46.283331 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m20:18:46.284344 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:18:46.285359 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:18:46.285359 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:18:46.285359 [info ] [Thread-4 (]: 3 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:18:46.286623 [info ] [Thread-3 (]: 4 of 5 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m20:18:46.286623 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:18:46.286623 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:18:46.288126 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m20:18:46.288126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_first_dbt_model, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m20:18:46.289256 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:18:46.289256 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:18:46.290284 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:18:46.299370 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:18:46.307966 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:18:46.314025 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:18:46.315474 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:18:46.317987 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:18:46.317987 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:18:46.319005 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:18:46.323229 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:18:46.324253 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:18:46.326361 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:18:46.327865 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:18:46.328890 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:18:46.329903 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:18:46.330922 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:18:46.330922 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m20:18:46.333034 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:18:46.334035 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:18:46.334035 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:18:46.958227 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.716 seconds
[0m20:18:46.962593 [debug] [Thread-2 (]: On test.dbt_dataops.tabel1__unique_check: Close
[0m20:18:46.964646 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m20:18:46.966665 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m20:18:47.009119 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m20:18:47.011288 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:18:47.083401 [error] [Thread-2 (]: 2 of 5 FAIL 1 tabel1__unique_check ............................................. [[31mFAIL 1[0m in 1.90s]
[0m20:18:47.084411 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.tabel1__unique_check
[0m20:18:47.088954 [info ] [Thread-3 (]: 4 of 5 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 0.80s]
[0m20:18:47.089992 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:18:47.132272 [error] [Thread-4 (]: 3 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.85s]
[0m20:18:47.133289 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:18:48.057973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.723 seconds
[0m20:18:48.060470 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:18:48.181904 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.89s]
[0m20:18:48.182921 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:18:48.184006 [info ] [MainThread]: 
[0m20:18:48.185023 [info ] [MainThread]: Running 1 on-run-end hook
[0m20:18:48.223956 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m20:18:48.229458 [debug] [MainThread]: Using snowflake connection "master"
[0m20:18:48.230483 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m20:18:48.230483 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:18:49.245040 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.014 seconds
[0m20:18:49.250217 [info ] [MainThread]: Test name: tabel1__unique_check
[0m20:18:49.251230 [info ] [MainThread]: Test type: singular
[0m20:18:49.252308 [info ] [MainThread]: Result node: SingularTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='tabel1__unique_check', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='tabel1__unique_check.sql', original_file_path='tests\\tabel1__unique_check.sql', unique_id='test.dbt_dataops.tabel1__unique_check', fqn=['dbt_dataops', 'tabel1__unique_check'], alias='tabel1__unique_check', checksum=FileHash(name='sha256', checksum='3a44da53a5f113ede9dc02ec80dc3dc5d739b6f56015c7277a74d089f78b7ca4'), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=['example_1'], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['example_1'], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\tests\\tabel1__unique_check.sql', unrendered_config={'tags': ['example_1']}, created_at=1740062530.9220967, config_call_dict={'tags': ['example_1']}, relation_name=None, raw_code="{{ config(tags=['example_1']\r\n\r\n) }}\r\nselect\r\n    count(*) as failures,\r\n    count(*) != 0 as should_warn,\r\n    count(*) != 0 as should_error\r\nfrom\r\n    (\r\n        with\r\n            null_counts as (\r\n                select\r\n                    sum(\r\n                        case\r\n                            when id is null then 1\r\n                            else 0\r\n                        end\r\n                    ) as id_null_count,\r\n                    sum(\r\n                        case\r\n                            when column_1 is null then 1\r\n                            else 0\r\n                        end\r\n                    ) as column_1_null_count,\r\n                    sum(\r\n                        case\r\n                            when column_2 is null then 1\r\n                            else 0\r\n                        end\r\n                    ) as column_2_null_count\r\n                from\r\n                    dev_dwdb.compute_wh.my_first_dbt_model\r\n            )\r\n        select\r\n            'column_name' as column_name,\r\n            case\r\n                when id_null_count > 0 then 'id'\r\n                else null\r\n            end as id_result,\r\n            case\r\n                when column_1_null_count > 0 then 'column_1'\r\n                else null\r\n            end as column_1_result,\r\n            case\r\n                when column_2_null_count > 0 then 'column_2'\r\n                else null\r\n            end as column_2_result\r\n        from\r\n            null_counts\r\n        where\r\n            id_null_count > 0\r\n            AND column_1_null_count > 0\r\n            AND column_2_null_count > 0\r\n    ) dbt_internal_test", language='sql', refs=[], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=[]), compiled_path='target\\compiled\\dbt_dataops\\tests\\tabel1__unique_check.sql', compiled=True, compiled_code="\nselect\n    count(*) as failures,\n    count(*) != 0 as should_warn,\n    count(*) != 0 as should_error\nfrom\n    (\n        with\n            null_counts as (\n                select\n                    sum(\n                        case\n                            when id is null then 1\n                            else 0\n                        end\n                    ) as id_null_count,\n                    sum(\n                        case\n                            when column_1 is null then 1\n                            else 0\n                        end\n                    ) as column_1_null_count,\n                    sum(\n                        case\n                            when column_2 is null then 1\n                            else 0\n                        end\n                    ) as column_2_null_count\n                from\n                    dev_dwdb.compute_wh.my_first_dbt_model\n            )\n        select\n            'column_name' as column_name,\n            case\n                when id_null_count > 0 then 'id'\n                else null\n            end as id_result,\n            case\n                when column_1_null_count > 0 then 'column_1'\n                else null\n            end as column_1_result,\n            case\n                when column_2_null_count > 0 then 'column_2'\n                else null\n            end as column_2_result\n        from\n            null_counts\n        where\n            id_null_count > 0\n            AND column_1_null_count > 0\n            AND column_2_null_count > 0\n    ) dbt_internal_test", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None))
[0m20:18:49.261973 [info ] [MainThread]: Test name: test_not_null_columns
[0m20:18:49.262996 [info ] [MainThread]: Test type: generic
[0m20:18:49.262996 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='test_not_null_columns_my_first_dbt_model_id__column_1__column_2', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5', fqn=['dbt_dataops', 'example', 'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'], alias='test_not_null_columns_my_first_dbt_model_id__column_1__column_2', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', unrendered_config={}, created_at=1740061491.112486, config_call_dict={}, relation_name=None, raw_code='{{ test_test_not_null_columns(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_dataops.test_test_not_null_columns', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', compiled=True, compiled_code="\n  \n  \n  with null_counts as (\n    select\n      \n        sum(case when id is null then 1 else 0 end) as id_null_count\n        , \n      \n        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count\n        , \n      \n        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count\n        \n      \n    from dev_dwdb.compute_wh.my_first_dbt_model\n    \n  )\nselect\n    'column_name' as column_name,\n    \n    case when id_null_count > 0 then 'id' else null end as id_result\n      , \n    \n    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result\n      , \n    \n    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result\n      \n    \n  from null_counts\n  where\n    \n      id_null_count > 0\n      \n        AND\n      \n    \n      column_1_null_count > 0\n      \n        AND\n      \n    \n      column_2_null_count > 0\n      \n    \n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='test_not_null_columns', kwargs={'columns': ['id', 'column_1', 'column_2'], 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:18:49.265018 [info ] [MainThread]: Test name: not_null
[0m20:18:49.265018 [info ] [MainThread]: Test type: generic
[0m20:18:49.266028 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740061491.111483, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:18:49.268037 [info ] [MainThread]: Test name: unique
[0m20:18:49.268540 [info ] [MainThread]: Test type: generic
[0m20:18:49.269542 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740061491.11048, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:18:49.270559 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m20:18:49.274660 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m20:18:49.280298 [debug] [MainThread]: Using snowflake connection "master"
[0m20:18:49.281309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('tabel1__unique_check' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'tabel1__unique_check'::varchar(4000) as test_name,
            'tabel1__unique_check'::varchar(10000) as test_name_long,
            'singular'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            ''::varchar(10000) as model_refs,
            split_part('', '.', 1)::varchar(255) as model_schema,
            split_part('', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9037470817565918'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'tests\tabel1__unique_check.sql'::varchar(4000) as file_test_defined,
            'select     count(*) as failures,     count(*) != 0 as should_warn,     count(*) != 0 as should_error from     (         with             null_counts as (                 select                     sum(                         case                             when id is null then 1                             else 0                         end                     ) as id_null_count,                     sum(                         case                             when column_1 is null then 1                             else 0                         end                     ) as column_1_null_count,                     sum(                         case                             when column_2 is null then 1                             else 0                         end                     ) as column_2_null_count                 from                     dev_dwdb.compute_wh.my_first_dbt_model             )         select             ''column_name'' as column_name,             case                 when id_null_count > 0 then ''id''                 else null             end as id_result,             case                 when column_1_null_count > 0 then ''column_1''                 else null             end as column_1_result,             case                 when column_2_null_count > 0 then ''column_2''                 else null             end as column_2_result         from             null_counts         where             id_null_count > 0             AND column_1_null_count > 0             AND column_2_null_count > 0     ) dbt_internal_test'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8008284568786621'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8456485271453857'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8937780857086182'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m20:18:49.761300 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.480 seconds
[0m20:18:49.762310 [debug] [MainThread]: Using snowflake connection "master"
[0m20:18:49.763317 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select '' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'tabel1__unique_check'::varchar(4000) as test_name,
            'select     count(*) as failures,     count(*) != 0 as should_warn,     count(*) != 0 as should_error from     (         with             null_counts as (                 select                     sum(                         case                             when id is null then 1                             else 0                         end                     ) as id_null_count,                     sum(                         case                             when column_1 is null then 1                             else 0                         end                     ) as column_1_null_count,                     sum(                         case                             when column_2 is null then 1                             else 0                         end                     ) as column_2_null_count                 from                     dev_dwdb.compute_wh.my_first_dbt_model             )         select             ''column_name'' as column_name,             case                 when id_null_count > 0 then ''id''                 else null             end as id_result,             case                 when column_1_null_count > 0 then ''column_1''                 else null             end as column_1_result,             case                 when column_2_null_count > 0 then ''column_2''                 else null             end as column_2_result         from             null_counts         where             id_null_count > 0             AND column_1_null_count > 0             AND column_2_null_count > 0     ) dbt_internal_test'::varchar(65535) as compiled_sql
          union all select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m20:18:50.069123 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.306 seconds
[0m20:18:50.070134 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.79s]
[0m20:18:50.071148 [info ] [MainThread]: 
[0m20:18:50.072158 [debug] [MainThread]: On master: Close
[0m20:18:50.195188 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:18:50.196214 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m20:18:50.196214 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m20:18:50.197262 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:18:50.197262 [debug] [MainThread]: Connection 'test.dbt_dataops.tabel1__unique_check' was properly closed.
[0m20:18:50.198260 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m20:18:50.198260 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m20:18:50.198260 [info ] [MainThread]: 
[0m20:18:50.199552 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 project hook in 0 hours 0 minutes and 6.57 seconds (6.57s).
[0m20:18:50.201573 [debug] [MainThread]: Command end result
[0m20:18:50.240458 [info ] [MainThread]: 
[0m20:18:50.241518 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:18:50.241518 [info ] [MainThread]: 
[0m20:18:50.242531 [error] [MainThread]: [31mFailure in test tabel1__unique_check (tests\tabel1__unique_check.sql)[0m
[0m20:18:50.243543 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:18:50.243543 [info ] [MainThread]: 
[0m20:18:50.244566 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\tests\tabel1__unique_check.sql
[0m20:18:50.245578 [info ] [MainThread]: 
[0m20:18:50.245578 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m20:18:50.246749 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:18:50.246749 [info ] [MainThread]: 
[0m20:18:50.248253 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m20:18:50.248253 [info ] [MainThread]: 
[0m20:18:50.249278 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m20:18:50.250295 [debug] [MainThread]: Command `dbt build` failed at 20:18:50.250295 after 8.11 seconds
[0m20:18:50.250295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203FBE5E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000203FDE3FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020397592F20>]}
[0m20:18:50.251307 [debug] [MainThread]: Flushing usage events
[0m20:20:06.686951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C127BE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C153825F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C15382410>]}


============================== 20:20:06.689869 | 6dcf7219-edf2-4602-b528-8d022bf72066 ==============================
[0m20:20:06.689869 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:20:06.689869 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:20:07.452855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6dcf7219-edf2-4602-b528-8d022bf72066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C12A4BEB0>]}
[0m20:20:07.497014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6dcf7219-edf2-4602-b528-8d022bf72066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C147FB790>]}
[0m20:20:07.498517 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:20:07.520382 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:20:07.769571 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:20:07.769571 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:20:07.823065 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6dcf7219-edf2-4602-b528-8d022bf72066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2E1D5C90>]}
[0m20:20:08.009963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6dcf7219-edf2-4602-b528-8d022bf72066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2E170550>]}
[0m20:20:08.011364 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m20:20:08.012668 [info ] [MainThread]: 
[0m20:20:08.013671 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:20:08.014773 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m20:20:08.027663 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m20:20:08.028668 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m20:20:08.028668 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:08.683701 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.655 seconds
[0m20:20:08.684704 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m20:20:08.813015 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m20:20:08.820554 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m20:20:08.821557 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m20:20:08.821557 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:20:09.404368 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.583 seconds
[0m20:20:09.406380 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m20:20:09.530528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6dcf7219-edf2-4602-b528-8d022bf72066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C15337D30>]}
[0m20:20:09.531560 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:20:09.532565 [info ] [MainThread]: 
[0m20:20:09.534577 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m20:20:09.535647 [debug] [Thread-2 (]: Began running node test.dbt_dataops.tabel1__unique_check
[0m20:20:09.535647 [info ] [Thread-1 (]: 1 of 5 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m20:20:09.536652 [info ] [Thread-2 (]: 2 of 5 START test tabel1__unique_check ......................................... [RUN]
[0m20:20:09.536652 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m20:20:09.537657 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.tabel1__unique_check'
[0m20:20:09.538656 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m20:20:09.538656 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.tabel1__unique_check
[0m20:20:09.545949 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m20:20:09.549469 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.tabel1__unique_check"
[0m20:20:09.550667 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m20:20:09.550667 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.tabel1__unique_check
[0m20:20:09.575031 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m20:20:09.589524 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.tabel1__unique_check"
[0m20:20:09.590534 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m20:20:09.591538 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:20:09.593586 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.tabel1__unique_check"
[0m20:20:09.593586 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:20:09.594856 [debug] [Thread-2 (]: On test.dbt_dataops.tabel1__unique_check: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.tabel1__unique_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select
    count(*) as failures,
    count(*) != 0 as should_warn,
    count(*) != 0 as should_error
from
    (
        with
            null_counts as (
                select
                    sum(
                        case
                            when id is null then 1
                            else 0
                        end
                    ) as id_null_count,
                    sum(
                        case
                            when column_1 is null then 1
                            else 0
                        end
                    ) as column_1_null_count,
                    sum(
                        case
                            when column_2 is null then 1
                            else 0
                        end
                    ) as column_2_null_count
                from
                    dev_dwdb.compute_wh.my_first_dbt_model
            )
        select
            'column_name' as column_name,
            case
                when id_null_count > 0 then 'id'
                else null
            end as id_result,
            case
                when column_1_null_count > 0 then 'column_1'
                else null
            end as column_1_result,
            case
                when column_2_null_count > 0 then 'column_2'
                else null
            end as column_2_result
        from
            null_counts
        where
            id_null_count > 0
            AND column_1_null_count > 0
            AND column_2_null_count > 0
    ) dbt_internal_test
      
    ) dbt_internal_test
[0m20:20:09.595926 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:20:10.500903 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.907 seconds
[0m20:20:10.518889 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m20:20:10.647641 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6dcf7219-edf2-4602-b528-8d022bf72066', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2E53ACB0>]}
[0m20:20:10.647641 [info ] [Thread-1 (]: 1 of 5 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.11s]
[0m20:20:10.649888 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m20:20:10.649888 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:20:10.650978 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:20:10.650978 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:20:10.651982 [info ] [Thread-4 (]: 3 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:20:10.651982 [info ] [Thread-3 (]: 4 of 5 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m20:20:10.652990 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:20:10.653991 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:20:10.653991 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m20:20:10.654992 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_first_dbt_model, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m20:20:10.654992 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:20:10.655993 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:20:10.656993 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:20:10.665513 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:20:10.674023 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:20:10.679538 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:20:10.681541 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:20:10.684543 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:20:10.684543 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:20:10.685544 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:20:10.688546 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:20:10.691052 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:20:10.691052 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:20:10.692053 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:20:10.694055 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:20:10.694055 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:20:10.695055 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:20:10.695055 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m20:20:10.697229 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:20:10.697229 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:20:10.698733 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:20:11.220622 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.624 seconds
[0m20:20:11.223624 [debug] [Thread-2 (]: On test.dbt_dataops.tabel1__unique_check: Close
[0m20:20:11.341580 [error] [Thread-2 (]: 2 of 5 FAIL 1 tabel1__unique_check ............................................. [[31mFAIL 1[0m in 1.80s]
[0m20:20:11.343604 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.tabel1__unique_check
[0m20:20:11.351832 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.657 seconds
[0m20:20:11.353839 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:20:11.729918 [error] [Thread-4 (]: 3 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.08s]
[0m20:20:11.730921 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:20:12.435593 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.737 seconds
[0m20:20:12.437613 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:20:12.448084 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.750 seconds
[0m20:20:12.449606 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m20:20:12.558794 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.90s]
[0m20:20:12.559876 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:20:12.572679 [info ] [Thread-3 (]: 4 of 5 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 1.92s]
[0m20:20:12.573682 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:20:12.574686 [info ] [MainThread]: 
[0m20:20:12.574686 [info ] [MainThread]: Running 1 on-run-end hook
[0m20:20:12.613139 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m20:20:12.618772 [debug] [MainThread]: Using snowflake connection "master"
[0m20:20:12.619795 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m20:20:12.619795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:20:13.596533 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.976 seconds
[0m20:20:13.602050 [info ] [MainThread]: Test name: tabel1__unique_check
[0m20:20:13.603053 [info ] [MainThread]: Test type: singular
[0m20:20:13.604200 [info ] [MainThread]: Result node: SingularTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='tabel1__unique_check', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='tabel1__unique_check.sql', original_file_path='tests\\tabel1__unique_check.sql', unique_id='test.dbt_dataops.tabel1__unique_check', fqn=['dbt_dataops', 'tabel1__unique_check'], alias='tabel1__unique_check', checksum=FileHash(name='sha256', checksum='3a44da53a5f113ede9dc02ec80dc3dc5d739b6f56015c7277a74d089f78b7ca4'), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=['example_1'], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['example_1'], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\tests\\tabel1__unique_check.sql', unrendered_config={'tags': ['example_1']}, created_at=1740062530.9220967, config_call_dict={'tags': ['example_1']}, relation_name=None, raw_code="{{ config(tags=['example_1']\r\n\r\n) }}\r\nselect\r\n    count(*) as failures,\r\n    count(*) != 0 as should_warn,\r\n    count(*) != 0 as should_error\r\nfrom\r\n    (\r\n        with\r\n            null_counts as (\r\n                select\r\n                    sum(\r\n                        case\r\n                            when id is null then 1\r\n                            else 0\r\n                        end\r\n                    ) as id_null_count,\r\n                    sum(\r\n                        case\r\n                            when column_1 is null then 1\r\n                            else 0\r\n                        end\r\n                    ) as column_1_null_count,\r\n                    sum(\r\n                        case\r\n                            when column_2 is null then 1\r\n                            else 0\r\n                        end\r\n                    ) as column_2_null_count\r\n                from\r\n                    dev_dwdb.compute_wh.my_first_dbt_model\r\n            )\r\n        select\r\n            'column_name' as column_name,\r\n            case\r\n                when id_null_count > 0 then 'id'\r\n                else null\r\n            end as id_result,\r\n            case\r\n                when column_1_null_count > 0 then 'column_1'\r\n                else null\r\n            end as column_1_result,\r\n            case\r\n                when column_2_null_count > 0 then 'column_2'\r\n                else null\r\n            end as column_2_result\r\n        from\r\n            null_counts\r\n        where\r\n            id_null_count > 0\r\n            AND column_1_null_count > 0\r\n            AND column_2_null_count > 0\r\n    ) dbt_internal_test", language='sql', refs=[], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=[]), compiled_path='target\\compiled\\dbt_dataops\\tests\\tabel1__unique_check.sql', compiled=True, compiled_code="\nselect\n    count(*) as failures,\n    count(*) != 0 as should_warn,\n    count(*) != 0 as should_error\nfrom\n    (\n        with\n            null_counts as (\n                select\n                    sum(\n                        case\n                            when id is null then 1\n                            else 0\n                        end\n                    ) as id_null_count,\n                    sum(\n                        case\n                            when column_1 is null then 1\n                            else 0\n                        end\n                    ) as column_1_null_count,\n                    sum(\n                        case\n                            when column_2 is null then 1\n                            else 0\n                        end\n                    ) as column_2_null_count\n                from\n                    dev_dwdb.compute_wh.my_first_dbt_model\n            )\n        select\n            'column_name' as column_name,\n            case\n                when id_null_count > 0 then 'id'\n                else null\n            end as id_result,\n            case\n                when column_1_null_count > 0 then 'column_1'\n                else null\n            end as column_1_result,\n            case\n                when column_2_null_count > 0 then 'column_2'\n                else null\n            end as column_2_result\n        from\n            null_counts\n        where\n            id_null_count > 0\n            AND column_1_null_count > 0\n            AND column_2_null_count > 0\n    ) dbt_internal_test", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None))
[0m20:20:13.614308 [info ] [MainThread]: Test name: not_null
[0m20:20:13.615311 [info ] [MainThread]: Test type: generic
[0m20:20:13.616314 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740061491.111483, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:20:13.617315 [info ] [MainThread]: Test name: unique
[0m20:20:13.618818 [info ] [MainThread]: Test type: generic
[0m20:20:13.618818 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740061491.11048, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:20:13.620328 [info ] [MainThread]: Test name: test_not_null_columns
[0m20:20:13.621334 [info ] [MainThread]: Test type: generic
[0m20:20:13.622342 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='test_not_null_columns_my_first_dbt_model_id__column_1__column_2', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5', fqn=['dbt_dataops', 'example', 'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'], alias='test_not_null_columns_my_first_dbt_model_id__column_1__column_2', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', unrendered_config={}, created_at=1740061491.112486, config_call_dict={}, relation_name=None, raw_code='{{ test_test_not_null_columns(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_dataops.test_test_not_null_columns', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', compiled=True, compiled_code="\n  \n  \n  with null_counts as (\n    select\n      \n        sum(case when id is null then 1 else 0 end) as id_null_count\n        , \n      \n        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count\n        , \n      \n        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count\n        \n      \n    from dev_dwdb.compute_wh.my_first_dbt_model\n    \n  )\nselect\n    'column_name' as column_name,\n    \n    case when id_null_count > 0 then 'id' else null end as id_result\n      , \n    \n    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result\n      , \n    \n    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result\n      \n    \n  from null_counts\n  where\n    \n      id_null_count > 0\n      \n        AND\n      \n    \n      column_1_null_count > 0\n      \n        AND\n      \n    \n      column_2_null_count > 0\n      \n    \n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='test_not_null_columns', kwargs={'columns': ['id', 'column_1', 'column_2'], 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:20:13.623355 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m20:20:13.627358 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m20:20:13.635145 [debug] [MainThread]: Using snowflake connection "master"
[0m20:20:13.635145 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('tabel1__unique_check' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'tabel1__unique_check'::varchar(4000) as test_name,
            'tabel1__unique_check'::varchar(10000) as test_name_long,
            'singular'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            ''::varchar(10000) as model_refs,
            split_part('', '.', 1)::varchar(255) as model_schema,
            split_part('', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8039238452911377'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'tests\tabel1__unique_check.sql'::varchar(4000) as file_test_defined,
            'select     count(*) as failures,     count(*) != 0 as should_warn,     count(*) != 0 as should_error from     (         with             null_counts as (                 select                     sum(                         case                             when id is null then 1                             else 0                         end                     ) as id_null_count,                     sum(                         case                             when column_1 is null then 1                             else 0                         end                     ) as column_1_null_count,                     sum(                         case                             when column_2 is null then 1                             else 0                         end                     ) as column_2_null_count                 from                     dev_dwdb.compute_wh.my_first_dbt_model             )         select             ''column_name'' as column_name,             case                 when id_null_count > 0 then ''id''                 else null             end as id_result,             case                 when column_1_null_count > 0 then ''column_1''                 else null             end as column_1_result,             case                 when column_2_null_count > 0 then ''column_2''                 else null             end as column_2_result         from             null_counts         where             id_null_count > 0             AND column_1_null_count > 0             AND column_2_null_count > 0     ) dbt_internal_test'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.076927900314331'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9038026332855225'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9176688194274902'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m20:20:14.151525 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.515 seconds
[0m20:20:14.152528 [debug] [MainThread]: Using snowflake connection "master"
[0m20:20:14.152528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select '' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'tabel1__unique_check'::varchar(4000) as test_name,
            'select     count(*) as failures,     count(*) != 0 as should_warn,     count(*) != 0 as should_error from     (         with             null_counts as (                 select                     sum(                         case                             when id is null then 1                             else 0                         end                     ) as id_null_count,                     sum(                         case                             when column_1 is null then 1                             else 0                         end                     ) as column_1_null_count,                     sum(                         case                             when column_2 is null then 1                             else 0                         end                     ) as column_2_null_count                 from                     dev_dwdb.compute_wh.my_first_dbt_model             )         select             ''column_name'' as column_name,             case                 when id_null_count > 0 then ''id''                 else null             end as id_result,             case                 when column_1_null_count > 0 then ''column_1''                 else null             end as column_1_result,             case                 when column_2_null_count > 0 then ''column_2''                 else null             end as column_2_result         from             null_counts         where             id_null_count > 0             AND column_1_null_count > 0             AND column_2_null_count > 0     ) dbt_internal_test'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m20:20:14.507944 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.354 seconds
[0m20:20:14.508945 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.88s]
[0m20:20:14.509449 [info ] [MainThread]: 
[0m20:20:14.510619 [debug] [MainThread]: On master: Close
[0m20:20:14.624859 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:20:14.624859 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m20:20:14.625974 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m20:20:14.625974 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:20:14.626978 [debug] [MainThread]: Connection 'test.dbt_dataops.tabel1__unique_check' was properly closed.
[0m20:20:14.626978 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m20:20:14.627988 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m20:20:14.628493 [info ] [MainThread]: 
[0m20:20:14.628493 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 project hook in 0 hours 0 minutes and 6.61 seconds (6.61s).
[0m20:20:14.630512 [debug] [MainThread]: Command end result
[0m20:20:14.665779 [info ] [MainThread]: 
[0m20:20:14.666783 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:20:14.667786 [info ] [MainThread]: 
[0m20:20:14.667786 [error] [MainThread]: [31mFailure in test tabel1__unique_check (tests\tabel1__unique_check.sql)[0m
[0m20:20:14.668788 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:20:14.668788 [info ] [MainThread]: 
[0m20:20:14.669816 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\tests\tabel1__unique_check.sql
[0m20:20:14.669816 [info ] [MainThread]: 
[0m20:20:14.670860 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m20:20:14.671863 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:20:14.671863 [info ] [MainThread]: 
[0m20:20:14.671863 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m20:20:14.673325 [info ] [MainThread]: 
[0m20:20:14.673325 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m20:20:14.675399 [debug] [MainThread]: Command `dbt build` failed at 20:20:14.675399 after 8.05 seconds
[0m20:20:14.675399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C127BE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C1479F460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023C2E170550>]}
[0m20:20:14.676444 [debug] [MainThread]: Flushing usage events
[0m20:21:07.258958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C952912980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95550E680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C95550E4A0>]}


============================== 20:21:07.262467 | b5d7312f-caf2-4967-82bb-4c20fad4fee2 ==============================
[0m20:21:07.262467 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:21:07.263654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m20:21:08.003822 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5d7312f-caf2-4967-82bb-4c20fad4fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C952B97DC0>]}
[0m20:21:08.049205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5d7312f-caf2-4967-82bb-4c20fad4fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C952413550>]}
[0m20:21:08.050712 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:21:08.071883 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:21:08.305719 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m20:21:08.306721 [debug] [MainThread]: Partial parsing: deleted file: dbt_dataops://tests\tabel1__unique_check.sql
[0m20:21:08.427979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b5d7312f-caf2-4967-82bb-4c20fad4fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96DE404C0>]}
[0m20:21:08.552257 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b5d7312f-caf2-4967-82bb-4c20fad4fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96E2F0D30>]}
[0m20:21:08.553306 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 841 macros
[0m20:21:08.554443 [info ] [MainThread]: 
[0m20:21:08.555444 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:21:08.556546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m20:21:08.569244 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m20:21:08.570258 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m20:21:08.570258 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:09.241887 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.672 seconds
[0m20:21:09.243901 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m20:21:09.373042 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m20:21:09.380618 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m20:21:09.380618 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m20:21:09.381623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:21:09.945529 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.564 seconds
[0m20:21:09.946535 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m20:21:10.066211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b5d7312f-caf2-4967-82bb-4c20fad4fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96E2F2A40>]}
[0m20:21:10.067290 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:21:10.068316 [info ] [MainThread]: 
[0m20:21:10.070495 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m20:21:10.071505 [info ] [Thread-1 (]: 1 of 4 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m20:21:10.072509 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m20:21:10.072509 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m20:21:10.080049 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m20:21:10.080049 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m20:21:10.103558 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m20:21:10.104567 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m20:21:10.104567 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:21:10.105577 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:21:11.048820 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.943 seconds
[0m20:21:11.066035 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m20:21:11.183522 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b5d7312f-caf2-4967-82bb-4c20fad4fee2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96DDAFBE0>]}
[0m20:21:11.183522 [info ] [Thread-1 (]: 1 of 4 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.11s]
[0m20:21:11.185534 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m20:21:11.185534 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:21:11.186537 [debug] [Thread-4 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:21:11.186537 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:21:11.186537 [info ] [Thread-3 (]: 2 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:21:11.187894 [info ] [Thread-4 (]: 3 of 4 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m20:21:11.187894 [info ] [Thread-2 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:21:11.189398 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:21:11.189398 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m20:21:11.190422 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m20:21:11.190422 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:21:11.191431 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:21:11.191431 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:21:11.200984 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:21:11.210802 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:21:11.216005 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:21:11.217010 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:21:11.218017 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:21:11.230104 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:21:11.230104 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:21:11.233125 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:21:11.237520 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:21:11.237520 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:21:11.239025 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:21:11.240034 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:21:11.240540 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:21:11.241545 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:21:11.241545 [debug] [Thread-4 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m20:21:11.243586 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:21:11.244594 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:21:11.244594 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:21:11.905318 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.665 seconds
[0m20:21:11.909336 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:21:11.915441 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m20:21:11.917448 [debug] [Thread-4 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m20:21:12.035773 [error] [Thread-3 (]: 2 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.85s]
[0m20:21:12.036779 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:21:12.048105 [info ] [Thread-4 (]: 3 of 4 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 0.86s]
[0m20:21:12.049105 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:21:13.071410 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.826 seconds
[0m20:21:13.073443 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:21:13.192155 [info ] [Thread-2 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.00s]
[0m20:21:13.193465 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:21:13.194468 [info ] [MainThread]: 
[0m20:21:13.194468 [info ] [MainThread]: Running 1 on-run-end hook
[0m20:21:13.233569 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m20:21:13.239488 [debug] [MainThread]: Using snowflake connection "master"
[0m20:21:13.239488 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m20:21:13.240491 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:21:14.239228 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.999 seconds
[0m20:21:14.244325 [info ] [MainThread]: Test name: not_null
[0m20:21:14.245327 [info ] [MainThread]: Test type: generic
[0m20:21:14.246347 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740061491.111483, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:21:14.255406 [info ] [MainThread]: Test name: test_not_null_columns
[0m20:21:14.256409 [info ] [MainThread]: Test type: generic
[0m20:21:14.256409 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='test_not_null_columns_my_first_dbt_model_id__column_1__column_2', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5', fqn=['dbt_dataops', 'example', 'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'], alias='test_not_null_columns_my_first_dbt_model_id__column_1__column_2', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', unrendered_config={}, created_at=1740061491.112486, config_call_dict={}, relation_name=None, raw_code='{{ test_test_not_null_columns(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_dataops.test_test_not_null_columns', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', compiled=True, compiled_code="\n  \n  \n  with null_counts as (\n    select\n      \n        sum(case when id is null then 1 else 0 end) as id_null_count\n        , \n      \n        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count\n        , \n      \n        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count\n        \n      \n    from dev_dwdb.compute_wh.my_first_dbt_model\n    \n  )\nselect\n    'column_name' as column_name,\n    \n    case when id_null_count > 0 then 'id' else null end as id_result\n      , \n    \n    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result\n      , \n    \n    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result\n      \n    \n  from null_counts\n  where\n    \n      id_null_count > 0\n      \n        AND\n      \n    \n      column_1_null_count > 0\n      \n        AND\n      \n    \n      column_2_null_count > 0\n      \n    \n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='test_not_null_columns', kwargs={'columns': ['id', 'column_1', 'column_2'], 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:21:14.258419 [info ] [MainThread]: Test name: unique
[0m20:21:14.259418 [info ] [MainThread]: Test type: generic
[0m20:21:14.259418 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740061491.11048, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:21:14.260853 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m20:21:14.264983 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m20:21:14.270247 [debug] [MainThread]: Using snowflake connection "master"
[0m20:21:14.270247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8463752269744873'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8587071895599365'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.000730037689209'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m20:21:14.707956 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.437 seconds
[0m20:21:14.709461 [debug] [MainThread]: Using snowflake connection "master"
[0m20:21:14.709461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m20:21:15.007583 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.298 seconds
[0m20:21:15.009087 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.74s]
[0m20:21:15.010099 [info ] [MainThread]: 
[0m20:21:15.011222 [debug] [MainThread]: On master: Close
[0m20:21:15.127962 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:21:15.127962 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m20:21:15.129466 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m20:21:15.129466 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m20:21:15.129466 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m20:21:15.130480 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m20:21:15.130480 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:21:15.131508 [info ] [MainThread]: 
[0m20:21:15.131508 [info ] [MainThread]: Finished running 1 table model, 3 data tests, 1 project hook in 0 hours 0 minutes and 6.58 seconds (6.58s).
[0m20:21:15.132512 [debug] [MainThread]: Command end result
[0m20:21:15.169442 [info ] [MainThread]: 
[0m20:21:15.170685 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:21:15.170685 [info ] [MainThread]: 
[0m20:21:15.171700 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m20:21:15.172704 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:21:15.172704 [info ] [MainThread]: 
[0m20:21:15.173708 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m20:21:15.173708 [info ] [MainThread]: 
[0m20:21:15.174711 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:21:15.176006 [debug] [MainThread]: Command `dbt build` failed at 20:21:15.176006 after 7.97 seconds
[0m20:21:15.177013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C952912980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C953184F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C96E2FC5E0>]}
[0m20:21:15.177013 [debug] [MainThread]: Flushing usage events
[0m20:23:20.013255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB7799E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB7A562620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB7A562440>]}


============================== 20:23:20.016266 | e2c98ada-51da-4a9e-8a8b-523230e9b809 ==============================
[0m20:23:20.016266 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:23:20.016770 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:23:20.748782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e2c98ada-51da-4a9e-8a8b-523230e9b809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB77C2BA90>]}
[0m20:23:20.792778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e2c98ada-51da-4a9e-8a8b-523230e9b809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB7FE6F670>]}
[0m20:23:20.794786 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:23:20.816248 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:23:21.060119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m20:23:21.060119 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m20:23:21.107621 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e2c98ada-51da-4a9e-8a8b-523230e9b809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB13444A90>]}
[0m20:23:21.284766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e2c98ada-51da-4a9e-8a8b-523230e9b809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB13447FD0>]}
[0m20:23:21.284766 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 841 macros
[0m20:23:21.286771 [info ] [MainThread]: 
[0m20:23:21.287782 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:23:21.288785 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m20:23:21.301846 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m20:23:21.302862 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m20:23:21.302862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:21.938853 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.636 seconds
[0m20:23:21.940357 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m20:23:22.063230 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m20:23:22.070866 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m20:23:22.070866 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m20:23:22.071868 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:23:22.615296 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.543 seconds
[0m20:23:22.617297 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m20:23:22.742203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e2c98ada-51da-4a9e-8a8b-523230e9b809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB1342EB60>]}
[0m20:23:22.742203 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:23:22.743340 [info ] [MainThread]: 
[0m20:23:22.746551 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m20:23:22.746551 [info ] [Thread-1 (]: 1 of 4 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m20:23:22.747555 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m20:23:22.748558 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m20:23:22.755456 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m20:23:22.755456 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m20:23:22.778821 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m20:23:22.780323 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m20:23:22.780323 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:23:22.781397 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:23:23.673307 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.892 seconds
[0m20:23:23.690531 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m20:23:24.062384 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e2c98ada-51da-4a9e-8a8b-523230e9b809', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB7FE6FBB0>]}
[0m20:23:24.063392 [info ] [Thread-1 (]: 1 of 4 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.31s]
[0m20:23:24.064398 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m20:23:24.065403 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:23:24.065403 [debug] [Thread-4 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:23:24.066406 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:23:24.066406 [info ] [Thread-3 (]: 2 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:23:24.067410 [info ] [Thread-4 (]: 3 of 4 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m20:23:24.067410 [info ] [Thread-2 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:23:24.068415 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:23:24.068415 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m20:23:24.069419 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m20:23:24.069419 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:23:24.070420 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:23:24.070925 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:23:24.080532 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:23:24.088572 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:23:24.093970 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:23:24.094974 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:23:24.107533 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:23:24.108545 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:23:24.108545 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:23:24.112203 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:23:24.113208 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:23:24.115219 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:23:24.116222 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:23:24.117226 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:23:24.117226 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:23:24.118232 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:23:24.118232 [debug] [Thread-4 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m20:23:24.120740 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:23:24.120740 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:23:24.121743 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:23:24.730674 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m20:23:24.731687 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m20:23:24.734696 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:23:24.736704 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:23:24.856120 [info ] [Thread-2 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.79s]
[0m20:23:24.857124 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:23:24.860650 [error] [Thread-3 (]: 2 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.79s]
[0m20:23:24.861653 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:23:25.781879 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.661 seconds
[0m20:23:25.783882 [debug] [Thread-4 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m20:23:25.904646 [info ] [Thread-4 (]: 3 of 4 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 1.84s]
[0m20:23:25.906001 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:23:25.907012 [info ] [MainThread]: 
[0m20:23:25.908025 [info ] [MainThread]: Running 1 on-run-end hook
[0m20:23:25.946346 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m20:23:25.951986 [debug] [MainThread]: Using snowflake connection "master"
[0m20:23:25.951986 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m20:23:25.952998 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:23:26.907989 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.955 seconds
[0m20:23:26.912516 [info ] [MainThread]: Test name: unique
[0m20:23:26.913564 [info ] [MainThread]: Test type: generic
[0m20:23:26.913564 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740061491.11048, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:23:26.923363 [info ] [MainThread]: Test name: not_null
[0m20:23:26.923363 [info ] [MainThread]: Test type: generic
[0m20:23:26.924366 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740061491.111483, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:23:26.925372 [info ] [MainThread]: Test name: test_not_null_columns
[0m20:23:26.926377 [info ] [MainThread]: Test type: generic
[0m20:23:26.927381 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='test_not_null_columns_my_first_dbt_model_id__column_1__column_2', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5', fqn=['dbt_dataops', 'example', 'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'], alias='test_not_null_columns_my_first_dbt_model_id__column_1__column_2', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', unrendered_config={}, created_at=1740061491.112486, config_call_dict={}, relation_name=None, raw_code='{{ test_test_not_null_columns(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_dataops.test_test_not_null_columns', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', compiled=True, compiled_code="\n  \n  \n  with null_counts as (\n    select\n      \n        sum(case when id is null then 1 else 0 end) as id_null_count\n        , \n      \n        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count\n        , \n      \n        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count\n        \n      \n    from dev_dwdb.compute_wh.my_first_dbt_model\n    \n  )\nselect\n    'column_name' as column_name,\n    \n    case when id_null_count > 0 then 'id' else null end as id_result\n      , \n    \n    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result\n      , \n    \n    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result\n      \n    \n  from null_counts\n  where\n    \n      id_null_count > 0\n      \n        AND\n      \n    \n      column_1_null_count > 0\n      \n        AND\n      \n    \n      column_2_null_count > 0\n      \n    \n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='test_not_null_columns', kwargs={'columns': ['id', 'column_1', 'column_2'], 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:23:26.929382 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m20:23:26.933921 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m20:23:26.939063 [debug] [MainThread]: Using snowflake connection "master"
[0m20:23:26.939063 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.785691499710083'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7922351360321045'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.836230754852295'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m20:23:27.399112 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.458 seconds
[0m20:23:27.399112 [debug] [MainThread]: Using snowflake connection "master"
[0m20:23:27.399112 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m20:23:27.703814 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.303 seconds
[0m20:23:27.704822 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.77s]
[0m20:23:27.705827 [info ] [MainThread]: 
[0m20:23:27.705827 [debug] [MainThread]: On master: Close
[0m20:23:27.818146 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:23:27.819275 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m20:23:27.819275 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m20:23:27.819275 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m20:23:27.820274 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m20:23:27.820274 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m20:23:27.820274 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:23:27.821742 [info ] [MainThread]: 
[0m20:23:27.821742 [info ] [MainThread]: Finished running 1 table model, 3 data tests, 1 project hook in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m20:23:27.823023 [debug] [MainThread]: Command end result
[0m20:23:27.859570 [info ] [MainThread]: 
[0m20:23:27.859570 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:23:27.860572 [info ] [MainThread]: 
[0m20:23:27.860572 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m20:23:27.862058 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:23:27.863064 [info ] [MainThread]: 
[0m20:23:27.863064 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m20:23:27.864069 [info ] [MainThread]: 
[0m20:23:27.865074 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:23:27.866198 [debug] [MainThread]: Command `dbt build` failed at 20:23:27.866198 after 7.91 seconds
[0m20:23:27.866198 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB7799E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB13446020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002CB138E1E70>]}
[0m20:23:27.867203 [debug] [MainThread]: Flushing usage events
[0m20:25:55.677511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD57C2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD837E680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD837E4A0>]}


============================== 20:25:55.680636 | 4280b34f-21d6-4283-829f-3cd64eb0c390 ==============================
[0m20:25:55.680636 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:25:55.682141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m20:25:56.403563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4280b34f-21d6-4283-829f-3cd64eb0c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD5A47DC0>]}
[0m20:25:56.447937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4280b34f-21d6-4283-829f-3cd64eb0c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD52B3550>]}
[0m20:25:56.448940 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:25:56.470292 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:25:56.710006 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:25:56.710006 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m20:25:56.873845 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4280b34f-21d6-4283-829f-3cd64eb0c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DF11C4130>]}
[0m20:25:57.000557 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4280b34f-21d6-4283-829f-3cd64eb0c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DF0E16080>]}
[0m20:25:57.002063 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 841 macros
[0m20:25:57.003072 [info ] [MainThread]: 
[0m20:25:57.004075 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:25:57.005078 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m20:25:57.018099 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m20:25:57.019101 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m20:25:57.019101 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:57.661490 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.643 seconds
[0m20:25:57.664977 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m20:25:57.797158 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m20:25:57.805914 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m20:25:57.806917 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m20:25:57.806917 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:25:58.346895 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.540 seconds
[0m20:25:58.348283 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m20:25:58.469753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4280b34f-21d6-4283-829f-3cd64eb0c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DF11C8670>]}
[0m20:25:58.469753 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:25:58.471146 [info ] [MainThread]: 
[0m20:25:58.473923 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m20:25:58.473923 [info ] [Thread-1 (]: 1 of 4 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m20:25:58.474932 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m20:25:58.474932 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m20:25:58.482304 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m20:25:58.483308 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m20:25:58.504765 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m20:25:58.506774 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m20:25:58.506774 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:25:58.507797 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:25:59.408643 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.900 seconds
[0m20:25:59.426780 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m20:25:59.544404 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4280b34f-21d6-4283-829f-3cd64eb0c390', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DF0C5FBE0>]}
[0m20:25:59.545415 [info ] [Thread-1 (]: 1 of 4 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.07s]
[0m20:25:59.546421 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m20:25:59.547427 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:25:59.547427 [debug] [Thread-4 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:25:59.547427 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:25:59.548432 [info ] [Thread-3 (]: 2 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:25:59.548432 [info ] [Thread-4 (]: 3 of 4 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m20:25:59.549438 [info ] [Thread-2 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:25:59.550447 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:25:59.550447 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m20:25:59.551449 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m20:25:59.551954 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:25:59.551954 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:25:59.552967 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:25:59.562869 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:25:59.571431 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:25:59.576565 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:25:59.577579 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:25:59.586631 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:25:59.592522 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:25:59.595543 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:25:59.595543 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:25:59.598568 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:25:59.599572 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:25:59.600581 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:25:59.601582 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:25:59.601582 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:25:59.602601 [debug] [Thread-4 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m20:25:59.602601 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:25:59.603702 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:25:59.603702 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:25:59.605713 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:26:00.163736 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.560 seconds
[0m20:26:00.166745 [debug] [Thread-4 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m20:26:00.284621 [info ] [Thread-4 (]: 3 of 4 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 0.73s]
[0m20:26:00.285624 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:26:01.416344 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.814 seconds
[0m20:26:01.418775 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:26:01.422058 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.817 seconds
[0m20:26:01.424121 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:26:01.537906 [error] [Thread-3 (]: 2 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.99s]
[0m20:26:01.539993 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:26:01.544281 [info ] [Thread-2 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.99s]
[0m20:26:01.545287 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:26:01.546307 [info ] [MainThread]: 
[0m20:26:01.547317 [info ] [MainThread]: Running 1 on-run-end hook
[0m20:26:01.588486 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m20:26:01.594115 [debug] [MainThread]: Using snowflake connection "master"
[0m20:26:01.594115 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m20:26:01.595118 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:02.570164 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.975 seconds
[0m20:26:02.574718 [info ] [MainThread]: Test name: test_not_null_columns
[0m20:26:02.575721 [info ] [MainThread]: Test type: generic
[0m20:26:02.576727 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='test_not_null_columns_my_first_dbt_model_id__column_1__column_2', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5', fqn=['dbt_dataops', 'example', 'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'], alias='test_not_null_columns_my_first_dbt_model_id__column_1__column_2', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', unrendered_config={}, created_at=1740061491.112486, config_call_dict={}, relation_name=None, raw_code='{{ test_test_not_null_columns(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_dataops.test_test_not_null_columns', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', compiled=True, compiled_code="\n  \n  \n  with null_counts as (\n    select\n      \n        sum(case when id is null then 1 else 0 end) as id_null_count\n        , \n      \n        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count\n        , \n      \n        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count\n        \n      \n    from dev_dwdb.compute_wh.my_first_dbt_model\n    \n  )\nselect\n    'column_name' as column_name,\n    \n    case when id_null_count > 0 then 'id' else null end as id_result\n      , \n    \n    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result\n      , \n    \n    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result\n      \n    \n  from null_counts\n  where\n    \n      id_null_count > 0\n      \n        AND\n      \n    \n      column_1_null_count > 0\n      \n        AND\n      \n    \n      column_2_null_count > 0\n      \n    \n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='test_not_null_columns', kwargs={'columns': ['id', 'column_1', 'column_2'], 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:26:02.586481 [info ] [MainThread]: Test name: not_null
[0m20:26:02.587485 [info ] [MainThread]: Test type: generic
[0m20:26:02.588490 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740061491.111483, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:26:02.589493 [info ] [MainThread]: Test name: unique
[0m20:26:02.590521 [info ] [MainThread]: Test type: generic
[0m20:26:02.590521 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740061491.11048, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:26:02.592771 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m20:26:02.596843 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m20:26:02.603150 [debug] [MainThread]: Using snowflake connection "master"
[0m20:26:02.604153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7331690788269043'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9884684085845947'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9928321838378906'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m20:26:03.070749 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.466 seconds
[0m20:26:03.070749 [debug] [MainThread]: Using snowflake connection "master"
[0m20:26:03.072253 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic for both generic and singular tests
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      with current_models as (select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2' as test_name,
            'models\example\schema.yml' as test_path
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'not_null_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'unique_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          ),
      split_models as (
        select distinct 
          value as model_name,
          test_name,
          test_path
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
        where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
      )
      or exists (
        select 1 
        from (
      with current_models as (select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2' as test_name,
            'models\example\schema.yml' as test_path
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'not_null_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'unique_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          ),
      split_models as (
        select distinct 
          value as model_name,
          test_name,
          test_path
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
        where dqm.dq_dbt_test_results_central.file_test_defined = current_models.test_path
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m20:26:03.414202 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.342 seconds
[0m20:26:03.416231 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.82s]
[0m20:26:03.417236 [info ] [MainThread]: 
[0m20:26:03.417236 [debug] [MainThread]: On master: Close
[0m20:26:03.534477 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:03.535478 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m20:26:03.535478 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m20:26:03.535478 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m20:26:03.536479 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m20:26:03.536479 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m20:26:03.537480 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:26:03.537480 [info ] [MainThread]: 
[0m20:26:03.538944 [info ] [MainThread]: Finished running 1 table model, 3 data tests, 1 project hook in 0 hours 0 minutes and 6.53 seconds (6.53s).
[0m20:26:03.539957 [debug] [MainThread]: Command end result
[0m20:26:03.578669 [info ] [MainThread]: 
[0m20:26:03.579674 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:26:03.580678 [info ] [MainThread]: 
[0m20:26:03.581680 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m20:26:03.581680 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:26:03.583020 [info ] [MainThread]: 
[0m20:26:03.583020 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m20:26:03.584024 [info ] [MainThread]: 
[0m20:26:03.584024 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m20:26:03.586114 [debug] [MainThread]: Command `dbt build` failed at 20:26:03.585027 after 7.97 seconds
[0m20:26:03.586114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD57C2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD52B3550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DF0D13040>]}
[0m20:26:03.587118 [debug] [MainThread]: Flushing usage events
[0m20:26:13.480338 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9C03E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9EC3E680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9EC3E4A0>]}


============================== 20:26:13.483860 | b1ba7920-2a0a-4c53-89b4-72a01dbdcbbc ==============================
[0m20:26:13.483860 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:26:13.484864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m20:26:14.187398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b1ba7920-2a0a-4c53-89b4-72a01dbdcbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9C2C7DC0>]}
[0m20:26:14.231550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b1ba7920-2a0a-4c53-89b4-72a01dbdcbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9BB33550>]}
[0m20:26:14.233059 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:26:14.253218 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:26:14.489756 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m20:26:14.490759 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://tests\tabel1__unique_check.sql
[0m20:26:14.719344 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b1ba7920-2a0a-4c53-89b4-72a01dbdcbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB7B5A7A0>]}
[0m20:26:14.851669 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b1ba7920-2a0a-4c53-89b4-72a01dbdcbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB7B3D7E0>]}
[0m20:26:14.852894 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m20:26:14.853897 [info ] [MainThread]: 
[0m20:26:14.855400 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:26:14.856463 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m20:26:14.868101 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m20:26:14.869104 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m20:26:14.869104 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:15.519554 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.650 seconds
[0m20:26:15.520561 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m20:26:15.664398 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m20:26:15.671998 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m20:26:15.673030 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m20:26:15.673030 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:26:16.199136 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.526 seconds
[0m20:26:16.200148 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m20:26:16.329555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b1ba7920-2a0a-4c53-89b4-72a01dbdcbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB7B3D360>]}
[0m20:26:16.329555 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:26:16.330663 [info ] [MainThread]: 
[0m20:26:16.333159 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m20:26:16.334166 [debug] [Thread-2 (]: Began running node test.dbt_dataops.tabel1__unique_check
[0m20:26:16.334166 [info ] [Thread-1 (]: 1 of 5 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m20:26:16.335313 [info ] [Thread-2 (]: 2 of 5 START test tabel1__unique_check ......................................... [RUN]
[0m20:26:16.335313 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m20:26:16.336317 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.tabel1__unique_check'
[0m20:26:16.336317 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m20:26:16.337320 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.tabel1__unique_check
[0m20:26:16.344928 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m20:26:16.348469 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.tabel1__unique_check"
[0m20:26:16.349472 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m20:26:16.361819 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.tabel1__unique_check
[0m20:26:16.371786 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m20:26:16.386612 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.tabel1__unique_check"
[0m20:26:16.387637 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m20:26:16.388897 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.tabel1__unique_check"
[0m20:26:16.389900 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:26:16.389900 [debug] [Thread-2 (]: On test.dbt_dataops.tabel1__unique_check: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.tabel1__unique_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select
    count(*) as failures,
    count(*) != 0 as should_warn,
    count(*) != 0 as should_error
from
    (
        with
            null_counts as (
                select
                    sum(
                        case
                            when id is null then 1
                            else 0
                        end
                    ) as id_null_count,
                    sum(
                        case
                            when column_1 is null then 1
                            else 0
                        end
                    ) as column_1_null_count,
                    sum(
                        case
                            when column_2 is null then 1
                            else 0
                        end
                    ) as column_2_null_count
                from
                    dev_dwdb.compute_wh.my_first_dbt_model
            )
        select
            'column_name' as column_name,
            case
                when id_null_count > 0 then 'id'
                else null
            end as id_result,
            case
                when column_1_null_count > 0 then 'column_1'
                else null
            end as column_1_result,
            case
                when column_2_null_count > 0 then 'column_2'
                else null
            end as column_2_result
        from
            null_counts
        where
            id_null_count > 0
            AND column_1_null_count > 0
            AND column_2_null_count > 0
    ) dbt_internal_test
      
    ) dbt_internal_test
[0m20:26:16.389900 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:26:16.391205 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:26:18.328524 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.938 seconds
[0m20:26:18.345755 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m20:26:18.524692 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b1ba7920-2a0a-4c53-89b4-72a01dbdcbbc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB7F298A0>]}
[0m20:26:18.525697 [info ] [Thread-1 (]: 1 of 5 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 2.19s]
[0m20:26:18.526701 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m20:26:18.527717 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:26:18.527717 [debug] [Thread-3 (]: Began running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:26:18.528721 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:26:18.528721 [info ] [Thread-4 (]: 3 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:26:18.529726 [info ] [Thread-3 (]: 4 of 5 START test test_not_null_columns_my_first_dbt_model_id__column_1__column_2  [RUN]
[0m20:26:18.530732 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:26:18.531731 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:26:18.532237 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5'
[0m20:26:18.532237 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_first_dbt_model, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m20:26:18.533244 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:26:18.533244 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:26:18.534250 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:26:18.544928 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:26:18.554846 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:26:18.559878 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:26:18.560886 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:26:18.565395 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:26:18.565395 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:26:18.566478 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:26:18.569493 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:26:18.570605 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:26:18.573115 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:26:18.573115 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:26:18.575446 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"
[0m20:26:18.575446 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:26:18.576454 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:26:18.576454 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
  
  
  with null_counts as (
    select
      
        sum(case when id is null then 1 else 0 end) as id_null_count
        , 
      
        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count
        , 
      
        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count
        
      
    from dev_dwdb.compute_wh.my_first_dbt_model
    
  )
select
    'column_name' as column_name,
    
    case when id_null_count > 0 then 'id' else null end as id_result
      , 
    
    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result
      , 
    
    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result
      
    
  from null_counts
  where
    
      id_null_count > 0
      
        AND
      
    
      column_1_null_count > 0
      
        AND
      
    
      column_2_null_count > 0
      
    

      
    ) dbt_internal_test
[0m20:26:18.578484 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:26:18.579487 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:26:18.579487 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m20:26:19.205688 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.815 seconds
[0m20:26:19.208695 [debug] [Thread-2 (]: On test.dbt_dataops.tabel1__unique_check: Close
[0m20:26:19.212243 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m20:26:19.213247 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:26:19.228231 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.653 seconds
[0m20:26:19.230250 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:26:19.528897 [error] [Thread-4 (]: 3 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.00s]
[0m20:26:19.529903 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:26:19.532743 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.00s]
[0m20:26:19.533752 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:26:19.532743 [error] [Thread-2 (]: 2 of 5 FAIL 1 tabel1__unique_check ............................................. [[31mFAIL 1[0m in 3.20s]
[0m20:26:19.534757 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.tabel1__unique_check
[0m20:26:20.148346 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.569 seconds
[0m20:26:20.150356 [debug] [Thread-3 (]: On test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5: Close
[0m20:26:20.270594 [info ] [Thread-3 (]: 4 of 5 PASS test_not_null_columns_my_first_dbt_model_id__column_1__column_2 .... [[32mPASS[0m in 1.74s]
[0m20:26:20.271596 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5
[0m20:26:20.272841 [info ] [MainThread]: 
[0m20:26:20.273845 [info ] [MainThread]: Running 1 on-run-end hook
[0m20:26:20.311643 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m20:26:20.317025 [debug] [MainThread]: Using snowflake connection "master"
[0m20:26:20.318028 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m20:26:20.318028 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:26:21.303438 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.985 seconds
[0m20:26:21.307444 [info ] [MainThread]: Test name: not_null
[0m20:26:21.308445 [info ] [MainThread]: Test type: generic
[0m20:26:21.309555 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740061491.111483, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:26:21.319102 [info ] [MainThread]: Test name: unique
[0m20:26:21.319102 [info ] [MainThread]: Test type: generic
[0m20:26:21.320106 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740061491.11048, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:26:21.321611 [info ] [MainThread]: Test name: tabel1__unique_check
[0m20:26:21.322626 [info ] [MainThread]: Test type: singular
[0m20:26:21.323708 [info ] [MainThread]: Result node: SingularTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='tabel1__unique_check', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='tabel1__unique_check.sql', original_file_path='tests\\tabel1__unique_check.sql', unique_id='test.dbt_dataops.tabel1__unique_check', fqn=['dbt_dataops', 'tabel1__unique_check'], alias='tabel1__unique_check', checksum=FileHash(name='sha256', checksum='3a44da53a5f113ede9dc02ec80dc3dc5d739b6f56015c7277a74d089f78b7ca4'), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=['example_1'], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['example_1'], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\tests\\tabel1__unique_check.sql', unrendered_config={'tags': ['example_1']}, created_at=1740063374.6253035, config_call_dict={'tags': ['example_1']}, relation_name=None, raw_code="{{ config(tags=['example_1']\r\n\r\n) }}\r\nselect\r\n    count(*) as failures,\r\n    count(*) != 0 as should_warn,\r\n    count(*) != 0 as should_error\r\nfrom\r\n    (\r\n        with\r\n            null_counts as (\r\n                select\r\n                    sum(\r\n                        case\r\n                            when id is null then 1\r\n                            else 0\r\n                        end\r\n                    ) as id_null_count,\r\n                    sum(\r\n                        case\r\n                            when column_1 is null then 1\r\n                            else 0\r\n                        end\r\n                    ) as column_1_null_count,\r\n                    sum(\r\n                        case\r\n                            when column_2 is null then 1\r\n                            else 0\r\n                        end\r\n                    ) as column_2_null_count\r\n                from\r\n                    dev_dwdb.compute_wh.my_first_dbt_model\r\n            )\r\n        select\r\n            'column_name' as column_name,\r\n            case\r\n                when id_null_count > 0 then 'id'\r\n                else null\r\n            end as id_result,\r\n            case\r\n                when column_1_null_count > 0 then 'column_1'\r\n                else null\r\n            end as column_1_result,\r\n            case\r\n                when column_2_null_count > 0 then 'column_2'\r\n                else null\r\n            end as column_2_result\r\n        from\r\n            null_counts\r\n        where\r\n            id_null_count > 0\r\n            AND column_1_null_count > 0\r\n            AND column_2_null_count > 0\r\n    ) dbt_internal_test", language=<ModelLanguage.sql: 'sql'>, refs=[], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=[]), compiled_path='target\\compiled\\dbt_dataops\\tests\\tabel1__unique_check.sql', compiled=True, compiled_code="\nselect\n    count(*) as failures,\n    count(*) != 0 as should_warn,\n    count(*) != 0 as should_error\nfrom\n    (\n        with\n            null_counts as (\n                select\n                    sum(\n                        case\n                            when id is null then 1\n                            else 0\n                        end\n                    ) as id_null_count,\n                    sum(\n                        case\n                            when column_1 is null then 1\n                            else 0\n                        end\n                    ) as column_1_null_count,\n                    sum(\n                        case\n                            when column_2 is null then 1\n                            else 0\n                        end\n                    ) as column_2_null_count\n                from\n                    dev_dwdb.compute_wh.my_first_dbt_model\n            )\n        select\n            'column_name' as column_name,\n            case\n                when id_null_count > 0 then 'id'\n                else null\n            end as id_result,\n            case\n                when column_1_null_count > 0 then 'column_1'\n                else null\n            end as column_1_result,\n            case\n                when column_2_null_count > 0 then 'column_2'\n                else null\n            end as column_2_result\n        from\n            null_counts\n        where\n            id_null_count > 0\n            AND column_1_null_count > 0\n            AND column_2_null_count > 0\n    ) dbt_internal_test", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None))
[0m20:26:21.325984 [info ] [MainThread]: Test name: test_not_null_columns
[0m20:26:21.325984 [info ] [MainThread]: Test type: generic
[0m20:26:21.327400 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='test_not_null_columns_my_first_dbt_model_id__column_1__column_2', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5', fqn=['dbt_dataops', 'example', 'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'], alias='test_not_null_columns_my_first_dbt_model_id__column_1__column_2', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', unrendered_config={}, created_at=1740061491.112486, config_call_dict={}, relation_name=None, raw_code='{{ test_test_not_null_columns(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_dataops.test_test_not_null_columns', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\test_not_null_columns_my_first_dbt_model_id__column_1__column_2.sql', compiled=True, compiled_code="\n  \n  \n  with null_counts as (\n    select\n      \n        sum(case when id is null then 1 else 0 end) as id_null_count\n        , \n      \n        sum(case when column_1 is null then 1 else 0 end) as column_1_null_count\n        , \n      \n        sum(case when column_2 is null then 1 else 0 end) as column_2_null_count\n        \n      \n    from dev_dwdb.compute_wh.my_first_dbt_model\n    \n  )\nselect\n    'column_name' as column_name,\n    \n    case when id_null_count > 0 then 'id' else null end as id_result\n      , \n    \n    case when column_1_null_count > 0 then 'column_1' else null end as column_1_result\n      , \n    \n    case when column_2_null_count > 0 then 'column_2' else null end as column_2_result\n      \n    \n  from null_counts\n  where\n    \n      id_null_count > 0\n      \n        AND\n      \n    \n      column_1_null_count > 0\n      \n        AND\n      \n    \n      column_2_null_count > 0\n      \n    \n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='test_not_null_columns', kwargs={'columns': ['id', 'column_1', 'column_2'], 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:26:21.329606 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m20:26:21.334124 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m20:26:21.341790 [debug] [MainThread]: Using snowflake connection "master"
[0m20:26:21.342809 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9981648921966553'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9994895458221436'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('tabel1__unique_check' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'tabel1__unique_check'::varchar(4000) as test_name,
            'tabel1__unique_check'::varchar(10000) as test_name_long,
            'singular'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            ''::varchar(10000) as model_refs,
            split_part('', '.', 1)::varchar(255) as model_schema,
            split_part('', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.1964263916015625'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'tests\tabel1__unique_check.sql'::varchar(4000) as file_test_defined,
            'select     count(*) as failures,     count(*) != 0 as should_warn,     count(*) != 0 as should_error from     (         with             null_counts as (                 select                     sum(                         case                             when id is null then 1                             else 0                         end                     ) as id_null_count,                     sum(                         case                             when column_1 is null then 1                             else 0                         end                     ) as column_1_null_count,                     sum(                         case                             when column_2 is null then 1                             else 0                         end                     ) as column_2_null_count                 from                     dev_dwdb.compute_wh.my_first_dbt_model             )         select             ''column_name'' as column_name,             case                 when id_null_count > 0 then ''id''                 else null             end as id_result,             case                 when column_1_null_count > 0 then ''column_1''                 else null             end as column_1_result,             case                 when column_2_null_count > 0 then ''column_2''                 else null             end as column_2_result         from             null_counts         where             id_null_count > 0             AND column_1_null_count > 0             AND column_2_null_count > 0     ) dbt_internal_test'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('test_not_null_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'test_not_null_columns'::varchar(4000) as test_name,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.738863468170166'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m20:26:21.896124 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.553 seconds
[0m20:26:21.897278 [debug] [MainThread]: Using snowflake connection "master"
[0m20:26:21.897278 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic for both generic and singular tests
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      with current_models as (select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'not_null_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'unique_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          union all select 
            '' as model_refs,
            'tabel1__unique_check' as test_name,
            'tests\tabel1__unique_check.sql' as test_path
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2' as test_name,
            'models\example\schema.yml' as test_path
          ),
      split_models as (
        select distinct 
          value as model_name,
          test_name,
          test_path
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
        where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
      )
      or exists (
        select 1 
        from (
      with current_models as (select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'not_null_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'unique_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          union all select 
            '' as model_refs,
            'tabel1__unique_check' as test_name,
            'tests\tabel1__unique_check.sql' as test_path
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'test_not_null_columns_my_first_dbt_model_id__column_1__column_2' as test_name,
            'models\example\schema.yml' as test_path
          ),
      split_models as (
        select distinct 
          value as model_name,
          test_name,
          test_path
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
        where dqm.dq_dbt_test_results_central.file_test_defined = current_models.test_path
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'tabel1__unique_check'::varchar(4000) as test_name,
            'select     count(*) as failures,     count(*) != 0 as should_warn,     count(*) != 0 as should_error from     (         with             null_counts as (                 select                     sum(                         case                             when id is null then 1                             else 0                         end                     ) as id_null_count,                     sum(                         case                             when column_1 is null then 1                             else 0                         end                     ) as column_1_null_count,                     sum(                         case                             when column_2 is null then 1                             else 0                         end                     ) as column_2_null_count                 from                     dev_dwdb.compute_wh.my_first_dbt_model             )         select             ''column_name'' as column_name,             case                 when id_null_count > 0 then ''id''                 else null             end as id_result,             case                 when column_1_null_count > 0 then ''column_1''                 else null             end as column_1_result,             case                 when column_2_null_count > 0 then ''column_2''                 else null             end as column_2_result         from             null_counts         where             id_null_count > 0             AND column_1_null_count > 0             AND column_2_null_count > 0     ) dbt_internal_test'::varchar(65535) as compiled_sql
          union all select
            'test_not_null_columns'::varchar(4000) as test_name,
            'with null_counts as (     select                sum(case when id is null then 1 else 0 end) as id_null_count         ,                 sum(case when column_1 is null then 1 else 0 end) as column_1_null_count         ,                 sum(case when column_2 is null then 1 else 0 end) as column_2_null_count                     from dev_dwdb.compute_wh.my_first_dbt_model        ) select     ''column_name'' as column_name,          case when id_null_count > 0 then ''id'' else null end as id_result       ,           case when column_1_null_count > 0 then ''column_1'' else null end as column_1_result       ,           case when column_2_null_count > 0 then ''column_2'' else null end as column_2_result               from null_counts   where            id_null_count > 0                AND                   column_1_null_count > 0                AND                   column_2_null_count > 0'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m20:26:22.224773 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.326 seconds
[0m20:26:22.225774 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.89s]
[0m20:26:22.226930 [info ] [MainThread]: 
[0m20:26:22.226930 [debug] [MainThread]: On master: Close
[0m20:26:22.341871 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:26:22.341871 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m20:26:22.342881 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m20:26:22.342881 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:26:22.343882 [debug] [MainThread]: Connection 'test.dbt_dataops.tabel1__unique_check' was properly closed.
[0m20:26:22.343882 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m20:26:22.343882 [debug] [MainThread]: Connection 'test.dbt_dataops.test_not_null_columns_my_first_dbt_model_id__column_1__column_2.6ff13a18d5' was properly closed.
[0m20:26:22.345256 [info ] [MainThread]: 
[0m20:26:22.345256 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 project hook in 0 hours 0 minutes and 7.49 seconds (7.49s).
[0m20:26:22.347280 [debug] [MainThread]: Command end result
[0m20:26:22.444805 [info ] [MainThread]: 
[0m20:26:22.445808 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:26:22.445808 [info ] [MainThread]: 
[0m20:26:22.446814 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m20:26:22.447817 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:26:22.447817 [info ] [MainThread]: 
[0m20:26:22.447817 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m20:26:22.449021 [info ] [MainThread]: 
[0m20:26:22.450166 [error] [MainThread]: [31mFailure in test tabel1__unique_check (tests\tabel1__unique_check.sql)[0m
[0m20:26:22.450166 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:26:22.450166 [info ] [MainThread]: 
[0m20:26:22.451670 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\tests\tabel1__unique_check.sql
[0m20:26:22.451670 [info ] [MainThread]: 
[0m20:26:22.452683 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m20:26:22.453864 [debug] [MainThread]: Command `dbt build` failed at 20:26:22.453864 after 9.03 seconds
[0m20:26:22.454893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9C03E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DB9AE539D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DBB7A86B60>]}
[0m20:26:22.454893 [debug] [MainThread]: Flushing usage events
[0m20:26:37.626640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467FDCE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024602A8E5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024602A8E410>]}


============================== 20:26:37.629651 | 76ae2c9c-bc8d-487e-ba6f-fa1f68867bec ==============================
[0m20:26:37.629651 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:26:37.630654 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m20:26:38.360250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '76ae2c9c-bc8d-487e-ba6f-fa1f68867bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024600057EB0>]}
[0m20:26:38.405211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '76ae2c9c-bc8d-487e-ba6f-fa1f68867bec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024601E0B790>]}
[0m20:26:38.406214 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:26:38.426376 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:26:38.666236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:26:38.667239 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m20:26:38.894432 [error] [MainThread]: Encountered an error:
Parsing Error
  Invalid models config given in models\example\schema.yml @ models: {'name': 'my_first_dbt_model', 'description': 'A starter dbt model', 'data_tests': None, 'columns': [{'name': 'id', 'description': 'The primary key for this table', 'data_tests': ['unique', 'not_null']}], 'original_file_path': 'models\\example\\schema.yml', 'yaml_key': 'models', 'package_name': 'dbt_dataops'} - at path ['data_tests']: None is not of type 'array'
[0m20:26:38.896582 [debug] [MainThread]: Command `dbt build` failed at 20:26:38.896582 after 1.33 seconds
[0m20:26:38.897771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002467FDCE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002461B4E1630>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002461B93C970>]}
[0m20:26:38.897771 [debug] [MainThread]: Flushing usage events
[0m20:27:05.161971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E06FDE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E09B9E650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E09B9E470>]}


============================== 20:27:05.165288 | b8f39c90-7b70-4610-a7a2-82f0551eb174 ==============================
[0m20:27:05.165288 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:27:05.166580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:27:05.911313 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b8f39c90-7b70-4610-a7a2-82f0551eb174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E07267970>]}
[0m20:27:05.955772 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b8f39c90-7b70-4610-a7a2-82f0551eb174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E06ADDC00>]}
[0m20:27:05.957816 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:27:05.978047 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:27:06.219390 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:27:06.220684 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m20:27:06.627735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b8f39c90-7b70-4610-a7a2-82f0551eb174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E22D00AF0>]}
[0m20:27:06.760632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b8f39c90-7b70-4610-a7a2-82f0551eb174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E22990700>]}
[0m20:27:06.760632 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 841 macros
[0m20:27:06.762135 [info ] [MainThread]: 
[0m20:27:06.763403 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:27:06.765558 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m20:27:06.775140 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m20:27:06.776146 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m20:27:06.776146 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:07.390842 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.615 seconds
[0m20:27:07.392346 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m20:27:07.519848 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m20:27:07.527510 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m20:27:07.528516 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m20:27:07.528516 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:08.040932 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.513 seconds
[0m20:27:08.043443 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m20:27:08.165802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b8f39c90-7b70-4610-a7a2-82f0551eb174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E22990580>]}
[0m20:27:08.166806 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:27:08.166806 [info ] [MainThread]: 
[0m20:27:08.169882 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m20:27:08.169882 [debug] [Thread-2 (]: Began running node test.dbt_dataops.tabel1__unique_check
[0m20:27:08.170895 [info ] [Thread-1 (]: 1 of 4 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m20:27:08.170895 [info ] [Thread-2 (]: 2 of 4 START test tabel1__unique_check ......................................... [RUN]
[0m20:27:08.172399 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m20:27:08.172399 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.tabel1__unique_check'
[0m20:27:08.173413 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m20:27:08.173413 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.tabel1__unique_check
[0m20:27:08.180616 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m20:27:08.185148 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.tabel1__unique_check"
[0m20:27:08.186153 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m20:27:08.186153 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.tabel1__unique_check
[0m20:27:08.209085 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m20:27:08.224184 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.tabel1__unique_check"
[0m20:27:08.225187 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m20:27:08.226220 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:27:08.227260 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.tabel1__unique_check"
[0m20:27:08.227260 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:27:08.228264 [debug] [Thread-2 (]: On test.dbt_dataops.tabel1__unique_check: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.tabel1__unique_check"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
select
    count(*) as failures,
    count(*) != 0 as should_warn,
    count(*) != 0 as should_error
from
    (
        with
            null_counts as (
                select
                    sum(
                        case
                            when id is null then 1
                            else 0
                        end
                    ) as id_null_count,
                    sum(
                        case
                            when column_1 is null then 1
                            else 0
                        end
                    ) as column_1_null_count,
                    sum(
                        case
                            when column_2 is null then 1
                            else 0
                        end
                    ) as column_2_null_count
                from
                    dev_dwdb.compute_wh.my_first_dbt_model
            )
        select
            'column_name' as column_name,
            case
                when id_null_count > 0 then 'id'
                else null
            end as id_result,
            case
                when column_1_null_count > 0 then 'column_1'
                else null
            end as column_1_result,
            case
                when column_2_null_count > 0 then 'column_2'
                else null
            end as column_2_result
        from
            null_counts
        where
            id_null_count > 0
            AND column_1_null_count > 0
            AND column_2_null_count > 0
    ) dbt_internal_test
      
    ) dbt_internal_test
[0m20:27:08.230271 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m20:27:09.085269 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.857 seconds
[0m20:27:09.103508 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m20:27:09.220490 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'b8f39c90-7b70-4610-a7a2-82f0551eb174', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E230DC3D0>]}
[0m20:27:09.222099 [info ] [Thread-1 (]: 1 of 4 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.05s]
[0m20:27:09.222099 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m20:27:09.223111 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:27:09.224116 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:27:09.224116 [info ] [Thread-4 (]: 3 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:27:09.225121 [info ] [Thread-3 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:27:09.225121 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:27:09.226126 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m20:27:09.226126 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:27:09.227132 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:27:09.234658 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:27:09.239890 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:27:09.240893 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:27:09.242398 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:27:09.244428 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:27:09.247495 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:27:09.248501 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:27:09.249513 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:27:09.249513 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:27:09.250520 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:27:09.250520 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:27:09.250520 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:27:09.896199 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.666 seconds
[0m20:27:09.899201 [debug] [Thread-2 (]: On test.dbt_dataops.tabel1__unique_check: Close
[0m20:27:09.901303 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.651 seconds
[0m20:27:09.903492 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:27:10.022023 [error] [Thread-4 (]: 3 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.80s]
[0m20:27:10.024045 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:27:10.025049 [error] [Thread-2 (]: 2 of 4 FAIL 1 tabel1__unique_check ............................................. [[31mFAIL 1[0m in 1.85s]
[0m20:27:10.026052 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.tabel1__unique_check
[0m20:27:10.042777 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.791 seconds
[0m20:27:10.044783 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:27:10.169482 [info ] [Thread-3 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.94s]
[0m20:27:10.171493 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:27:10.172494 [info ] [MainThread]: 
[0m20:27:10.172494 [info ] [MainThread]: Running 1 on-run-end hook
[0m20:27:10.210720 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m20:27:10.219980 [debug] [MainThread]: Using snowflake connection "master"
[0m20:27:10.220983 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m20:27:10.220983 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:11.218600 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.998 seconds
[0m20:27:11.224117 [info ] [MainThread]: Test name: not_null
[0m20:27:11.225150 [info ] [MainThread]: Test type: generic
[0m20:27:11.225150 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740063426.5321977, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:27:11.235933 [info ] [MainThread]: Test name: tabel1__unique_check
[0m20:27:11.236936 [info ] [MainThread]: Test type: singular
[0m20:27:11.236936 [info ] [MainThread]: Result node: SingularTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='tabel1__unique_check', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='tabel1__unique_check.sql', original_file_path='tests\\tabel1__unique_check.sql', unique_id='test.dbt_dataops.tabel1__unique_check', fqn=['dbt_dataops', 'tabel1__unique_check'], alias='tabel1__unique_check', checksum=FileHash(name='sha256', checksum='3a44da53a5f113ede9dc02ec80dc3dc5d739b6f56015c7277a74d089f78b7ca4'), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=['example_1'], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['example_1'], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\tests\\tabel1__unique_check.sql', unrendered_config={'tags': ['example_1']}, created_at=1740063374.6253035, config_call_dict={'tags': ['example_1']}, relation_name=None, raw_code="{{ config(tags=['example_1']\r\n\r\n) }}\r\nselect\r\n    count(*) as failures,\r\n    count(*) != 0 as should_warn,\r\n    count(*) != 0 as should_error\r\nfrom\r\n    (\r\n        with\r\n            null_counts as (\r\n                select\r\n                    sum(\r\n                        case\r\n                            when id is null then 1\r\n                            else 0\r\n                        end\r\n                    ) as id_null_count,\r\n                    sum(\r\n                        case\r\n                            when column_1 is null then 1\r\n                            else 0\r\n                        end\r\n                    ) as column_1_null_count,\r\n                    sum(\r\n                        case\r\n                            when column_2 is null then 1\r\n                            else 0\r\n                        end\r\n                    ) as column_2_null_count\r\n                from\r\n                    dev_dwdb.compute_wh.my_first_dbt_model\r\n            )\r\n        select\r\n            'column_name' as column_name,\r\n            case\r\n                when id_null_count > 0 then 'id'\r\n                else null\r\n            end as id_result,\r\n            case\r\n                when column_1_null_count > 0 then 'column_1'\r\n                else null\r\n            end as column_1_result,\r\n            case\r\n                when column_2_null_count > 0 then 'column_2'\r\n                else null\r\n            end as column_2_result\r\n        from\r\n            null_counts\r\n        where\r\n            id_null_count > 0\r\n            AND column_1_null_count > 0\r\n            AND column_2_null_count > 0\r\n    ) dbt_internal_test", language='sql', refs=[], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=[]), compiled_path='target\\compiled\\dbt_dataops\\tests\\tabel1__unique_check.sql', compiled=True, compiled_code="\nselect\n    count(*) as failures,\n    count(*) != 0 as should_warn,\n    count(*) != 0 as should_error\nfrom\n    (\n        with\n            null_counts as (\n                select\n                    sum(\n                        case\n                            when id is null then 1\n                            else 0\n                        end\n                    ) as id_null_count,\n                    sum(\n                        case\n                            when column_1 is null then 1\n                            else 0\n                        end\n                    ) as column_1_null_count,\n                    sum(\n                        case\n                            when column_2 is null then 1\n                            else 0\n                        end\n                    ) as column_2_null_count\n                from\n                    dev_dwdb.compute_wh.my_first_dbt_model\n            )\n        select\n            'column_name' as column_name,\n            case\n                when id_null_count > 0 then 'id'\n                else null\n            end as id_result,\n            case\n                when column_1_null_count > 0 then 'column_1'\n                else null\n            end as column_1_result,\n            case\n                when column_2_null_count > 0 then 'column_2'\n                else null\n            end as column_2_result\n        from\n            null_counts\n        where\n            id_null_count > 0\n            AND column_1_null_count > 0\n            AND column_2_null_count > 0\n    ) dbt_internal_test", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None))
[0m20:27:11.239413 [info ] [MainThread]: Test name: unique
[0m20:27:11.239413 [info ] [MainThread]: Test type: generic
[0m20:27:11.240776 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740063426.5291235, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:27:11.242279 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m20:27:11.246383 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m20:27:11.253658 [debug] [MainThread]: Using snowflake connection "master"
[0m20:27:11.254662 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7969019412994385'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('tabel1__unique_check' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'tabel1__unique_check'::varchar(4000) as test_name,
            'tabel1__unique_check'::varchar(10000) as test_name_long,
            'singular'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            'id,column_1,column_2'::varchar(1000) as column_details,
            ''::varchar(10000) as model_refs,
            split_part('', '.', 1)::varchar(255) as model_schema,
            split_part('', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.852649450302124'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'tests\tabel1__unique_check.sql'::varchar(4000) as file_test_defined,
            'select     count(*) as failures,     count(*) != 0 as should_warn,     count(*) != 0 as should_error from     (         with             null_counts as (                 select                     sum(                         case                             when id is null then 1                             else 0                         end                     ) as id_null_count,                     sum(                         case                             when column_1 is null then 1                             else 0                         end                     ) as column_1_null_count,                     sum(                         case                             when column_2 is null then 1                             else 0                         end                     ) as column_2_null_count                 from                     dev_dwdb.compute_wh.my_first_dbt_model             )         select             ''column_name'' as column_name,             case                 when id_null_count > 0 then ''id''                 else null             end as id_result,             case                 when column_1_null_count > 0 then ''column_1''                 else null             end as column_1_result,             case                 when column_2_null_count > 0 then ''column_2''                 else null             end as column_2_result         from             null_counts         where             id_null_count > 0             AND column_1_null_count > 0             AND column_2_null_count > 0     ) dbt_internal_test'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9433560371398926'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m20:27:11.754379 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.499 seconds
[0m20:27:11.754379 [debug] [MainThread]: Using snowflake connection "master"
[0m20:27:11.755380 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic for both generic and singular tests
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      with current_models as (select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'not_null_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          union all select 
            '' as model_refs,
            'tabel1__unique_check' as test_name,
            'tests\tabel1__unique_check.sql' as test_path
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'unique_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          ),
      split_models as (
        select distinct 
          value as model_name,
          test_name,
          test_path
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
        where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
      )
      or exists (
        select 1 
        from (
      with current_models as (select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'not_null_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          union all select 
            '' as model_refs,
            'tabel1__unique_check' as test_name,
            'tests\tabel1__unique_check.sql' as test_path
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'unique_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          ),
      split_models as (
        select distinct 
          value as model_name,
          test_name,
          test_path
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
        where dqm.dq_dbt_test_results_central.file_test_defined = current_models.test_path
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'tabel1__unique_check'::varchar(4000) as test_name,
            'select     count(*) as failures,     count(*) != 0 as should_warn,     count(*) != 0 as should_error from     (         with             null_counts as (                 select                     sum(                         case                             when id is null then 1                             else 0                         end                     ) as id_null_count,                     sum(                         case                             when column_1 is null then 1                             else 0                         end                     ) as column_1_null_count,                     sum(                         case                             when column_2 is null then 1                             else 0                         end                     ) as column_2_null_count                 from                     dev_dwdb.compute_wh.my_first_dbt_model             )         select             ''column_name'' as column_name,             case                 when id_null_count > 0 then ''id''                 else null             end as id_result,             case                 when column_1_null_count > 0 then ''column_1''                 else null             end as column_1_result,             case                 when column_2_null_count > 0 then ''column_2''                 else null             end as column_2_result         from             null_counts         where             id_null_count > 0             AND column_1_null_count > 0             AND column_2_null_count > 0     ) dbt_internal_test'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m20:27:12.201466 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.445 seconds
[0m20:27:12.202466 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.96s]
[0m20:27:12.202970 [info ] [MainThread]: 
[0m20:27:12.203975 [debug] [MainThread]: On master: Close
[0m20:27:12.318118 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:12.319237 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m20:27:12.319237 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m20:27:12.320243 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m20:27:12.320243 [debug] [MainThread]: Connection 'test.dbt_dataops.tabel1__unique_check' was properly closed.
[0m20:27:12.320243 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m20:27:12.321249 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:27:12.321249 [info ] [MainThread]: 
[0m20:27:12.322250 [info ] [MainThread]: Finished running 1 table model, 3 data tests, 1 project hook in 0 hours 0 minutes and 5.56 seconds (5.56s).
[0m20:27:12.323475 [debug] [MainThread]: Command end result
[0m20:27:12.359170 [info ] [MainThread]: 
[0m20:27:12.359170 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:27:12.360174 [info ] [MainThread]: 
[0m20:27:12.361179 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m20:27:12.362179 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:27:12.362179 [info ] [MainThread]: 
[0m20:27:12.363216 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m20:27:12.364357 [info ] [MainThread]: 
[0m20:27:12.364357 [error] [MainThread]: [31mFailure in test tabel1__unique_check (tests\tabel1__unique_check.sql)[0m
[0m20:27:12.365440 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:27:12.365440 [info ] [MainThread]: 
[0m20:27:12.366444 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\tests\tabel1__unique_check.sql
[0m20:27:12.366444 [info ] [MainThread]: 
[0m20:27:12.367447 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m20:27:12.368480 [debug] [MainThread]: Command `dbt build` failed at 20:27:12.368480 after 7.27 seconds
[0m20:27:12.369484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E06FDE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E22533A90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000011E22530D90>]}
[0m20:27:12.369484 [debug] [MainThread]: Flushing usage events
[0m20:27:25.410907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D9578E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D9834E680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D9834E4A0>]}


============================== 20:27:25.413435 | f4c2376f-2811-4945-9983-3c2270d59e36 ==============================
[0m20:27:25.413435 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:27:25.414592 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m20:27:26.113758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f4c2376f-2811-4945-9983-3c2270d59e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D95A17DC0>]}
[0m20:27:26.157089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f4c2376f-2811-4945-9983-3c2270d59e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D9528F550>]}
[0m20:27:26.158161 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:27:26.178570 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:27:26.417879 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m20:27:26.417879 [debug] [MainThread]: Partial parsing: deleted file: dbt_dataops://tests\tabel1__unique_check.sql
[0m20:27:26.543632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f4c2376f-2811-4945-9983-3c2270d59e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB0C81ED0>]}
[0m20:27:26.663412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f4c2376f-2811-4945-9983-3c2270d59e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB0CC2DA0>]}
[0m20:27:26.664416 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 841 macros
[0m20:27:26.665806 [info ] [MainThread]: 
[0m20:27:26.666808 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:27:26.667810 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m20:27:26.679704 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m20:27:26.679704 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m20:27:26.680709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:27.301559 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.621 seconds
[0m20:27:27.303063 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m20:27:27.429731 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m20:27:27.438554 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m20:27:27.438554 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m20:27:27.439555 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:27:27.985362 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.546 seconds
[0m20:27:27.987480 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m20:27:28.108604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f4c2376f-2811-4945-9983-3c2270d59e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB0CC17B0>]}
[0m20:27:28.108604 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:27:28.109739 [info ] [MainThread]: 
[0m20:27:28.112248 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m20:27:28.113275 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m20:27:28.114278 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m20:27:28.114278 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m20:27:28.121407 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m20:27:28.122407 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m20:27:28.146310 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m20:27:28.147314 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m20:27:28.148464 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:27:28.148464 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:27:29.010321 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.861 seconds
[0m20:27:29.026915 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m20:27:29.152249 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f4c2376f-2811-4945-9983-3c2270d59e36', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DB0C2FBE0>]}
[0m20:27:29.152249 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.04s]
[0m20:27:29.153264 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m20:27:29.154268 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:27:29.155274 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:27:29.155274 [info ] [Thread-3 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:27:29.156282 [info ] [Thread-4 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:27:29.156282 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:27:29.157290 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m20:27:29.157290 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:27:29.158298 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:27:29.168352 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:27:29.173875 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:27:29.174879 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:27:29.182495 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:27:29.188808 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:27:29.190833 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:27:29.192336 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:27:29.193358 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:27:29.193358 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:27:29.194362 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:27:29.194362 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:27:29.195370 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:27:29.953289 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.758 seconds
[0m20:27:29.956301 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:27:30.074330 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.92s]
[0m20:27:30.075331 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:27:30.742452 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.549 seconds
[0m20:27:30.744690 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:27:30.861432 [error] [Thread-3 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.71s]
[0m20:27:30.862634 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:27:30.864653 [info ] [MainThread]: 
[0m20:27:30.864653 [info ] [MainThread]: Running 1 on-run-end hook
[0m20:27:30.903765 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m20:27:30.908795 [debug] [MainThread]: Using snowflake connection "master"
[0m20:27:30.909802 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m20:27:30.909802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:27:31.911608 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.002 seconds
[0m20:27:31.916629 [info ] [MainThread]: Test name: unique
[0m20:27:31.918032 [info ] [MainThread]: Test type: generic
[0m20:27:31.918032 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740063426.5291235, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:27:31.927708 [info ] [MainThread]: Test name: not_null
[0m20:27:31.928712 [info ] [MainThread]: Test type: generic
[0m20:27:31.929715 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740063426.5321977, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:27:31.930725 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m20:27:31.935257 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m20:27:31.939437 [debug] [MainThread]: Using snowflake connection "master"
[0m20:27:31.940446 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9170396327972412'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7051496505737305'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m20:27:32.358121 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.417 seconds
[0m20:27:32.358121 [debug] [MainThread]: Using snowflake connection "master"
[0m20:27:32.359132 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic for both generic and singular tests
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      with current_models as (select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'unique_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'not_null_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          ),
      split_models as (
        select distinct 
          value as model_name,
          test_name,
          test_path
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
        where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
      )
      or exists (
        select 1 
        from (
      with current_models as (select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'unique_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'not_null_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path
          ),
      split_models as (
        select distinct 
          value as model_name,
          test_name,
          test_path
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
        where dqm.dq_dbt_test_results_central.file_test_defined = current_models.test_path
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m20:27:32.717297 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.358 seconds
[0m20:27:32.719364 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.78s]
[0m20:27:32.720370 [info ] [MainThread]: 
[0m20:27:32.720370 [debug] [MainThread]: On master: Close
[0m20:27:32.839029 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:27:32.840035 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m20:27:32.841061 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m20:27:32.841061 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m20:27:32.841061 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m20:27:32.841061 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:27:32.842565 [info ] [MainThread]: 
[0m20:27:32.843579 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 6.18 seconds (6.18s).
[0m20:27:32.844585 [debug] [MainThread]: Command end result
[0m20:27:32.882542 [info ] [MainThread]: 
[0m20:27:32.883577 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m20:27:32.884581 [info ] [MainThread]: 
[0m20:27:32.885616 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m20:27:32.885616 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:27:32.886621 [info ] [MainThread]: 
[0m20:27:32.887633 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m20:27:32.887633 [info ] [MainThread]: 
[0m20:27:32.888640 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m20:27:32.889646 [debug] [MainThread]: Command `dbt build` failed at 20:27:32.889646 after 7.54 seconds
[0m20:27:32.890649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D9578E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D9528F550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D96004F70>]}
[0m20:27:32.890649 [debug] [MainThread]: Flushing usage events
[0m20:29:28.087456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002341D9FE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234205C6680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234205C64A0>]}


============================== 20:29:28.090468 | 2fd66652-08db-49ca-8c96-d225e46af54d ==============================
[0m20:29:28.090468 [info ] [MainThread]: Running with dbt=1.8.7
[0m20:29:28.091471 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m20:29:28.797460 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fd66652-08db-49ca-8c96-d225e46af54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002341DC87DC0>]}
[0m20:29:28.842446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fd66652-08db-49ca-8c96-d225e46af54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002341D503550>]}
[0m20:29:28.843450 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m20:29:28.865980 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m20:29:29.114233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m20:29:29.115234 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m20:29:29.273481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fd66652-08db-49ca-8c96-d225e46af54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234393FC130>]}
[0m20:29:29.393988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fd66652-08db-49ca-8c96-d225e46af54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234393FF1F0>]}
[0m20:29:29.393988 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 841 macros
[0m20:29:29.395999 [info ] [MainThread]: 
[0m20:29:29.397004 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m20:29:29.398009 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m20:29:29.410393 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m20:29:29.411400 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m20:29:29.411400 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:30.033957 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.622 seconds
[0m20:29:30.035092 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m20:29:30.156929 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m20:29:30.164961 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m20:29:30.164961 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m20:29:30.165964 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m20:29:30.664334 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.499 seconds
[0m20:29:30.666345 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m20:29:30.790930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fd66652-08db-49ca-8c96-d225e46af54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000234393FE3B0>]}
[0m20:29:30.791936 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m20:29:30.793031 [info ] [MainThread]: 
[0m20:29:30.795047 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m20:29:30.796096 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m20:29:30.797100 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m20:29:30.798117 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m20:29:30.805152 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m20:29:30.806181 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m20:29:30.830207 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m20:29:30.831711 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m20:29:30.831711 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m20:29:30.832720 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m20:29:31.741275 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.909 seconds
[0m20:29:31.759617 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m20:29:31.881299 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fd66652-08db-49ca-8c96-d225e46af54d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023438E9FBE0>]}
[0m20:29:31.882305 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.08s]
[0m20:29:31.883314 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m20:29:31.884318 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:29:31.884318 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:29:31.885323 [info ] [Thread-3 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m20:29:31.885323 [info ] [Thread-4 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m20:29:31.886502 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m20:29:31.886502 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m20:29:31.887657 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:29:31.887657 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:29:31.897867 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:29:31.902886 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:29:31.903892 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:29:31.916062 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:29:31.917066 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:29:31.920104 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:29:31.921104 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m20:29:31.922295 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m20:29:31.922295 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m20:29:31.923315 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m20:29:31.924324 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m20:29:31.925330 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m20:29:32.543816 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m20:29:32.547342 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m20:29:32.667235 [error] [Thread-3 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m20:29:32.668391 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m20:29:33.577628 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.652 seconds
[0m20:29:33.579663 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m20:29:33.701510 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.82s]
[0m20:29:33.702513 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m20:29:33.704086 [info ] [MainThread]: 
[0m20:29:33.704086 [info ] [MainThread]: Running 1 on-run-end hook
[0m20:29:33.741593 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m20:29:33.747617 [debug] [MainThread]: Using snowflake connection "master"
[0m20:29:33.747617 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m20:29:33.747617 [debug] [MainThread]: Opening a new connection, currently in state init
[0m20:29:34.705944 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.958 seconds
[0m20:29:34.711499 [info ] [MainThread]: Test name: not_null
[0m20:29:34.712505 [info ] [MainThread]: Test type: generic
[0m20:29:34.713517 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740063426.5321977, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:29:34.721568 [info ] [MainThread]: Test name: unique
[0m20:29:34.722570 [info ] [MainThread]: Test type: generic
[0m20:29:34.723611 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740063426.5291235, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m20:29:34.724617 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m20:29:34.728748 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m20:29:34.733755 [debug] [MainThread]: Using snowflake connection "master"
[0m20:29:34.734757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.781912088394165'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8150079250335693'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m20:29:35.136200 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.402 seconds
[0m20:29:35.137203 [debug] [MainThread]: Using snowflake connection "master"
[0m20:29:35.138208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic for both generic and singular tests
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      with current_models as (select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'not_null_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path,
            'test' as test_type
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'unique_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path,
            'test' as test_type
          ),
      split_models as (
        select distinct 
          test_name,
          test_path
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
        where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
      )
      or exists (
        select 1 
        from (
      with current_models as (select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'not_null_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path,
            'test' as test_type
          union all select 
            'compute_wh.my_first_dbt_model' as model_refs,
            'unique_my_first_dbt_model_id' as test_name,
            'models\example\schema.yml' as test_path,
            'test' as test_type
          ),
      split_models as (
        select distinct 
          test_name,
          test_path
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
        where dqm.dq_dbt_test_results_central.file_test_defined = current_models.test_path
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m20:29:35.338150 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8563-3201-7372-000b-f6920002e12e
[0m20:29:35.339151 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 30 at position 69
invalid identifier 'CURRENT_MODELS.MODEL_NAME'
[0m20:29:35.339151 [info ] [MainThread]: Database error while running on-run-end
[0m20:29:35.340376 [debug] [MainThread]: On master: Close
[0m20:29:35.455210 [debug] [MainThread]: Connection 'master' was properly closed.
[0m20:29:35.456216 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m20:29:35.456216 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m20:29:35.457235 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m20:29:35.457235 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m20:29:35.457235 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m20:29:35.458242 [info ] [MainThread]: 
[0m20:29:35.459247 [info ] [MainThread]: Finished running 1 table model, 2 data tests in 0 hours 0 minutes and 6.06 seconds (6.06s).
[0m20:29:35.460490 [debug] [MainThread]: Command end result
[0m20:29:35.497331 [info ] [MainThread]: 
[0m20:29:35.498337 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m20:29:35.498337 [info ] [MainThread]: 
[0m20:29:35.499342 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m20:29:35.500346 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m20:29:35.501412 [info ] [MainThread]: 
[0m20:29:35.501412 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m20:29:35.502424 [info ] [MainThread]: 
[0m20:29:35.502424 [error] [MainThread]:   on-run-end failed, error:
 000904 (42000): SQL compilation error: error line 30 at position 69
invalid identifier 'CURRENT_MODELS.MODEL_NAME'
[0m20:29:35.503430 [info ] [MainThread]: 
[0m20:29:35.504436 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m20:29:35.505440 [debug] [MainThread]: Command `dbt build` failed at 20:29:35.505440 after 7.47 seconds
[0m20:29:35.505440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002341D9FE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002341D503550>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002341E274F70>]}
[0m20:29:35.506445 [debug] [MainThread]: Flushing usage events
[0m11:54:42.199089 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC19CE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC457E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC457E2F0>]}


============================== 11:54:42.202932 | 9c0f63d5-266e-4866-b2a9-19a45c7fb257 ==============================
[0m11:54:42.202932 [info ] [MainThread]: Running with dbt=1.8.7
[0m11:54:42.204205 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example_2', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m11:54:45.271267 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9c0f63d5-266e-4866-b2a9-19a45c7fb257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC4536980>]}
[0m11:54:45.320227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9c0f63d5-266e-4866-b2a9-19a45c7fb257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC227B730>]}
[0m11:54:45.322235 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m11:54:45.387812 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m11:54:47.175226 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m11:54:47.175226 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m11:54:47.348217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9c0f63d5-266e-4866-b2a9-19a45c7fb257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBDD3C0100>]}
[0m11:54:47.517016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9c0f63d5-266e-4866-b2a9-19a45c7fb257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBDD35B190>]}
[0m11:54:47.517522 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 841 macros
[0m11:54:47.518595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c0f63d5-266e-4866-b2a9-19a45c7fb257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBDD36E500>]}
[0m11:54:47.519836 [info ] [MainThread]: 
[0m11:54:47.519836 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m11:54:47.524893 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m11:54:47.540253 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m11:54:47.541257 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m11:54:47.541257 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m11:54:48.499832 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.958 seconds
[0m11:54:48.501840 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m11:54:48.657891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9c0f63d5-266e-4866-b2a9-19a45c7fb257', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBDD1421D0>]}
[0m11:54:48.658894 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m11:54:48.659898 [info ] [MainThread]: 
[0m11:54:48.662524 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m11:54:48.663530 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m11:54:48.663530 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m11:54:48.664538 [info ] [Thread-2 (]: 2 of 2 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m11:54:48.664538 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m11:54:48.665636 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m11:54:48.665636 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m11:54:48.665636 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m11:54:48.680245 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m11:54:48.686131 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:54:48.687432 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m11:54:48.688434 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m11:54:48.704765 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m11:54:48.707510 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:54:48.710374 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m11:54:48.710374 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m11:54:48.710374 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m11:54:48.711782 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m11:54:48.711782 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m11:54:48.714784 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m11:54:49.356995 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.643 seconds
[0m11:54:49.364034 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m11:54:49.483060 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.82s]
[0m11:54:49.484064 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m11:54:50.349201 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.638 seconds
[0m11:54:50.351220 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m11:54:50.481725 [info ] [Thread-1 (]: 1 of 2 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.82s]
[0m11:54:50.482730 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m11:54:50.483761 [info ] [MainThread]: 
[0m11:54:50.483761 [info ] [MainThread]: Running 1 on-run-end hook
[0m11:54:50.525802 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m11:54:50.531670 [debug] [MainThread]: Using snowflake connection "master"
[0m11:54:50.532676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m11:54:50.532676 [debug] [MainThread]: Opening a new connection, currently in state init
[0m11:54:51.879991 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.347 seconds
[0m11:54:51.885271 [info ] [MainThread]: Test name: unique
[0m11:54:51.886773 [info ] [MainThread]: Test type: generic
[0m11:54:51.886773 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_id'], alias='unique_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740049321.7086601, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_second_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m11:54:51.896759 [info ] [MainThread]: Test name: not_null
[0m11:54:51.897906 [info ] [MainThread]: Test type: generic
[0m11:54:51.899165 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_second_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778', fqn=['dbt_dataops', 'example', 'not_null_my_second_dbt_model_id'], alias='not_null_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740049321.7066371, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_second_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m11:54:51.901176 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m11:54:51.907683 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m11:54:51.914192 [debug] [MainThread]: Using snowflake connection "master"
[0m11:54:51.915193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8174245357513428'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8161802291870117'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m11:54:52.623536 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.707 seconds
[0m11:54:52.624052 [debug] [MainThread]: Using snowflake connection "master"
[0m11:54:52.624562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'compute_wh.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'compute_wh.my_second_dbt_model' as model_refs,
              'not_null_my_second_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m11:54:53.266838 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.641 seconds
[0m11:54:53.267850 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.36s]
[0m11:54:53.267850 [info ] [MainThread]: 
[0m11:54:53.269229 [debug] [MainThread]: On master: Close
[0m11:54:53.386902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m11:54:53.388024 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m11:54:53.388024 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m11:54:53.388024 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m11:54:53.389441 [info ] [MainThread]: 
[0m11:54:53.390446 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m11:54:53.390446 [debug] [MainThread]: Command end result
[0m11:54:53.432236 [info ] [MainThread]: 
[0m11:54:53.433245 [info ] [MainThread]: [32mCompleted successfully[0m
[0m11:54:53.433245 [info ] [MainThread]: 
[0m11:54:53.434560 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m11:54:53.435603 [debug] [MainThread]: Command `dbt test` succeeded at 11:54:53.435603 after 11.31 seconds
[0m11:54:53.435603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC19CE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC227B730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC2234B80>]}
[0m11:54:53.435603 [debug] [MainThread]: Flushing usage events
[0m13:32:12.033606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013945A6E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000139486025F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013948602410>]}


============================== 13:32:12.037875 | 2e22d670-1898-48bb-8470-3ee0599d95d9 ==============================
[0m13:32:12.037875 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:32:12.037875 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:example_2', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m13:32:13.249988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2e22d670-1898-48bb-8470-3ee0599d95d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013945CFBEB0>]}
[0m13:32:13.297289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2e22d670-1898-48bb-8470-3ee0599d95d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013947A7B790>]}
[0m13:32:13.299408 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m13:32:13.321887 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:32:13.649145 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:32:13.649145 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m13:32:14.020997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2e22d670-1898-48bb-8470-3ee0599d95d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013961761690>]}
[0m13:32:14.158026 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2e22d670-1898-48bb-8470-3ee0599d95d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013961760AF0>]}
[0m13:32:14.159026 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m13:32:14.160500 [info ] [MainThread]: 
[0m13:32:14.161503 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:32:14.162640 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m13:32:14.172907 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m13:32:14.173918 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m13:32:14.173918 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:14.968161 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.794 seconds
[0m13:32:14.970186 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m13:32:15.100066 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m13:32:15.108196 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m13:32:15.108196 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m13:32:15.109199 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:32:15.763597 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.654 seconds
[0m13:32:15.764609 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m13:32:15.893975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2e22d670-1898-48bb-8470-3ee0599d95d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013961760880>]}
[0m13:32:15.895196 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:32:15.895196 [info ] [MainThread]: 
[0m13:32:15.898837 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m13:32:15.899850 [info ] [Thread-1 (]: 1 of 5 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m13:32:15.899850 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m13:32:15.900856 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m13:32:15.908272 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m13:32:15.909276 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m13:32:15.931705 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m13:32:15.932705 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m13:32:15.933706 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m13:32:15.933706 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:32:17.420072 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.485 seconds
[0m13:32:17.436226 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m13:32:17.555671 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2e22d670-1898-48bb-8470-3ee0599d95d9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013960EDFB80>]}
[0m13:32:17.555671 [info ] [Thread-1 (]: 1 of 5 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.65s]
[0m13:32:17.557067 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m13:32:17.558116 [debug] [Thread-3 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74
[0m13:32:17.558116 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m13:32:17.558116 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m13:32:17.559119 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m13:32:17.559119 [info ] [Thread-3 (]: 2 of 5 START test dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1  [RUN]
[0m13:32:17.560122 [info ] [Thread-4 (]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m13:32:17.560122 [info ] [Thread-2 (]: 4 of 5 START test unique_my_second_dbt_model_ .................................. [RUN]
[0m13:32:17.561286 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74'
[0m13:32:17.560122 [info ] [Thread-1 (]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m13:32:17.562289 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m13:32:17.562289 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6'
[0m13:32:17.563297 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74
[0m13:32:17.563297 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_second_dbt_model, now test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:32:17.563297 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m13:32:17.564647 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m13:32:17.569125 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74"
[0m13:32:17.569125 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m13:32:17.576131 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m13:32:17.581361 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m13:32:17.584743 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:32:17.585744 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74
[0m13:32:17.586756 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m13:32:17.599132 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74"
[0m13:32:17.599132 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m13:32:17.602265 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m13:32:17.603271 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m13:32:17.661346 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m13:32:17.662350 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74"
[0m13:32:17.664812 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:32:17.664812 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m13:32:17.666115 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




with left_table as (

  select
     as id

  from dev_dwdb.compute_wh.my_second_dbt_model

  where  is not null
    and id <> '1'

),

right_table as (

  select
    id as id

  from dev_dwdb.compute_wh.my_first_dbt_model

  where id is not null
    and current_date -1

),

exceptions as (

  select
    left_table.id,
    right_table.id as right_id

  from left_table

  left join right_table
         on left_table.id = right_table.id

  where right_table.id is null

)

select * from exceptions


      
    ) dbt_internal_test
[0m13:32:17.667330 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m13:32:17.667330 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m13:32:17.668501 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:32:17.668501 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:32:17.669506 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
     as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where  is not null
group by 
having count(*) > 1



      
    ) dbt_internal_test
[0m13:32:17.670507 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:32:17.670507 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:32:17.671742 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:32:17.674043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:32:18.373046 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba8962-3201-73bc-000b-f6920002f066
[0m13:32:18.374056 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ba8962-3201-72ef-000b-f6920002d31a
[0m13:32:18.374056 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 5 unexpected 'as'.
syntax error line 18 at position 9 unexpected 'is'.
syntax error line 21 at position 0 unexpected ')'.
[0m13:32:18.374056 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 5 unexpected 'as'.
syntax error line 12 at position 9 unexpected '('.
syntax error line 15 at position 7 unexpected 'is'.
syntax error line 17 at position 0 unexpected 'having'.
syntax error line 22 at position 4 unexpected ')'.
[0m13:32:18.375115 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74: Close
[0m13:32:18.375115 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: Close
[0m13:32:18.510962 [debug] [Thread-2 (]: Database Error in test unique_my_second_dbt_model_ (models\example\schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\unique_my_second_dbt_model_.sql
[0m13:32:18.510962 [debug] [Thread-3 (]: Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 5 unexpected 'as'.
  syntax error line 18 at position 9 unexpected 'is'.
  syntax error line 21 at position 0 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\dbt_utils_relationships_where__edda71a933c59492086f0e5d408e6225.sql
[0m13:32:18.511965 [error] [Thread-2 (]: 4 of 5 ERROR unique_my_second_dbt_model_ ....................................... [[31mERROR[0m in 0.95s]
[0m13:32:18.513156 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m13:32:18.511965 [error] [Thread-3 (]: 2 of 5 ERROR dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1  [[31mERROR[0m in 0.95s]
[0m13:32:18.515245 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74
[0m13:32:19.480359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.806 seconds
[0m13:32:19.483399 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:32:19.605661 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 2.04s]
[0m13:32:19.606671 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m13:32:20.643215 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.973 seconds
[0m13:32:20.645224 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:32:20.770107 [info ] [Thread-4 (]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 3.21s]
[0m13:32:20.771573 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m13:32:20.772645 [info ] [MainThread]: 
[0m13:32:20.772645 [info ] [MainThread]: Running 1 on-run-end hook
[0m13:32:20.813327 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m13:32:20.819361 [debug] [MainThread]: Using snowflake connection "master"
[0m13:32:20.820364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m13:32:20.820364 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:32:21.827823 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.007 seconds
[0m13:32:21.831825 [info ] [MainThread]: Test name: unique
[0m13:32:21.832827 [info ] [MainThread]: Test type: generic
[0m13:32:21.833971 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_second_dbt_model_', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_'], alias='unique_my_second_dbt_model_', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_.sql', unrendered_config={}, created_at=1740124933.944124, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n     as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_second_dbt_model\nwhere  is not null\ngroup by \nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m13:32:21.843338 [info ] [MainThread]: Test name: relationships_where
[0m13:32:21.844499 [info ] [MainThread]: Test type: generic
[0m13:32:21.844499 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__edda71a933c59492086f0e5d408e6225.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__edda71a933c59492086f0e5d408e6225', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__edda71a933c59492086f0e5d408e6225', schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\dbt_utils_relationships_where__edda71a933c59492086f0e5d408e6225.sql', unrendered_config={'alias': 'dbt_utils_relationships_where__edda71a933c59492086f0e5d408e6225'}, created_at=1740124933.9451268, config_call_dict={'alias': 'dbt_utils_relationships_where__edda71a933c59492086f0e5d408e6225'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(alias="dbt_utils_relationships_where__edda71a933c59492086f0e5d408e6225") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\dbt_utils_relationships_where__edda71a933c59492086f0e5d408e6225.sql', compiled=True, compiled_code="\n\n\n\n\nwith left_table as (\n\n  select\n     as id\n\n  from dev_dwdb.compute_wh.my_second_dbt_model\n\n  where  is not null\n    and id <> '1'\n\n),\n\nright_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.compute_wh.my_first_dbt_model\n\n  where id is not null\n    and current_date -1\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m13:32:21.846510 [info ] [MainThread]: Test name: unique
[0m13:32:21.847546 [info ] [MainThread]: Test type: generic
[0m13:32:21.847546 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_id'], alias='unique_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740124933.9431212, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_second_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m13:32:21.849897 [info ] [MainThread]: Test name: not_null
[0m13:32:21.849897 [info ] [MainThread]: Test type: generic
[0m13:32:21.850902 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_second_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778', fqn=['dbt_dataops', 'example', 'not_null_my_second_dbt_model_id'], alias='not_null_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740124933.9421184, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_second_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m13:32:21.852913 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m13:32:21.857245 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m13:32:21.863669 [debug] [MainThread]: Using snowflake connection "master"
[0m13:32:21.864674 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9496762752532959'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9506797790527344'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with left_table as (    select      as id    from dev_dwdb.compute_wh.my_second_dbt_model    where  is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.compute_wh.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.0423636436462402'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.2078189849853516'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m13:32:22.413892 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.548 seconds
[0m13:32:22.413892 [debug] [MainThread]: Using snowflake connection "master"
[0m13:32:22.414893 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'compute_wh.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'compute_wh.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'compute_wh.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'compute_wh.my_second_dbt_model' as model_refs,
              'not_null_my_second_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'relationships_where'::varchar(4000) as test_name,
            'with left_table as (    select      as id    from dev_dwdb.compute_wh.my_second_dbt_model    where  is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.compute_wh.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m13:32:22.829466 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.414 seconds
[0m13:32:22.830758 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.97s]
[0m13:32:22.830758 [info ] [MainThread]: 
[0m13:32:22.831763 [debug] [MainThread]: On master: Close
[0m13:32:22.949001 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:32:22.950002 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m13:32:22.950002 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m13:32:22.950002 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:32:22.951376 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1.cef89f7e74' was properly closed.
[0m13:32:22.951376 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m13:32:22.951376 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6' was properly closed.
[0m13:32:22.952384 [info ] [MainThread]: 
[0m13:32:22.953388 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 project hook in 0 hours 0 minutes and 8.79 seconds (8.79s).
[0m13:32:22.954544 [debug] [MainThread]: Command end result
[0m13:32:22.990659 [info ] [MainThread]: 
[0m13:32:22.990659 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:32:22.991667 [info ] [MainThread]: 
[0m13:32:22.992673 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_ (models\example\schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\unique_my_second_dbt_model_.sql
[0m13:32:22.992673 [info ] [MainThread]: 
[0m13:32:22.993687 [error] [MainThread]:   Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 14 at position 5 unexpected 'as'.
  syntax error line 18 at position 9 unexpected 'is'.
  syntax error line 21 at position 0 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\dbt_utils_relationships_where__edda71a933c59492086f0e5d408e6225.sql
[0m13:32:22.993687 [info ] [MainThread]: 
[0m13:32:22.994690 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m13:32:22.995702 [debug] [MainThread]: Command `dbt build` failed at 13:32:22.995702 after 11.02 seconds
[0m13:32:22.995702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013945A6E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013960F723E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013960F72C80>]}
[0m13:32:22.996706 [debug] [MainThread]: Flushing usage events
[0m13:42:12.075685 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001496A22E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001496CDE2680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001496CDE24A0>]}


============================== 13:42:12.078729 | 70e6f498-cdc6-4324-9f2d-3cb58443f619 ==============================
[0m13:42:12.078729 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:42:12.079733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_2', 'send_anonymous_usage_stats': 'True'}
[0m13:42:12.825881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '70e6f498-cdc6-4324-9f2d-3cb58443f619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001496A4B7DC0>]}
[0m13:42:12.870158 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '70e6f498-cdc6-4324-9f2d-3cb58443f619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014969D53550>]}
[0m13:42:12.871218 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m13:42:12.892429 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:42:13.126323 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:42:13.126323 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m13:42:13.497723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '70e6f498-cdc6-4324-9f2d-3cb58443f619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014905F5D6C0>]}
[0m13:42:13.621753 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '70e6f498-cdc6-4324-9f2d-3cb58443f619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014905F5D7E0>]}
[0m13:42:13.622754 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m13:42:13.624844 [info ] [MainThread]: 
[0m13:42:13.626164 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:42:13.627197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m13:42:13.639699 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m13:42:13.639699 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m13:42:13.640708 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:14.373552 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.733 seconds
[0m13:42:14.375562 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m13:42:14.500756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m13:42:14.507762 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m13:42:14.508764 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m13:42:14.508764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:42:15.105139 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.597 seconds
[0m13:42:15.107181 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m13:42:15.226732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '70e6f498-cdc6-4324-9f2d-3cb58443f619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014905F5D2A0>]}
[0m13:42:15.227736 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:42:15.228745 [info ] [MainThread]: 
[0m13:42:15.230752 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m13:42:15.231757 [info ] [Thread-1 (]: 1 of 5 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m13:42:15.231757 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m13:42:15.232763 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m13:42:15.241130 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m13:42:15.242134 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m13:42:15.264889 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m13:42:15.265893 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m13:42:15.265893 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m13:42:15.266898 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:42:16.377235 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.110 seconds
[0m13:42:16.394516 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m13:42:16.522443 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '70e6f498-cdc6-4324-9f2d-3cb58443f619', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000149056DFBE0>]}
[0m13:42:16.523444 [info ] [Thread-1 (]: 1 of 5 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.29s]
[0m13:42:16.523444 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m13:42:16.524832 [debug] [Thread-3 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:42:16.525836 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m13:42:16.525836 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m13:42:16.525836 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m13:42:16.526882 [info ] [Thread-3 (]: 2 of 5 START test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [RUN]
[0m13:42:16.526882 [info ] [Thread-4 (]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m13:42:16.527884 [info ] [Thread-2 (]: 4 of 5 START test unique_my_second_dbt_model_ .................................. [RUN]
[0m13:42:16.527884 [info ] [Thread-1 (]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m13:42:16.528991 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba'
[0m13:42:16.528991 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m13:42:16.530068 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6'
[0m13:42:16.530068 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_second_dbt_model, now test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:42:16.531195 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:42:16.531195 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m13:42:16.532198 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m13:42:16.532198 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m13:42:16.536623 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m13:42:16.544832 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m13:42:16.549839 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m13:42:16.553309 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:42:16.554410 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:42:16.555414 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m13:42:16.555414 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m13:42:16.567759 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m13:42:16.568762 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m13:42:16.632204 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m13:42:16.636602 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m13:42:16.640098 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:42:16.641101 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m13:42:16.642435 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m13:42:16.642435 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m13:42:16.643451 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




with left_table as (

  select
    id as id

  from dev_dwdb.compute_wh.my_second_dbt_model

  where id is not null
    and id <> '1'

),

right_table as (

  select
    id as id

  from dev_dwdb.compute_wh.my_first_dbt_model

  where id is not null
    and current_date -1

),

exceptions as (

  select
    left_table.id,
    right_table.id as right_id

  from left_table

  left join right_table
         on left_table.id = right_table.id

  where right_table.id is null

)

select * from exceptions


      
    ) dbt_internal_test
[0m13:42:16.643451 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m13:42:16.644462 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:42:16.645462 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
     as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where  is not null
group by 
having count(*) > 1



      
    ) dbt_internal_test
[0m13:42:16.645462 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:42:16.646463 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:42:16.646463 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:42:16.646463 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:42:16.649782 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:42:17.203679 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba896c-3201-72ef-000b-f6920002d362
[0m13:42:17.203679 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 31 at position 4
Invalid argument types for function 'AND': (BOOLEAN, DATE)
[0m13:42:17.204688 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: Close
[0m13:42:17.293716 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.644 seconds
[0m13:42:17.296745 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:42:17.326061 [debug] [Thread-3 (]: Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\schema.yml)
  001044 (42P13): SQL compilation error: error line 31 at position 4
  Invalid argument types for function 'AND': (BOOLEAN, DATE)
  compiled code at target\run\dbt_dataops\models\example\schema.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m13:42:17.327065 [error] [Thread-3 (]: 2 of 5 ERROR dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [[31mERROR[0m in 0.80s]
[0m13:42:17.328070 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:42:17.429248 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.90s]
[0m13:42:17.431256 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m13:42:18.410864 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.765 seconds
[0m13:42:18.412869 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:42:18.531538 [info ] [Thread-4 (]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 2.00s]
[0m13:42:18.532941 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m13:42:19.396154 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ba896c-3201-7372-000b-f69200030afe
[0m13:42:19.397162 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 5 unexpected 'as'.
syntax error line 12 at position 9 unexpected '('.
syntax error line 15 at position 7 unexpected 'is'.
syntax error line 17 at position 0 unexpected 'having'.
syntax error line 22 at position 4 unexpected ')'.
[0m13:42:19.397162 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: Close
[0m13:42:19.523166 [debug] [Thread-2 (]: Database Error in test unique_my_second_dbt_model_ (models\example\schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\unique_my_second_dbt_model_.sql
[0m13:42:19.524167 [error] [Thread-2 (]: 4 of 5 ERROR unique_my_second_dbt_model_ ....................................... [[31mERROR[0m in 2.99s]
[0m13:42:19.524167 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m13:42:19.526562 [info ] [MainThread]: 
[0m13:42:19.526562 [info ] [MainThread]: Running 1 on-run-end hook
[0m13:42:19.570368 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m13:42:19.576427 [debug] [MainThread]: Using snowflake connection "master"
[0m13:42:19.577431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m13:42:19.577431 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:42:20.685286 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.107 seconds
[0m13:42:20.689311 [info ] [MainThread]: Test name: relationships_where
[0m13:42:20.690313 [info ] [MainThread]: Test type: generic
[0m13:42:20.692318 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', unrendered_config={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, created_at=1740125533.413087, config_call_dict={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(alias="dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', compiled=True, compiled_code="\n\n\n\n\nwith left_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.compute_wh.my_second_dbt_model\n\n  where id is not null\n    and id <> '1'\n\n),\n\nright_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.compute_wh.my_first_dbt_model\n\n  where id is not null\n    and current_date -1\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m13:42:20.702754 [info ] [MainThread]: Test name: unique
[0m13:42:20.703759 [info ] [MainThread]: Test type: generic
[0m13:42:20.704767 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_id'], alias='unique_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740125533.4313087, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_second_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m13:42:20.706812 [info ] [MainThread]: Test name: not_null
[0m13:42:20.706812 [info ] [MainThread]: Test type: generic
[0m13:42:20.708223 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_second_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778', fqn=['dbt_dataops', 'example', 'not_null_my_second_dbt_model_id'], alias='not_null_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740125533.4303062, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_second_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m13:42:20.710241 [info ] [MainThread]: Test name: unique
[0m13:42:20.710241 [info ] [MainThread]: Test type: generic
[0m13:42:20.711244 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_second_dbt_model_', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_'], alias='unique_my_second_dbt_model_', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_.sql', unrendered_config={}, created_at=1740125533.4323115, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n     as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_second_dbt_model\nwhere  is not null\ngroup by \nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m13:42:20.713386 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m13:42:20.717389 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m13:42:20.727757 [debug] [MainThread]: Using snowflake connection "master"
[0m13:42:20.727757 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7970695495605469'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with left_table as (    select     id as id    from dev_dwdb.compute_wh.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.compute_wh.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8991811275482178'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.002546548843384'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.9930989742279053'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m13:42:21.265183 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.537 seconds
[0m13:42:21.266268 [debug] [MainThread]: Using snowflake connection "master"
[0m13:42:21.266268 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'compute_wh.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'compute_wh.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'compute_wh.my_second_dbt_model' as model_refs,
              'not_null_my_second_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'compute_wh.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'relationships_where'::varchar(4000) as test_name,
            'with left_table as (    select     id as id    from dev_dwdb.compute_wh.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.compute_wh.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m13:42:21.771724 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.504 seconds
[0m13:42:21.772727 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 1.05s]
[0m13:42:21.773731 [info ] [MainThread]: 
[0m13:42:21.773731 [debug] [MainThread]: On master: Close
[0m13:42:21.893537 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:42:21.894538 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m13:42:21.894538 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m13:42:21.895538 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:42:21.895538 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba' was properly closed.
[0m13:42:21.896568 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m13:42:21.896568 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6' was properly closed.
[0m13:42:21.897578 [info ] [MainThread]: 
[0m13:42:21.897578 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 project hook in 0 hours 0 minutes and 8.27 seconds (8.27s).
[0m13:42:21.899632 [debug] [MainThread]: Command end result
[0m13:42:21.940807 [info ] [MainThread]: 
[0m13:42:21.941819 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:42:21.942826 [info ] [MainThread]: 
[0m13:42:21.942826 [error] [MainThread]:   Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\schema.yml)
  001044 (42P13): SQL compilation error: error line 31 at position 4
  Invalid argument types for function 'AND': (BOOLEAN, DATE)
  compiled code at target\run\dbt_dataops\models\example\schema.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m13:42:21.943850 [info ] [MainThread]: 
[0m13:42:21.944856 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_ (models\example\schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\unique_my_second_dbt_model_.sql
[0m13:42:21.944856 [info ] [MainThread]: 
[0m13:42:21.945859 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m13:42:21.946926 [debug] [MainThread]: Command `dbt build` failed at 13:42:21.946926 after 9.93 seconds
[0m13:42:21.947929 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001496A22E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001490583F700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001490583DB70>]}
[0m13:42:21.948973 [debug] [MainThread]: Flushing usage events
[0m13:44:04.398670 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212328A2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212354999F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021235499BD0>]}


============================== 13:44:04.401757 | 3dc1d65b-b8ed-40c0-8d47-d640a43e752a ==============================
[0m13:44:04.401757 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:44:04.402760 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_2', 'send_anonymous_usage_stats': 'True'}
[0m13:44:05.123923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3dc1d65b-b8ed-40c0-8d47-d640a43e752a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021232B2BA90>]}
[0m13:44:05.168484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3dc1d65b-b8ed-40c0-8d47-d640a43e752a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002124DD3F670>]}
[0m13:44:05.170509 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m13:44:05.190651 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:44:05.431842 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:44:05.431842 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:44:05.479866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3dc1d65b-b8ed-40c0-8d47-d640a43e752a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002124E2A4D90>]}
[0m13:44:05.650459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3dc1d65b-b8ed-40c0-8d47-d640a43e752a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021235416740>]}
[0m13:44:05.650459 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m13:44:05.652470 [info ] [MainThread]: 
[0m13:44:05.652470 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:44:05.654511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m13:44:05.666660 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m13:44:05.666660 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m13:44:05.667663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:06.312243 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.645 seconds
[0m13:44:06.314245 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m13:44:06.444090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m13:44:06.451225 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m13:44:06.451225 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m13:44:06.452232 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:44:06.962368 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.510 seconds
[0m13:44:06.964382 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m13:44:07.085253 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3dc1d65b-b8ed-40c0-8d47-d640a43e752a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021235417430>]}
[0m13:44:07.085253 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:44:07.086255 [info ] [MainThread]: 
[0m13:44:07.089270 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m13:44:07.090273 [info ] [Thread-1 (]: 1 of 5 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m13:44:07.090273 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m13:44:07.091278 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m13:44:07.100480 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m13:44:07.100480 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m13:44:07.123765 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m13:44:07.125775 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m13:44:07.125775 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m13:44:07.126779 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:44:08.029658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.903 seconds
[0m13:44:08.046839 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m13:44:08.166452 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '3dc1d65b-b8ed-40c0-8d47-d640a43e752a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002124DD3FBB0>]}
[0m13:44:08.167458 [info ] [Thread-1 (]: 1 of 5 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.08s]
[0m13:44:08.168463 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m13:44:08.169469 [debug] [Thread-3 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:44:08.169469 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m13:44:08.169469 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m13:44:08.170476 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m13:44:08.170476 [info ] [Thread-3 (]: 2 of 5 START test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [RUN]
[0m13:44:08.171486 [info ] [Thread-4 (]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m13:44:08.171486 [info ] [Thread-2 (]: 4 of 5 START test unique_my_second_dbt_model_ .................................. [RUN]
[0m13:44:08.172490 [info ] [Thread-1 (]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m13:44:08.173500 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba'
[0m13:44:08.173500 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m13:44:08.174506 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6'
[0m13:44:08.174506 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_second_dbt_model, now test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493)
[0m13:44:08.175616 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:44:08.175616 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m13:44:08.176622 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m13:44:08.176622 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m13:44:08.186689 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m13:44:08.194086 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m13:44:08.199126 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m13:44:08.203152 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:44:08.204611 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:44:08.204611 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m13:44:08.205617 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m13:44:08.217910 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m13:44:08.217910 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m13:44:08.219928 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m13:44:08.223023 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m13:44:08.226036 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:44:08.227045 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m13:44:08.228048 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m13:44:08.228048 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




with left_table as (

  select
    id as id

  from dev_dwdb.compute_wh.my_second_dbt_model

  where id is not null
    and id <> '1'

),

right_table as (

  select
    id as id

  from dev_dwdb.compute_wh.my_first_dbt_model

  where id is not null
    and current_date -1

),

exceptions as (

  select
    left_table.id,
    right_table.id as right_id

  from left_table

  left join right_table
         on left_table.id = right_table.id

  where right_table.id is null

)

select * from exceptions


      
    ) dbt_internal_test
[0m13:44:08.229179 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m13:44:08.229179 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m13:44:08.230186 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m13:44:08.230186 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:44:08.231194 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
     as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where  is not null
group by 
having count(*) > 1



      
    ) dbt_internal_test
[0m13:44:08.231194 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:44:08.232198 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:44:08.233209 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:44:08.235219 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:44:08.815490 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba896e-3201-73bc-000b-f6920002f0de
[0m13:44:08.816493 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 31 at position 4
Invalid argument types for function 'AND': (BOOLEAN, DATE)
[0m13:44:08.817512 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: Close
[0m13:44:08.895910 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.664 seconds
[0m13:44:08.899933 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m13:44:08.978431 [debug] [Thread-3 (]: Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\schema.yml)
  001044 (42P13): SQL compilation error: error line 31 at position 4
  Invalid argument types for function 'AND': (BOOLEAN, DATE)
  compiled code at target\run\dbt_dataops\models\example\schema.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m13:44:08.979438 [error] [Thread-3 (]: 2 of 5 ERROR dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [[31mERROR[0m in 0.81s]
[0m13:44:08.980446 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:44:09.050146 [info ] [Thread-4 (]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.88s]
[0m13:44:09.051151 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m13:44:09.800980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.566 seconds
[0m13:44:09.803004 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m13:44:09.928568 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.75s]
[0m13:44:09.929572 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m13:44:11.000367 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ba896e-3201-72ef-000b-f6920002d3ae
[0m13:44:11.001374 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 5 unexpected 'as'.
syntax error line 12 at position 9 unexpected '('.
syntax error line 15 at position 7 unexpected 'is'.
syntax error line 17 at position 0 unexpected 'having'.
syntax error line 22 at position 4 unexpected ')'.
[0m13:44:11.001374 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: Close
[0m13:44:11.432619 [debug] [Thread-2 (]: Database Error in test unique_my_second_dbt_model_ (models\example\schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\unique_my_second_dbt_model_.sql
[0m13:44:11.433623 [error] [Thread-2 (]: 4 of 5 ERROR unique_my_second_dbt_model_ ....................................... [[31mERROR[0m in 3.26s]
[0m13:44:11.434628 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m13:44:11.435634 [info ] [MainThread]: 
[0m13:44:11.436638 [info ] [MainThread]: Running 1 on-run-end hook
[0m13:44:11.475322 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m13:44:11.480484 [debug] [MainThread]: Using snowflake connection "master"
[0m13:44:11.481489 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m13:44:11.481489 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:44:12.486575 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.004 seconds
[0m13:44:12.490601 [info ] [MainThread]: Test name: relationships_where
[0m13:44:12.491607 [info ] [MainThread]: Test type: generic
[0m13:44:12.492614 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', unrendered_config={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, created_at=1740125533.413087, config_call_dict={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(alias="dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', compiled=True, compiled_code="\n\n\n\n\nwith left_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.compute_wh.my_second_dbt_model\n\n  where id is not null\n    and id <> '1'\n\n),\n\nright_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.compute_wh.my_first_dbt_model\n\n  where id is not null\n    and current_date -1\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m13:44:12.501793 [info ] [MainThread]: Test name: not_null
[0m13:44:12.501793 [info ] [MainThread]: Test type: generic
[0m13:44:12.502798 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_second_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778', fqn=['dbt_dataops', 'example', 'not_null_my_second_dbt_model_id'], alias='not_null_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740125533.4303062, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh.my_second_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m13:44:12.503803 [info ] [MainThread]: Test name: unique
[0m13:44:12.504808 [info ] [MainThread]: Test type: generic
[0m13:44:12.505814 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_id'], alias='unique_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740125533.4313087, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_second_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m13:44:12.506820 [info ] [MainThread]: Test name: unique
[0m13:44:12.507826 [info ] [MainThread]: Test type: generic
[0m13:44:12.508837 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_second_dbt_model_', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_'], alias='unique_my_second_dbt_model_', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_.sql', unrendered_config={}, created_at=1740125533.4323115, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_second_dbt_model_.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n     as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh.my_second_dbt_model\nwhere  is not null\ngroup by \nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m13:44:12.511091 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m13:44:12.515120 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m13:44:12.521151 [debug] [MainThread]: Using snowflake connection "master"
[0m13:44:12.522159 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8069474697113037'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with left_table as (    select     id as id    from dev_dwdb.compute_wh.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.compute_wh.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8766465187072754'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7540619373321533'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.2591168880462646'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m13:44:12.962093 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.439 seconds
[0m13:44:12.962093 [debug] [MainThread]: Using snowflake connection "master"
[0m13:44:12.963094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'compute_wh.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'compute_wh.my_second_dbt_model' as model_refs,
              'not_null_my_second_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'compute_wh.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'compute_wh.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'relationships_where'::varchar(4000) as test_name,
            'with left_table as (    select     id as id    from dev_dwdb.compute_wh.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.compute_wh.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m13:44:13.267358 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.304 seconds
[0m13:44:13.268365 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.75s]
[0m13:44:13.269369 [info ] [MainThread]: 
[0m13:44:13.270378 [debug] [MainThread]: On master: Close
[0m13:44:13.399084 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:44:13.400087 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m13:44:13.400087 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m13:44:13.400087 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m13:44:13.401091 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba' was properly closed.
[0m13:44:13.401091 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m13:44:13.401091 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6' was properly closed.
[0m13:44:13.402094 [info ] [MainThread]: 
[0m13:44:13.403098 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 project hook in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m13:44:13.404103 [debug] [MainThread]: Command end result
[0m13:44:13.440653 [info ] [MainThread]: 
[0m13:44:13.441712 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:44:13.442715 [info ] [MainThread]: 
[0m13:44:13.442715 [error] [MainThread]:   Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\schema.yml)
  001044 (42P13): SQL compilation error: error line 31 at position 4
  Invalid argument types for function 'AND': (BOOLEAN, DATE)
  compiled code at target\run\dbt_dataops\models\example\schema.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m13:44:13.443761 [info ] [MainThread]: 
[0m13:44:13.443761 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_ (models\example\schema.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\unique_my_second_dbt_model_.sql
[0m13:44:13.444764 [info ] [MainThread]: 
[0m13:44:13.444764 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m13:44:13.445905 [debug] [MainThread]: Command `dbt build` failed at 13:44:13.445905 after 9.10 seconds
[0m13:44:13.446980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212328A2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002124DD3F670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002124E8DD210>]}
[0m13:44:13.446980 [debug] [MainThread]: Flushing usage events
[0m13:55:36.464331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B6CFE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B98BA620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B98BA440>]}


============================== 13:55:36.466337 | aa2b3aa5-d25d-4900-8dfa-84d60efc1bf3 ==============================
[0m13:55:36.466337 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:55:36.467340 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m13:55:37.206866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa2b3aa5-d25d-4900-8dfa-84d60efc1bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B6F8BA90>]}
[0m13:55:37.250261 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa2b3aa5-d25d-4900-8dfa-84d60efc1bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9D219F670>]}
[0m13:55:37.251264 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m13:55:37.272077 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:55:37.502454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:55:37.502454 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_first_dbt_model.sql
[0m13:55:37.879922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa2b3aa5-d25d-4900-8dfa-84d60efc1bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9D2A27EB0>]}
[0m13:55:38.000204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa2b3aa5-d25d-4900-8dfa-84d60efc1bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9D2A27A30>]}
[0m13:55:38.001251 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m13:55:38.003344 [info ] [MainThread]: 
[0m13:55:38.003344 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:55:38.004735 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m13:55:38.015975 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m13:55:38.015975 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m13:55:38.016976 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:38.736986 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.720 seconds
[0m13:55:38.738001 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m13:55:38.872825 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_dwdb, now create_dev_dwdb_compute_wh_marketing)
[0m13:55:38.873842 [debug] [ThreadPool]: Creating schema "database: "dev_dwdb"
schema: "compute_wh_marketing"
"
[0m13:55:38.878939 [debug] [ThreadPool]: Using snowflake connection "create_dev_dwdb_compute_wh_marketing"
[0m13:55:38.878939 [debug] [ThreadPool]: On create_dev_dwdb_compute_wh_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "create_dev_dwdb_compute_wh_marketing"} */
create schema if not exists dev_dwdb.compute_wh_marketing
[0m13:55:38.878939 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:55:39.397345 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.518 seconds
[0m13:55:39.398347 [debug] [ThreadPool]: On create_dev_dwdb_compute_wh_marketing: Close
[0m13:55:39.523872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh_marketing'
[0m13:55:39.523872 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m13:55:39.532040 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh_marketing"
[0m13:55:39.534054 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m13:55:39.535057 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh_marketing"} */
show objects in dev_dwdb.compute_wh_marketing limit 10000
[0m13:55:39.535057 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m13:55:39.535057 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:39.536062 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:55:40.143010 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.607 seconds
[0m13:55:40.144014 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh_marketing: Close
[0m13:55:41.060976 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 1.525 seconds
[0m13:55:41.061982 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m13:55:41.190949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa2b3aa5-d25d-4900-8dfa-84d60efc1bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9D2A24CA0>]}
[0m13:55:41.191953 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:55:41.191953 [info ] [MainThread]: 
[0m13:55:41.194963 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m13:55:41.194963 [info ] [Thread-1 (]: 1 of 4 START sql table model compute_wh_marketing.my_first_dbt_model ........... [RUN]
[0m13:55:41.195966 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m13:55:41.196968 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m13:55:41.204174 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m13:55:41.205177 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m13:55:41.226373 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m13:55:41.228429 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m13:55:41.228429 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh_marketing.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m13:55:41.229433 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:55:42.477373 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.248 seconds
[0m13:55:42.503342 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m13:55:42.635475 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aa2b3aa5-d25d-4900-8dfa-84d60efc1bf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9D2D816C0>]}
[0m13:55:42.636479 [info ] [Thread-1 (]: 1 of 4 OK created sql table model compute_wh_marketing.my_first_dbt_model ...... [[32mSUCCESS 1[0m in 1.44s]
[0m13:55:42.637481 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m13:55:42.638503 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:55:42.639506 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:55:42.639506 [info ] [Thread-3 (]: 2 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m13:55:42.640507 [info ] [Thread-4 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m13:55:42.641508 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:55:42.641508 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m13:55:42.642522 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:55:42.643527 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:55:42.655566 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:55:42.662017 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m13:55:42.663025 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:55:42.677494 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:55:42.678499 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:55:42.682511 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m13:55:42.683512 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:55:42.683512 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh_marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m13:55:42.684533 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:55:42.685537 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m13:55:42.686539 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh_marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:55:42.687668 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:55:43.540103 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.856 seconds
[0m13:55:43.544699 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:55:43.575523 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.887 seconds
[0m13:55:43.577900 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:55:43.678040 [error] [Thread-3 (]: 2 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.04s]
[0m13:55:43.680043 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:55:43.710439 [info ] [Thread-4 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.07s]
[0m13:55:43.712441 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:55:43.713442 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:55:43.714443 [info ] [Thread-1 (]: 4 of 4 SKIP test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [[33mSKIP[0m]
[0m13:55:43.715444 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:55:43.717446 [info ] [MainThread]: 
[0m13:55:43.718446 [info ] [MainThread]: Running 1 on-run-end hook
[0m13:55:43.789511 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh_marketing'}
[0m13:55:43.800521 [debug] [MainThread]: Using snowflake connection "master"
[0m13:55:43.801522 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m13:55:43.802523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:55:44.968765 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.167 seconds
[0m13:55:44.974807 [info ] [MainThread]: Test name: not_null
[0m13:55:44.975813 [info ] [MainThread]: Test type: generic
[0m13:55:44.976819 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126337.81138, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.compute_wh_marketing.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m13:55:44.985954 [info ] [MainThread]: Test name: unique
[0m13:55:44.986957 [info ] [MainThread]: Test type: generic
[0m13:55:44.987962 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126337.810377, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.compute_wh_marketing.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m13:55:44.988966 [info ] [MainThread]: Test name: relationships_where
[0m13:55:44.989970 [info ] [MainThread]: Test type: generic
[0m13:55:44.990984 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='compute_wh_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path=None, unrendered_config={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, created_at=1740125533.413087, config_call_dict={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(alias="dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path=None, compiled=False, compiled_code=None, extra_ctes_injected=False, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m13:55:44.991985 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m13:55:44.996665 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m13:55:45.002948 [debug] [MainThread]: Using snowflake connection "master"
[0m13:55:45.003949 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh_marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh_marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh_marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.035531997680664'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh_marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh_marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh_marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh_marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.0689318180084229'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh_marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'compute_wh_marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('compute_wh_marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('compute_wh_marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0'::text as execution_time_seconds,
            'skipped'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'None'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m13:55:45.534533 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.530 seconds
[0m13:55:45.535547 [debug] [MainThread]: Using snowflake connection "master"
[0m13:55:45.535547 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'compute_wh_marketing.my_first_dbt_model' as model_refs,
              'not_null_my_first_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'compute_wh_marketing.my_first_dbt_model' as model_refs,
              'unique_my_first_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'compute_wh_marketing.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh_marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh_marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'relationships_where'::varchar(4000) as test_name,
            'None'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m13:55:46.024126 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.487 seconds
[0m13:55:46.025127 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.03s]
[0m13:55:46.026163 [info ] [MainThread]: 
[0m13:55:46.027168 [debug] [MainThread]: On master: Close
[0m13:55:46.151094 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:55:46.151094 [debug] [MainThread]: Connection 'create_dev_dwdb_compute_wh_marketing' was properly closed.
[0m13:55:46.152105 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh_marketing' was properly closed.
[0m13:55:46.152105 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m13:55:46.153254 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m13:55:46.153254 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m13:55:46.153254 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m13:55:46.154259 [info ] [MainThread]: 
[0m13:55:46.155276 [info ] [MainThread]: Finished running 1 table model, 3 data tests, 1 project hook in 0 hours 0 minutes and 8.15 seconds (8.15s).
[0m13:55:46.156356 [debug] [MainThread]: Command end result
[0m13:55:46.196850 [info ] [MainThread]: 
[0m13:55:46.197854 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:55:46.197854 [info ] [MainThread]: 
[0m13:55:46.198858 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m13:55:46.200083 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:55:46.201092 [info ] [MainThread]: 
[0m13:55:46.201092 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m13:55:46.202095 [info ] [MainThread]: 
[0m13:55:46.203100 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m13:55:46.204104 [debug] [MainThread]: Command `dbt build` failed at 13:55:46.204104 after 9.79 seconds
[0m13:55:46.204104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B6CFE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B67FE4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A9B67FD450>]}
[0m13:55:46.205107 [debug] [MainThread]: Flushing usage events
[0m13:56:39.020626 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC44DDA9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4799A650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC4799A470>]}


============================== 13:56:39.023649 | f5190708-ae3d-4917-abce-28224d5a1da0 ==============================
[0m13:56:39.023649 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:56:39.024653 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m13:56:39.834600 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f5190708-ae3d-4917-abce-28224d5a1da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC47956C20>]}
[0m13:56:39.880181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f5190708-ae3d-4917-abce-28224d5a1da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC448B3580>]}
[0m13:56:39.882190 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m13:56:39.902356 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:56:40.014445 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:56:40.014445 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f5190708-ae3d-4917-abce-28224d5a1da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC46DC41F0>]}
[0m13:56:41.982210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f5190708-ae3d-4917-abce-28224d5a1da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC60583FA0>]}
[0m13:56:42.101857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f5190708-ae3d-4917-abce-28224d5a1da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC607C87C0>]}
[0m13:56:42.101857 [info ] [MainThread]: Found 2 models, 1 operation, 6 data tests, 841 macros
[0m13:56:42.104865 [info ] [MainThread]: 
[0m13:56:42.104865 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:56:42.106234 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m13:56:42.117348 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m13:56:42.117348 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m13:56:42.118351 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:42.782136 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.664 seconds
[0m13:56:42.783140 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m13:56:42.908834 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_dwdb, now create_dev_dwdb_marketing_marketing)
[0m13:56:42.909879 [debug] [ThreadPool]: Creating schema "database: "dev_dwdb"
schema: "marketing_marketing"
"
[0m13:56:42.915033 [debug] [ThreadPool]: Using snowflake connection "create_dev_dwdb_marketing_marketing"
[0m13:56:42.915033 [debug] [ThreadPool]: On create_dev_dwdb_marketing_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "create_dev_dwdb_marketing_marketing"} */
create schema if not exists dev_dwdb.marketing_marketing
[0m13:56:42.915033 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:56:43.462641 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.547 seconds
[0m13:56:43.463651 [debug] [ThreadPool]: On create_dev_dwdb_marketing_marketing: Close
[0m13:56:43.595796 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing_marketing'
[0m13:56:43.597204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m13:56:43.605408 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing_marketing"
[0m13:56:43.607533 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m13:56:43.608634 [debug] [ThreadPool]: On list_dev_dwdb_marketing_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing_marketing"} */
show objects in dev_dwdb.marketing_marketing limit 10000
[0m13:56:43.608634 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m13:56:43.609637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:43.609637 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:56:44.159409 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.549 seconds
[0m13:56:44.160412 [debug] [ThreadPool]: On list_dev_dwdb_marketing_marketing: Close
[0m13:56:45.157558 [debug] [ThreadPool]: Snowflake adapter: Snowflake query id: 01ba897a-3201-7372-000b-f69200030b86
[0m13:56:45.158570 [debug] [ThreadPool]: Snowflake adapter: Snowflake error: 002043 (02000): SQL compilation error:
Object does not exist, or operation cannot be performed.
[0m13:56:45.158570 [debug] [ThreadPool]: Snowflake adapter: Error running SQL: macro list_relations_without_caching
[0m13:56:45.159618 [debug] [ThreadPool]: Snowflake adapter: Rolling back transaction.
[0m13:56:45.159618 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m13:56:45.280716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f5190708-ae3d-4917-abce-28224d5a1da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC60DD6650>]}
[0m13:56:45.280716 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:56:45.281773 [info ] [MainThread]: 
[0m13:56:45.284787 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m13:56:45.285862 [info ] [Thread-1 (]: 1 of 4 START sql table model marketing_marketing.my_first_dbt_model ............ [RUN]
[0m13:56:45.286871 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m13:56:45.286871 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m13:56:45.296507 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m13:56:45.297962 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m13:56:45.320632 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m13:56:45.321643 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m13:56:45.322806 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.marketing_marketing.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m13:56:45.322806 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:56:46.208610 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.885 seconds
[0m13:56:46.227065 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m13:56:46.347605 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f5190708-ae3d-4917-abce-28224d5a1da0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC60E3CFA0>]}
[0m13:56:46.348608 [info ] [Thread-1 (]: 1 of 4 OK created sql table model marketing_marketing.my_first_dbt_model ....... [[32mSUCCESS 1[0m in 1.06s]
[0m13:56:46.349611 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m13:56:46.350614 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:56:46.350614 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:56:46.351620 [info ] [Thread-3 (]: 2 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m13:56:46.351620 [info ] [Thread-4 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m13:56:46.352622 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:56:46.352622 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m13:56:46.353685 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:56:46.353685 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:56:46.361724 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:56:46.366900 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m13:56:46.367903 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:56:46.368909 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:56:46.381032 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:56:46.384041 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m13:56:46.385046 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:56:46.385046 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m13:56:46.386147 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing_marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m13:56:46.386147 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing_marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:56:46.387152 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:56:46.387152 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:56:46.984107 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m13:56:46.987117 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:56:47.114318 [error] [Thread-3 (]: 2 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m13:56:47.116349 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:56:48.338192 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.950 seconds
[0m13:56:48.339284 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:56:48.460335 [info ] [Thread-4 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.11s]
[0m13:56:48.462347 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:56:48.462347 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:56:48.463394 [info ] [Thread-1 (]: 4 of 4 SKIP test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [[33mSKIP[0m]
[0m13:56:48.464408 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:56:48.465412 [info ] [MainThread]: 
[0m13:56:48.465412 [info ] [MainThread]: Running 1 on-run-end hook
[0m13:56:48.552801 [info ] [MainThread]: {'my_first_dbt_model': 'marketing_marketing', 'my_second_dbt_model': 'marketing'}
[0m13:56:48.557876 [debug] [MainThread]: Using snowflake connection "master"
[0m13:56:48.558879 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m13:56:48.560104 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:56:49.574943 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.015 seconds
[0m13:56:49.580959 [info ] [MainThread]: Test name: not_null
[0m13:56:49.580959 [info ] [MainThread]: Test type: generic
[0m13:56:49.582443 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126401.8817916, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing_marketing.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m13:56:49.591537 [info ] [MainThread]: Test name: unique
[0m13:56:49.592542 [info ] [MainThread]: Test type: generic
[0m13:56:49.593652 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126401.8807847, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing_marketing.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m13:56:49.594759 [info ] [MainThread]: Test name: relationships_where
[0m13:56:49.595783 [info ] [MainThread]: Test type: generic
[0m13:56:49.596790 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path=None, unrendered_config={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, created_at=1740126401.8827996, config_call_dict={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(alias="dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path=None, compiled=False, compiled_code=None, extra_ctes_injected=False, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m13:56:49.597794 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m13:56:49.601852 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m13:56:49.606901 [debug] [MainThread]: Using snowflake connection "master"
[0m13:56:49.607903 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing_marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing_marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing_marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.761695384979248'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing_marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing_marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing_marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing_marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.107712984085083'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing_marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing_marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing_marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing_marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0'::text as execution_time_seconds,
            'skipped'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'None'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m13:56:50.096244 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.488 seconds
[0m13:56:50.097506 [debug] [MainThread]: Using snowflake connection "master"
[0m13:56:50.098513 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing_marketing.my_first_dbt_model' as model_refs,
              'not_null_my_first_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing_marketing.my_first_dbt_model' as model_refs,
              'unique_my_first_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing_marketing.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing_marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing_marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'relationships_where'::varchar(4000) as test_name,
            'None'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m13:56:50.441085 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.342 seconds
[0m13:56:50.442105 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.84s]
[0m13:56:50.443170 [info ] [MainThread]: 
[0m13:56:50.443170 [debug] [MainThread]: On master: Close
[0m13:56:50.561671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:56:50.562676 [debug] [MainThread]: Connection 'create_dev_dwdb_marketing_marketing' was properly closed.
[0m13:56:50.562676 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing_marketing' was properly closed.
[0m13:56:50.563723 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m13:56:50.563723 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m13:56:50.564723 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m13:56:50.564723 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m13:56:50.565784 [info ] [MainThread]: 
[0m13:56:50.566917 [info ] [MainThread]: Finished running 1 table model, 3 data tests, 1 project hook in 0 hours 0 minutes and 8.46 seconds (8.46s).
[0m13:56:50.566917 [debug] [MainThread]: Command end result
[0m13:56:50.604828 [info ] [MainThread]: 
[0m13:56:50.605833 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:56:50.605833 [info ] [MainThread]: 
[0m13:56:50.606838 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m13:56:50.607842 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:56:50.608851 [info ] [MainThread]: 
[0m13:56:50.608851 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m13:56:50.609866 [info ] [MainThread]: 
[0m13:56:50.610873 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m13:56:50.612039 [debug] [MainThread]: Command `dbt build` failed at 13:56:50.612039 after 11.66 seconds
[0m13:56:50.612039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC44DDA9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC605A2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC605A1D50>]}
[0m13:56:50.613366 [debug] [MainThread]: Flushing usage events
[0m13:57:30.999013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023869E72950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002386CA2E620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002386CA2E440>]}


============================== 13:57:31.002024 | afb0f0c2-abf0-4e13-83ec-ec70b6ebc898 ==============================
[0m13:57:31.002024 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:57:31.002024 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:57:31.755863 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'afb0f0c2-abf0-4e13-83ec-ec70b6ebc898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002386C9E75B0>]}
[0m13:57:31.800317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'afb0f0c2-abf0-4e13-83ec-ec70b6ebc898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238053DF670>]}
[0m13:57:31.801321 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m13:57:31.822464 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:57:32.105386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:57:32.106462 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_first_dbt_model.sql
[0m13:57:32.476511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'afb0f0c2-abf0-4e13-83ec-ec70b6ebc898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023805C6BE50>]}
[0m13:57:32.602625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'afb0f0c2-abf0-4e13-83ec-ec70b6ebc898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023805C69E40>]}
[0m13:57:32.603641 [info ] [MainThread]: Found 2 models, 1 operation, 6 data tests, 841 macros
[0m13:57:32.604645 [info ] [MainThread]: 
[0m13:57:32.605648 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:57:32.606651 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m13:57:32.617782 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m13:57:32.618794 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m13:57:32.618794 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:33.250183 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.632 seconds
[0m13:57:33.252217 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m13:57:33.375140 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_dwdb, now create_dev_dwdb_marketing)
[0m13:57:33.376145 [debug] [ThreadPool]: Creating schema "database: "dev_dwdb"
schema: "marketing"
"
[0m13:57:33.380181 [debug] [ThreadPool]: Using snowflake connection "create_dev_dwdb_marketing"
[0m13:57:33.380181 [debug] [ThreadPool]: On create_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "create_dev_dwdb_marketing"} */
create schema if not exists dev_dwdb.marketing
[0m13:57:33.381187 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:57:33.943369 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.563 seconds
[0m13:57:33.944376 [debug] [ThreadPool]: On create_dev_dwdb_marketing: Close
[0m13:57:34.078408 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m13:57:34.085656 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m13:57:34.086666 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m13:57:34.086666 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:57:34.643767 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.557 seconds
[0m13:57:34.644771 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m13:57:34.783489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'afb0f0c2-abf0-4e13-83ec-ec70b6ebc898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023805C6A470>]}
[0m13:57:34.784495 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:57:34.784495 [info ] [MainThread]: 
[0m13:57:34.787560 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m13:57:34.788567 [info ] [Thread-1 (]: 1 of 4 START sql table model marketing.my_first_dbt_model ...................... [RUN]
[0m13:57:34.788567 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m13:57:34.789572 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m13:57:34.797670 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m13:57:34.798683 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m13:57:34.820009 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m13:57:34.822024 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m13:57:34.822024 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.marketing.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m13:57:34.823037 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:57:35.737812 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.915 seconds
[0m13:57:35.753145 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m13:57:35.882340 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'afb0f0c2-abf0-4e13-83ec-ec70b6ebc898', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238053DFBB0>]}
[0m13:57:35.882340 [info ] [Thread-1 (]: 1 of 4 OK created sql table model marketing.my_first_dbt_model ................. [[32mSUCCESS 1[0m in 1.09s]
[0m13:57:35.883355 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m13:57:35.884370 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:57:35.885375 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:57:35.885375 [info ] [Thread-3 (]: 2 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m13:57:35.886393 [info ] [Thread-4 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m13:57:35.886393 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:57:35.887398 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m13:57:35.887398 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:57:35.888409 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:57:35.897514 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:57:35.903546 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m13:57:35.904548 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:57:35.909577 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:57:35.917695 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:57:35.920715 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m13:57:35.921721 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:57:35.921721 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m13:57:35.922724 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m13:57:35.922724 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:57:35.923767 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:57:35.925946 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m13:57:36.539698 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m13:57:36.542720 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:57:36.668936 [error] [Thread-3 (]: 2 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m13:57:36.669946 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:57:37.568995 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.643 seconds
[0m13:57:37.570007 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:57:37.696135 [info ] [Thread-4 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.81s]
[0m13:57:37.697138 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:57:37.698146 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:57:37.699149 [info ] [Thread-1 (]: 4 of 4 SKIP test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [[33mSKIP[0m]
[0m13:57:37.699149 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:57:37.700151 [info ] [MainThread]: 
[0m13:57:37.701157 [info ] [MainThread]: Running 1 on-run-end hook
[0m13:57:37.813166 [info ] [MainThread]: {'my_second_dbt_model': 'marketing', 'my_first_dbt_model': 'marketing'}
[0m13:57:37.818185 [debug] [MainThread]: Using snowflake connection "master"
[0m13:57:37.819188 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m13:57:37.819188 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:57:38.783214 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.964 seconds
[0m13:57:38.788241 [info ] [MainThread]: Test name: not_null
[0m13:57:38.789247 [info ] [MainThread]: Test type: generic
[0m13:57:38.790251 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126452.4066944, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m13:57:38.800387 [info ] [MainThread]: Test name: unique
[0m13:57:38.800387 [info ] [MainThread]: Test type: generic
[0m13:57:38.801413 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126452.4056914, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m13:57:38.802419 [info ] [MainThread]: Test name: relationships_where
[0m13:57:38.803425 [info ] [MainThread]: Test type: generic
[0m13:57:38.804431 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path=None, unrendered_config={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, created_at=1740126401.8827996, config_call_dict={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(alias="dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path=None, compiled=False, compiled_code=None, extra_ctes_injected=False, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m13:57:38.805441 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m13:57:38.809467 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m13:57:38.814593 [debug] [MainThread]: Using snowflake connection "master"
[0m13:57:38.815658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7825427055358887'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.80873703956604'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0'::text as execution_time_seconds,
            'skipped'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'None'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m13:57:39.707000 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.890 seconds
[0m13:57:39.708002 [debug] [MainThread]: Using snowflake connection "master"
[0m13:57:39.708002 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_first_dbt_model' as model_refs,
              'not_null_my_first_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'unique_my_first_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'relationships_where'::varchar(4000) as test_name,
            'None'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m13:57:40.183464 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.474 seconds
[0m13:57:40.184465 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 4[0m in 1.37s]
[0m13:57:40.185465 [info ] [MainThread]: 
[0m13:57:40.186530 [debug] [MainThread]: On master: Close
[0m13:57:40.309249 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:57:40.310252 [debug] [MainThread]: Connection 'create_dev_dwdb_marketing' was properly closed.
[0m13:57:40.310252 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m13:57:40.310252 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m13:57:40.311257 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m13:57:40.311257 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m13:57:40.312261 [info ] [MainThread]: 
[0m13:57:40.312261 [info ] [MainThread]: Finished running 1 table model, 3 data tests, 1 project hook in 0 hours 0 minutes and 7.71 seconds (7.71s).
[0m13:57:40.314298 [debug] [MainThread]: Command end result
[0m13:57:40.352485 [info ] [MainThread]: 
[0m13:57:40.353491 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m13:57:40.354498 [info ] [MainThread]: 
[0m13:57:40.355503 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m13:57:40.355503 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:57:40.356509 [info ] [MainThread]: 
[0m13:57:40.356509 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m13:57:40.357570 [info ] [MainThread]: 
[0m13:57:40.358581 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=1 TOTAL=4
[0m13:57:40.359639 [debug] [MainThread]: Command `dbt build` failed at 13:57:40.359639 after 9.42 seconds
[0m13:57:40.360644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023869E72950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023805969AE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002380596AB00>]}
[0m13:57:40.360644 [debug] [MainThread]: Flushing usage events
[0m13:58:15.308760 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1069E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1325E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1325E230>]}


============================== 13:58:15.312066 | 7dfabe73-2818-4e4f-8e86-a0ab6f6fc7e6 ==============================
[0m13:58:15.312066 [info ] [MainThread]: Running with dbt=1.8.7
[0m13:58:15.313070 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m13:58:16.021807 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7dfabe73-2818-4e4f-8e86-a0ab6f6fc7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C10F59990>]}
[0m13:58:16.077554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7dfabe73-2818-4e4f-8e86-a0ab6f6fc7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C126DB700>]}
[0m13:58:16.079882 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m13:58:16.106646 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m13:58:16.355188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:58:16.355188 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:58:16.402684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7dfabe73-2818-4e4f-8e86-a0ab6f6fc7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2C0A4AF0>]}
[0m13:58:16.574990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7dfabe73-2818-4e4f-8e86-a0ab6f6fc7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2C0A5630>]}
[0m13:58:16.574990 [info ] [MainThread]: Found 2 models, 1 operation, 6 data tests, 841 macros
[0m13:58:16.576177 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dfabe73-2818-4e4f-8e86-a0ab6f6fc7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2BEC69E0>]}
[0m13:58:16.578188 [info ] [MainThread]: 
[0m13:58:16.578188 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m13:58:16.583214 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m13:58:16.597713 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m13:58:16.598725 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m13:58:16.598725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:58:17.275097 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.676 seconds
[0m13:58:17.277105 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m13:58:17.400741 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7dfabe73-2818-4e4f-8e86-a0ab6f6fc7e6', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C2C0A4E20>]}
[0m13:58:17.400741 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m13:58:17.401744 [info ] [MainThread]: 
[0m13:58:17.404756 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:58:17.405759 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:58:17.405759 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:58:17.406762 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [RUN]
[0m13:58:17.406762 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m13:58:17.407768 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m13:58:17.408786 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba'
[0m13:58:17.408786 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m13:58:17.410256 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m13:58:17.410256 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:58:17.411261 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:58:17.411261 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:58:17.425985 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m13:58:17.433013 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:58:17.438037 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m13:58:17.439041 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:58:17.440045 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:58:17.440045 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:58:17.457674 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m13:58:17.460686 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:58:17.462692 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m13:58:17.464700 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m13:58:17.464700 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m13:58:17.465701 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




with left_table as (

  select
    id as id

  from dev_dwdb.marketing.my_second_dbt_model

  where id is not null
    and id <> '1'

),

right_table as (

  select
    id as id

  from dev_dwdb.marketing.my_first_dbt_model

  where id is not null
    and current_date -1

),

exceptions as (

  select
    left_table.id,
    right_table.id as right_id

  from left_table

  left join right_table
         on left_table.id = right_table.id

  where right_table.id is null

)

select * from exceptions


      
    ) dbt_internal_test
[0m13:58:17.466702 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m13:58:17.466702 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m13:58:17.467745 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m13:58:17.467745 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m13:58:17.468760 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m13:58:17.469766 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m13:58:18.009183 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba897c-3201-73bc-000b-f6920002f25a
[0m13:58:18.009183 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m13:58:18.010188 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: Close
[0m13:58:18.133703 [debug] [Thread-1 (]: Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m13:58:18.134754 [error] [Thread-1 (]: 1 of 3 ERROR dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [[31mERROR[0m in 0.73s]
[0m13:58:18.135885 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m13:58:18.962533 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.492 seconds
[0m13:58:18.969623 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m13:58:19.096391 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.69s]
[0m13:58:19.097397 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m13:58:20.164271 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.696 seconds
[0m13:58:20.166282 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m13:58:20.291960 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.88s]
[0m13:58:20.293056 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m13:58:20.294062 [info ] [MainThread]: 
[0m13:58:20.295071 [info ] [MainThread]: Running 1 on-run-end hook
[0m13:58:20.335141 [info ] [MainThread]: {'my_second_dbt_model': 'marketing', 'my_first_dbt_model': 'marketing'}
[0m13:58:20.341408 [debug] [MainThread]: Using snowflake connection "master"
[0m13:58:20.342409 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m13:58:20.342409 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:58:21.368110 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.025 seconds
[0m13:58:21.372186 [info ] [MainThread]: Test name: relationships_where
[0m13:58:21.373190 [info ] [MainThread]: Test type: generic
[0m13:58:21.374194 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', unrendered_config={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, created_at=1740126401.8827996, config_call_dict={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(alias="dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', compiled=True, compiled_code="\n\n\n\n\nwith left_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_second_dbt_model\n\n  where id is not null\n    and id <> '1'\n\n),\n\nright_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_first_dbt_model\n\n  where id is not null\n    and current_date -1\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m13:58:21.383299 [info ] [MainThread]: Test name: unique
[0m13:58:21.384305 [info ] [MainThread]: Test type: generic
[0m13:58:21.385311 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126452.4056914, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m13:58:21.386378 [info ] [MainThread]: Test name: not_null
[0m13:58:21.387383 [info ] [MainThread]: Test type: generic
[0m13:58:21.387383 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126452.4066944, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m13:58:21.389444 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m13:58:21.393474 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m13:58:21.398506 [debug] [MainThread]: Using snowflake connection "master"
[0m13:58:21.399515 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7259676456451416'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.685131311416626'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.8831732273101807'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m13:58:21.799592 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.399 seconds
[0m13:58:21.799592 [debug] [MainThread]: Using snowflake connection "master"
[0m13:58:21.800603 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'unique_my_first_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'not_null_my_first_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'relationships_where'::varchar(4000) as test_name,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m13:58:22.189556 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.388 seconds
[0m13:58:22.190568 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.80s]
[0m13:58:22.191623 [info ] [MainThread]: 
[0m13:58:22.192648 [debug] [MainThread]: On master: Close
[0m13:58:22.311455 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:58:22.311455 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m13:58:22.312455 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba' was properly closed.
[0m13:58:22.312455 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m13:58:22.313457 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m13:58:22.313457 [info ] [MainThread]: 
[0m13:58:22.314646 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 5.74 seconds (5.74s).
[0m13:58:22.315744 [debug] [MainThread]: Command end result
[0m13:58:22.354490 [info ] [MainThread]: 
[0m13:58:22.354490 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m13:58:22.355624 [info ] [MainThread]: 
[0m13:58:22.356626 [error] [MainThread]:   Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m13:58:22.356626 [info ] [MainThread]: 
[0m13:58:22.357655 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m13:58:22.358718 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m13:58:22.358718 [info ] [MainThread]: 
[0m13:58:22.359724 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m13:58:22.360731 [info ] [MainThread]: 
[0m13:58:22.360731 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m13:58:22.362741 [debug] [MainThread]: Command `dbt test` failed at 13:58:22.362741 after 7.11 seconds
[0m13:58:22.363880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1069E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C126DB700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022C1267E650>]}
[0m13:58:22.363880 [debug] [MainThread]: Flushing usage events
[0m14:03:16.868230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE96F528F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE99B0A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE99B0A230>]}


============================== 14:03:16.871359 | f447c40e-5849-4fb8-be56-e22ac09ddf81 ==============================
[0m14:03:16.871359 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:03:16.872362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:03:17.578284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f447c40e-5849-4fb8-be56-e22ac09ddf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE971DBCD0>]}
[0m14:03:17.621755 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f447c40e-5849-4fb8-be56-e22ac09ddf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE98F8B760>]}
[0m14:03:17.622759 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:03:17.642880 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:03:17.867653 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:03:17.868656 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m14:03:18.217358 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f447c40e-5849-4fb8-be56-e22ac09ddf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB2C785B0>]}
[0m14:03:18.333359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f447c40e-5849-4fb8-be56-e22ac09ddf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB2C78AC0>]}
[0m14:03:18.334366 [info ] [MainThread]: Found 2 models, 1 operation, 6 data tests, 841 macros
[0m14:03:18.335370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f447c40e-5849-4fb8-be56-e22ac09ddf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB26E1D20>]}
[0m14:03:18.336377 [info ] [MainThread]: 
[0m14:03:18.337380 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:03:18.341399 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:03:18.354623 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:03:18.355626 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:03:18.355626 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:03:19.048767 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.693 seconds
[0m14:03:19.050779 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:03:19.179362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f447c40e-5849-4fb8-be56-e22ac09ddf81', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB2C780A0>]}
[0m14:03:19.179362 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:03:19.180363 [info ] [MainThread]: 
[0m14:03:19.183419 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:03:19.183419 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:03:19.183419 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:03:19.184539 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [RUN]
[0m14:03:19.185601 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:03:19.185601 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:03:19.186614 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba'
[0m14:03:19.186614 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:03:19.187644 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m14:03:19.187644 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:03:19.188652 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:03:19.188652 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:03:19.203086 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:03:19.209215 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:03:19.214707 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:03:19.215710 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:03:19.230693 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:03:19.230693 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:03:19.232806 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:03:19.235823 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:03:19.238864 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:03:19.240874 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:03:19.240874 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




with left_table as (

  select
    id as id

  from dev_dwdb.marketing.my_second_dbt_model

  where id is not null
    and id <> '1'

),

right_table as (

  select
    id as id

  from dev_dwdb.marketing.my_first_dbt_model

  where id is not null
    and current_date -1

),

exceptions as (

  select
    left_table.id,
    right_table.id as right_id

  from left_table

  left join right_table
         on left_table.id = right_table.id

  where right_table.id is null

)

select * from exceptions


      
    ) dbt_internal_test
[0m14:03:19.241882 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:03:19.241882 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:03:19.243220 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:03:19.244223 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:03:19.246348 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:03:19.247427 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:03:19.247427 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:03:19.825246 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba8981-3201-72ef-000b-f6920002d526
[0m14:03:19.825246 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m14:03:19.826249 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: Close
[0m14:03:19.866629 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.619 seconds
[0m14:03:19.873684 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:03:19.947709 [debug] [Thread-1 (]: Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m14:03:19.948715 [error] [Thread-1 (]: 1 of 3 ERROR dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [[31mERROR[0m in 0.76s]
[0m14:03:19.949718 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:03:20.001118 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.81s]
[0m14:03:20.002121 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:03:20.946706 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.699 seconds
[0m14:03:20.948774 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:03:21.074455 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.89s]
[0m14:03:21.075462 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:03:21.077074 [info ] [MainThread]: 
[0m14:03:21.077074 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:03:21.117598 [info ] [MainThread]: {'my_second_dbt_model': 'marketing', 'my_first_dbt_model': 'marketing'}
[0m14:03:21.122604 [debug] [MainThread]: Using snowflake connection "master"
[0m14:03:21.123605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:03:21.123605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:03:22.576391 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.452 seconds
[0m14:03:22.580413 [info ] [MainThread]: Test name: relationships_where
[0m14:03:22.581417 [info ] [MainThread]: Test type: generic
[0m14:03:22.582418 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', unrendered_config={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, created_at=1740126401.8827996, config_call_dict={'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(alias="dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', compiled=True, compiled_code="\n\n\n\n\nwith left_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_second_dbt_model\n\n  where id is not null\n    and id <> '1'\n\n),\n\nright_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_first_dbt_model\n\n  where id is not null\n    and current_date -1\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m14:03:22.592237 [info ] [MainThread]: Test name: unique
[0m14:03:22.592237 [info ] [MainThread]: Test type: generic
[0m14:03:22.593242 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126798.1507509, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:03:22.595256 [info ] [MainThread]: Test name: not_null
[0m14:03:22.595256 [info ] [MainThread]: Test type: generic
[0m14:03:22.596259 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126798.1517558, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:03:22.598283 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:03:22.601435 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:03:22.606714 [debug] [MainThread]: Using snowflake connection "master"
[0m14:03:22.607717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7631137371063232'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8134729862213135'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.887840986251831'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:03:23.056896 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.449 seconds
[0m14:03:23.056896 [debug] [MainThread]: Using snowflake connection "master"
[0m14:03:23.057901 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'unique_my_first_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'not_null_my_first_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'relationships_where'::varchar(4000) as test_name,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:03:23.422439 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.364 seconds
[0m14:03:23.423685 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.82s]
[0m14:03:23.423685 [info ] [MainThread]: 
[0m14:03:23.424689 [debug] [MainThread]: On master: Close
[0m14:03:23.544614 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:03:23.545619 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:03:23.545619 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba' was properly closed.
[0m14:03:23.545619 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:03:23.546624 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:03:23.546624 [info ] [MainThread]: 
[0m14:03:23.548097 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m14:03:23.549153 [debug] [MainThread]: Command end result
[0m14:03:23.662455 [info ] [MainThread]: 
[0m14:03:23.663622 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:03:23.664626 [info ] [MainThread]: 
[0m14:03:23.664626 [error] [MainThread]:   Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m14:03:23.665630 [info ] [MainThread]: 
[0m14:03:23.667704 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m14:03:23.667704 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:03:23.668714 [info ] [MainThread]: 
[0m14:03:23.669719 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m14:03:23.669719 [info ] [MainThread]: 
[0m14:03:23.670725 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m14:03:23.672031 [debug] [MainThread]: Command `dbt test` failed at 14:03:23.672031 after 6.86 seconds
[0m14:03:23.673035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DE96F528F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB3045BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DEB3047220>]}
[0m14:03:23.673035 [debug] [MainThread]: Flushing usage events
[0m14:04:34.910175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EAA87E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EAD43E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EAD43E230>]}


============================== 14:04:34.913299 | 5b2c8fb4-425c-4adf-a380-fd5b742da01a ==============================
[0m14:04:34.913299 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:04:34.914310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:04:35.633172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b2c8fb4-425c-4adf-a380-fd5b742da01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EAB138BE0>]}
[0m14:04:35.676603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b2c8fb4-425c-4adf-a380-fd5b742da01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EAC8BB700>]}
[0m14:04:35.677608 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:04:35.697306 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:04:35.936199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:04:35.937206 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m14:04:36.296827 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b2c8fb4-425c-4adf-a380-fd5b742da01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EC65A5480>]}
[0m14:04:36.415395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b2c8fb4-425c-4adf-a380-fd5b742da01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EC65A7070>]}
[0m14:04:36.415395 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m14:04:36.416556 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b2c8fb4-425c-4adf-a380-fd5b742da01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EC6011DB0>]}
[0m14:04:36.417561 [info ] [MainThread]: 
[0m14:04:36.418565 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:04:36.423584 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:04:36.435756 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:04:36.436764 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:04:36.436764 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:04:37.116083 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.679 seconds
[0m14:04:37.117089 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:04:37.248681 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b2c8fb4-425c-4adf-a380-fd5b742da01a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EC65A6680>]}
[0m14:04:37.248681 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:04:37.249785 [info ] [MainThread]: 
[0m14:04:37.252798 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:04:37.253813 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:04:37.253813 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:04:37.253813 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [RUN]
[0m14:04:37.254820 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:04:37.255888 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:04:37.255888 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba'
[0m14:04:37.256891 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:04:37.256891 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m14:04:37.256891 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:04:37.258377 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:04:37.258377 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:04:37.267434 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:04:37.273530 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:04:37.279573 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:04:37.280579 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:04:37.280579 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:04:37.296135 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:04:37.297145 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:04:37.299161 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:04:37.302259 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:04:37.303263 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:04:37.304272 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:04:37.304272 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




with left_table as (

  select
    id as id

  from dev_dwdb.marketing.my_second_dbt_model

  where id is not null
    and id <> '1'

),

right_table as (

  select
    id as id

  from dev_dwdb.marketing.my_first_dbt_model

  where id is not null
    and current_date -1

),

exceptions as (

  select
    left_table.id,
    right_table.id as right_id

  from left_table

  left join right_table
         on left_table.id = right_table.id

  where right_table.id is null

)

select * from exceptions


      
    ) dbt_internal_test
[0m14:04:37.305278 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:04:37.306284 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:04:37.306284 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:04:37.307291 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:04:37.307291 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:04:37.309300 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:04:37.895223 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba8982-3201-7372-000b-f69200030cae
[0m14:04:37.896238 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m14:04:37.896238 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: Close
[0m14:04:38.027638 [debug] [Thread-1 (]: Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m14:04:38.027638 [error] [Thread-1 (]: 1 of 3 ERROR dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [[31mERROR[0m in 0.77s]
[0m14:04:38.028642 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:04:38.833107 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.524 seconds
[0m14:04:38.839304 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:04:38.970446 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.71s]
[0m14:04:38.972461 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:04:40.080154 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.773 seconds
[0m14:04:40.082165 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:04:40.211968 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.96s]
[0m14:04:40.212972 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:04:40.213976 [info ] [MainThread]: 
[0m14:04:40.214982 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:04:40.253755 [info ] [MainThread]: {'my_first_dbt_model': 'marketing', 'my_second_dbt_model': 'marketing'}
[0m14:04:40.258917 [debug] [MainThread]: Using snowflake connection "master"
[0m14:04:40.259932 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:04:40.259932 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:04:41.253530 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.993 seconds
[0m14:04:41.258647 [info ] [MainThread]: Test name: relationships_where
[0m14:04:41.258647 [info ] [MainThread]: Test type: generic
[0m14:04:41.260108 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', schema='dbt_test__audit', database=None, tags=['example_2'], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['example_2'], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', unrendered_config={'tags': ['example_2'], 'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, created_at=1740126876.2190936, config_call_dict={'tags': ['example_2'], 'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(tags=[\'example_2\'],alias="dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', compiled=True, compiled_code="\n\n\n\n\nwith left_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_second_dbt_model\n\n  where id is not null\n    and id <> '1'\n\n),\n\nright_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_first_dbt_model\n\n  where id is not null\n    and current_date -1\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m14:04:41.269144 [info ] [MainThread]: Test name: unique
[0m14:04:41.269144 [info ] [MainThread]: Test type: generic
[0m14:04:41.270236 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126798.1507509, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:04:41.272378 [info ] [MainThread]: Test name: not_null
[0m14:04:41.272378 [info ] [MainThread]: Test type: generic
[0m14:04:41.273389 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\schema.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126798.1517558, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\schema.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:04:41.275514 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:04:41.279540 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:04:41.284565 [debug] [MainThread]: Using snowflake connection "master"
[0m14:04:41.285803 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7717494964599609'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.713555097579956'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.9550769329071045'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:04:41.709702 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.423 seconds
[0m14:04:41.709702 [debug] [MainThread]: Using snowflake connection "master"
[0m14:04:41.710717 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'unique_my_first_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'not_null_my_first_dbt_model_id' as test_name,
              'models\example\schema.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'relationships_where'::varchar(4000) as test_name,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:04:42.095468 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.384 seconds
[0m14:04:42.096472 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.82s]
[0m14:04:42.096472 [info ] [MainThread]: 
[0m14:04:42.097477 [debug] [MainThread]: On master: Close
[0m14:04:42.225218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:04:42.225218 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:04:42.226223 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba' was properly closed.
[0m14:04:42.226223 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:04:42.227227 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:04:42.227227 [info ] [MainThread]: 
[0m14:04:42.228251 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 5.81 seconds (5.81s).
[0m14:04:42.229254 [debug] [MainThread]: Command end result
[0m14:04:42.328221 [info ] [MainThread]: 
[0m14:04:42.329230 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:04:42.330338 [info ] [MainThread]: 
[0m14:04:42.330338 [error] [MainThread]:   Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\schema.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\schema.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m14:04:42.331343 [info ] [MainThread]: 
[0m14:04:42.332347 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m14:04:42.332347 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:04:42.332347 [info ] [MainThread]: 
[0m14:04:42.333615 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m14:04:42.333615 [info ] [MainThread]: 
[0m14:04:42.334718 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m14:04:42.335792 [debug] [MainThread]: Command `dbt test` failed at 14:04:42.335792 after 7.48 seconds
[0m14:04:42.335792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EAA87E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EC6363460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015EC6362800>]}
[0m14:04:42.336796 [debug] [MainThread]: Flushing usage events
[0m14:05:33.970480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D329CA2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D32C85A4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D32C85A2F0>]}


============================== 14:05:33.973513 | 0c91a5ca-e15c-4c2a-8d11-6cda85aab5c0 ==============================
[0m14:05:33.973513 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:05:33.974517 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:05:34.746104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c91a5ca-e15c-4c2a-8d11-6cda85aab5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D34516A020>]}
[0m14:05:34.789629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c91a5ca-e15c-4c2a-8d11-6cda85aab5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D32A55B730>]}
[0m14:05:34.790652 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:05:34.813014 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:05:35.063822 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 2 files added, 0 files changed.
[0m14:05:35.063822 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://models\example\my_second_dbt_model.yml
[0m14:05:35.064825 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://models\example\my_first_dbt_model.yml
[0m14:05:35.445028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c91a5ca-e15c-4c2a-8d11-6cda85aab5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3459CD660>]}
[0m14:05:35.571591 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c91a5ca-e15c-4c2a-8d11-6cda85aab5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D34548F4F0>]}
[0m14:05:35.571591 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m14:05:35.572598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c91a5ca-e15c-4c2a-8d11-6cda85aab5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D3456614E0>]}
[0m14:05:35.573614 [info ] [MainThread]: 
[0m14:05:35.574617 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:05:35.579651 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:05:35.591661 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:05:35.592663 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:05:35.592663 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:05:36.245454 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.652 seconds
[0m14:05:36.246459 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:05:36.372419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c91a5ca-e15c-4c2a-8d11-6cda85aab5c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D34548DAB0>]}
[0m14:05:36.373577 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:05:36.373577 [info ] [MainThread]: 
[0m14:05:36.376586 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:05:36.377589 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:05:36.377589 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:05:36.377589 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [RUN]
[0m14:05:36.378592 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:05:36.379596 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:05:36.379596 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba'
[0m14:05:36.380601 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:05:36.380601 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m14:05:36.381605 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:05:36.381605 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:05:36.382612 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:05:36.390790 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:05:36.396818 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:05:36.402845 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:05:36.405107 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:05:36.406315 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:05:36.406315 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:05:36.421450 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:05:36.424464 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:05:36.427472 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:05:36.429489 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:05:36.430495 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




with left_table as (

  select
    id as id

  from dev_dwdb.marketing.my_second_dbt_model

  where id is not null
    and id <> '1'

),

right_table as (

  select
    id as id

  from dev_dwdb.marketing.my_first_dbt_model

  where id is not null
    and current_date -1

),

exceptions as (

  select
    left_table.id,
    right_table.id as right_id

  from left_table

  left join right_table
         on left_table.id = right_table.id

  where right_table.id is null

)

select * from exceptions


      
    ) dbt_internal_test
[0m14:05:36.430495 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:05:36.431499 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:05:36.431499 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:05:36.432502 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:05:36.432502 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:05:36.434686 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:05:36.435690 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:05:37.026494 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba8983-3201-73bc-000b-f6920002f296
[0m14:05:37.026494 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m14:05:37.027497 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: Close
[0m14:05:37.153408 [debug] [Thread-1 (]: Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\my_second_dbt_model.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m14:05:37.154426 [error] [Thread-1 (]: 1 of 3 ERROR dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [[31mERROR[0m in 0.77s]
[0m14:05:37.155446 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:05:38.000523 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.566 seconds
[0m14:05:38.007831 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:05:38.134185 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.75s]
[0m14:05:38.135452 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:05:39.217898 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.783 seconds
[0m14:05:39.218923 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:05:39.344028 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.96s]
[0m14:05:39.345031 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:05:39.347073 [info ] [MainThread]: 
[0m14:05:39.347073 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:05:39.386322 [info ] [MainThread]: {'my_first_dbt_model': 'marketing', 'my_second_dbt_model': 'marketing'}
[0m14:05:39.391375 [debug] [MainThread]: Using snowflake connection "master"
[0m14:05:39.391375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:05:39.392384 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:05:40.432982 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.040 seconds
[0m14:05:40.437002 [info ] [MainThread]: Test name: relationships_where
[0m14:05:40.438006 [info ] [MainThread]: Test type: generic
[0m14:05:40.439058 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', schema='dbt_test__audit', database=None, tags=['example_2'], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['example_2'], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', unrendered_config={'tags': ['example_2'], 'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, created_at=1740126935.3609014, config_call_dict={'tags': ['example_2'], 'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(tags=[\'example_2\'],alias="dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', compiled=True, compiled_code="\n\n\n\n\nwith left_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_second_dbt_model\n\n  where id is not null\n    and id <> '1'\n\n),\n\nright_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_first_dbt_model\n\n  where id is not null\n    and current_date -1\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m14:05:40.449479 [info ] [MainThread]: Test name: unique
[0m14:05:40.449479 [info ] [MainThread]: Test type: generic
[0m14:05:40.450973 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\my_first_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126935.3844373, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:05:40.452302 [info ] [MainThread]: Test name: not_null
[0m14:05:40.452302 [info ] [MainThread]: Test type: generic
[0m14:05:40.452302 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\my_first_dbt_model.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126935.385441, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:05:40.454798 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:05:40.522163 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:05:40.527190 [debug] [MainThread]: Using snowflake connection "master"
[0m14:05:40.528193 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.774829626083374'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.753584384918213'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_first_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.9634268283843994'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\my_first_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:05:40.965160 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.436 seconds
[0m14:05:40.966166 [debug] [MainThread]: Using snowflake connection "master"
[0m14:05:40.966166 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'unique_my_first_dbt_model_id' as test_name,
              'models\example\my_first_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'not_null_my_first_dbt_model_id' as test_name,
              'models\example\my_first_dbt_model.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'relationships_where'::varchar(4000) as test_name,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:05:41.328399 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.362 seconds
[0m14:05:41.330625 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.81s]
[0m14:05:41.330625 [info ] [MainThread]: 
[0m14:05:41.331631 [debug] [MainThread]: On master: Close
[0m14:05:41.464489 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:05:41.464489 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:05:41.465490 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba' was properly closed.
[0m14:05:41.465490 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:05:41.466627 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:05:41.466627 [info ] [MainThread]: 
[0m14:05:41.467631 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 5.89 seconds (5.89s).
[0m14:05:41.468709 [debug] [MainThread]: Command end result
[0m14:05:41.505008 [info ] [MainThread]: 
[0m14:05:41.506013 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:05:41.507017 [info ] [MainThread]: 
[0m14:05:41.508021 [error] [MainThread]:   Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\my_second_dbt_model.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m14:05:41.508021 [info ] [MainThread]: 
[0m14:05:41.509075 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\my_first_dbt_model.yml)[0m
[0m14:05:41.509075 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:05:41.510143 [info ] [MainThread]: 
[0m14:05:41.510143 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\my_first_dbt_model.yml\not_null_my_first_dbt_model_id.sql
[0m14:05:41.511148 [info ] [MainThread]: 
[0m14:05:41.512375 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m14:05:41.513388 [debug] [MainThread]: Command `dbt test` failed at 14:05:41.513388 after 7.60 seconds
[0m14:05:41.513388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D329CA2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D345CCBBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D345D2A4D0>]}
[0m14:05:41.514395 [debug] [MainThread]: Flushing usage events
[0m14:06:38.009638 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E4667E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E4923E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E4923E230>]}


============================== 14:06:38.012657 | 64869c4b-48ff-43fd-8b4a-bfe9b2b4b9c9 ==============================
[0m14:06:38.012657 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:06:38.013662 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example_1 --indirect-selection=cautious', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:06:38.746561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '64869c4b-48ff-43fd-8b4a-bfe9b2b4b9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E4690BCD0>]}
[0m14:06:38.791840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '64869c4b-48ff-43fd-8b4a-bfe9b2b4b9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E486BB760>]}
[0m14:06:38.792873 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:06:38.814622 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:06:39.058386 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:06:39.058386 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:06:39.106768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '64869c4b-48ff-43fd-8b4a-bfe9b2b4b9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6208CCD0>]}
[0m14:06:39.273808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '64869c4b-48ff-43fd-8b4a-bfe9b2b4b9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6208F820>]}
[0m14:06:39.273808 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m14:06:39.274812 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64869c4b-48ff-43fd-8b4a-bfe9b2b4b9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E61CAB4C0>]}
[0m14:06:39.275815 [info ] [MainThread]: 
[0m14:06:39.276818 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:06:39.281899 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:06:39.296218 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:06:39.297284 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:06:39.297284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:06:39.939376 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.642 seconds
[0m14:06:39.941387 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:06:40.072764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '64869c4b-48ff-43fd-8b4a-bfe9b2b4b9c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E6208C2B0>]}
[0m14:06:40.073782 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:06:40.073782 [info ] [MainThread]: 
[0m14:06:40.076872 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:06:40.076872 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:06:40.077878 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:06:40.077878 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:06:40.078884 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:06:40.079889 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m14:06:40.079889 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:06:40.079889 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:06:40.094292 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:06:40.099454 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:06:40.100460 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:06:40.116157 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:06:40.117160 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:06:40.120184 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:06:40.121207 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:06:40.121207 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:06:40.122339 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:06:40.123343 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:06:40.124349 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:06:40.125360 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:06:40.750532 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m14:06:40.757729 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:06:40.881146 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.80s]
[0m14:06:40.883251 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:06:41.716690 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.594 seconds
[0m14:06:41.718839 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:06:41.863732 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.78s]
[0m14:06:41.864752 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:06:41.866810 [info ] [MainThread]: 
[0m14:06:41.866810 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:06:41.904226 [info ] [MainThread]: {'my_first_dbt_model': 'marketing', 'my_second_dbt_model': 'marketing'}
[0m14:06:41.910411 [debug] [MainThread]: Using snowflake connection "master"
[0m14:06:41.911416 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:06:41.911416 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:06:42.936931 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.025 seconds
[0m14:06:42.940960 [info ] [MainThread]: Test name: unique
[0m14:06:42.941968 [info ] [MainThread]: Test type: generic
[0m14:06:42.942971 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\my_first_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126935.3844373, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:06:42.952180 [info ] [MainThread]: Test name: not_null
[0m14:06:42.952180 [info ] [MainThread]: Test type: generic
[0m14:06:42.953189 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\my_first_dbt_model.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126935.385441, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:06:42.954198 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:06:42.958389 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:06:42.963462 [debug] [MainThread]: Using snowflake connection "master"
[0m14:06:42.963462 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.802262544631958'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_first_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.784848928451538'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\my_first_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:06:43.446745 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.482 seconds
[0m14:06:43.446745 [debug] [MainThread]: Using snowflake connection "master"
[0m14:06:43.447746 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_first_dbt_model' as model_refs,
              'unique_my_first_dbt_model_id' as test_name,
              'models\example\my_first_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'not_null_my_first_dbt_model_id' as test_name,
              'models\example\my_first_dbt_model.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:06:44.174266 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.726 seconds
[0m14:06:44.175269 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 1.22s]
[0m14:06:44.176274 [info ] [MainThread]: 
[0m14:06:44.177276 [debug] [MainThread]: On master: Close
[0m14:06:44.294010 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:06:44.294010 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:06:44.295106 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:06:44.295106 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:06:44.296109 [info ] [MainThread]: 
[0m14:06:44.296109 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m14:06:44.297112 [debug] [MainThread]: Command end result
[0m14:06:44.334466 [info ] [MainThread]: 
[0m14:06:44.335469 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:06:44.335469 [info ] [MainThread]: 
[0m14:06:44.336472 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\my_first_dbt_model.yml)[0m
[0m14:06:44.337475 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:06:44.337475 [info ] [MainThread]: 
[0m14:06:44.338478 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\my_first_dbt_model.yml\not_null_my_first_dbt_model_id.sql
[0m14:06:44.339483 [info ] [MainThread]: 
[0m14:06:44.339483 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:06:44.341544 [debug] [MainThread]: Command `dbt test` failed at 14:06:44.341544 after 6.39 seconds
[0m14:06:44.341544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E4667E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E486BB760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024E624B55A0>]}
[0m14:06:44.342548 [debug] [MainThread]: Flushing usage events
[0m14:07:18.668949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B06A2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B325A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B325A320>]}


============================== 14:07:18.670954 | 26984aba-a7e2-47a3-aea1-ed33ffd59f1c ==============================
[0m14:07:18.670954 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:07:18.671959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example_1 --exclude model_2', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:19.361418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '26984aba-a7e2-47a3-aea1-ed33ffd59f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B3216620>]}
[0m14:07:19.404912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '26984aba-a7e2-47a3-aea1-ed33ffd59f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B01734F0>]}
[0m14:07:19.405915 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:07:19.427444 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:07:19.652311 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:07:19.652311 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:07:19.698804 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '26984aba-a7e2-47a3-aea1-ed33ffd59f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CC0ACD30>]}
[0m14:07:19.863504 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '26984aba-a7e2-47a3-aea1-ed33ffd59f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CC0AF880>]}
[0m14:07:19.864509 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m14:07:19.865514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26984aba-a7e2-47a3-aea1-ed33ffd59f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CC059030>]}
[0m14:07:19.865514 [warn ] [MainThread]: The selection criterion 'model_2' does not match any enabled nodes
[0m14:07:19.867526 [info ] [MainThread]: 
[0m14:07:19.868538 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:07:19.873570 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:07:19.888725 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:07:19.889725 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:07:19.889725 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:20.525016 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.635 seconds
[0m14:07:20.526023 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:07:20.677583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '26984aba-a7e2-47a3-aea1-ed33ffd59f1c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CC090820>]}
[0m14:07:20.678604 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:07:20.679609 [info ] [MainThread]: 
[0m14:07:20.681672 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:07:20.682819 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:07:20.682819 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:07:20.683825 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [RUN]
[0m14:07:20.683825 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:07:20.684829 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:07:20.684829 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba'
[0m14:07:20.685875 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:07:20.685875 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m14:07:20.686885 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:07:20.686885 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:07:20.687890 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:07:20.704173 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:07:20.711680 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:07:20.716789 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:07:20.717793 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:07:20.718796 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:07:20.735139 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:07:20.735139 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:07:20.738162 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:07:20.740172 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:07:20.742183 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:07:20.742183 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:07:20.743187 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




with left_table as (

  select
    id as id

  from dev_dwdb.marketing.my_second_dbt_model

  where id is not null
    and id <> '1'

),

right_table as (

  select
    id as id

  from dev_dwdb.marketing.my_first_dbt_model

  where id is not null
    and current_date -1

),

exceptions as (

  select
    left_table.id,
    right_table.id as right_id

  from left_table

  left join right_table
         on left_table.id = right_table.id

  where right_table.id is null

)

select * from exceptions


      
    ) dbt_internal_test
[0m14:07:20.743187 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:07:20.744288 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:07:20.744288 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:07:20.745308 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:07:20.745308 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:07:20.748322 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:07:21.282648 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba8985-3201-72ef-000b-f6920002d576
[0m14:07:21.283651 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m14:07:21.283651 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: Close
[0m14:07:21.403388 [debug] [Thread-1 (]: Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\my_second_dbt_model.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m14:07:21.403388 [error] [Thread-1 (]: 1 of 3 ERROR dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [[31mERROR[0m in 0.72s]
[0m14:07:21.404391 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:07:22.258577 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.511 seconds
[0m14:07:22.265600 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:07:22.391798 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.71s]
[0m14:07:22.392800 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:07:23.453938 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.709 seconds
[0m14:07:23.455966 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:07:23.584479 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.90s]
[0m14:07:23.585791 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:07:23.586801 [info ] [MainThread]: 
[0m14:07:23.587806 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:07:23.634431 [info ] [MainThread]: {'my_first_dbt_model': 'marketing', 'my_second_dbt_model': 'marketing'}
[0m14:07:23.639938 [debug] [MainThread]: Using snowflake connection "master"
[0m14:07:23.640941 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:07:23.640941 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:07:24.582485 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.941 seconds
[0m14:07:24.586488 [info ] [MainThread]: Test name: relationships_where
[0m14:07:24.586488 [info ] [MainThread]: Test type: generic
[0m14:07:24.587974 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', schema='dbt_test__audit', database=None, tags=['example_2'], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['example_2'], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', unrendered_config={'tags': ['example_2'], 'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, created_at=1740126935.3609014, config_call_dict={'tags': ['example_2'], 'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(tags=[\'example_2\'],alias="dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', compiled=True, compiled_code="\n\n\n\n\nwith left_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_second_dbt_model\n\n  where id is not null\n    and id <> '1'\n\n),\n\nright_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_first_dbt_model\n\n  where id is not null\n    and current_date -1\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m14:07:24.598763 [info ] [MainThread]: Test name: unique
[0m14:07:24.599766 [info ] [MainThread]: Test type: generic
[0m14:07:24.600770 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\my_first_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126935.3844373, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:07:24.601900 [info ] [MainThread]: Test name: not_null
[0m14:07:24.602906 [info ] [MainThread]: Test type: generic
[0m14:07:24.602906 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\my_first_dbt_model.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126935.385441, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:07:24.605115 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:07:24.609089 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:07:24.614838 [debug] [MainThread]: Using snowflake connection "master"
[0m14:07:24.615353 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7185592651367188'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7059223651885986'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_first_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.898603916168213'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\my_first_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:07:25.019132 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.404 seconds
[0m14:07:25.020170 [debug] [MainThread]: Using snowflake connection "master"
[0m14:07:25.021174 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'unique_my_first_dbt_model_id' as test_name,
              'models\example\my_first_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'not_null_my_first_dbt_model_id' as test_name,
              'models\example\my_first_dbt_model.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'relationships_where'::varchar(4000) as test_name,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:07:25.397666 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.376 seconds
[0m14:07:25.398672 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.79s]
[0m14:07:25.399677 [info ] [MainThread]: 
[0m14:07:25.400680 [debug] [MainThread]: On master: Close
[0m14:07:25.513732 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:07:25.514744 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:07:25.514744 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba' was properly closed.
[0m14:07:25.515748 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:07:25.515748 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:07:25.516752 [info ] [MainThread]: 
[0m14:07:25.516752 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 5.65 seconds (5.65s).
[0m14:07:25.517756 [debug] [MainThread]: Command end result
[0m14:07:25.557023 [info ] [MainThread]: 
[0m14:07:25.558037 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:07:25.559044 [info ] [MainThread]: 
[0m14:07:25.560049 [error] [MainThread]:   Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\my_second_dbt_model.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m14:07:25.560049 [info ] [MainThread]: 
[0m14:07:25.561056 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\my_first_dbt_model.yml)[0m
[0m14:07:25.562083 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:07:25.562083 [info ] [MainThread]: 
[0m14:07:25.563087 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\my_first_dbt_model.yml\not_null_my_first_dbt_model_id.sql
[0m14:07:25.563087 [info ] [MainThread]: 
[0m14:07:25.564155 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m14:07:25.565478 [debug] [MainThread]: Command `dbt test` failed at 14:07:25.565478 after 6.96 seconds
[0m14:07:25.566506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B06A2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8B267F4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C8CC4707F0>]}
[0m14:07:25.567510 [debug] [MainThread]: Flushing usage events
[0m14:07:56.831919 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9F2FA9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA1E8A560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA1E8A380>]}


============================== 14:07:56.834986 | 4f8c88ff-efe0-4c4b-aee4-1431614df69d ==============================
[0m14:07:56.834986 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:07:56.835989 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example_1 --indirect-selection=cautious', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:07:57.536355 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4f8c88ff-efe0-4c4b-aee4-1431614df69d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9F587940>]}
[0m14:07:57.581118 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4f8c88ff-efe0-4c4b-aee4-1431614df69d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA12D1720>]}
[0m14:07:57.582121 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:07:57.602653 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:07:57.826743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:07:57.827749 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:07:57.876331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4f8c88ff-efe0-4c4b-aee4-1431614df69d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBACDCDC0>]}
[0m14:07:58.041287 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4f8c88ff-efe0-4c4b-aee4-1431614df69d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBACDFCA0>]}
[0m14:07:58.042291 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m14:07:58.043298 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f8c88ff-efe0-4c4b-aee4-1431614df69d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBAC8C9A0>]}
[0m14:07:58.045307 [info ] [MainThread]: 
[0m14:07:58.045307 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:07:58.050327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:07:58.064487 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:07:58.064487 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:07:58.065491 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:07:58.695038 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.630 seconds
[0m14:07:58.697049 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:07:58.827465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4f8c88ff-efe0-4c4b-aee4-1431614df69d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9F5F09D0>]}
[0m14:07:58.828479 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:07:58.829485 [info ] [MainThread]: 
[0m14:07:58.832718 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:07:58.832718 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:07:58.833721 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:07:58.833721 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:07:58.834984 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:07:58.834984 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m14:07:58.835987 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:07:58.835987 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:07:58.851139 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:07:58.856172 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:07:58.857175 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:07:58.872188 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:07:58.873189 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:07:58.876494 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:07:58.877497 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:07:58.877497 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:07:58.878669 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:07:58.879676 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:07:58.881809 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:07:58.881809 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:07:59.776327 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.894 seconds
[0m14:07:59.783631 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:07:59.909431 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.07s]
[0m14:07:59.910434 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:07:59.988564 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.110 seconds
[0m14:07:59.990573 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:08:00.109937 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.28s]
[0m14:08:00.111944 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:08:00.112954 [info ] [MainThread]: 
[0m14:08:00.112954 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:08:00.152559 [info ] [MainThread]: {'my_first_dbt_model': 'marketing', 'my_second_dbt_model': 'marketing'}
[0m14:08:00.157578 [debug] [MainThread]: Using snowflake connection "master"
[0m14:08:00.158588 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:08:00.159590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:08:01.197287 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.038 seconds
[0m14:08:01.204364 [info ] [MainThread]: Test name: unique
[0m14:08:01.204364 [info ] [MainThread]: Test type: generic
[0m14:08:01.205365 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\my_first_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126935.3844373, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:08:01.216546 [info ] [MainThread]: Test name: not_null
[0m14:08:01.217549 [info ] [MainThread]: Test type: generic
[0m14:08:01.218570 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\my_first_dbt_model.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740126935.385441, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:08:01.220584 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:08:01.225899 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:08:01.234226 [debug] [MainThread]: Using snowflake connection "master"
[0m14:08:01.235227 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.0744478702545166'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_first_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.2762165069580078'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\my_first_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:08:01.669154 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.433 seconds
[0m14:08:01.669154 [debug] [MainThread]: Using snowflake connection "master"
[0m14:08:01.670159 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_first_dbt_model' as model_refs,
              'unique_my_first_dbt_model_id' as test_name,
              'models\example\my_first_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'not_null_my_first_dbt_model_id' as test_name,
              'models\example\my_first_dbt_model.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:08:02.090938 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.420 seconds
[0m14:08:02.091959 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.87s]
[0m14:08:02.092967 [info ] [MainThread]: 
[0m14:08:02.092967 [debug] [MainThread]: On master: Close
[0m14:08:02.221006 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:08:02.222063 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:08:02.222063 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:08:02.222063 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:08:02.223069 [info ] [MainThread]: 
[0m14:08:02.223069 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.18 seconds (4.18s).
[0m14:08:02.224076 [debug] [MainThread]: Command end result
[0m14:08:02.260780 [info ] [MainThread]: 
[0m14:08:02.261785 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:08:02.261785 [info ] [MainThread]: 
[0m14:08:02.262789 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\my_first_dbt_model.yml)[0m
[0m14:08:02.263794 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:08:02.264797 [info ] [MainThread]: 
[0m14:08:02.264797 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\my_first_dbt_model.yml\not_null_my_first_dbt_model_id.sql
[0m14:08:02.265807 [info ] [MainThread]: 
[0m14:08:02.265807 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:08:02.267876 [debug] [MainThread]: Command `dbt test` failed at 14:08:02.267876 after 5.49 seconds
[0m14:08:02.268880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AD9F2FA9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADA17C1B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001ADBB0C1660>]}
[0m14:08:02.268880 [debug] [MainThread]: Flushing usage events
[0m14:08:50.179345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121182F28F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001211AEA62F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001211AEA6110>]}


============================== 14:08:50.182631 | 46d8b9a0-4282-46ab-be8c-9ba74ce095b0 ==============================
[0m14:08:50.182631 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:08:50.183641 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt clean', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:08:50.337937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '46d8b9a0-4282-46ab-be8c-9ba74ce095b0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001211857BCD0>]}
[0m14:08:50.458172 [debug] [MainThread]: Command `dbt clean` succeeded at 14:08:50.458172 after 0.34 seconds
[0m14:08:50.458172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000121182F28F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012118BA9AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001211AEF2E90>]}
[0m14:08:50.459179 [debug] [MainThread]: Flushing usage events
[0m14:08:55.937013 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0DCD29E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC1088A560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC1088A380>]}


============================== 14:08:55.940022 | 59ab8de2-8134-4df7-a453-56754f1ed7e9 ==============================
[0m14:08:55.940022 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:08:55.941026 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_1 --indirect-selection=cautious', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:08:56.644178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59ab8de2-8134-4df7-a453-56754f1ed7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0DF57940>]}
[0m14:08:56.689576 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59ab8de2-8134-4df7-a453-56754f1ed7e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0FCCD720>]}
[0m14:08:56.690579 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:08:56.691584 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 3 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m14:08:56.692589 [debug] [MainThread]: Command `dbt test` failed at 14:08:56.692589 after 0.81 seconds
[0m14:08:56.692589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC0DCD29E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC292FA470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DC292F9C30>]}
[0m14:08:56.693600 [debug] [MainThread]: Flushing usage events
[0m14:09:02.842497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6566A2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65925A320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D65925A140>]}


============================== 14:09:02.845770 | 8abbcfa3-e49a-4cb2-8323-c509e84980d1 ==============================
[0m14:09:02.845770 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:09:02.846797 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt deps', 'send_anonymous_usage_stats': 'True'}
[0m14:09:02.999864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8abbcfa3-e49a-4cb2-8323-c509e84980d1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D659258F70>]}
[0m14:09:03.024658 [debug] [MainThread]: Set downloads directory='C:\Users\Vignesh\AppData\Local\Temp\dbt-downloads-3w2xra1m'
[0m14:09:03.025659 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:09:03.296694 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:09:03.297917 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m14:09:03.473569 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m14:09:03.475879 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:09:03.647030 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:09:03.650050 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m14:09:03.755720 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m14:09:03.757748 [info ] [MainThread]: Installing calogica/dbt_date
[0m14:09:04.212295 [info ] [MainThread]: Installed from version 0.10.1
[0m14:09:04.212295 [info ] [MainThread]: Up to date!
[0m14:09:04.213299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8abbcfa3-e49a-4cb2-8323-c509e84980d1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D656F62770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6594B3F10>]}
[0m14:09:04.214305 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:09:04.750491 [info ] [MainThread]: Installed from version 1.3.0
[0m14:09:04.751494 [info ] [MainThread]: Up to date!
[0m14:09:04.751494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8abbcfa3-e49a-4cb2-8323-c509e84980d1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D656F62770>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6594B3D90>]}
[0m14:09:04.752495 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m14:09:05.575412 [info ] [MainThread]: Installed from version 0.10.4
[0m14:09:05.575412 [info ] [MainThread]: Up to date!
[0m14:09:05.576791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '8abbcfa3-e49a-4cb2-8323-c509e84980d1', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6594B3340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6594B0160>]}
[0m14:09:05.578793 [debug] [MainThread]: Command `dbt deps` succeeded at 14:09:05.578793 after 2.79 seconds
[0m14:09:05.578793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D6566A2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D659259930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D656F61C00>]}
[0m14:09:05.580012 [debug] [MainThread]: Flushing usage events
[0m14:09:10.773050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A853E2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A87F9E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A87F9E2F0>]}


============================== 14:09:10.776358 | bb153f48-4b9f-4bfd-9408-e33a5d124226 ==============================
[0m14:09:10.776358 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:09:10.777366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example_1 --indirect-selection=cautious', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:09:11.566183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb153f48-4b9f-4bfd-9408-e33a5d124226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA08AE8C0>]}
[0m14:09:11.622718 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb153f48-4b9f-4bfd-9408-e33a5d124226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A85C9B730>]}
[0m14:09:11.624721 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:09:11.661862 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:09:11.664062 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:09:11.665440 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb153f48-4b9f-4bfd-9408-e33a5d124226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA09E0C70>]}
[0m14:09:13.924091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb153f48-4b9f-4bfd-9408-e33a5d124226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA08D3340>]}
[0m14:09:14.048782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb153f48-4b9f-4bfd-9408-e33a5d124226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA0D87130>]}
[0m14:09:14.049786 [info ] [MainThread]: Found 2 models, 1 operation, 6 data tests, 841 macros
[0m14:09:14.049786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb153f48-4b9f-4bfd-9408-e33a5d124226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA08D22F0>]}
[0m14:09:14.051802 [info ] [MainThread]: 
[0m14:09:14.052805 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:09:14.056819 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:09:14.072337 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:09:14.072337 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:09:14.073338 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:09:14.728577 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.656 seconds
[0m14:09:14.730585 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:09:14.859043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb153f48-4b9f-4bfd-9408-e33a5d124226', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA0D85930>]}
[0m14:09:14.859043 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:09:14.860044 [info ] [MainThread]: 
[0m14:09:14.863098 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:09:14.863098 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:09:14.864145 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:09:14.864145 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:09:14.865148 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:09:14.866155 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m14:09:14.866155 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:09:14.867160 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:09:14.878218 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:09:14.883447 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:09:14.885461 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:09:14.885461 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:09:14.900774 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:09:14.903809 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:09:14.905820 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:09:14.906825 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:09:14.906825 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:09:14.907831 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:09:14.907831 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:09:14.908837 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:09:15.414472 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m14:09:15.420627 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:09:15.551864 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.68s]
[0m14:09:15.552873 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:09:16.650954 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.743 seconds
[0m14:09:16.653628 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:09:16.772757 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.91s]
[0m14:09:16.773763 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:09:16.774769 [info ] [MainThread]: 
[0m14:09:16.775784 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:09:16.782795 [info ] [MainThread]: {'my_first_dbt_model': 'marketing', 'my_second_dbt_model': 'marketing'}
[0m14:09:16.788268 [debug] [MainThread]: Using snowflake connection "master"
[0m14:09:16.789275 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:09:16.789275 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:09:17.786274 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.996 seconds
[0m14:09:17.790636 [info ] [MainThread]: Test name: unique
[0m14:09:17.791729 [info ] [MainThread]: Test type: generic
[0m14:09:17.791729 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\my_first_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740127153.8224895, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:09:17.802868 [info ] [MainThread]: Test name: not_null
[0m14:09:17.802868 [info ] [MainThread]: Test type: generic
[0m14:09:17.804195 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\my_first_dbt_model.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740127153.8234906, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:09:17.805205 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:09:17.810250 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:09:17.814255 [debug] [MainThread]: Using snowflake connection "master"
[0m14:09:17.814255 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6847021579742432'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_first_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9066016674041748'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\my_first_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:09:18.212174 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.397 seconds
[0m14:09:18.213180 [debug] [MainThread]: Using snowflake connection "master"
[0m14:09:18.213180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_first_dbt_model' as model_refs,
              'unique_my_first_dbt_model_id' as test_name,
              'models\example\my_first_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'not_null_my_first_dbt_model_id' as test_name,
              'models\example\my_first_dbt_model.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:09:18.561345 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.347 seconds
[0m14:09:18.562349 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.75s]
[0m14:09:18.563365 [info ] [MainThread]: 
[0m14:09:18.563365 [debug] [MainThread]: On master: Close
[0m14:09:18.686368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:09:18.687374 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:09:18.687374 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:09:18.687374 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:09:18.688382 [info ] [MainThread]: 
[0m14:09:18.689387 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.64 seconds (4.64s).
[0m14:09:18.690473 [debug] [MainThread]: Command end result
[0m14:09:18.727067 [info ] [MainThread]: 
[0m14:09:18.728080 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:09:18.729092 [info ] [MainThread]: 
[0m14:09:18.729092 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\my_first_dbt_model.yml)[0m
[0m14:09:18.730115 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:09:18.731118 [info ] [MainThread]: 
[0m14:09:18.732138 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\my_first_dbt_model.yml\not_null_my_first_dbt_model_id.sql
[0m14:09:18.732138 [info ] [MainThread]: 
[0m14:09:18.733142 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:09:18.734147 [debug] [MainThread]: Command `dbt test` failed at 14:09:18.734147 after 8.02 seconds
[0m14:09:18.734147 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019A853E2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA09E34F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019AA12FFEB0>]}
[0m14:09:18.735151 [debug] [MainThread]: Flushing usage events
[0m14:10:59.730719 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF05C4E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF087FA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF087FA320>]}


============================== 14:10:59.733185 | b523dceb-1689-469f-b53c-7c9bb209d7cf ==============================
[0m14:10:59.733185 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:10:59.734189 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1 --indirect-selection=cautious', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:00.461332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b523dceb-1689-469f-b53c-7c9bb209d7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF2110E0B0>]}
[0m14:11:00.505628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b523dceb-1689-469f-b53c-7c9bb209d7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF05733520>]}
[0m14:11:00.505628 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:11:00.526508 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:11:00.667319 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:11:00.668340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'b523dceb-1689-469f-b53c-7c9bb209d7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF07C1A320>]}
[0m14:11:02.479922 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b523dceb-1689-469f-b53c-7c9bb209d7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF21423EE0>]}
[0m14:11:02.608972 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b523dceb-1689-469f-b53c-7c9bb209d7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF213C5810>]}
[0m14:11:02.608972 [info ] [MainThread]: Found 2 models, 1 operation, 6 data tests, 841 macros
[0m14:11:02.609997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b523dceb-1689-469f-b53c-7c9bb209d7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF21457820>]}
[0m14:11:02.612055 [info ] [MainThread]: 
[0m14:11:02.612055 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:11:02.619061 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:11:02.638974 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:11:02.640463 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:11:02.641507 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:03.330962 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.690 seconds
[0m14:11:03.333186 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:11:03.465782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b523dceb-1689-469f-b53c-7c9bb209d7cf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF2136DC90>]}
[0m14:11:03.466786 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:03.466786 [info ] [MainThread]: 
[0m14:11:03.470805 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:11:03.470805 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:11:03.471870 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:11:03.471870 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:11:03.473029 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:11:03.474033 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m14:11:03.474033 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:11:03.475033 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:11:03.486043 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:11:03.491561 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:11:03.492565 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:11:03.501630 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:11:03.509951 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:11:03.513973 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:11:03.515975 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:11:03.516976 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:11:03.517977 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:11:03.518978 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:11:03.518978 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:11:03.521193 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:11:04.005900 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.487 seconds
[0m14:11:04.013454 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:11:04.133468 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.66s]
[0m14:11:04.134480 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:11:05.093069 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.572 seconds
[0m14:11:05.095081 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:11:05.256196 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.78s]
[0m14:11:05.257199 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:11:05.264265 [error] [MainThread]: CANCEL query list_dev_dwdb_marketing ........................................... [[31mCANCEL[0m]
[0m14:11:05.265270 [error] [MainThread]: CANCEL query test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710 ........ [[31mCANCEL[0m]
[0m14:11:05.266292 [error] [MainThread]: CANCEL query test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321 .......... [[31mCANCEL[0m]
[0m14:11:05.266292 [info ] [MainThread]: 
[0m14:11:05.267535 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m14:11:05.267535 [info ] [MainThread]: 
[0m14:11:05.269025 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\my_first_dbt_model.yml)[0m
[0m14:11:05.270081 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:11:05.270081 [info ] [MainThread]: 
[0m14:11:05.271084 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\my_first_dbt_model.yml\not_null_my_first_dbt_model_id.sql
[0m14:11:05.271084 [info ] [MainThread]: 
[0m14:11:05.272097 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:11:05.272097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:05.273111 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:11:05.273111 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:11:05.274115 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:11:05.274115 [info ] [MainThread]: 
[0m14:11:05.275118 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.66 seconds (2.66s).
[0m14:11:05.275118 [error] [MainThread]: Encountered an error:

[0m14:11:05.312659 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 816, in test
    results = task.run()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 487, in execute_with_hooks
    res = self.execute_nodes()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 397, in execute_nodes
    self.run_queue(pool)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 315, in run_queue
    self.job_queue.join()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\graph\queue.py", line 198, in join
    self.inner.join()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\threading.py", line 320, in wait
    waiter.acquire()
KeyboardInterrupt

[0m14:11:05.314666 [debug] [MainThread]: Command `dbt test` failed at 14:11:05.313663 after 5.65 seconds
[0m14:11:05.314666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF05C4E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF21457F70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF21C9A020>]}
[0m14:11:05.315670 [debug] [MainThread]: Flushing usage events
[0m14:11:14.876443 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286FF77E8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002868245E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002868245E230>]}


============================== 14:11:14.879584 | e0fb1b06-3f6a-46c2-922b-cab671633c9c ==============================
[0m14:11:14.879584 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:11:14.880738 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:11:15.610899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e0fb1b06-3f6a-46c2-922b-cab671633c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869AD91FC0>]}
[0m14:11:15.655765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e0fb1b06-3f6a-46c2-922b-cab671633c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286822A4A30>]}
[0m14:11:15.656768 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:11:15.676990 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:11:15.911021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:11:15.912023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:11:15.958990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e0fb1b06-3f6a-46c2-922b-cab671633c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869B2A4C70>]}
[0m14:11:16.142706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e0fb1b06-3f6a-46c2-922b-cab671633c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869B2A55A0>]}
[0m14:11:16.143707 [info ] [MainThread]: Found 2 models, 1 operation, 6 data tests, 841 macros
[0m14:11:16.145150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0fb1b06-3f6a-46c2-922b-cab671633c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869B0D29B0>]}
[0m14:11:16.146168 [info ] [MainThread]: 
[0m14:11:16.147171 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:11:16.152257 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:11:16.169611 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:11:16.169611 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:11:16.169611 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:11:16.779307 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.609 seconds
[0m14:11:16.781317 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:11:16.912673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e0fb1b06-3f6a-46c2-922b-cab671633c9c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286FF601DB0>]}
[0m14:11:16.913681 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:11:16.914949 [info ] [MainThread]: 
[0m14:11:16.917005 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:11:16.918010 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:11:16.918010 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:11:16.919015 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:11:16.920045 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m14:11:16.920045 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m14:11:16.921051 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:11:16.921051 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:11:16.935193 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:11:16.940223 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:11:16.941251 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:11:16.957023 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:11:16.958034 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:11:16.961067 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:11:16.962136 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:11:16.962136 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:11:16.963142 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m14:11:16.963142 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:11:16.964303 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:11:16.965307 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:11:17.478415 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m14:11:17.485463 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m14:11:17.611668 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.69s]
[0m14:11:17.612671 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:11:18.466250 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.500 seconds
[0m14:11:18.467254 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m14:11:18.594401 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.67s]
[0m14:11:18.595405 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m14:11:18.596411 [info ] [MainThread]: 
[0m14:11:18.597416 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:11:18.636773 [info ] [MainThread]: {'my_first_dbt_model': 'marketing', 'my_second_dbt_model': 'marketing'}
[0m14:11:18.642943 [debug] [MainThread]: Using snowflake connection "master"
[0m14:11:18.642943 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:11:18.642943 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:11:19.759632 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.116 seconds
[0m14:11:19.763666 [info ] [MainThread]: Test name: not_null
[0m14:11:19.764672 [info ] [MainThread]: Test type: generic
[0m14:11:19.765677 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_first_dbt_model_id.sql', original_file_path='models\\example\\my_first_dbt_model.yml', unique_id='test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710', fqn=['dbt_dataops', 'example', 'not_null_my_first_dbt_model_id'], alias='not_null_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\not_null_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740127262.3814735, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\not_null_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:11:19.774829 [info ] [MainThread]: Test name: unique
[0m14:11:19.775835 [info ] [MainThread]: Test type: generic
[0m14:11:19.776842 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_first_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_first_dbt_model_id.sql', original_file_path='models\\example\\my_first_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321', fqn=['dbt_dataops', 'example', 'unique_my_first_dbt_model_id'], alias='unique_my_first_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\unique_my_first_dbt_model_id.sql', unrendered_config={}, created_at=1740127262.379466, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_first_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_first_dbt_model.yml\\unique_my_first_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_first_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_first_dbt_model', attached_node='model.dbt_dataops.my_first_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_first_dbt_model')) }}"}, namespace=None))
[0m14:11:19.777845 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:11:19.782888 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:11:19.786903 [debug] [MainThread]: Using snowflake connection "master"
[0m14:11:19.787966 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6926524639129639'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\my_first_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.6743557453155518'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_first_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:11:20.160569 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.371 seconds
[0m14:11:20.160569 [debug] [MainThread]: Using snowflake connection "master"
[0m14:11:20.161593 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_first_dbt_model' as model_refs,
              'not_null_my_first_dbt_model_id' as test_name,
              'models\example\my_first_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'unique_my_first_dbt_model_id' as test_name,
              'models\example\my_first_dbt_model.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:11:20.509983 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.348 seconds
[0m14:11:20.510983 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.73s]
[0m14:11:20.511993 [info ] [MainThread]: 
[0m14:11:20.513006 [debug] [MainThread]: On master: Close
[0m14:11:20.630895 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:11:20.631917 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:11:20.631917 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:11:20.632931 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:11:20.632931 [info ] [MainThread]: 
[0m14:11:20.633935 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.49 seconds (4.49s).
[0m14:11:20.634949 [debug] [MainThread]: Command end result
[0m14:11:20.673308 [info ] [MainThread]: 
[0m14:11:20.674311 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:11:20.675331 [info ] [MainThread]: 
[0m14:11:20.675331 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\my_first_dbt_model.yml)[0m
[0m14:11:20.676336 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:11:20.676336 [info ] [MainThread]: 
[0m14:11:20.677340 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\my_first_dbt_model.yml\not_null_my_first_dbt_model_id.sql
[0m14:11:20.677340 [info ] [MainThread]: 
[0m14:11:20.678355 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:11:20.679362 [debug] [MainThread]: Command `dbt test` failed at 14:11:20.679362 after 5.86 seconds
[0m14:11:20.679362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286FF77E8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000286822A4A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002869B6C54E0>]}
[0m14:11:20.680530 [debug] [MainThread]: Flushing usage events
[0m14:12:50.460866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE2872980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE543A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE543A320>]}


============================== 14:12:50.463014 | 565227c0-4c35-4f2e-85e8-fd46cfbbb070 ==============================
[0m14:12:50.463014 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:12:50.464017 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_2', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:12:51.212405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '565227c0-4c35-4f2e-85e8-fd46cfbbb070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFFDD488E0>]}
[0m14:12:51.257723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '565227c0-4c35-4f2e-85e8-fd46cfbbb070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE2343520>]}
[0m14:12:51.258723 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:12:51.282833 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:12:51.508855 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:12:51.509858 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:12:51.558577 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '565227c0-4c35-4f2e-85e8-fd46cfbbb070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFFE284D30>]}
[0m14:12:51.723834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '565227c0-4c35-4f2e-85e8-fd46cfbbb070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFFE287640>]}
[0m14:12:51.723834 [info ] [MainThread]: Found 2 models, 1 operation, 6 data tests, 841 macros
[0m14:12:51.724839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '565227c0-4c35-4f2e-85e8-fd46cfbbb070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFFE012AA0>]}
[0m14:12:51.725843 [info ] [MainThread]: 
[0m14:12:51.726847 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:12:51.731972 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:12:51.747233 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:12:51.748236 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:12:51.748236 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:12:52.474619 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.726 seconds
[0m14:12:52.475623 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:12:52.597500 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '565227c0-4c35-4f2e-85e8-fd46cfbbb070', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFFE2843A0>]}
[0m14:12:52.597500 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:12:52.598510 [info ] [MainThread]: 
[0m14:12:52.601521 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:12:52.601521 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:12:52.602658 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:12:52.602658 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:12:52.602658 [info ] [Thread-1 (]: 1 of 4 START test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [RUN]
[0m14:12:52.603661 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:12:52.603661 [info ] [Thread-3 (]: 3 of 4 START test unique_my_second_dbt_model_ .................................. [RUN]
[0m14:12:52.604668 [info ] [Thread-4 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:12:52.605672 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba'
[0m14:12:52.605672 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m14:12:52.606676 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6'
[0m14:12:52.606676 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m14:12:52.607680 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:12:52.607680 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:12:52.608682 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:12:52.608682 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:12:52.623854 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:12:52.630885 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:12:52.637113 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:12:52.641125 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:12:52.642900 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:12:52.642900 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:12:52.644110 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:12:52.644110 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:12:52.659599 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:12:52.661934 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:12:52.665021 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:12:52.668069 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:12:52.669701 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:12:52.670704 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:12:52.671856 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:12:52.671856 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




with left_table as (

  select
    id as id

  from dev_dwdb.marketing.my_second_dbt_model

  where id is not null
    and id <> '1'

),

right_table as (

  select
    id as id

  from dev_dwdb.marketing.my_first_dbt_model

  where id is not null
    and current_date -1

),

exceptions as (

  select
    left_table.id,
    right_table.id as right_id

  from left_table

  left join right_table
         on left_table.id = right_table.id

  where right_table.id is null

)

select * from exceptions


      
    ) dbt_internal_test
[0m14:12:52.672861 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:12:52.672861 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:12:52.673874 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:12:52.673874 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:12:52.674879 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
     as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_second_dbt_model
where  is not null
group by 
having count(*) > 1



      
    ) dbt_internal_test
[0m14:12:52.674879 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:12:52.675884 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:12:52.676891 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:12:53.281558 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01ba898a-3201-73bc-000b-f6920002f2fe
[0m14:12:53.282559 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m14:12:53.282559 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:12:53.297673 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ba898a-3201-73bc-000b-f6920002f302
[0m14:12:53.298674 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m14:12:53.298674 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m14:12:53.308745 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba898a-3201-7372-000b-f69200030d26
[0m14:12:53.309746 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
[0m14:12:53.309746 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: Close
[0m14:12:53.404341 [debug] [Thread-4 (]: Database Error in test unique_my_second_dbt_model_id (models\example\my_second_dbt_model.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\unique_my_second_dbt_model_id.sql
[0m14:12:53.405344 [error] [Thread-4 (]: 4 of 4 ERROR unique_my_second_dbt_model_id ..................................... [[31mERROR[0m in 0.80s]
[0m14:12:53.406369 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:12:53.427555 [debug] [Thread-2 (]: Database Error in test not_null_my_second_dbt_model_id (models\example\my_second_dbt_model.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\not_null_my_second_dbt_model_id.sql
[0m14:12:53.428555 [error] [Thread-2 (]: 2 of 4 ERROR not_null_my_second_dbt_model_id ................................... [[31mERROR[0m in 0.82s]
[0m14:12:53.429556 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:12:53.438564 [debug] [Thread-1 (]: Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\my_second_dbt_model.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m14:12:53.438564 [error] [Thread-1 (]: 1 of 4 ERROR dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [[31mERROR[0m in 0.83s]
[0m14:12:53.440566 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:12:54.229780 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba898a-3201-72ef-000b-f6920002d5da
[0m14:12:54.229780 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 5 unexpected 'as'.
syntax error line 12 at position 9 unexpected '('.
syntax error line 15 at position 7 unexpected 'is'.
syntax error line 17 at position 0 unexpected 'having'.
syntax error line 22 at position 4 unexpected ')'.
[0m14:12:54.230786 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: Close
[0m14:12:54.350763 [debug] [Thread-3 (]: Database Error in test unique_my_second_dbt_model_ (models\example\my_second_dbt_model.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\unique_my_second_dbt_model_.sql
[0m14:12:54.351313 [error] [Thread-3 (]: 3 of 4 ERROR unique_my_second_dbt_model_ ....................................... [[31mERROR[0m in 1.74s]
[0m14:12:54.352319 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:12:54.353345 [info ] [MainThread]: 
[0m14:12:54.354348 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:12:54.392742 [info ] [MainThread]: {'my_first_dbt_model': 'marketing', 'my_second_dbt_model': 'marketing'}
[0m14:12:54.398882 [debug] [MainThread]: Using snowflake connection "master"
[0m14:12:54.398882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:12:54.399886 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:12:55.635093 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.235 seconds
[0m14:12:55.639107 [info ] [MainThread]: Test name: unique
[0m14:12:55.640110 [info ] [MainThread]: Test type: generic
[0m14:12:55.641113 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_id.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_id'], alias='unique_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740127262.3996615, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:12:55.650373 [info ] [MainThread]: Test name: not_null
[0m14:12:55.651377 [info ] [MainThread]: Test type: generic
[0m14:12:55.652525 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_second_dbt_model_id.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778', fqn=['dbt_dataops', 'example', 'not_null_my_second_dbt_model_id'], alias='not_null_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\not_null_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740127262.3986588, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\not_null_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:12:55.653528 [info ] [MainThread]: Test name: relationships_where
[0m14:12:55.654637 [info ] [MainThread]: Test type: generic
[0m14:12:55.655643 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', schema='dbt_test__audit', database=None, tags=['example_2'], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['example_2'], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', unrendered_config={'tags': ['example_2'], 'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, created_at=1740127262.383479, config_call_dict={'tags': ['example_2'], 'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(tags=[\'example_2\'],alias="dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', compiled=True, compiled_code="\n\n\n\n\nwith left_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_second_dbt_model\n\n  where id is not null\n    and id <> '1'\n\n),\n\nright_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_first_dbt_model\n\n  where id is not null\n    and current_date -1\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m14:12:55.656993 [info ] [MainThread]: Test name: unique
[0m14:12:55.657995 [info ] [MainThread]: Test type: generic
[0m14:12:55.659110 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_second_dbt_model_', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_'], alias='unique_my_second_dbt_model_', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_.sql', unrendered_config={}, created_at=1740127262.4006643, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n     as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere  is not null\ngroup by \nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:12:55.661821 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:12:55.666136 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:12:55.672657 [debug] [MainThread]: Using snowflake connection "master"
[0m14:12:55.672657 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7986681461334229'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8218827247619629'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8338963985443115'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7446362972259521'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:12:56.210277 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.537 seconds
[0m14:12:56.211283 [debug] [MainThread]: Using snowflake connection "master"
[0m14:12:56.211283 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_id' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_second_dbt_model' as model_refs,
              'not_null_my_second_dbt_model_id' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'relationships_where'::varchar(4000) as test_name,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:12:56.651165 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.439 seconds
[0m14:12:56.652174 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.99s]
[0m14:12:56.652174 [info ] [MainThread]: 
[0m14:12:56.653179 [debug] [MainThread]: On master: Close
[0m14:12:56.775935 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:12:56.775935 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:12:56.776936 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba' was properly closed.
[0m14:12:56.776936 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m14:12:56.776936 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6' was properly closed.
[0m14:12:56.777958 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:12:56.777958 [info ] [MainThread]: 
[0m14:12:56.778961 [info ] [MainThread]: Finished running 4 data tests, 1 project hook in 0 hours 0 minutes and 5.05 seconds (5.05s).
[0m14:12:56.780127 [debug] [MainThread]: Command end result
[0m14:12:56.816722 [info ] [MainThread]: 
[0m14:12:56.818079 [info ] [MainThread]: [31mCompleted with 4 errors and 0 warnings:[0m
[0m14:12:56.818079 [info ] [MainThread]: 
[0m14:12:56.819085 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_id (models\example\my_second_dbt_model.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\unique_my_second_dbt_model_id.sql
[0m14:12:56.819085 [info ] [MainThread]: 
[0m14:12:56.820107 [error] [MainThread]:   Database Error in test not_null_my_second_dbt_model_id (models\example\my_second_dbt_model.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\not_null_my_second_dbt_model_id.sql
[0m14:12:56.821153 [info ] [MainThread]: 
[0m14:12:56.821153 [error] [MainThread]:   Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\my_second_dbt_model.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MY_SECOND_DBT_MODEL' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m14:12:56.821153 [info ] [MainThread]: 
[0m14:12:56.822386 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_ (models\example\my_second_dbt_model.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\unique_my_second_dbt_model_.sql
[0m14:12:56.823484 [info ] [MainThread]: 
[0m14:12:56.824637 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=4 SKIP=0 TOTAL=4
[0m14:12:56.825640 [debug] [MainThread]: Command `dbt test` failed at 14:12:56.825640 after 6.42 seconds
[0m14:12:56.825640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE2872980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFE2343520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BFFE70AE00>]}
[0m14:12:56.826732 [debug] [MainThread]: Flushing usage events
[0m14:14:16.335218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE5D12950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE88D65F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE88D6410>]}


============================== 14:14:16.338229 | 461b559a-efdf-4ce0-938d-fd7e1150d435 ==============================
[0m14:14:16.338229 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:14:16.339232 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt build --select tag:example_2', 'send_anonymous_usage_stats': 'True'}
[0m14:14:17.126411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '461b559a-efdf-4ce0-938d-fd7e1150d435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE5F9BA90>]}
[0m14:14:17.170877 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '461b559a-efdf-4ce0-938d-fd7e1150d435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD8120CA60>]}
[0m14:14:17.171882 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:14:17.193223 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:14:17.475836 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:14:17.476839 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:14:17.524510 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '461b559a-efdf-4ce0-938d-fd7e1150d435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD81744E80>]}
[0m14:14:17.705612 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '461b559a-efdf-4ce0-938d-fd7e1150d435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD816FA0E0>]}
[0m14:14:17.706619 [info ] [MainThread]: Found 2 models, 1 operation, 6 data tests, 841 macros
[0m14:14:17.708647 [info ] [MainThread]: 
[0m14:14:17.709654 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:14:17.710659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m14:14:17.723065 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m14:14:17.724075 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m14:14:17.724075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:18.391102 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.667 seconds
[0m14:14:18.393108 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m14:14:18.525668 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:14:18.533714 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:14:18.533714 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:14:18.534727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:14:19.085256 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.551 seconds
[0m14:14:19.087333 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:14:19.209077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '461b559a-efdf-4ce0-938d-fd7e1150d435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE8887850>]}
[0m14:14:19.210387 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:14:19.210387 [info ] [MainThread]: 
[0m14:14:19.213404 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m14:14:19.214456 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.my_second_dbt_model ..................... [RUN]
[0m14:14:19.214456 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m14:14:19.215459 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m14:14:19.222627 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m14:14:19.223646 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m14:14:19.246093 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m14:14:19.247094 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m14:14:19.247094 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.marketing.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.marketing.my_first_dbt_model
where id = 1
        );
[0m14:14:19.248095 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:14:20.097518 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.849 seconds
[0m14:14:20.113600 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m14:14:20.240291 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '461b559a-efdf-4ce0-938d-fd7e1150d435', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE7CEED10>]}
[0m14:14:20.241518 [info ] [Thread-1 (]: 1 of 5 OK created sql table model marketing.my_second_dbt_model ................ [[32mSUCCESS 1[0m in 1.02s]
[0m14:14:20.242522 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m14:14:20.242522 [debug] [Thread-3 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:14:20.243538 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:14:20.243538 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:14:20.243538 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:14:20.244541 [info ] [Thread-3 (]: 2 of 5 START test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [RUN]
[0m14:14:20.245547 [info ] [Thread-4 (]: 3 of 5 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:14:20.245547 [info ] [Thread-2 (]: 4 of 5 START test unique_my_second_dbt_model_ .................................. [RUN]
[0m14:14:20.246555 [info ] [Thread-1 (]: 5 of 5 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:14:20.246555 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba'
[0m14:14:20.247562 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m14:14:20.248567 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6'
[0m14:14:20.248567 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_second_dbt_model, now test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493)
[0m14:14:20.249573 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:14:20.249573 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:14:20.250581 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:14:20.250581 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:14:20.261711 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:14:20.268747 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:14:20.273849 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:14:20.277871 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:14:20.278876 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:14:20.279883 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:14:20.293214 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:14:20.293214 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:14:20.296241 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:14:20.296241 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:14:20.299257 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:14:20.300262 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"
[0m14:14:20.303450 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:14:20.303450 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:14:20.304466 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




with left_table as (

  select
    id as id

  from dev_dwdb.marketing.my_second_dbt_model

  where id is not null
    and id <> '1'

),

right_table as (

  select
    id as id

  from dev_dwdb.marketing.my_first_dbt_model

  where id is not null
    and current_date -1

),

exceptions as (

  select
    left_table.id,
    right_table.id as right_id

  from left_table

  left join right_table
         on left_table.id = right_table.id

  where right_table.id is null

)

select * from exceptions


      
    ) dbt_internal_test
[0m14:14:20.305472 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:14:20.305472 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:14:20.306479 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:14:20.306479 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:14:20.307484 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
     as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_second_dbt_model
where  is not null
group by 
having count(*) > 1



      
    ) dbt_internal_test
[0m14:14:20.307484 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:14:20.308488 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:14:20.310498 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:14:20.311505 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:14:20.844051 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba898c-3201-72ef-000b-f6920002d616
[0m14:14:20.844051 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001044 (42P13): SQL compilation error: error line 31 at position 4
Invalid argument types for function 'AND': (BOOLEAN, DATE)
[0m14:14:20.845060 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba: Close
[0m14:14:20.949077 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m14:14:20.953125 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:14:20.973761 [debug] [Thread-3 (]: Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\my_second_dbt_model.yml)
  001044 (42P13): SQL compilation error: error line 31 at position 4
  Invalid argument types for function 'AND': (BOOLEAN, DATE)
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m14:14:20.973761 [error] [Thread-3 (]: 2 of 5 ERROR dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1  [[31mERROR[0m in 0.73s]
[0m14:14:20.975770 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba
[0m14:14:21.079581 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.83s]
[0m14:14:21.081589 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:14:21.818140 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ba898c-3201-7372-000b-f69200030d6a
[0m14:14:21.819147 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 5 unexpected 'as'.
syntax error line 12 at position 9 unexpected '('.
syntax error line 15 at position 7 unexpected 'is'.
syntax error line 17 at position 0 unexpected 'having'.
syntax error line 22 at position 4 unexpected ')'.
[0m14:14:21.819147 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: Close
[0m14:14:21.944077 [debug] [Thread-2 (]: Database Error in test unique_my_second_dbt_model_ (models\example\my_second_dbt_model.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\unique_my_second_dbt_model_.sql
[0m14:14:21.945079 [error] [Thread-2 (]: 4 of 5 ERROR unique_my_second_dbt_model_ ....................................... [[31mERROR[0m in 1.70s]
[0m14:14:21.946141 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:14:23.125851 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.817 seconds
[0m14:14:23.126855 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m14:14:23.272433 [info ] [Thread-4 (]: 3 of 5 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 3.02s]
[0m14:14:23.273445 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:14:23.275452 [info ] [MainThread]: 
[0m14:14:23.275452 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:14:23.318362 [info ] [MainThread]: {'my_first_dbt_model': 'marketing', 'my_second_dbt_model': 'marketing'}
[0m14:14:23.326383 [debug] [MainThread]: Using snowflake connection "master"
[0m14:14:23.326383 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:14:23.327387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:24.324883 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.997 seconds
[0m14:14:24.328905 [info ] [MainThread]: Test name: relationships_where
[0m14:14:24.329915 [info ] [MainThread]: Test type: generic
[0m14:14:24.330920 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'], alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57', schema='dbt_test__audit', database=None, tags=['example_2'], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['example_2'], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', unrendered_config={'tags': ['example_2'], 'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, created_at=1740127262.383479, config_call_dict={'tags': ['example_2'], 'alias': 'dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(tags=[\'example_2\'],alias="dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57") }}', language='sql', refs=[RefArgs(name='my_first_dbt_model', package=None, version=None), RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_first_dbt_model', 'model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql', compiled=True, compiled_code="\n\n\n\n\nwith left_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_second_dbt_model\n\n  where id is not null\n    and id <> '1'\n\n),\n\nright_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.my_first_dbt_model\n\n  where id is not null\n    and current_date -1\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('my_first_dbt_model')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace='dbt_utils'))
[0m14:14:24.342042 [info ] [MainThread]: Test name: unique
[0m14:14:24.343046 [info ] [MainThread]: Test type: generic
[0m14:14:24.344068 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_id.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_id'], alias='unique_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740127262.3996615, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:14:24.345072 [info ] [MainThread]: Test name: unique
[0m14:14:24.346075 [info ] [MainThread]: Test type: generic
[0m14:14:24.347078 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_second_dbt_model_', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_'], alias='unique_my_second_dbt_model_', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_.sql', unrendered_config={}, created_at=1740127262.4006643, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n     as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere  is not null\ngroup by \nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:14:24.349085 [info ] [MainThread]: Test name: not_null
[0m14:14:24.350093 [info ] [MainThread]: Test type: generic
[0m14:14:24.351099 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_second_dbt_model_id.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778', fqn=['dbt_dataops', 'example', 'not_null_my_second_dbt_model_id'], alias='not_null_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\not_null_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740127262.3986588, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\not_null_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:14:24.353189 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:14:24.357202 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:14:24.363304 [debug] [MainThread]: Using snowflake connection "master"
[0m14:14:24.364309 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_first_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_first_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_first_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7272055149078369'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8310143947601318'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.697516918182373'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.024871349334717'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:14:24.771514 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.407 seconds
[0m14:14:24.772514 [debug] [MainThread]: Using snowflake connection "master"
[0m14:14:24.773516 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_first_dbt_model' as model_refs,
              'dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_id' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_second_dbt_model' as model_refs,
              'not_null_my_second_dbt_model_id' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'relationships_where'::varchar(4000) as test_name,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.my_second_dbt_model    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.my_first_dbt_model    where id is not null     and current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:14:25.099426 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.324 seconds
[0m14:14:25.100437 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.74s]
[0m14:14:25.101444 [info ] [MainThread]: 
[0m14:14:25.101444 [debug] [MainThread]: On master: Close
[0m14:14:25.220586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:14:25.221592 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m14:14:25.221592 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:14:25.222596 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:14:25.222596 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1.b599413eba' was properly closed.
[0m14:14:25.222596 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m14:14:25.223606 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6' was properly closed.
[0m14:14:25.223606 [info ] [MainThread]: 
[0m14:14:25.224609 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 project hook in 0 hours 0 minutes and 7.51 seconds (7.51s).
[0m14:14:25.225612 [debug] [MainThread]: Command end result
[0m14:14:25.263523 [info ] [MainThread]: 
[0m14:14:25.264524 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m14:14:25.265815 [info ] [MainThread]: 
[0m14:14:25.266823 [error] [MainThread]:   Database Error in test dbt_utils_relationships_where_my_second_dbt_model_id__id__id_1___ref_my_first_dbt_model___current_date_1 (models\example\my_second_dbt_model.yml)
  001044 (42P13): SQL compilation error: error line 31 at position 4
  Invalid argument types for function 'AND': (BOOLEAN, DATE)
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\dbt_utils_relationships_where__027f438ae78c72fd4d2f81091409ae57.sql
[0m14:14:25.268053 [info ] [MainThread]: 
[0m14:14:25.269077 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_ (models\example\my_second_dbt_model.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\unique_my_second_dbt_model_.sql
[0m14:14:25.270084 [info ] [MainThread]: 
[0m14:14:25.271089 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m14:14:25.272107 [debug] [MainThread]: Command `dbt build` failed at 14:14:25.272107 after 9.00 seconds
[0m14:14:25.273112 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE5D12950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BDE65863B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BD81D5BDF0>]}
[0m14:14:25.273112 [debug] [MainThread]: Flushing usage events
[0m14:15:15.075696 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1B8C9E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1BB8625C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1BB8623E0>]}


============================== 14:15:15.078708 | da3a068e-d95b-4bfb-b2a3-ab150e2780fd ==============================
[0m14:15:15.078708 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:15:15.079878 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_2', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:15:15.809907 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'da3a068e-d95b-4bfb-b2a3-ab150e2780fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1D413DFF0>]}
[0m14:15:15.854847 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'da3a068e-d95b-4bfb-b2a3-ab150e2780fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1BB191750>]}
[0m14:15:15.856862 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:15:15.877069 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:15:16.117164 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m14:15:16.118201 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_second_dbt_model.yml
[0m14:15:16.118201 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_first_dbt_model.yml
[0m14:15:16.505326 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'da3a068e-d95b-4bfb-b2a3-ab150e2780fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1D49CD7B0>]}
[0m14:15:16.631517 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'da3a068e-d95b-4bfb-b2a3-ab150e2780fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1D49CEE00>]}
[0m14:15:16.631517 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m14:15:16.633527 [info ] [MainThread]: 
[0m14:15:16.634662 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:15:16.635667 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m14:15:16.646731 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m14:15:16.646731 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m14:15:16.647735 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:17.306388 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.659 seconds
[0m14:15:17.308400 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m14:15:17.433873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:15:17.441999 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:15:17.441999 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:15:17.441999 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:18.016790 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.574 seconds
[0m14:15:18.017807 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:15:18.139148 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'da3a068e-d95b-4bfb-b2a3-ab150e2780fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1D49CD840>]}
[0m14:15:18.140216 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:18.140216 [info ] [MainThread]: 
[0m14:15:18.143657 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m14:15:18.144681 [info ] [Thread-1 (]: 1 of 4 START sql table model marketing.my_second_dbt_model ..................... [RUN]
[0m14:15:18.145688 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m14:15:18.145688 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m14:15:18.154165 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m14:15:18.155169 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m14:15:18.177442 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m14:15:18.178443 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m14:15:18.178443 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.marketing.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.marketing.my_first_dbt_model
where id = 1
        );
[0m14:15:18.179444 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:19.103232 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.924 seconds
[0m14:15:19.120433 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m14:15:19.245004 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'da3a068e-d95b-4bfb-b2a3-ab150e2780fd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1D413FB50>]}
[0m14:15:19.246010 [info ] [Thread-1 (]: 1 of 4 OK created sql table model marketing.my_second_dbt_model ................ [[32mSUCCESS 1[0m in 1.10s]
[0m14:15:19.247014 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m14:15:19.247014 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:15:19.248076 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:15:19.248076 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:15:19.249079 [info ] [Thread-3 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:15:19.249079 [info ] [Thread-4 (]: 3 of 4 START test unique_my_second_dbt_model_ .................................. [RUN]
[0m14:15:19.250124 [info ] [Thread-2 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:15:19.251169 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m14:15:19.251169 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6'
[0m14:15:19.251169 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m14:15:19.252468 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:15:19.252468 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:15:19.253477 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:15:19.260584 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:15:19.265603 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:15:19.269613 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:15:19.270720 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:15:19.282819 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:15:19.282819 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:15:19.283829 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:15:19.286089 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:15:19.349389 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:15:19.351392 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:15:19.352393 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:15:19.353439 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:15:19.353439 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:15:19.354442 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:15:19.354442 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
     as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_second_dbt_model
where  is not null
group by 
having count(*) > 1



      
    ) dbt_internal_test
[0m14:15:19.356602 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:15:19.356602 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:15:19.357809 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:15:19.957154 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m14:15:19.960171 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m14:15:20.085865 [info ] [Thread-3 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.84s]
[0m14:15:20.086870 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:15:20.906432 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01ba898d-3201-72ef-000b-f6920002d64e
[0m14:15:20.907442 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 5 unexpected 'as'.
syntax error line 12 at position 9 unexpected '('.
syntax error line 15 at position 7 unexpected 'is'.
syntax error line 17 at position 0 unexpected 'having'.
syntax error line 22 at position 4 unexpected ')'.
[0m14:15:20.907442 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: Close
[0m14:15:21.031854 [debug] [Thread-4 (]: Database Error in test unique_my_second_dbt_model_ (models\example\my_second_dbt_model.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\unique_my_second_dbt_model_.sql
[0m14:15:21.032855 [error] [Thread-4 (]: 3 of 4 ERROR unique_my_second_dbt_model_ ....................................... [[31mERROR[0m in 1.78s]
[0m14:15:21.032855 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:15:22.192428 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.834 seconds
[0m14:15:22.193446 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:15:22.338567 [info ] [Thread-2 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 3.09s]
[0m14:15:22.339571 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:15:22.341579 [info ] [MainThread]: 
[0m14:15:22.341579 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:15:22.381177 [info ] [MainThread]: {'my_second_dbt_model': 'marketing', 'my_first_dbt_model': 'marketing'}
[0m14:15:22.387198 [debug] [MainThread]: Using snowflake connection "master"
[0m14:15:22.388208 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:15:22.388208 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:23.398145 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.009 seconds
[0m14:15:23.403178 [info ] [MainThread]: Test name: not_null
[0m14:15:23.403178 [info ] [MainThread]: Test type: generic
[0m14:15:23.404182 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_second_dbt_model_id.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778', fqn=['dbt_dataops', 'example', 'not_null_my_second_dbt_model_id'], alias='not_null_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\not_null_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740127516.4375775, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\not_null_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:15:23.414197 [info ] [MainThread]: Test name: unique
[0m14:15:23.414197 [info ] [MainThread]: Test type: generic
[0m14:15:23.415668 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_second_dbt_model_', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_'], alias='unique_my_second_dbt_model_', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_.sql', unrendered_config={}, created_at=1740127516.439583, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n     as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere  is not null\ngroup by \nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:15:23.416995 [info ] [MainThread]: Test name: unique
[0m14:15:23.417999 [info ] [MainThread]: Test type: generic
[0m14:15:23.419002 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_id.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_id'], alias='unique_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740127516.4385805, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:15:23.420330 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:15:23.424333 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:15:23.429508 [debug] [MainThread]: Using snowflake connection "master"
[0m14:15:23.429508 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8357415199279785'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.780684471130371'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.087398052215576'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:15:23.907942 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.477 seconds
[0m14:15:23.907942 [debug] [MainThread]: Using snowflake connection "master"
[0m14:15:23.908947 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_second_dbt_model' as model_refs,
              'not_null_my_second_dbt_model_id' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_id' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:15:24.254161 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.344 seconds
[0m14:15:24.255166 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.83s]
[0m14:15:24.256170 [info ] [MainThread]: 
[0m14:15:24.256170 [debug] [MainThread]: On master: Close
[0m14:15:24.383269 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:24.384278 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m14:15:24.384278 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:15:24.384278 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m14:15:24.385386 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m14:15:24.385386 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6' was properly closed.
[0m14:15:24.386390 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:15:24.386390 [info ] [MainThread]: 
[0m14:15:24.387395 [info ] [MainThread]: Finished running 1 table model, 3 data tests, 1 project hook in 0 hours 0 minutes and 7.75 seconds (7.75s).
[0m14:15:24.388408 [debug] [MainThread]: Command end result
[0m14:15:24.425154 [info ] [MainThread]: 
[0m14:15:24.426386 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:15:24.426386 [info ] [MainThread]: 
[0m14:15:24.427391 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_ (models\example\my_second_dbt_model.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\unique_my_second_dbt_model_.sql
[0m14:15:24.428421 [info ] [MainThread]: 
[0m14:15:24.428421 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:15:24.430537 [debug] [MainThread]: Command `dbt build` failed at 14:15:24.429432 after 9.41 seconds
[0m14:15:24.430537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1B8C9E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1B8773520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002F1BACD9D80>]}
[0m14:15:24.430537 [debug] [MainThread]: Flushing usage events
[0m14:15:37.858604 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2867E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2B286440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2B286260>]}


============================== 14:15:37.862083 | 7d089e19-4b0a-418d-8fd4-5a5ad03ec7fc ==============================
[0m14:15:37.862083 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:15:37.862083 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example_2', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:15:38.569857 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7d089e19-4b0a-418d-8fd4-5a5ad03ec7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2890BEB0>]}
[0m14:15:38.613464 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7d089e19-4b0a-418d-8fd4-5a5ad03ec7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE43B58670>]}
[0m14:15:38.614468 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:15:38.634893 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:15:38.869558 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:15:38.870562 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:15:38.918075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7d089e19-4b0a-418d-8fd4-5a5ad03ec7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE44094D90>]}
[0m14:15:39.086575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7d089e19-4b0a-418d-8fd4-5a5ad03ec7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE44095870>]}
[0m14:15:39.087580 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m14:15:39.087580 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d089e19-4b0a-418d-8fd4-5a5ad03ec7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE44050880>]}
[0m14:15:39.089598 [info ] [MainThread]: 
[0m14:15:39.089598 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:15:39.094787 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:15:39.108880 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:15:39.109882 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:15:39.109882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:15:39.783638 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.673 seconds
[0m14:15:39.785648 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:15:39.910122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7d089e19-4b0a-418d-8fd4-5a5ad03ec7fc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE440819C0>]}
[0m14:15:39.911125 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:15:39.912129 [info ] [MainThread]: 
[0m14:15:39.915141 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:15:39.915141 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:15:39.916146 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:15:39.916146 [info ] [Thread-1 (]: 1 of 3 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:15:39.917153 [info ] [Thread-2 (]: 2 of 3 START test unique_my_second_dbt_model_ .................................. [RUN]
[0m14:15:39.918159 [info ] [Thread-3 (]: 3 of 3 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:15:39.918159 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m14:15:39.919177 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6'
[0m14:15:39.920185 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m14:15:39.920185 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:15:39.921192 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:15:39.921192 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:15:39.934432 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:15:39.940528 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:15:39.943544 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:15:39.944631 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:15:39.944631 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:15:39.945636 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:15:39.961240 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:15:39.963246 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:15:39.966262 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:15:39.967266 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:15:39.967266 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:15:39.968282 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:15:39.968282 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:15:39.969350 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:15:39.969350 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
     as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_second_dbt_model
where  is not null
group by 
having count(*) > 1



      
    ) dbt_internal_test
[0m14:15:39.971364 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:15:39.972369 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:15:39.972369 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:15:40.536286 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.564 seconds
[0m14:15:40.543331 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:15:40.662461 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.74s]
[0m14:15:40.663464 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:15:41.668445 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ba898d-3201-72ef-000b-f6920002d662
[0m14:15:41.669446 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 5 unexpected 'as'.
syntax error line 12 at position 9 unexpected '('.
syntax error line 15 at position 7 unexpected 'is'.
syntax error line 17 at position 0 unexpected 'having'.
syntax error line 22 at position 4 unexpected ')'.
[0m14:15:41.669446 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: Close
[0m14:15:41.794077 [debug] [Thread-2 (]: Database Error in test unique_my_second_dbt_model_ (models\example\my_second_dbt_model.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\unique_my_second_dbt_model_.sql
[0m14:15:41.795080 [error] [Thread-2 (]: 2 of 3 ERROR unique_my_second_dbt_model_ ....................................... [[31mERROR[0m in 1.88s]
[0m14:15:41.796082 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:15:43.713650 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 3.745 seconds
[0m14:15:43.714653 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m14:15:43.844721 [info ] [Thread-1 (]: 1 of 3 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 3.93s]
[0m14:15:43.845799 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:15:43.847817 [info ] [MainThread]: 
[0m14:15:43.847817 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:15:43.886191 [info ] [MainThread]: {'my_second_dbt_model': 'marketing', 'my_first_dbt_model': 'marketing'}
[0m14:15:43.891507 [debug] [MainThread]: Using snowflake connection "master"
[0m14:15:43.892510 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:15:43.892510 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:15:44.896823 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.004 seconds
[0m14:15:44.900837 [info ] [MainThread]: Test name: unique
[0m14:15:44.901839 [info ] [MainThread]: Test type: generic
[0m14:15:44.902846 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_id.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_id'], alias='unique_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740127516.4385805, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:15:44.912064 [info ] [MainThread]: Test name: unique
[0m14:15:44.913078 [info ] [MainThread]: Test type: generic
[0m14:15:44.914082 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_second_dbt_model_', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_'], alias='unique_my_second_dbt_model_', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_.sql', unrendered_config={}, created_at=1740127516.439583, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n     as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere  is not null\ngroup by \nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:15:44.915088 [info ] [MainThread]: Test name: not_null
[0m14:15:44.917099 [info ] [MainThread]: Test type: generic
[0m14:15:44.917099 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_second_dbt_model_id.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778', fqn=['dbt_dataops', 'example', 'not_null_my_second_dbt_model_id'], alias='not_null_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\not_null_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740127516.4375775, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\not_null_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:15:44.919182 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:15:44.923312 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:15:44.927422 [debug] [MainThread]: Using snowflake connection "master"
[0m14:15:44.928425 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.743283748626709'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8759024143218994'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.9265618324279785'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:15:45.348077 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.419 seconds
[0m14:15:45.349080 [debug] [MainThread]: Using snowflake connection "master"
[0m14:15:45.349080 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_id' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_second_dbt_model' as model_refs,
              'not_null_my_second_dbt_model_id' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:15:45.667951 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.318 seconds
[0m14:15:45.669262 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.75s]
[0m14:15:45.670378 [info ] [MainThread]: 
[0m14:15:45.671381 [debug] [MainThread]: On master: Close
[0m14:15:45.788494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:15:45.789503 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:15:45.789503 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m14:15:45.790507 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6' was properly closed.
[0m14:15:45.790507 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:15:45.791515 [info ] [MainThread]: 
[0m14:15:45.791515 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 6.70 seconds (6.70s).
[0m14:15:45.792518 [debug] [MainThread]: Command end result
[0m14:15:45.828702 [info ] [MainThread]: 
[0m14:15:45.828702 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:15:45.829707 [info ] [MainThread]: 
[0m14:15:45.830712 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_ (models\example\my_second_dbt_model.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\unique_my_second_dbt_model_.sql
[0m14:15:45.830712 [info ] [MainThread]: 
[0m14:15:45.831714 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:15:45.832731 [debug] [MainThread]: Command `dbt test` failed at 14:15:45.832731 after 8.03 seconds
[0m14:15:45.833742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE2867E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE43EC01C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001AE444F2020>]}
[0m14:15:45.833742 [debug] [MainThread]: Flushing usage events
[0m14:18:09.335866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB12BE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB3E7A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB3E7A320>]}


============================== 14:18:09.338885 | 7fb8f574-2090-4d5b-a89e-b558bf909977 ==============================
[0m14:18:09.338885 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:18:09.339889 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example_2', 'send_anonymous_usage_stats': 'True'}
[0m14:18:10.075183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7fb8f574-2090-4d5b-a89e-b558bf909977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCC7888E0>]}
[0m14:18:10.118575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7fb8f574-2090-4d5b-a89e-b558bf909977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB0D93520>]}
[0m14:18:10.119579 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:18:10.140781 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:18:10.376393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:18:10.377395 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m14:18:10.544625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7fb8f574-2090-4d5b-a89e-b558bf909977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCCCB4130>]}
[0m14:18:10.675643 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7fb8f574-2090-4d5b-a89e-b558bf909977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCCB2FB80>]}
[0m14:18:10.676644 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 841 macros
[0m14:18:10.676644 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fb8f574-2090-4d5b-a89e-b558bf909977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCCC81B40>]}
[0m14:18:10.678736 [info ] [MainThread]: 
[0m14:18:10.679737 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:18:10.683740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:18:10.697840 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:18:10.698843 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:18:10.698843 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:18:11.359849 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.660 seconds
[0m14:18:11.360871 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:18:11.493789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7fb8f574-2090-4d5b-a89e-b558bf909977', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCCB2F760>]}
[0m14:18:11.494794 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:18:11.495810 [info ] [MainThread]: 
[0m14:18:11.498838 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:18:11.498838 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:18:11.499842 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:18:11.499842 [info ] [Thread-1 (]: 1 of 3 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:18:11.500851 [info ] [Thread-2 (]: 2 of 3 START test unique_my_second_dbt_model_ .................................. [RUN]
[0m14:18:11.501859 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m14:18:11.500851 [info ] [Thread-3 (]: 3 of 3 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:18:11.502859 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6'
[0m14:18:11.502859 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:18:11.504011 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m14:18:11.504011 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:18:11.517280 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:18:11.518286 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:18:11.524755 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:18:11.528787 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:18:11.528787 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:18:11.538854 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:18:11.547220 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:18:11.550233 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:18:11.550233 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:18:11.554236 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:18:11.554236 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m14:18:11.555237 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"
[0m14:18:11.556238 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m14:18:11.556238 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
     as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_second_dbt_model
where  is not null
group by 
having count(*) > 1



      
    ) dbt_internal_test
[0m14:18:11.557239 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:18:11.557239 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:18:11.557239 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:18:11.558240 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:18:11.561243 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:18:12.111881 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.551 seconds
[0m14:18:12.118889 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m14:18:12.228270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m14:18:12.230289 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m14:18:12.241030 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.74s]
[0m14:18:12.242052 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m14:18:12.346858 [info ] [Thread-1 (]: 1 of 3 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 0.84s]
[0m14:18:12.348865 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m14:18:13.102686 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ba8990-3201-7372-000b-f69200030dba
[0m14:18:13.103696 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 5 unexpected 'as'.
syntax error line 12 at position 9 unexpected '('.
syntax error line 15 at position 7 unexpected 'is'.
syntax error line 17 at position 0 unexpected 'having'.
syntax error line 22 at position 4 unexpected ')'.
[0m14:18:13.103696 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6: Close
[0m14:18:13.230172 [debug] [Thread-2 (]: Database Error in test unique_my_second_dbt_model_ (models\example\my_second_dbt_model.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\unique_my_second_dbt_model_.sql
[0m14:18:13.231180 [error] [Thread-2 (]: 2 of 3 ERROR unique_my_second_dbt_model_ ....................................... [[31mERROR[0m in 1.73s]
[0m14:18:13.232186 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6
[0m14:18:13.234202 [info ] [MainThread]: 
[0m14:18:13.234202 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:18:13.279396 [info ] [MainThread]: {'my_second_dbt_model': 'marketing', 'my_first_dbt_model': 'marketing'}
[0m14:18:13.285454 [debug] [MainThread]: Using snowflake connection "master"
[0m14:18:13.286460 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:18:13.286460 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:18:14.262489 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.976 seconds
[0m14:18:14.267656 [info ] [MainThread]: Test name: unique
[0m14:18:14.268664 [info ] [MainThread]: Test type: generic
[0m14:18:14.268664 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_id.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_id'], alias='unique_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740127516.4385805, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:18:14.277704 [info ] [MainThread]: Test name: not_null
[0m14:18:14.278707 [info ] [MainThread]: Test type: generic
[0m14:18:14.279711 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_my_second_dbt_model_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_my_second_dbt_model_id.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778', fqn=['dbt_dataops', 'example', 'not_null_my_second_dbt_model_id'], alias='not_null_my_second_dbt_model_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\not_null_my_second_dbt_model_id.sql', unrendered_config={}, created_at=1740127516.4375775, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\not_null_my_second_dbt_model_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:18:14.280794 [info ] [MainThread]: Test name: unique
[0m14:18:14.281803 [info ] [MainThread]: Test type: generic
[0m14:18:14.282809 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_my_second_dbt_model_', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_my_second_dbt_model_.sql', original_file_path='models\\example\\my_second_dbt_model.yml', unique_id='test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6', fqn=['dbt_dataops', 'example', 'unique_my_second_dbt_model_'], alias='unique_my_second_dbt_model_', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_.sql', unrendered_config={}, created_at=1740127516.439583, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='my_second_dbt_model', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.my_second_dbt_model']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\my_second_dbt_model.yml\\unique_my_second_dbt_model_.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n     as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.my_second_dbt_model\nwhere  is not null\ngroup by \nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.my_second_dbt_model', attached_node='model.dbt_dataops.my_second_dbt_model', test_metadata=TestMetadata(name='unique', kwargs={'model': "{{ get_where_subquery(ref('my_second_dbt_model')) }}"}, namespace=None))
[0m14:18:14.284820 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:18:14.289217 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:18:14.295240 [debug] [MainThread]: Using snowflake connection "master"
[0m14:18:14.296299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.736706018447876'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8449993133544922'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.my_second_dbt_model'::varchar(10000) as model_refs,
            split_part('marketing.my_second_dbt_model', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.my_second_dbt_model', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.729321002960205'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\my_second_dbt_model.yml'::varchar(4000) as file_test_defined,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:18:14.697878 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.401 seconds
[0m14:18:14.697878 [debug] [MainThread]: Using snowflake connection "master"
[0m14:18:14.698951 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_id' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_second_dbt_model' as model_refs,
              'not_null_my_second_dbt_model_id' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.my_second_dbt_model' as model_refs,
              'unique_my_second_dbt_model_' as test_name,
              'models\example\my_second_dbt_model.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.my_second_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.my_second_dbt_model where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:18:15.127137 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.427 seconds
[0m14:18:15.128172 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.84s]
[0m14:18:15.129207 [info ] [MainThread]: 
[0m14:18:15.129722 [debug] [MainThread]: On master: Close
[0m14:18:15.251932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:18:15.251932 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:18:15.252937 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m14:18:15.252937 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_.eb303b74c6' was properly closed.
[0m14:18:15.252937 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:18:15.253940 [info ] [MainThread]: 
[0m14:18:15.254946 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m14:18:15.255951 [debug] [MainThread]: Command end result
[0m14:18:15.294304 [info ] [MainThread]: 
[0m14:18:15.295308 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:18:15.295308 [info ] [MainThread]: 
[0m14:18:15.296312 [error] [MainThread]:   Database Error in test unique_my_second_dbt_model_ (models\example\my_second_dbt_model.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\my_second_dbt_model.yml\unique_my_second_dbt_model_.sql
[0m14:18:15.297322 [info ] [MainThread]: 
[0m14:18:15.297322 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:18:15.299333 [debug] [MainThread]: Command `dbt test` failed at 14:18:15.298327 after 6.02 seconds
[0m14:18:15.299333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB12BE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBCC7B2230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBB329ED40>]}
[0m14:18:15.300338 [debug] [MainThread]: Flushing usage events
[0m14:20:22.071002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E90EE8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215EBCAA2C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215EBCAA0E0>]}


============================== 14:20:22.073321 | 36bbe71c-0196-4e04-b519-996029c6152c ==============================
[0m14:20:22.073321 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:20:22.074325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt clean', 'send_anonymous_usage_stats': 'True'}
[0m14:20:22.253193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '36bbe71c-0196-4e04-b519-996029c6152c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215EBCA8670>]}
[0m14:20:22.362319 [debug] [MainThread]: Command `dbt clean` succeeded at 14:20:22.362319 after 0.35 seconds
[0m14:20:22.363322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215E90EE8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215EBD83AF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000215EBCA86A0>]}
[0m14:20:22.363322 [debug] [MainThread]: Flushing usage events
[0m14:20:51.934173 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460C542920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460F0FA2F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460F0FA110>]}


============================== 14:20:51.937715 | d12bede1-f650-4035-908b-604035d7200c ==============================
[0m14:20:51.937715 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:20:51.938863 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt deps', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:20:52.087389 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd12bede1-f650-4035-908b-604035d7200c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460C7CBEB0>]}
[0m14:20:52.109667 [debug] [MainThread]: Set downloads directory='C:\Users\Vignesh\AppData\Local\Temp\dbt-downloads-83tvmt2f'
[0m14:20:52.110671 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m14:20:52.254138 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m14:20:52.255143 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json
[0m14:20:52.773832 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_date.json 200
[0m14:20:52.776949 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m14:20:52.851294 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m14:20:52.854386 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json
[0m14:20:52.941733 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/calogica/dbt_expectations.json 200
[0m14:20:52.944750 [info ] [MainThread]: Installing calogica/dbt_date
[0m14:20:53.395400 [info ] [MainThread]: Installed from version 0.10.1
[0m14:20:53.395400 [info ] [MainThread]: Up to date!
[0m14:20:53.396405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd12bede1-f650-4035-908b-604035d7200c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460CDF98A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460F357F10>]}
[0m14:20:53.396405 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m14:20:53.899613 [info ] [MainThread]: Installed from version 1.3.0
[0m14:20:53.900621 [info ] [MainThread]: Up to date!
[0m14:20:53.901625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd12bede1-f650-4035-908b-604035d7200c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460CDF98A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460F357D90>]}
[0m14:20:53.901625 [info ] [MainThread]: Installing calogica/dbt_expectations
[0m14:20:54.694938 [info ] [MainThread]: Installed from version 0.10.4
[0m14:20:54.694938 [info ] [MainThread]: Up to date!
[0m14:20:54.695941 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'd12bede1-f650-4035-908b-604035d7200c', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460F357340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460F354160>]}
[0m14:20:54.698012 [debug] [MainThread]: Command `dbt deps` succeeded at 14:20:54.698012 after 2.82 seconds
[0m14:20:54.699062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460C542920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460F24C100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002460CDBC7F0>]}
[0m14:20:54.699062 [debug] [MainThread]: Flushing usage events
[0m14:21:58.729400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FDCF42950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FDFB3E5F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FDFB3E410>]}


============================== 14:21:58.732415 | af382ee7-efcb-4314-a610-575a0e3ac96f ==============================
[0m14:21:58.732415 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:21:58.732415 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:fact_orders', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:21:59.442771 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'af382ee7-efcb-4314-a610-575a0e3ac96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FDD1CBA90>]}
[0m14:21:59.485086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'af382ee7-efcb-4314-a610-575a0e3ac96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FF840CA60>]}
[0m14:21:59.487095 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:21:59.511366 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:21:59.512437 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:21:59.512437 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'af382ee7-efcb-4314-a610-575a0e3ac96f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FF8540EB0>]}
[0m14:22:01.444124 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.dbt_dataops.fact_sales' (models\example\fact_sales.sql) depends on a node named 'my_first_dbt_model' which was not found
[0m14:22:01.445127 [debug] [MainThread]: Command `dbt build` failed at 14:22:01.445127 after 2.77 seconds
[0m14:22:01.446222 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FDCF42950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FF8B400D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018FF8BD8E80>]}
[0m14:22:01.446222 [debug] [MainThread]: Flushing usage events
[0m14:22:28.140558 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C46132920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C48CF65C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C48CF63E0>]}


============================== 14:22:28.143577 | 01ae8021-eb4b-4388-8540-5e8b6cdebd17 ==============================
[0m14:22:28.143577 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:22:28.143577 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:fact_orders', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:22:28.879950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '01ae8021-eb4b-4388-8540-5e8b6cdebd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C615CDFF0>]}
[0m14:22:28.926341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '01ae8021-eb4b-4388-8540-5e8b6cdebd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C48621750>]}
[0m14:22:28.927343 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:22:28.948664 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:22:28.949667 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:22:28.950674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '01ae8021-eb4b-4388-8540-5e8b6cdebd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C617823E0>]}
[0m14:22:30.857252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '01ae8021-eb4b-4388-8540-5e8b6cdebd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C61908B50>]}
[0m14:22:30.980732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '01ae8021-eb4b-4388-8540-5e8b6cdebd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C61969CF0>]}
[0m14:22:30.981733 [info ] [MainThread]: Found 2 models, 1 operation, 6 data tests, 841 macros
[0m14:22:30.983088 [info ] [MainThread]: 
[0m14:22:30.984102 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:22:30.985106 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m14:22:30.997852 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m14:22:30.997852 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m14:22:30.998863 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:31.673955 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.675 seconds
[0m14:22:31.674988 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m14:22:31.799511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_dev_dwdb, now create_dev_dwdb_marketing)
[0m14:22:31.800516 [debug] [ThreadPool]: Creating schema "database: "dev_dwdb"
schema: "marketing"
"
[0m14:22:31.804532 [debug] [ThreadPool]: Using snowflake connection "create_dev_dwdb_marketing"
[0m14:22:31.805535 [debug] [ThreadPool]: On create_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "create_dev_dwdb_marketing"} */
create schema if not exists dev_dwdb.marketing
[0m14:22:31.805535 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:22:32.356208 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.551 seconds
[0m14:22:32.357216 [debug] [ThreadPool]: On create_dev_dwdb_marketing: Close
[0m14:22:32.478050 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:22:32.486739 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:22:32.486739 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:22:32.486739 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:22:32.992435 [debug] [ThreadPool]: SQL status: SUCCESS 0 in 0.506 seconds
[0m14:22:32.994447 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:22:33.145340 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '01ae8021-eb4b-4388-8540-5e8b6cdebd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C61945F60>]}
[0m14:22:33.146343 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:22:33.146343 [info ] [MainThread]: 
[0m14:22:33.148793 [debug] [Thread-1 (]: Began running node model.dbt_dataops.fact_orders
[0m14:22:33.149797 [info ] [Thread-1 (]: 1 of 3 START sql table model marketing.fact_orders ............................. [RUN]
[0m14:22:33.150801 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.fact_orders'
[0m14:22:33.150801 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.fact_orders
[0m14:22:33.157989 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.fact_orders"
[0m14:22:33.158992 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.fact_orders
[0m14:22:33.181461 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.fact_orders"
[0m14:22:33.183464 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.fact_orders"
[0m14:22:33.184464 [debug] [Thread-1 (]: On model.dbt_dataops.fact_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.fact_orders"} */
create or replace transient table dev_dwdb.marketing.fact_orders
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m14:22:33.185465 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:22:34.148553 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.963 seconds
[0m14:22:34.163797 [debug] [Thread-1 (]: On model.dbt_dataops.fact_orders: Close
[0m14:22:34.301352 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '01ae8021-eb4b-4388-8540-5e8b6cdebd17', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C615CFB50>]}
[0m14:22:34.302357 [info ] [Thread-1 (]: 1 of 3 OK created sql table model marketing.fact_orders ........................ [[32mSUCCESS 1[0m in 1.15s]
[0m14:22:34.303363 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.fact_orders
[0m14:22:34.304367 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d
[0m14:22:34.304367 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_fact_orders_id.92484f801c
[0m14:22:34.304367 [info ] [Thread-3 (]: 2 of 3 START test not_null_fact_orders_id ...................................... [RUN]
[0m14:22:34.305372 [info ] [Thread-4 (]: 3 of 3 START test unique_fact_orders_id ........................................ [RUN]
[0m14:22:34.305372 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d'
[0m14:22:34.306378 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_fact_orders_id.92484f801c'
[0m14:22:34.306378 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d
[0m14:22:34.307385 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_fact_orders_id.92484f801c
[0m14:22:34.314502 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d"
[0m14:22:34.319530 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_fact_orders_id.92484f801c"
[0m14:22:34.321550 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d
[0m14:22:34.321550 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_fact_orders_id.92484f801c
[0m14:22:34.336138 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d"
[0m14:22:34.339147 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_fact_orders_id.92484f801c"
[0m14:22:34.341155 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d"
[0m14:22:34.341155 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_fact_orders_id.92484f801c"
[0m14:22:34.342212 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.fact_orders
where id is null



      
    ) dbt_internal_test
[0m14:22:34.342212 [debug] [Thread-4 (]: On test.dbt_dataops.unique_fact_orders_id.92484f801c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_fact_orders_id.92484f801c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.fact_orders
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:22:34.343225 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:22:34.343225 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:22:34.961709 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m14:22:34.964718 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d: Close
[0m14:22:35.084132 [error] [Thread-3 (]: 2 of 3 FAIL 1 not_null_fact_orders_id .......................................... [[31mFAIL 1[0m in 0.78s]
[0m14:22:35.085138 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d
[0m14:22:35.882273 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.539 seconds
[0m14:22:35.884281 [debug] [Thread-4 (]: On test.dbt_dataops.unique_fact_orders_id.92484f801c: Close
[0m14:22:36.013963 [info ] [Thread-4 (]: 3 of 3 PASS unique_fact_orders_id .............................................. [[32mPASS[0m in 1.71s]
[0m14:22:36.014970 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_fact_orders_id.92484f801c
[0m14:22:36.015976 [info ] [MainThread]: 
[0m14:22:36.017234 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:22:36.023302 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing'}
[0m14:22:36.028320 [debug] [MainThread]: Using snowflake connection "master"
[0m14:22:36.028320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:22:36.029323 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:22:36.964378 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.936 seconds
[0m14:22:36.969707 [info ] [MainThread]: Test name: not_null
[0m14:22:36.970710 [info ] [MainThread]: Test type: generic
[0m14:22:36.971713 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_fact_orders_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_fact_orders_id.sql', original_file_path='models\\example\\fact_orders.yml', unique_id='test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d', fqn=['dbt_dataops', 'example', 'not_null_fact_orders_id'], alias='not_null_fact_orders_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\fact_orders.yml\\not_null_fact_orders_id.sql', unrendered_config={}, created_at=1740127950.7550514, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='fact_orders', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.fact_orders']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\fact_orders.yml\\not_null_fact_orders_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.fact_orders\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.fact_orders', attached_node='model.dbt_dataops.fact_orders', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('fact_orders')) }}"}, namespace=None))
[0m14:22:36.981063 [info ] [MainThread]: Test name: unique
[0m14:22:36.982132 [info ] [MainThread]: Test type: generic
[0m14:22:36.983154 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_fact_orders_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_fact_orders_id.sql', original_file_path='models\\example\\fact_orders.yml', unique_id='test.dbt_dataops.unique_fact_orders_id.92484f801c', fqn=['dbt_dataops', 'example', 'unique_fact_orders_id'], alias='unique_fact_orders_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\fact_orders.yml\\unique_fact_orders_id.sql', unrendered_config={}, created_at=1740127950.7540398, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='fact_orders', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.fact_orders']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\fact_orders.yml\\unique_fact_orders_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.fact_orders\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.fact_orders', attached_node='model.dbt_dataops.fact_orders', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('fact_orders')) }}"}, namespace=None))
[0m14:22:36.984158 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:22:36.989186 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:22:36.993215 [debug] [MainThread]: Using snowflake connection "master"
[0m14:22:36.994218 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_fact_orders_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_orders'::varchar(10000) as model_refs,
            split_part('marketing.fact_orders', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_orders', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7787594795227051'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\fact_orders.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.fact_orders where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_fact_orders_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_orders'::varchar(10000) as model_refs,
            split_part('marketing.fact_orders', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_orders', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7075848579406738'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_orders.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_orders where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:22:37.448773 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.453 seconds
[0m14:22:37.448773 [debug] [MainThread]: Using snowflake connection "master"
[0m14:22:37.449784 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.fact_orders' as model_refs,
              'not_null_fact_orders_id' as test_name,
              'models\example\fact_orders.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.fact_orders' as model_refs,
              'unique_fact_orders_id' as test_name,
              'models\example\fact_orders.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.fact_orders where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_orders where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:22:37.804264 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.354 seconds
[0m14:22:37.805265 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.82s]
[0m14:22:37.806558 [info ] [MainThread]: 
[0m14:22:37.807608 [debug] [MainThread]: On master: Close
[0m14:22:37.928761 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:22:37.928761 [debug] [MainThread]: Connection 'create_dev_dwdb_marketing' was properly closed.
[0m14:22:37.929764 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:22:37.929764 [debug] [MainThread]: Connection 'model.dbt_dataops.fact_orders' was properly closed.
[0m14:22:37.929764 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d' was properly closed.
[0m14:22:37.930792 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_fact_orders_id.92484f801c' was properly closed.
[0m14:22:37.931796 [info ] [MainThread]: 
[0m14:22:37.931796 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 6.95 seconds (6.95s).
[0m14:22:37.932801 [debug] [MainThread]: Command end result
[0m14:22:37.968833 [info ] [MainThread]: 
[0m14:22:37.969911 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:22:37.970917 [info ] [MainThread]: 
[0m14:22:37.971917 [error] [MainThread]: [31mFailure in test not_null_fact_orders_id (models\example\fact_orders.yml)[0m
[0m14:22:37.971917 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:22:37.972918 [info ] [MainThread]: 
[0m14:22:37.972918 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\fact_orders.yml\not_null_fact_orders_id.sql
[0m14:22:37.972918 [info ] [MainThread]: 
[0m14:22:37.974346 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m14:22:37.975626 [debug] [MainThread]: Command `dbt build` failed at 14:22:37.975626 after 9.89 seconds
[0m14:22:37.976628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C46132920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C61969CF0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019C48136830>]}
[0m14:22:37.976628 [debug] [MainThread]: Flushing usage events
[0m14:23:18.466169 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160B1B9E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160B476E5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160B476E3E0>]}


============================== 14:23:18.469204 | d7ceb92a-40b0-44c7-aec9-ea1a29f462dd ==============================
[0m14:23:18.469204 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:23:18.470210 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'cautious', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:fact_sales', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:19.176212 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7ceb92a-40b0-44c7-aec9-ea1a29f462dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160CD0392D0>]}
[0m14:23:19.220695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7ceb92a-40b0-44c7-aec9-ea1a29f462dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160B3BAB760>]}
[0m14:23:19.221699 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:23:19.243087 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:23:19.485274 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:23:19.486280 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:23:19.531873 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7ceb92a-40b0-44c7-aec9-ea1a29f462dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160CD574E20>]}
[0m14:23:19.701721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7ceb92a-40b0-44c7-aec9-ea1a29f462dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160CD51F5B0>]}
[0m14:23:19.702726 [info ] [MainThread]: Found 2 models, 1 operation, 6 data tests, 841 macros
[0m14:23:19.703737 [info ] [MainThread]: 
[0m14:23:19.704749 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:23:19.705756 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m14:23:19.717917 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m14:23:19.718930 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m14:23:19.718930 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:20.352146 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.632 seconds
[0m14:23:20.353150 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m14:23:20.485716 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:23:20.493745 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:23:20.493745 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:23:20.494746 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:21.109604 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.615 seconds
[0m14:23:21.110608 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:23:21.245390 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7ceb92a-40b0-44c7-aec9-ea1a29f462dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160CD574A90>]}
[0m14:23:21.246393 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:23:21.246393 [info ] [MainThread]: 
[0m14:23:21.249541 [debug] [Thread-1 (]: Began running node model.dbt_dataops.fact_sales
[0m14:23:21.250546 [info ] [Thread-1 (]: 1 of 4 START sql table model marketing.fact_sales .............................. [RUN]
[0m14:23:21.250546 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.fact_sales'
[0m14:23:21.251551 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.fact_sales
[0m14:23:21.258584 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.fact_sales"
[0m14:23:21.259780 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.fact_sales
[0m14:23:21.282150 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.fact_sales"
[0m14:23:21.283153 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.fact_sales"
[0m14:23:21.283153 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.fact_sales"} */
create or replace transient table dev_dwdb.marketing.fact_sales
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.marketing.fact_orders
where id = 1
        );
[0m14:23:21.284171 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:22.106175 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.823 seconds
[0m14:23:22.122878 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: Close
[0m14:23:22.249078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd7ceb92a-40b0-44c7-aec9-ea1a29f462dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160B3B4C820>]}
[0m14:23:22.250082 [info ] [Thread-1 (]: 1 of 4 OK created sql table model marketing.fact_sales ......................... [[32mSUCCESS 1[0m in 1.00s]
[0m14:23:22.251086 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.fact_sales
[0m14:23:22.252090 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m14:23:22.252090 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_fact_sales_.a2396a030a
[0m14:23:22.253099 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_fact_sales_id.0a7365843e
[0m14:23:22.253099 [info ] [Thread-3 (]: 2 of 4 START test not_null_fact_sales_id ....................................... [RUN]
[0m14:23:22.254104 [info ] [Thread-4 (]: 3 of 4 START test unique_fact_sales_ ........................................... [RUN]
[0m14:23:22.254104 [info ] [Thread-2 (]: 4 of 4 START test unique_fact_sales_id ......................................... [RUN]
[0m14:23:22.255109 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_fact_sales_id.735cdaeb13'
[0m14:23:22.255109 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_fact_sales_.a2396a030a'
[0m14:23:22.256119 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_fact_sales_id.0a7365843e'
[0m14:23:22.256119 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m14:23:22.257123 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_fact_sales_.a2396a030a
[0m14:23:22.257123 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_fact_sales_id.0a7365843e
[0m14:23:22.267823 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m14:23:22.272863 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_fact_sales_.a2396a030a"
[0m14:23:22.276936 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_fact_sales_id.0a7365843e"
[0m14:23:22.278967 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_fact_sales_.a2396a030a
[0m14:23:22.278967 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m14:23:22.278967 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_fact_sales_id.0a7365843e
[0m14:23:22.292409 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_fact_sales_.a2396a030a"
[0m14:23:22.294422 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m14:23:22.297557 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_fact_sales_id.0a7365843e"
[0m14:23:22.299575 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_fact_sales_id.0a7365843e"
[0m14:23:22.299575 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m14:23:22.300580 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_fact_sales_.a2396a030a"
[0m14:23:22.300580 [debug] [Thread-2 (]: On test.dbt_dataops.unique_fact_sales_id.0a7365843e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_fact_sales_id.0a7365843e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.fact_sales
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:23:22.301585 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_fact_sales_id.735cdaeb13: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.fact_sales
where id is null



      
    ) dbt_internal_test
[0m14:23:22.301585 [debug] [Thread-4 (]: On test.dbt_dataops.unique_fact_sales_.a2396a030a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_fact_sales_.a2396a030a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
     as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.fact_sales
where  is not null
group by 
having count(*) > 1



      
    ) dbt_internal_test
[0m14:23:22.302590 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:23:22.302590 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:23:22.303594 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:23:23.125468 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.822 seconds
[0m14:23:23.128478 [debug] [Thread-2 (]: On test.dbt_dataops.unique_fact_sales_id.0a7365843e: Close
[0m14:23:23.256537 [info ] [Thread-2 (]: 4 of 4 PASS unique_fact_sales_id ............................................... [[32mPASS[0m in 1.00s]
[0m14:23:23.257541 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_fact_sales_id.0a7365843e
[0m14:23:24.134576 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.831 seconds
[0m14:23:24.135580 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_fact_sales_id.735cdaeb13: Close
[0m14:23:24.265152 [info ] [Thread-3 (]: 2 of 4 PASS not_null_fact_sales_id ............................................. [[32mPASS[0m in 2.01s]
[0m14:23:24.266156 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m14:23:25.014631 [debug] [Thread-4 (]: Snowflake adapter: Snowflake query id: 01ba8995-3201-73bc-000b-f6920002f422
[0m14:23:25.015635 [debug] [Thread-4 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 5 unexpected 'as'.
syntax error line 12 at position 9 unexpected '('.
syntax error line 15 at position 7 unexpected 'is'.
syntax error line 17 at position 0 unexpected 'having'.
syntax error line 22 at position 4 unexpected ')'.
[0m14:23:25.015635 [debug] [Thread-4 (]: On test.dbt_dataops.unique_fact_sales_.a2396a030a: Close
[0m14:23:25.134983 [debug] [Thread-4 (]: Database Error in test unique_fact_sales_ (models\example\fact_sales.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\fact_sales.yml\unique_fact_sales_.sql
[0m14:23:25.135989 [error] [Thread-4 (]: 3 of 4 ERROR unique_fact_sales_ ................................................ [[31mERROR[0m in 2.88s]
[0m14:23:25.136994 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_fact_sales_.a2396a030a
[0m14:23:25.139004 [info ] [MainThread]: 
[0m14:23:25.139004 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:23:25.181818 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing'}
[0m14:23:25.187801 [debug] [MainThread]: Using snowflake connection "master"
[0m14:23:25.187801 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:23:25.187801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:23:26.141035 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.953 seconds
[0m14:23:26.146055 [info ] [MainThread]: Test name: unique
[0m14:23:26.147057 [info ] [MainThread]: Test type: generic
[0m14:23:26.147057 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_fact_sales_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_fact_sales_id.sql', original_file_path='models\\example\\fact_sales.yml', unique_id='test.dbt_dataops.unique_fact_sales_id.0a7365843e', fqn=['dbt_dataops', 'example', 'unique_fact_sales_id'], alias='unique_fact_sales_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\fact_sales.yml\\unique_fact_sales_id.sql', unrendered_config={}, created_at=1740127950.77438, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='fact_sales', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.fact_sales']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\fact_sales.yml\\unique_fact_sales_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.fact_sales\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.fact_sales', attached_node='model.dbt_dataops.fact_sales', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('fact_sales')) }}"}, namespace=None))
[0m14:23:26.157204 [info ] [MainThread]: Test name: not_null
[0m14:23:26.158210 [info ] [MainThread]: Test type: generic
[0m14:23:26.158210 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_fact_sales_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_fact_sales_id.sql', original_file_path='models\\example\\fact_sales.yml', unique_id='test.dbt_dataops.not_null_fact_sales_id.735cdaeb13', fqn=['dbt_dataops', 'example', 'not_null_fact_sales_id'], alias='not_null_fact_sales_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\fact_sales.yml\\not_null_fact_sales_id.sql', unrendered_config={}, created_at=1740127950.7733765, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='fact_sales', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.fact_sales']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\fact_sales.yml\\not_null_fact_sales_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.fact_sales\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.fact_sales', attached_node='model.dbt_dataops.fact_sales', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('fact_sales')) }}"}, namespace=None))
[0m14:23:26.160223 [info ] [MainThread]: Test name: unique
[0m14:23:26.161226 [info ] [MainThread]: Test type: generic
[0m14:23:26.161226 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_fact_sales_', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_fact_sales_.sql', original_file_path='models\\example\\fact_sales.yml', unique_id='test.dbt_dataops.unique_fact_sales_.a2396a030a', fqn=['dbt_dataops', 'example', 'unique_fact_sales_'], alias='unique_fact_sales_', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\fact_sales.yml\\unique_fact_sales_.sql', unrendered_config={}, created_at=1740127950.7753828, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='fact_sales', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.fact_sales']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\fact_sales.yml\\unique_fact_sales_.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n     as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.fact_sales\nwhere  is not null\ngroup by \nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.fact_sales', attached_node='model.dbt_dataops.fact_sales', test_metadata=TestMetadata(name='unique', kwargs={'model': "{{ get_where_subquery(ref('fact_sales')) }}"}, namespace=None))
[0m14:23:26.163255 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:23:26.167578 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:23:26.173151 [debug] [MainThread]: Using snowflake connection "master"
[0m14:23:26.174157 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_fact_sales_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.000417947769165'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_sales where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_fact_sales_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.010042667388916'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.fact_sales where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_fact_sales_'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.8808796405792236'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_sales where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:23:26.963475 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.788 seconds
[0m14:23:26.963475 [debug] [MainThread]: Using snowflake connection "master"
[0m14:23:26.964665 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.fact_sales' as model_refs,
              'unique_fact_sales_id' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.fact_sales' as model_refs,
              'not_null_fact_sales_id' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.fact_sales' as model_refs,
              'unique_fact_sales_' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_sales where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.fact_sales where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_sales where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:23:27.281881 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.316 seconds
[0m14:23:27.282906 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.12s]
[0m14:23:27.283952 [info ] [MainThread]: 
[0m14:23:27.283952 [debug] [MainThread]: On master: Close
[0m14:23:27.400325 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:23:27.401334 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m14:23:27.401334 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:23:27.401334 [debug] [MainThread]: Connection 'model.dbt_dataops.fact_sales' was properly closed.
[0m14:23:27.402503 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_fact_sales_id.735cdaeb13' was properly closed.
[0m14:23:27.402503 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_fact_sales_.a2396a030a' was properly closed.
[0m14:23:27.402503 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_fact_sales_id.0a7365843e' was properly closed.
[0m14:23:27.403507 [info ] [MainThread]: 
[0m14:23:27.404511 [info ] [MainThread]: Finished running 1 table model, 3 data tests, 1 project hook in 0 hours 0 minutes and 7.70 seconds (7.70s).
[0m14:23:27.405516 [debug] [MainThread]: Command end result
[0m14:23:27.441156 [info ] [MainThread]: 
[0m14:23:27.441156 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:23:27.442162 [info ] [MainThread]: 
[0m14:23:27.443173 [error] [MainThread]:   Database Error in test unique_fact_sales_ (models\example\fact_sales.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\fact_sales.yml\unique_fact_sales_.sql
[0m14:23:27.444177 [info ] [MainThread]: 
[0m14:23:27.444177 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:23:27.445219 [debug] [MainThread]: Command `dbt build` failed at 14:23:27.445219 after 9.04 seconds
[0m14:23:27.446223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160B1B9E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160B3BAB760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000160CD51D510>]}
[0m14:23:27.446223 [debug] [MainThread]: Flushing usage events
[0m14:23:53.224311 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC4E62980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC7A2E620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC7A2E440>]}


============================== 14:23:53.227324 | bb220d3b-67cb-469e-a9bb-785994ec20cd ==============================
[0m14:23:53.227324 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:23:53.228335 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:fact_sales', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:23:53.927746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb220d3b-67cb-469e-a9bb-785994ec20cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC50E7DC0>]}
[0m14:23:53.970995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb220d3b-67cb-469e-a9bb-785994ec20cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC4923520>]}
[0m14:23:53.971998 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:23:53.992266 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:23:54.093971 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m14:23:54.094974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bb220d3b-67cb-469e-a9bb-785994ec20cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC6E3E320>]}
[0m14:23:55.880619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb220d3b-67cb-469e-a9bb-785994ec20cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE0647E50>]}
[0m14:23:55.999677 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb220d3b-67cb-469e-a9bb-785994ec20cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE08809D0>]}
[0m14:23:56.000681 [info ] [MainThread]: Found 2 models, 1 operation, 6 data tests, 841 macros
[0m14:23:56.002802 [info ] [MainThread]: 
[0m14:23:56.003813 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:23:56.004816 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m14:23:56.014848 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m14:23:56.015851 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m14:23:56.015851 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:56.709481 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.693 seconds
[0m14:23:56.710491 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m14:23:56.839391 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:23:56.847509 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:23:56.847509 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:23:56.848513 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:23:57.421263 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.573 seconds
[0m14:23:57.423283 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:23:57.554214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb220d3b-67cb-469e-a9bb-785994ec20cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE0882E60>]}
[0m14:23:57.555219 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:23:57.556224 [info ] [MainThread]: 
[0m14:23:57.559242 [debug] [Thread-1 (]: Began running node model.dbt_dataops.fact_sales
[0m14:23:57.559242 [info ] [Thread-1 (]: 1 of 5 START sql table model marketing.fact_sales .............................. [RUN]
[0m14:23:57.560339 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.fact_sales'
[0m14:23:57.560339 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.fact_sales
[0m14:23:57.567392 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.fact_sales"
[0m14:23:57.568396 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.fact_sales
[0m14:23:57.591354 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.fact_sales"
[0m14:23:57.592359 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.fact_sales"
[0m14:23:57.593377 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.fact_sales"} */
create or replace transient table dev_dwdb.marketing.fact_sales
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.marketing.fact_orders
where id = 1
        );
[0m14:23:57.593377 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:23:58.445134 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.851 seconds
[0m14:23:58.461389 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: Close
[0m14:23:58.594052 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb220d3b-67cb-469e-a9bb-785994ec20cd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBE030FBB0>]}
[0m14:23:58.594052 [info ] [Thread-1 (]: 1 of 5 OK created sql table model marketing.fact_sales ......................... [[32mSUCCESS 1[0m in 1.03s]
[0m14:23:58.595057 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.fact_sales
[0m14:23:58.596061 [debug] [Thread-3 (]: Began running node test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad
[0m14:23:58.596061 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m14:23:58.597146 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_fact_sales_.a2396a030a
[0m14:23:58.597146 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_fact_sales_id.0a7365843e
[0m14:23:58.598155 [info ] [Thread-3 (]: 2 of 5 START test dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1  [RUN]
[0m14:23:58.598155 [info ] [Thread-4 (]: 3 of 5 START test not_null_fact_sales_id ....................................... [RUN]
[0m14:23:58.598155 [info ] [Thread-2 (]: 4 of 5 START test unique_fact_sales_ ........................................... [RUN]
[0m14:23:58.599541 [info ] [Thread-1 (]: 5 of 5 START test unique_fact_sales_id ......................................... [RUN]
[0m14:23:58.600543 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad'
[0m14:23:58.600543 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_fact_sales_id.735cdaeb13'
[0m14:23:58.600543 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_fact_sales_.a2396a030a'
[0m14:23:58.601861 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.fact_sales, now test.dbt_dataops.unique_fact_sales_id.0a7365843e)
[0m14:23:58.601861 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad
[0m14:23:58.602907 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m14:23:58.602907 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_fact_sales_.a2396a030a
[0m14:23:58.602907 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_fact_sales_id.0a7365843e
[0m14:23:58.608959 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad"
[0m14:23:58.615178 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m14:23:58.621187 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_fact_sales_.a2396a030a"
[0m14:23:58.624573 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_fact_sales_id.0a7365843e"
[0m14:23:58.625575 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad
[0m14:23:58.626964 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m14:23:58.626964 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_fact_sales_.a2396a030a
[0m14:23:58.639204 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad"
[0m14:23:58.639204 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_fact_sales_id.0a7365843e
[0m14:23:58.642226 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m14:23:58.701114 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_fact_sales_.a2396a030a"
[0m14:23:58.704133 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_fact_sales_id.0a7365843e"
[0m14:23:58.705134 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad"
[0m14:23:58.706135 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m14:23:58.707487 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      




with left_table as (

  select
    id as id

  from dev_dwdb.marketing.fact_sales

  where id is not null
    and id <> '1'

),

right_table as (

  select
    id as id

  from dev_dwdb.marketing.fact_orders

  where id is not null
    and current_date > current_date -1

),

exceptions as (

  select
    left_table.id,
    right_table.id as right_id

  from left_table

  left join right_table
         on left_table.id = right_table.id

  where right_table.id is null

)

select * from exceptions


      
    ) dbt_internal_test
[0m14:23:58.707487 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_fact_sales_.a2396a030a"
[0m14:23:58.707487 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_fact_sales_id.735cdaeb13: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.fact_sales
where id is null



      
    ) dbt_internal_test
[0m14:23:58.708946 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_fact_sales_id.0a7365843e"
[0m14:23:58.708946 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:23:58.710005 [debug] [Thread-2 (]: On test.dbt_dataops.unique_fact_sales_.a2396a030a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_fact_sales_.a2396a030a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
     as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.fact_sales
where  is not null
group by 
having count(*) > 1



      
    ) dbt_internal_test
[0m14:23:58.710005 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:23:58.711088 [debug] [Thread-1 (]: On test.dbt_dataops.unique_fact_sales_id.0a7365843e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_fact_sales_id.0a7365843e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.fact_sales
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m14:23:58.712153 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:23:58.713465 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:23:59.300506 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01ba8995-3201-7372-000b-f69200030e32
[0m14:23:59.301508 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 5 unexpected 'as'.
syntax error line 12 at position 9 unexpected '('.
syntax error line 15 at position 7 unexpected 'is'.
syntax error line 17 at position 0 unexpected 'having'.
syntax error line 22 at position 4 unexpected ')'.
[0m14:23:59.301508 [debug] [Thread-2 (]: On test.dbt_dataops.unique_fact_sales_.a2396a030a: Close
[0m14:23:59.423521 [debug] [Thread-2 (]: Database Error in test unique_fact_sales_ (models\example\fact_sales.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\fact_sales.yml\unique_fact_sales_.sql
[0m14:23:59.424525 [error] [Thread-2 (]: 4 of 5 ERROR unique_fact_sales_ ................................................ [[31mERROR[0m in 0.82s]
[0m14:23:59.425528 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_fact_sales_.a2396a030a
[0m14:23:59.466239 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.757 seconds
[0m14:23:59.470274 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad: Close
[0m14:23:59.592376 [info ] [Thread-3 (]: 2 of 5 PASS dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1  [[32mPASS[0m in 0.99s]
[0m14:23:59.594386 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad
[0m14:24:00.288531 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.579 seconds
[0m14:24:00.291029 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_fact_sales_id.735cdaeb13: Close
[0m14:24:00.418905 [info ] [Thread-4 (]: 3 of 5 PASS not_null_fact_sales_id ............................................. [[32mPASS[0m in 1.82s]
[0m14:24:00.419908 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m14:24:01.476433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.763 seconds
[0m14:24:01.478445 [debug] [Thread-1 (]: On test.dbt_dataops.unique_fact_sales_id.0a7365843e: Close
[0m14:24:01.608241 [info ] [Thread-1 (]: 5 of 5 PASS unique_fact_sales_id ............................................... [[32mPASS[0m in 3.01s]
[0m14:24:01.609248 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_fact_sales_id.0a7365843e
[0m14:24:01.610254 [info ] [MainThread]: 
[0m14:24:01.611260 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:24:01.618318 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing'}
[0m14:24:01.625260 [debug] [MainThread]: Using snowflake connection "master"
[0m14:24:01.625260 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:24:01.626269 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:24:02.622323 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.996 seconds
[0m14:24:02.626337 [info ] [MainThread]: Test name: unique
[0m14:24:02.627340 [info ] [MainThread]: Test type: generic
[0m14:24:02.628414 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_fact_sales_', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_fact_sales_.sql', original_file_path='models\\example\\fact_sales.yml', unique_id='test.dbt_dataops.unique_fact_sales_.a2396a030a', fqn=['dbt_dataops', 'example', 'unique_fact_sales_'], alias='unique_fact_sales_', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\fact_sales.yml\\unique_fact_sales_.sql', unrendered_config={}, created_at=1740128035.8007145, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='fact_sales', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.fact_sales']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\fact_sales.yml\\unique_fact_sales_.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n     as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.fact_sales\nwhere  is not null\ngroup by \nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.fact_sales', attached_node='model.dbt_dataops.fact_sales', test_metadata=TestMetadata(name='unique', kwargs={'model': "{{ get_where_subquery(ref('fact_sales')) }}"}, namespace=None))
[0m14:24:02.637456 [info ] [MainThread]: Test name: relationships_where
[0m14:24:02.638463 [info ] [MainThread]: Test type: generic
[0m14:24:02.639468 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='dbt_utils_relationships_where__a66c009fcc3a4d3101f9da9a0572245d.sql', original_file_path='models\\example\\fact_sales.yml', unique_id='test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad', fqn=['dbt_dataops', 'example', 'dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1'], alias='dbt_utils_relationships_where__a66c009fcc3a4d3101f9da9a0572245d', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias='dbt_utils_relationships_where__a66c009fcc3a4d3101f9da9a0572245d', schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\fact_sales.yml\\dbt_utils_relationships_where__a66c009fcc3a4d3101f9da9a0572245d.sql', unrendered_config={'alias': 'dbt_utils_relationships_where__a66c009fcc3a4d3101f9da9a0572245d'}, created_at=1740128035.782394, config_call_dict={'alias': 'dbt_utils_relationships_where__a66c009fcc3a4d3101f9da9a0572245d'}, relation_name=None, raw_code='{{ dbt_utils.test_relationships_where(**_dbt_generic_test_kwargs) }}{{ config(alias="dbt_utils_relationships_where__a66c009fcc3a4d3101f9da9a0572245d") }}', language='sql', refs=[RefArgs(name='fact_orders', package=None, version=None), RefArgs(name='fact_sales', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_utils.test_relationships_where', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.fact_orders', 'model.dbt_dataops.fact_sales']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\fact_sales.yml\\dbt_utils_relationships_where__a66c009fcc3a4d3101f9da9a0572245d.sql', compiled=True, compiled_code="\n\n\n\n\nwith left_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.fact_sales\n\n  where id is not null\n    and id <> '1'\n\n),\n\nright_table as (\n\n  select\n    id as id\n\n  from dev_dwdb.marketing.fact_orders\n\n  where id is not null\n    and current_date > current_date -1\n\n),\n\nexceptions as (\n\n  select\n    left_table.id,\n    right_table.id as right_id\n\n  from left_table\n\n  left join right_table\n         on left_table.id = right_table.id\n\n  where right_table.id is null\n\n)\n\nselect * from exceptions\n\n", extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.fact_sales', attached_node='model.dbt_dataops.fact_sales', test_metadata=TestMetadata(name='relationships_where', kwargs={'to': "ref('fact_orders')", 'field': 'id', 'from_condition': "id <> '1'", 'to_condition': 'current_date > current_date -1', 'column_name': 'id', 'model': "{{ get_where_subquery(ref('fact_sales')) }}"}, namespace='dbt_utils'))
[0m14:24:02.640471 [info ] [MainThread]: Test name: not_null
[0m14:24:02.641478 [info ] [MainThread]: Test type: generic
[0m14:24:02.642481 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_fact_sales_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_fact_sales_id.sql', original_file_path='models\\example\\fact_sales.yml', unique_id='test.dbt_dataops.not_null_fact_sales_id.735cdaeb13', fqn=['dbt_dataops', 'example', 'not_null_fact_sales_id'], alias='not_null_fact_sales_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\fact_sales.yml\\not_null_fact_sales_id.sql', unrendered_config={}, created_at=1740128035.7975512, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='fact_sales', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.fact_sales']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\fact_sales.yml\\not_null_fact_sales_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.fact_sales\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.fact_sales', attached_node='model.dbt_dataops.fact_sales', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('fact_sales')) }}"}, namespace=None))
[0m14:24:02.643902 [info ] [MainThread]: Test name: unique
[0m14:24:02.643902 [info ] [MainThread]: Test type: generic
[0m14:24:02.644905 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_fact_sales_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_fact_sales_id.sql', original_file_path='models\\example\\fact_sales.yml', unique_id='test.dbt_dataops.unique_fact_sales_id.0a7365843e', fqn=['dbt_dataops', 'example', 'unique_fact_sales_id'], alias='unique_fact_sales_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\fact_sales.yml\\unique_fact_sales_id.sql', unrendered_config={}, created_at=1740128035.799558, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='fact_sales', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.fact_sales']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\fact_sales.yml\\unique_fact_sales_id.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n    id as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.fact_sales\nwhere id is not null\ngroup by id\nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.fact_sales', attached_node='model.dbt_dataops.fact_sales', test_metadata=TestMetadata(name='unique', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('fact_sales')) }}"}, namespace=None))
[0m14:24:02.647932 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:24:02.651948 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:24:02.657974 [debug] [MainThread]: Using snowflake connection "master"
[0m14:24:02.657974 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_fact_sales_'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8229777812957764'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_sales where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('relationships_where' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'relationships_where'::varchar(4000) as test_name,
            'dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_orders'::varchar(10000) as model_refs,
            split_part('marketing.fact_orders', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_orders', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.992835521697998'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.fact_sales    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.fact_orders    where id is not null     and current_date > current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_fact_sales_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8183610439300537'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.fact_sales where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_fact_sales_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.0053749084472656'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_sales where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:24:03.170594 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.511 seconds
[0m14:24:03.170594 [debug] [MainThread]: Using snowflake connection "master"
[0m14:24:03.171664 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.fact_sales' as model_refs,
              'unique_fact_sales_' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.fact_orders' as model_refs,
              'dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.fact_sales' as model_refs,
              'not_null_fact_sales_id' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.fact_sales' as model_refs,
              'unique_fact_sales_id' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_sales where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'relationships_where'::varchar(4000) as test_name,
            'with left_table as (    select     id as id    from dev_dwdb.marketing.fact_sales    where id is not null     and id <> ''1''  ),  right_table as (    select     id as id    from dev_dwdb.marketing.fact_orders    where id is not null     and current_date > current_date -1  ),  exceptions as (    select     left_table.id,     right_table.id as right_id    from left_table    left join right_table          on left_table.id = right_table.id    where right_table.id is null  )  select * from exceptions'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.fact_sales where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_sales where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:24:03.636024 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.463 seconds
[0m14:24:03.637029 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.99s]
[0m14:24:03.638124 [info ] [MainThread]: 
[0m14:24:03.639240 [debug] [MainThread]: On master: Close
[0m14:24:03.761690 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:24:03.762694 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m14:24:03.762694 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:24:03.763701 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_fact_sales_id.0a7365843e' was properly closed.
[0m14:24:03.763701 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_relationships_where_fact_sales_id__id__id_1___ref_fact_orders___current_date_current_date_1.346ae027ad' was properly closed.
[0m14:24:03.764706 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_fact_sales_id.735cdaeb13' was properly closed.
[0m14:24:03.764706 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_fact_sales_.a2396a030a' was properly closed.
[0m14:24:03.765709 [info ] [MainThread]: 
[0m14:24:03.765709 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 project hook in 0 hours 0 minutes and 7.76 seconds (7.76s).
[0m14:24:03.768205 [debug] [MainThread]: Command end result
[0m14:24:03.820344 [info ] [MainThread]: 
[0m14:24:03.821354 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:24:03.822359 [info ] [MainThread]: 
[0m14:24:03.822359 [error] [MainThread]:   Database Error in test unique_fact_sales_ (models\example\fact_sales.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\fact_sales.yml\unique_fact_sales_.sql
[0m14:24:03.823460 [info ] [MainThread]: 
[0m14:24:03.823460 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m14:24:03.825470 [debug] [MainThread]: Command `dbt build` failed at 14:24:03.825470 after 10.66 seconds
[0m14:24:03.825470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC4E62980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC4923520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBC3CCC4C0>]}
[0m14:24:03.826548 [debug] [MainThread]: Flushing usage events
[0m14:27:36.140317 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019221192950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019223D525F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019223D52410>]}


============================== 14:27:36.143338 | 1a1518f9-81b7-4b65-9717-4e92f88677e2 ==============================
[0m14:27:36.143338 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:27:36.144342 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:fact_sales', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:27:36.840664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a1518f9-81b7-4b65-9717-4e92f88677e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019220C92290>]}
[0m14:27:36.884235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a1518f9-81b7-4b65-9717-4e92f88677e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019220C634F0>]}
[0m14:27:36.885241 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:27:36.906172 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:27:37.149766 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:27:37.150774 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\fact_sales.yml
[0m14:27:37.497062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a1518f9-81b7-4b65-9717-4e92f88677e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001923CEA8130>]}
[0m14:27:37.618707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a1518f9-81b7-4b65-9717-4e92f88677e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001923CEA9FF0>]}
[0m14:27:37.618707 [info ] [MainThread]: Found 2 models, 1 operation, 3 data tests, 841 macros
[0m14:27:37.620724 [info ] [MainThread]: 
[0m14:27:37.621728 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:27:37.622732 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m14:27:37.633874 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m14:27:37.633874 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m14:27:37.634874 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:38.299727 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.665 seconds
[0m14:27:38.300733 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m14:27:38.428659 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:27:38.435683 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:27:38.436685 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:27:38.436685 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:27:39.012017 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.575 seconds
[0m14:27:39.014027 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:27:39.228270 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a1518f9-81b7-4b65-9717-4e92f88677e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001923CEAAB60>]}
[0m14:27:39.229405 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:27:39.229405 [info ] [MainThread]: 
[0m14:27:39.232420 [debug] [Thread-1 (]: Began running node model.dbt_dataops.fact_sales
[0m14:27:39.232420 [info ] [Thread-1 (]: 1 of 2 START sql table model marketing.fact_sales .............................. [RUN]
[0m14:27:39.233432 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.fact_sales'
[0m14:27:39.233432 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.fact_sales
[0m14:27:39.240471 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.fact_sales"
[0m14:27:39.241542 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.fact_sales
[0m14:27:39.264896 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.fact_sales"
[0m14:27:39.265903 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.fact_sales"
[0m14:27:39.265903 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.fact_sales"} */
create or replace transient table dev_dwdb.marketing.fact_sales
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.marketing.fact_orders
where id = 1
        );
[0m14:27:39.266907 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:27:40.218386 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.952 seconds
[0m14:27:40.235502 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: Close
[0m14:27:40.357298 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1a1518f9-81b7-4b65-9717-4e92f88677e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001923CE3CAF0>]}
[0m14:27:40.358313 [info ] [Thread-1 (]: 1 of 2 OK created sql table model marketing.fact_sales ......................... [[32mSUCCESS 1[0m in 1.12s]
[0m14:27:40.359319 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.fact_sales
[0m14:27:40.359319 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_fact_sales_.a2396a030a
[0m14:27:40.360323 [info ] [Thread-3 (]: 2 of 2 START test unique_fact_sales_ ........................................... [RUN]
[0m14:27:40.360323 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_fact_sales_.a2396a030a'
[0m14:27:40.361330 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_fact_sales_.a2396a030a
[0m14:27:40.368378 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_fact_sales_.a2396a030a"
[0m14:27:40.369385 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_fact_sales_.a2396a030a
[0m14:27:40.382628 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_fact_sales_.a2396a030a"
[0m14:27:40.384642 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_fact_sales_.a2396a030a"
[0m14:27:40.384642 [debug] [Thread-3 (]: On test.dbt_dataops.unique_fact_sales_.a2396a030a: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_fact_sales_.a2396a030a"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
     as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.fact_sales
where  is not null
group by 
having count(*) > 1



      
    ) dbt_internal_test
[0m14:27:40.384642 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:27:40.884828 [debug] [Thread-3 (]: Snowflake adapter: Snowflake query id: 01ba8999-3201-73bc-000b-f6920002f456
[0m14:27:40.885843 [debug] [Thread-3 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 11 at position 5 unexpected 'as'.
syntax error line 12 at position 9 unexpected '('.
syntax error line 15 at position 7 unexpected 'is'.
syntax error line 17 at position 0 unexpected 'having'.
syntax error line 22 at position 4 unexpected ')'.
[0m14:27:40.885843 [debug] [Thread-3 (]: On test.dbt_dataops.unique_fact_sales_.a2396a030a: Close
[0m14:27:41.002905 [debug] [Thread-3 (]: Database Error in test unique_fact_sales_ (models\example\fact_sales.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\fact_sales.yml\unique_fact_sales_.sql
[0m14:27:41.002905 [error] [Thread-3 (]: 2 of 2 ERROR unique_fact_sales_ ................................................ [[31mERROR[0m in 0.64s]
[0m14:27:41.005005 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_fact_sales_.a2396a030a
[0m14:27:41.006035 [info ] [MainThread]: 
[0m14:27:41.006035 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:27:41.050523 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing'}
[0m14:27:41.055599 [debug] [MainThread]: Using snowflake connection "master"
[0m14:27:41.055599 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:27:41.056605 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:27:41.998137 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.941 seconds
[0m14:27:42.002195 [info ] [MainThread]: Test name: unique
[0m14:27:42.003199 [info ] [MainThread]: Test type: generic
[0m14:27:42.004202 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='unique_fact_sales_', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='unique_fact_sales_.sql', original_file_path='models\\example\\fact_sales.yml', unique_id='test.dbt_dataops.unique_fact_sales_.a2396a030a', fqn=['dbt_dataops', 'example', 'unique_fact_sales_'], alias='unique_fact_sales_', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\fact_sales.yml\\unique_fact_sales_.sql', unrendered_config={}, created_at=1740128257.4311666, config_call_dict={}, relation_name=None, raw_code='{{ test_unique(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='fact_sales', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_unique', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.fact_sales']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\fact_sales.yml\\unique_fact_sales_.sql', compiled=True, compiled_code='\n    \n    \n\nselect\n     as unique_field,\n    count(*) as n_records\n\nfrom dev_dwdb.marketing.fact_sales\nwhere  is not null\ngroup by \nhaving count(*) > 1\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name=None, file_key_name='models.fact_sales', attached_node='model.dbt_dataops.fact_sales', test_metadata=TestMetadata(name='unique', kwargs={'model': "{{ get_where_subquery(ref('fact_sales')) }}"}, namespace=None))
[0m14:27:42.013246 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:27:42.017424 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:27:42.021705 [debug] [MainThread]: Using snowflake connection "master"
[0m14:27:42.021705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_fact_sales_'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6425819396972656'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_sales where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:27:42.373613 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.351 seconds
[0m14:27:42.374620 [debug] [MainThread]: Using snowflake connection "master"
[0m14:27:42.374620 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.fact_sales' as model_refs,
              'unique_fact_sales_' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select      as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_sales where  is not null group by  having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:27:42.672793 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.297 seconds
[0m14:27:42.674141 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.66s]
[0m14:27:42.674141 [info ] [MainThread]: 
[0m14:27:42.675563 [debug] [MainThread]: On master: Close
[0m14:27:42.797573 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:27:42.797573 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m14:27:42.798586 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:27:42.798586 [debug] [MainThread]: Connection 'model.dbt_dataops.fact_sales' was properly closed.
[0m14:27:42.798586 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_fact_sales_.a2396a030a' was properly closed.
[0m14:27:42.799591 [info ] [MainThread]: 
[0m14:27:42.800594 [info ] [MainThread]: Finished running 1 table model, 1 test, 1 project hook in 0 hours 0 minutes and 5.18 seconds (5.18s).
[0m14:27:42.801598 [debug] [MainThread]: Command end result
[0m14:27:42.921776 [info ] [MainThread]: 
[0m14:27:42.922791 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:27:42.923828 [info ] [MainThread]: 
[0m14:27:42.923828 [error] [MainThread]:   Database Error in test unique_fact_sales_ (models\example\fact_sales.yml)
  001003 (42000): SQL compilation error:
  syntax error line 11 at position 5 unexpected 'as'.
  syntax error line 12 at position 9 unexpected '('.
  syntax error line 15 at position 7 unexpected 'is'.
  syntax error line 17 at position 0 unexpected 'having'.
  syntax error line 22 at position 4 unexpected ')'.
  compiled code at target\run\dbt_dataops\models\example\fact_sales.yml\unique_fact_sales_.sql
[0m14:27:42.924882 [info ] [MainThread]: 
[0m14:27:42.925902 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m14:27:42.926909 [debug] [MainThread]: Command `dbt build` failed at 14:27:42.926909 after 6.84 seconds
[0m14:27:42.926909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019221192950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000192215596F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001923D2D84F0>]}
[0m14:27:42.927912 [debug] [MainThread]: Flushing usage events
[0m14:29:02.579397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AE3EC29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AE6A92650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AE6A92470>]}


============================== 14:29:02.583410 | fef5769a-08b7-410c-ac3d-99129dff3509 ==============================
[0m14:29:02.583410 [info ] [MainThread]: Running with dbt=1.8.7
[0m14:29:02.583410 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:fact_sales', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:29:03.326647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fef5769a-08b7-410c-ac3d-99129dff3509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AE6A46740>]}
[0m14:29:03.385560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fef5769a-08b7-410c-ac3d-99129dff3509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AFF39F3A0>]}
[0m14:29:03.387573 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m14:29:03.410517 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m14:29:03.656182 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:29:03.657185 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\fact_sales.yml
[0m14:29:04.020783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fef5769a-08b7-410c-ac3d-99129dff3509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AFFBEC130>]}
[0m14:29:04.140240 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fef5769a-08b7-410c-ac3d-99129dff3509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AFFBEFD60>]}
[0m14:29:04.140240 [info ] [MainThread]: Found 2 models, 1 operation, 3 data tests, 841 macros
[0m14:29:04.142492 [info ] [MainThread]: 
[0m14:29:04.143500 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m14:29:04.145511 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m14:29:04.155676 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m14:29:04.155676 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m14:29:04.156680 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:04.771807 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.615 seconds
[0m14:29:04.772811 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m14:29:04.899583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m14:29:04.907946 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m14:29:04.908954 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m14:29:04.908954 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:29:05.480112 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.570 seconds
[0m14:29:05.481115 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m14:29:05.599490 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fef5769a-08b7-410c-ac3d-99129dff3509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AFFBEE200>]}
[0m14:29:05.600518 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:29:05.600518 [info ] [MainThread]: 
[0m14:29:05.603728 [debug] [Thread-1 (]: Began running node model.dbt_dataops.fact_sales
[0m14:29:05.603728 [info ] [Thread-1 (]: 1 of 2 START sql table model marketing.fact_sales .............................. [RUN]
[0m14:29:05.604783 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.fact_sales'
[0m14:29:05.605789 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.fact_sales
[0m14:29:05.613829 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.fact_sales"
[0m14:29:05.615027 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.fact_sales
[0m14:29:05.638258 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.fact_sales"
[0m14:29:05.639263 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.fact_sales"
[0m14:29:05.640269 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.fact_sales"} */
create or replace transient table dev_dwdb.marketing.fact_sales
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.marketing.fact_orders
where id = 1
        );
[0m14:29:05.640269 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m14:29:06.585364 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.945 seconds
[0m14:29:06.613373 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: Close
[0m14:29:06.741967 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fef5769a-08b7-410c-ac3d-99129dff3509', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AFF36FBE0>]}
[0m14:29:06.742968 [info ] [Thread-1 (]: 1 of 2 OK created sql table model marketing.fact_sales ......................... [[32mSUCCESS 1[0m in 1.14s]
[0m14:29:06.743969 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.fact_sales
[0m14:29:06.744970 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m14:29:06.744970 [info ] [Thread-3 (]: 2 of 2 START test not_null_fact_sales_id ....................................... [RUN]
[0m14:29:06.745990 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_fact_sales_id.735cdaeb13'
[0m14:29:06.745990 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m14:29:06.756175 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m14:29:06.758200 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m14:29:06.770769 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m14:29:06.772770 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m14:29:06.772770 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_fact_sales_id.735cdaeb13: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.fact_sales
where id is null



      
    ) dbt_internal_test
[0m14:29:06.773772 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:29:07.467533 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.693 seconds
[0m14:29:07.470551 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_fact_sales_id.735cdaeb13: Close
[0m14:29:07.596244 [info ] [Thread-3 (]: 2 of 2 PASS not_null_fact_sales_id ............................................. [[32mPASS[0m in 0.85s]
[0m14:29:07.597247 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m14:29:07.598257 [info ] [MainThread]: 
[0m14:29:07.599262 [info ] [MainThread]: Running 1 on-run-end hook
[0m14:29:07.640983 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing'}
[0m14:29:07.647088 [debug] [MainThread]: Using snowflake connection "master"
[0m14:29:07.647088 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m14:29:07.648089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:29:08.640391 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.993 seconds
[0m14:29:08.645409 [info ] [MainThread]: Test name: not_null
[0m14:29:08.645409 [info ] [MainThread]: Test type: generic
[0m14:29:08.646414 [info ] [MainThread]: Result node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_fact_sales_id', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_fact_sales_id.sql', original_file_path='models\\example\\fact_sales.yml', unique_id='test.dbt_dataops.not_null_fact_sales_id.735cdaeb13', fqn=['dbt_dataops', 'example', 'not_null_fact_sales_id'], alias='not_null_fact_sales_id', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\fact_sales.yml\\not_null_fact_sales_id.sql', unrendered_config={}, created_at=1740128343.9528623, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='fact_sales', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.fact_sales']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\fact_sales.yml\\not_null_fact_sales_id.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect id\nfrom dev_dwdb.marketing.fact_sales\nwhere id is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='id', file_key_name='models.fact_sales', attached_node='model.dbt_dataops.fact_sales', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'id', 'model': "{{ get_where_subquery(ref('fact_sales')) }}"}, namespace=None))
[0m14:29:08.655812 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m14:29:08.659859 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m14:29:08.662892 [debug] [MainThread]: Using snowflake connection "master"
[0m14:29:08.663899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_fact_sales_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8502533435821533'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.fact_sales where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m14:29:09.285342 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.621 seconds
[0m14:29:09.285342 [debug] [MainThread]: Using snowflake connection "master"
[0m14:29:09.286346 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.fact_sales' as model_refs,
              'not_null_fact_sales_id' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.fact_sales where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m14:29:09.746549 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.460 seconds
[0m14:29:09.748088 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 1.09s]
[0m14:29:09.748631 [info ] [MainThread]: 
[0m14:29:09.749663 [debug] [MainThread]: On master: Close
[0m14:29:09.869397 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:29:09.870400 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m14:29:09.870400 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m14:29:09.870400 [debug] [MainThread]: Connection 'model.dbt_dataops.fact_sales' was properly closed.
[0m14:29:09.871403 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_fact_sales_id.735cdaeb13' was properly closed.
[0m14:29:09.871403 [info ] [MainThread]: 
[0m14:29:09.872406 [info ] [MainThread]: Finished running 1 table model, 1 test, 1 project hook in 0 hours 0 minutes and 5.73 seconds (5.73s).
[0m14:29:09.873944 [debug] [MainThread]: Command end result
[0m14:29:09.969233 [info ] [MainThread]: 
[0m14:29:09.970236 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:29:09.971240 [info ] [MainThread]: 
[0m14:29:09.972244 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:29:09.973247 [debug] [MainThread]: Command `dbt build` succeeded at 14:29:09.973247 after 7.45 seconds
[0m14:29:09.974250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AE3EC29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AFFB2A050>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027AFF6E3760>]}
[0m14:29:09.974250 [debug] [MainThread]: Flushing usage events
[0m15:10:56.699171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1CA6E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1F62E620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1F62E440>]}


============================== 15:10:56.702761 | e9392937-a4e3-4b11-9c61-fbc47b8039d4 ==============================
[0m15:10:56.702761 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:10:56.704168 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --select tag:fact_sales', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:10:57.663450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e9392937-a4e3-4b11-9c61-fbc47b8039d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1F5E75B0>]}
[0m15:10:57.706902 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e9392937-a4e3-4b11-9c61-fbc47b8039d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC37F0F670>]}
[0m15:10:57.708915 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:10:57.728230 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:10:58.005031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:10:58.005031 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m15:10:58.163061 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e9392937-a4e3-4b11-9c61-fbc47b8039d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC3848C130>]}
[0m15:10:58.304397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e9392937-a4e3-4b11-9c61-fbc47b8039d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC3840B760>]}
[0m15:10:58.304397 [info ] [MainThread]: Found 2 models, 1 operation, 3 data tests, 841 macros
[0m15:10:58.306412 [info ] [MainThread]: 
[0m15:10:58.307417 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:10:58.308546 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m15:10:58.321856 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m15:10:58.321856 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m15:10:58.321856 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:59.016757 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.695 seconds
[0m15:10:59.018759 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m15:10:59.146185 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:10:59.155232 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:10:59.156359 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:10:59.156359 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:10:59.738974 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.582 seconds
[0m15:10:59.740480 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:10:59.864382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e9392937-a4e3-4b11-9c61-fbc47b8039d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC3848DF00>]}
[0m15:10:59.864382 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:10:59.865395 [info ] [MainThread]: 
[0m15:10:59.868243 [debug] [Thread-1 (]: Began running node model.dbt_dataops.fact_sales
[0m15:10:59.869248 [info ] [Thread-1 (]: 1 of 2 START sql table model marketing.fact_sales .............................. [RUN]
[0m15:10:59.869248 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.fact_sales'
[0m15:10:59.870249 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.fact_sales
[0m15:10:59.877398 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.fact_sales"
[0m15:10:59.878402 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.fact_sales
[0m15:10:59.898617 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.fact_sales"
[0m15:10:59.901140 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.fact_sales"
[0m15:10:59.901140 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.fact_sales"} */
create or replace transient table dev_dwdb.marketing.fact_sales
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.marketing.fact_orders
where id = 1
        );
[0m15:10:59.902426 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:11:01.827907 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.926 seconds
[0m15:11:01.845156 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: Close
[0m15:11:01.972956 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'e9392937-a4e3-4b11-9c61-fbc47b8039d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC37F0FBB0>]}
[0m15:11:01.973959 [info ] [Thread-1 (]: 1 of 2 OK created sql table model marketing.fact_sales ......................... [[32mSUCCESS 1[0m in 2.10s]
[0m15:11:01.974967 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.fact_sales
[0m15:11:01.974967 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m15:11:01.976059 [info ] [Thread-3 (]: 2 of 2 START test not_null_fact_sales_id ....................................... [RUN]
[0m15:11:01.977068 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_fact_sales_id.735cdaeb13'
[0m15:11:01.977068 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m15:11:01.986604 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m15:11:01.987617 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m15:11:01.999249 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m15:11:02.000755 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m15:11:02.000755 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_fact_sales_id.735cdaeb13: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.fact_sales
where id is null



      
    ) dbt_internal_test
[0m15:11:02.001761 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:11:02.836822 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.835 seconds
[0m15:11:02.839842 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_fact_sales_id.735cdaeb13: Close
[0m15:11:02.972751 [info ] [Thread-3 (]: 2 of 2 PASS not_null_fact_sales_id ............................................. [[32mPASS[0m in 1.00s]
[0m15:11:02.973726 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m15:11:02.974760 [info ] [MainThread]: 
[0m15:11:02.975770 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:11:03.016264 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing'}
[0m15:11:03.022286 [debug] [MainThread]: Using snowflake connection "master"
[0m15:11:03.022286 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:11:03.022286 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:04.031952 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.009 seconds
[0m15:11:04.037752 [info ] [MainThread]: Test name: not_null
[0m15:11:04.038263 [info ] [MainThread]: Test type: generic
[0m15:11:04.039289 [info ] [MainThread]: Column name: id
[0m15:11:04.050198 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:11:04.054296 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:11:04.058370 [debug] [MainThread]: Using snowflake connection "master"
[0m15:11:04.058370 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_fact_sales_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id'::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9966921806335449'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.fact_sales where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:11:05.350160 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.291 seconds
[0m15:11:05.350160 [debug] [MainThread]: Using snowflake connection "master"
[0m15:11:05.351161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.fact_sales' as model_refs,
              'not_null_fact_sales_id' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.fact_sales where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:11:05.976881 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.624 seconds
[0m15:11:05.977885 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.92s]
[0m15:11:05.979049 [info ] [MainThread]: 
[0m15:11:05.979049 [debug] [MainThread]: On master: Close
[0m15:11:06.098290 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:06.099294 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m15:11:06.099294 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:11:06.100297 [debug] [MainThread]: Connection 'model.dbt_dataops.fact_sales' was properly closed.
[0m15:11:06.100297 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_fact_sales_id.735cdaeb13' was properly closed.
[0m15:11:06.101301 [info ] [MainThread]: 
[0m15:11:06.101301 [info ] [MainThread]: Finished running 1 table model, 1 test, 1 project hook in 0 hours 0 minutes and 7.79 seconds (7.79s).
[0m15:11:06.102425 [debug] [MainThread]: Command end result
[0m15:11:06.142554 [info ] [MainThread]: 
[0m15:11:06.143557 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:06.144564 [info ] [MainThread]: 
[0m15:11:06.145568 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:11:06.146571 [debug] [MainThread]: Command `dbt build` succeeded at 15:11:06.146571 after 9.50 seconds
[0m15:11:06.146571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1CA6E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC1D2E63B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BC38893F40>]}
[0m15:11:06.147583 [debug] [MainThread]: Flushing usage events
[0m15:11:20.243072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235952AE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023597E765F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023597E76410>]}


============================== 15:11:20.245921 | 662367f2-3d8d-4d57-92a7-f7b1d9d6ffb7 ==============================
[0m15:11:20.245921 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:11:20.247116 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt build --select tag:fact_sales', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:11:20.998497 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '662367f2-3d8d-4d57-92a7-f7b1d9d6ffb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023594DAE290>]}
[0m15:11:21.042870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '662367f2-3d8d-4d57-92a7-f7b1d9d6ffb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023594D834F0>]}
[0m15:11:21.044374 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:11:21.064817 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:11:21.301472 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:11:21.301472 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:11:21.347989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '662367f2-3d8d-4d57-92a7-f7b1d9d6ffb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B0CAC6A0>]}
[0m15:11:21.541124 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '662367f2-3d8d-4d57-92a7-f7b1d9d6ffb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B0CAE140>]}
[0m15:11:21.542150 [info ] [MainThread]: Found 2 models, 1 operation, 3 data tests, 841 macros
[0m15:11:21.543692 [info ] [MainThread]: 
[0m15:11:21.544200 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:11:21.545228 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m15:11:21.557612 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m15:11:21.558615 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m15:11:21.558615 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:22.193546 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.635 seconds
[0m15:11:22.195050 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m15:11:22.329273 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:11:22.337361 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:11:22.337361 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:11:22.338366 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:22.925464 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.587 seconds
[0m15:11:22.926468 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:11:23.051141 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '662367f2-3d8d-4d57-92a7-f7b1d9d6ffb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B08DA380>]}
[0m15:11:23.052144 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:11:23.053229 [info ] [MainThread]: 
[0m15:11:23.055549 [debug] [Thread-1 (]: Began running node model.dbt_dataops.fact_sales
[0m15:11:23.056570 [info ] [Thread-1 (]: 1 of 2 START sql table model marketing.fact_sales .............................. [RUN]
[0m15:11:23.057574 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.fact_sales'
[0m15:11:23.057574 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.fact_sales
[0m15:11:23.065115 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.fact_sales"
[0m15:11:23.066142 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.fact_sales
[0m15:11:23.091742 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.fact_sales"
[0m15:11:23.092743 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.fact_sales"
[0m15:11:23.094245 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.fact_sales"} */
create or replace transient table dev_dwdb.marketing.fact_sales
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.marketing.fact_orders
where id = 1
        );
[0m15:11:23.094245 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:11:24.126836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.032 seconds
[0m15:11:24.143615 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: Close
[0m15:11:24.267511 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '662367f2-3d8d-4d57-92a7-f7b1d9d6ffb7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002359728F4C0>]}
[0m15:11:24.267511 [info ] [Thread-1 (]: 1 of 2 OK created sql table model marketing.fact_sales ......................... [[32mSUCCESS 1[0m in 1.21s]
[0m15:11:24.268742 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.fact_sales
[0m15:11:24.269773 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m15:11:24.269773 [info ] [Thread-3 (]: 2 of 2 START test not_null_fact_sales_id ....................................... [RUN]
[0m15:11:24.270791 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_fact_sales_id.735cdaeb13'
[0m15:11:24.271806 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m15:11:24.280666 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m15:11:24.281669 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m15:11:24.294561 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m15:11:24.295064 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"
[0m15:11:24.296069 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_fact_sales_id.735cdaeb13: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_fact_sales_id.735cdaeb13"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.fact_sales
where id is null



      
    ) dbt_internal_test
[0m15:11:24.296069 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:11:24.920594 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m15:11:24.922601 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_fact_sales_id.735cdaeb13: Close
[0m15:11:25.049547 [info ] [Thread-3 (]: 2 of 2 PASS not_null_fact_sales_id ............................................. [[32mPASS[0m in 0.78s]
[0m15:11:25.050552 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_fact_sales_id.735cdaeb13
[0m15:11:25.051643 [info ] [MainThread]: 
[0m15:11:25.052669 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:11:25.091420 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing'}
[0m15:11:25.098087 [debug] [MainThread]: Using snowflake connection "master"
[0m15:11:25.098087 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:11:25.099089 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:26.124258 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.026 seconds
[0m15:11:26.131527 [info ] [MainThread]: Test name: not_null
[0m15:11:26.132998 [info ] [MainThread]: Test type: generic
[0m15:11:26.132998 [info ] [MainThread]: Column name: id
[0m15:11:26.142606 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:11:26.147359 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:11:26.151096 [debug] [MainThread]: Using snowflake connection "master"
[0m15:11:26.152158 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_fact_sales_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id'::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7787556648254395'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.fact_sales where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:11:26.570162 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.417 seconds
[0m15:11:26.570162 [debug] [MainThread]: Using snowflake connection "master"
[0m15:11:26.571170 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.fact_sales' as model_refs,
              'not_null_fact_sales_id' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.fact_sales where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:11:26.927868 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.356 seconds
[0m15:11:26.928903 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.78s]
[0m15:11:26.929906 [info ] [MainThread]: 
[0m15:11:26.931006 [debug] [MainThread]: On master: Close
[0m15:11:27.074681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:27.075686 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m15:11:27.076686 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:11:27.076686 [debug] [MainThread]: Connection 'model.dbt_dataops.fact_sales' was properly closed.
[0m15:11:27.077687 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_fact_sales_id.735cdaeb13' was properly closed.
[0m15:11:27.077687 [info ] [MainThread]: 
[0m15:11:27.078688 [info ] [MainThread]: Finished running 1 table model, 1 test, 1 project hook in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m15:11:27.079688 [debug] [MainThread]: Command end result
[0m15:11:27.122005 [info ] [MainThread]: 
[0m15:11:27.123085 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:11:27.123085 [info ] [MainThread]: 
[0m15:11:27.124101 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:11:27.125106 [debug] [MainThread]: Command `dbt build` succeeded at 15:11:27.125106 after 6.94 seconds
[0m15:11:27.125106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235952AE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023594D834F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235B1108D60>]}
[0m15:11:27.126132 [debug] [MainThread]: Flushing usage events
[0m15:11:42.932859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199ADB9E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199B072E5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199B072E3E0>]}


============================== 15:11:42.937167 | 482a5239-9833-4e66-abbf-db2a8c417653 ==============================
[0m15:11:42.937167 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:11:42.937167 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:fact_orders', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:11:43.680542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '482a5239-9833-4e66-abbf-db2a8c417653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199AE453E20>]}
[0m15:11:43.724233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '482a5239-9833-4e66-abbf-db2a8c417653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199AD6934C0>]}
[0m15:11:43.725234 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:11:43.747128 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:11:43.976883 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:11:43.976883 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:11:44.025187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '482a5239-9833-4e66-abbf-db2a8c417653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199C9568670>]}
[0m15:11:44.233320 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '482a5239-9833-4e66-abbf-db2a8c417653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199C956B6D0>]}
[0m15:11:44.233320 [info ] [MainThread]: Found 2 models, 1 operation, 3 data tests, 841 macros
[0m15:11:44.235552 [info ] [MainThread]: 
[0m15:11:44.236800 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:11:44.238802 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m15:11:44.256496 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m15:11:44.256496 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m15:11:44.257717 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:45.001424 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.743 seconds
[0m15:11:45.003427 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m15:11:45.130577 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:11:45.142898 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:11:45.143908 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:11:45.144908 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:11:45.769243 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.625 seconds
[0m15:11:45.771722 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:11:45.907429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '482a5239-9833-4e66-abbf-db2a8c417653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199C955B790>]}
[0m15:11:45.908431 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:11:45.909431 [info ] [MainThread]: 
[0m15:11:45.911433 [debug] [Thread-1 (]: Began running node model.dbt_dataops.fact_orders
[0m15:11:45.912916 [info ] [Thread-1 (]: 1 of 3 START sql table model marketing.fact_orders ............................. [RUN]
[0m15:11:45.914186 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.fact_orders'
[0m15:11:45.914186 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.fact_orders
[0m15:11:45.926573 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.fact_orders"
[0m15:11:45.927590 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.fact_orders
[0m15:11:45.966132 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.fact_orders"
[0m15:11:45.968140 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.fact_orders"
[0m15:11:45.969141 [debug] [Thread-1 (]: On model.dbt_dataops.fact_orders: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.fact_orders"} */
create or replace transient table dev_dwdb.marketing.fact_orders
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m15:11:45.969141 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:11:46.993150 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.023 seconds
[0m15:11:47.015251 [debug] [Thread-1 (]: On model.dbt_dataops.fact_orders: Close
[0m15:11:47.138772 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '482a5239-9833-4e66-abbf-db2a8c417653', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199AFB4C820>]}
[0m15:11:47.139778 [info ] [Thread-1 (]: 1 of 3 OK created sql table model marketing.fact_orders ........................ [[32mSUCCESS 1[0m in 1.22s]
[0m15:11:47.140783 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.fact_orders
[0m15:11:47.141787 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d
[0m15:11:47.141787 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_fact_orders_id.92484f801c
[0m15:11:47.142801 [info ] [Thread-3 (]: 2 of 3 START test not_null_fact_orders_id ...................................... [RUN]
[0m15:11:47.142801 [info ] [Thread-4 (]: 3 of 3 START test unique_fact_orders_id ........................................ [RUN]
[0m15:11:47.143805 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d'
[0m15:11:47.144811 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_fact_orders_id.92484f801c'
[0m15:11:47.144811 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d
[0m15:11:47.145814 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_fact_orders_id.92484f801c
[0m15:11:47.159009 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d"
[0m15:11:47.165739 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_fact_orders_id.92484f801c"
[0m15:11:47.168204 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d
[0m15:11:47.168204 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_fact_orders_id.92484f801c
[0m15:11:47.183928 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d"
[0m15:11:47.187387 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_fact_orders_id.92484f801c"
[0m15:11:47.188627 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d"
[0m15:11:47.189636 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_fact_orders_id.92484f801c"
[0m15:11:47.189636 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.marketing.fact_orders
where id is null



      
    ) dbt_internal_test
[0m15:11:47.190637 [debug] [Thread-4 (]: On test.dbt_dataops.unique_fact_orders_id.92484f801c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_fact_orders_id.92484f801c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.marketing.fact_orders
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m15:11:47.191638 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:11:47.191638 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:11:47.822292 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m15:11:47.827797 [debug] [Thread-4 (]: On test.dbt_dataops.unique_fact_orders_id.92484f801c: Close
[0m15:11:47.955507 [info ] [Thread-4 (]: 3 of 3 PASS unique_fact_orders_id .............................................. [[32mPASS[0m in 0.81s]
[0m15:11:47.956510 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_fact_orders_id.92484f801c
[0m15:11:48.841910 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.651 seconds
[0m15:11:48.843911 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d: Close
[0m15:11:48.967091 [error] [Thread-3 (]: 2 of 3 FAIL 1 not_null_fact_orders_id .......................................... [[31mFAIL 1[0m in 1.82s]
[0m15:11:48.969286 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d
[0m15:11:48.970287 [info ] [MainThread]: 
[0m15:11:48.971458 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:11:49.023369 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing'}
[0m15:11:49.031707 [debug] [MainThread]: Using snowflake connection "master"
[0m15:11:49.032707 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:11:49.033946 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:11:50.069365 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.036 seconds
[0m15:11:50.076148 [info ] [MainThread]: Test name: unique
[0m15:11:50.078150 [info ] [MainThread]: Test type: generic
[0m15:11:50.078150 [info ] [MainThread]: Column name: id
[0m15:11:50.091070 [info ] [MainThread]: Test name: not_null
[0m15:11:50.092075 [info ] [MainThread]: Test type: generic
[0m15:11:50.093078 [info ] [MainThread]: Column name: id
[0m15:11:50.094131 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:11:50.098174 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:11:50.104549 [debug] [MainThread]: Using snowflake connection "master"
[0m15:11:50.105602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_fact_orders_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id'::varchar(1000) as column_details,
            'marketing.fact_orders'::varchar(10000) as model_refs,
            split_part('marketing.fact_orders', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_orders', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8117022514343262'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_orders.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_orders where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_fact_orders_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'id'::varchar(1000) as column_details,
            'marketing.fact_orders'::varchar(10000) as model_refs,
            split_part('marketing.fact_orders', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_orders', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.823286533355713'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\fact_orders.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.marketing.fact_orders where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:11:50.604998 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.499 seconds
[0m15:11:50.606004 [debug] [MainThread]: Using snowflake connection "master"
[0m15:11:50.607014 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.fact_orders' as model_refs,
              'unique_fact_orders_id' as test_name,
              'models\example\fact_orders.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.fact_orders' as model_refs,
              'not_null_fact_orders_id' as test_name,
              'models\example\fact_orders.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.marketing.fact_orders where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.marketing.fact_orders where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:11:50.917033 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.310 seconds
[0m15:11:50.918038 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.82s]
[0m15:11:50.919043 [info ] [MainThread]: 
[0m15:11:50.920050 [debug] [MainThread]: On master: Close
[0m15:11:51.039556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:11:51.039556 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m15:11:51.040557 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:11:51.040557 [debug] [MainThread]: Connection 'model.dbt_dataops.fact_orders' was properly closed.
[0m15:11:51.041558 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_fact_orders_id.3ab3adfc3d' was properly closed.
[0m15:11:51.041558 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_fact_orders_id.92484f801c' was properly closed.
[0m15:11:51.042559 [info ] [MainThread]: 
[0m15:11:51.042559 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m15:11:51.043559 [debug] [MainThread]: Command end result
[0m15:11:51.079890 [info ] [MainThread]: 
[0m15:11:51.080896 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:11:51.082110 [info ] [MainThread]: 
[0m15:11:51.083114 [error] [MainThread]: [31mFailure in test not_null_fact_orders_id (models\example\fact_orders.yml)[0m
[0m15:11:51.083114 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:11:51.084314 [info ] [MainThread]: 
[0m15:11:51.085319 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\fact_orders.yml\not_null_fact_orders_id.sql
[0m15:11:51.085319 [info ] [MainThread]: 
[0m15:11:51.086323 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:11:51.087339 [debug] [MainThread]: Command `dbt build` failed at 15:11:51.087339 after 8.21 seconds
[0m15:11:51.087339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199ADB9E8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199AD6934C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000199B0061AB0>]}
[0m15:11:51.088523 [debug] [MainThread]: Flushing usage events
[0m15:14:35.239297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028251502980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282540BE680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282540BE4A0>]}


============================== 15:14:35.242306 | 2fa03956-7037-45e1-9ee4-c723693f1b01 ==============================
[0m15:14:35.242306 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:14:35.243311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt build --select tag:fact_sales', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:14:35.990374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2fa03956-7037-45e1-9ee4-c723693f1b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028251DB8D60>]}
[0m15:14:36.033835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2fa03956-7037-45e1-9ee4-c723693f1b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028250FE3550>]}
[0m15:14:36.034838 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:14:36.056081 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:14:36.285727 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m15:14:36.286733 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\fact_sales.yml
[0m15:14:36.286733 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\fact_sales.sql
[0m15:14:36.650286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2fa03956-7037-45e1-9ee4-c723693f1b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826D225120>]}
[0m15:14:36.771723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2fa03956-7037-45e1-9ee4-c723693f1b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826D2269E0>]}
[0m15:14:36.771723 [info ] [MainThread]: Found 2 models, 1 operation, 3 data tests, 841 macros
[0m15:14:36.773798 [info ] [MainThread]: 
[0m15:14:36.774805 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:14:36.775810 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m15:14:36.786853 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m15:14:36.786853 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m15:14:36.786853 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:37.417116 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.630 seconds
[0m15:14:37.419124 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m15:14:37.548120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:14:37.555163 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:14:37.555163 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:14:37.556167 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:14:38.066352 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.511 seconds
[0m15:14:38.067822 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:14:38.198933 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2fa03956-7037-45e1-9ee4-c723693f1b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826D2259C0>]}
[0m15:14:38.198933 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:14:38.200125 [info ] [MainThread]: 
[0m15:14:38.203143 [debug] [Thread-1 (]: Began running node model.dbt_dataops.fact_sales
[0m15:14:38.203143 [info ] [Thread-1 (]: 1 of 2 START sql table model marketing.fact_sales .............................. [RUN]
[0m15:14:38.204148 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.fact_sales'
[0m15:14:38.204148 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.fact_sales
[0m15:14:38.211996 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.fact_sales"
[0m15:14:38.213318 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.fact_sales
[0m15:14:38.234683 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.fact_sales"
[0m15:14:38.236691 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.fact_sales"
[0m15:14:38.236691 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.fact_sales"} */
create or replace transient table dev_dwdb.marketing.fact_sales
         as
        (-- Use the `ref` function to select from other models

select *, 'value_4' as column_4
from dev_dwdb.marketing.fact_orders
where id = 1
        );
[0m15:14:38.237778 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:14:39.134402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.897 seconds
[0m15:14:39.150579 [debug] [Thread-1 (]: On model.dbt_dataops.fact_sales: Close
[0m15:14:39.274078 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2fa03956-7037-45e1-9ee4-c723693f1b01', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826C99FBE0>]}
[0m15:14:39.274078 [info ] [Thread-1 (]: 1 of 2 OK created sql table model marketing.fact_sales ......................... [[32mSUCCESS 1[0m in 1.07s]
[0m15:14:39.275081 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.fact_sales
[0m15:14:39.276257 [debug] [Thread-3 (]: Began running node test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f
[0m15:14:39.277262 [info ] [Thread-3 (]: 2 of 2 START test dbt_utils_unique_combination_of_columns_fact_sales_id__column_4  [RUN]
[0m15:14:39.277262 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f'
[0m15:14:39.278266 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f
[0m15:14:39.282280 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f"
[0m15:14:39.282280 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f
[0m15:14:39.296338 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f"
[0m15:14:39.298341 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f"
[0m15:14:39.298341 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        id, column_4
    from dev_dwdb.marketing.fact_sales
    group by id, column_4
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m15:14:39.299342 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:14:39.913395 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m15:14:39.916911 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f: Close
[0m15:14:40.036721 [info ] [Thread-3 (]: 2 of 2 PASS dbt_utils_unique_combination_of_columns_fact_sales_id__column_4 .... [[32mPASS[0m in 0.76s]
[0m15:14:40.037747 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f
[0m15:14:40.039295 [info ] [MainThread]: 
[0m15:14:40.039809 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:14:40.078627 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing'}
[0m15:14:40.083693 [debug] [MainThread]: Using snowflake connection "master"
[0m15:14:40.084697 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:14:40.084697 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:14:41.112252 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.027 seconds
[0m15:14:41.116520 [info ] [MainThread]: Test name: unique_combination_of_columns
[0m15:14:41.117524 [info ] [MainThread]: Test type: generic
[0m15:14:41.118528 [info ] [MainThread]: Column name: None
[0m15:14:41.127080 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:14:41.131271 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:14:41.134362 [debug] [MainThread]: Using snowflake connection "master"
[0m15:14:41.135612 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('unique_combination_of_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique_combination_of_columns'::varchar(4000) as test_name,
            'dbt_utils_unique_combination_of_columns_fact_sales_id__column_4'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7594590187072754'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'with validation_errors as (      select         id, column_4     from dev_dwdb.marketing.fact_sales     group by id, column_4     having count(*) > 1  )  select * from validation_errors'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:14:41.648198 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.512 seconds
[0m15:14:41.648198 [debug] [MainThread]: Using snowflake connection "master"
[0m15:14:41.649202 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.fact_sales' as model_refs,
              'dbt_utils_unique_combination_of_columns_fact_sales_id__column_4' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique_combination_of_columns'::varchar(4000) as test_name,
            'with validation_errors as (      select         id, column_4     from dev_dwdb.marketing.fact_sales     group by id, column_4     having count(*) > 1  )  select * from validation_errors'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:14:42.096431 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.447 seconds
[0m15:14:42.097440 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.97s]
[0m15:14:42.097440 [info ] [MainThread]: 
[0m15:14:42.098445 [debug] [MainThread]: On master: Close
[0m15:14:42.219578 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:14:42.220093 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m15:14:42.220093 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:14:42.220610 [debug] [MainThread]: Connection 'model.dbt_dataops.fact_sales' was properly closed.
[0m15:14:42.221124 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f' was properly closed.
[0m15:14:42.221124 [info ] [MainThread]: 
[0m15:14:42.222163 [info ] [MainThread]: Finished running 1 table model, 1 test, 1 project hook in 0 hours 0 minutes and 5.45 seconds (5.45s).
[0m15:14:42.223195 [debug] [MainThread]: Command end result
[0m15:14:42.320254 [info ] [MainThread]: 
[0m15:14:42.321328 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:14:42.321328 [info ] [MainThread]: 
[0m15:14:42.322334 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m15:14:42.323339 [debug] [MainThread]: Command `dbt build` succeeded at 15:14:42.323339 after 7.14 seconds
[0m15:14:42.323339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028251502980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000282502F7C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002826D1AB5E0>]}
[0m15:14:42.324343 [debug] [MainThread]: Flushing usage events
[0m15:16:20.758937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093F05E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020941C2A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020941C2A320>]}


============================== 15:16:20.761666 | f0f7420b-35cf-4ebc-82f0-362f55c5b30e ==============================
[0m15:16:20.761666 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:16:20.762847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:fact_sales', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:16:21.478052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f0f7420b-35cf-4ebc-82f0-362f55c5b30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093F2E7A90>]}
[0m15:16:21.523609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f0f7420b-35cf-4ebc-82f0-362f55c5b30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093EB33520>]}
[0m15:16:21.524609 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:16:21.546158 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:16:21.786570 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:16:21.787075 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\fact_sales.yml
[0m15:16:22.153720 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f0f7420b-35cf-4ebc-82f0-362f55c5b30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095ADA1630>]}
[0m15:16:22.274624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f0f7420b-35cf-4ebc-82f0-362f55c5b30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095ADA0940>]}
[0m15:16:22.275630 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 841 macros
[0m15:16:22.276634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0f7420b-35cf-4ebc-82f0-362f55c5b30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095AA28E80>]}
[0m15:16:22.277637 [info ] [MainThread]: 
[0m15:16:22.278640 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:16:22.282651 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:16:22.295579 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:16:22.296580 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:16:22.296580 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:16:22.995980 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.699 seconds
[0m15:16:22.997996 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:16:23.121166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f0f7420b-35cf-4ebc-82f0-362f55c5b30e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095ADA3E20>]}
[0m15:16:23.122174 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:16:23.123180 [info ] [MainThread]: 
[0m15:16:23.126196 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e
[0m15:16:23.126196 [debug] [Thread-2 (]: Began running node test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f
[0m15:16:23.126196 [info ] [Thread-1 (]: 1 of 2 START test dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper  [RUN]
[0m15:16:23.127199 [info ] [Thread-2 (]: 2 of 2 START test dbt_utils_unique_combination_of_columns_fact_sales_id__column_4  [RUN]
[0m15:16:23.128334 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e'
[0m15:16:23.128334 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f'
[0m15:16:23.128334 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e
[0m15:16:23.129639 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f
[0m15:16:23.145348 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e"
[0m15:16:23.150487 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f"
[0m15:16:23.150487 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e"} */
describe table dev_dwdb.marketing.fact_sales
[0m15:16:23.151612 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:16:23.152827 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f
[0m15:16:23.170481 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f"
[0m15:16:23.171484 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f"
[0m15:16:23.172680 [debug] [Thread-2 (]: On test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        id, column_4
    from dev_dwdb.marketing.fact_sales
    group by id, column_4
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m15:16:23.173685 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:16:23.670960 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.520 seconds
[0m15:16:23.677410 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e"
[0m15:16:23.678416 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e
[0m15:16:23.680431 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e"
[0m15:16:23.682451 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e"
[0m15:16:23.683457 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            1 as relation_column_idx,
            cast('ID' as TEXT) as relation_column
        union all
        
        select
            2 as relation_column_idx,
            cast('COLUMN_1' as TEXT) as relation_column
        union all
        
        select
            3 as relation_column_idx,
            cast('COLUMN_2' as TEXT) as relation_column
        union all
        
        select
            4 as relation_column_idx,
            cast('COLUMN_3' as TEXT) as relation_column
        union all
        
        select
            5 as relation_column_idx,
            cast('COLUMN_4' as TEXT) as relation_column
        
        
    ),
    input_columns as (

        
        select
            1 as input_column_idx,
            cast('COLUMN_1' as TEXT) as input_column
        union all
        
        select
            2 as input_column_idx,
            cast('COLUMN_2' as TEXT) as input_column
        
        
    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null
      
    ) dbt_internal_test
[0m15:16:23.819737 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.136 seconds
[0m15:16:23.826761 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e: Close
[0m15:16:23.950343 [error] [Thread-1 (]: 1 of 2 FAIL 7 dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper  [[31mFAIL 7[0m in 0.82s]
[0m15:16:23.951351 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e
[0m15:16:24.853707 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.680 seconds
[0m15:16:24.854717 [debug] [Thread-2 (]: On test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f: Close
[0m15:16:24.975999 [info ] [Thread-2 (]: 2 of 2 PASS dbt_utils_unique_combination_of_columns_fact_sales_id__column_4 .... [[32mPASS[0m in 1.85s]
[0m15:16:24.977003 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f
[0m15:16:24.978006 [info ] [MainThread]: 
[0m15:16:24.979010 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:16:25.017352 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing'}
[0m15:16:25.023672 [debug] [MainThread]: Using snowflake connection "master"
[0m15:16:25.023672 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:16:25.023672 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:16:26.093024 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.068 seconds
[0m15:16:26.097041 [info ] [MainThread]: Test name: expect_table_columns_to_match_ordered_list
[0m15:16:26.098050 [info ] [MainThread]: Test type: generic
[0m15:16:26.098050 [info ] [MainThread]: Column name: None
[0m15:16:26.106183 [info ] [MainThread]: Test name: unique_combination_of_columns
[0m15:16:26.107186 [info ] [MainThread]: Test type: generic
[0m15:16:26.108189 [info ] [MainThread]: Column name: None
[0m15:16:26.109193 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:16:26.113213 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:16:26.116727 [debug] [MainThread]: Using snowflake connection "master"
[0m15:16:26.117738 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('expect_table_columns_to_match_ordered_list' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expect_table_columns_to_match_ordered_list'::varchar(4000) as test_name,
            'dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8231439590454102'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'with relation_columns as (                   select             1 as relation_column_idx,             cast(''ID'' as TEXT) as relation_column         union all                  select             2 as relation_column_idx,             cast(''COLUMN_1'' as TEXT) as relation_column         union all                  select             3 as relation_column_idx,             cast(''COLUMN_2'' as TEXT) as relation_column         union all                  select             4 as relation_column_idx,             cast(''COLUMN_3'' as TEXT) as relation_column         union all                  select             5 as relation_column_idx,             cast(''COLUMN_4'' as TEXT) as relation_column                       ),     input_columns as (                   select             1 as input_column_idx,             cast(''COLUMN_1'' as TEXT) as input_column         union all                  select             2 as input_column_idx,             cast(''COLUMN_2'' as TEXT) as input_column                       )     select *     from         relation_columns r         full outer join         input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx     where         -- catch any column in input list that is not in the sequence of table columns         -- or any table column that is not in the input sequence         r.relation_column is null or         i.input_column is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique_combination_of_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique_combination_of_columns'::varchar(4000) as test_name,
            'dbt_utils_unique_combination_of_columns_fact_sales_id__column_4'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8476643562316895'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'with validation_errors as (      select         id, column_4     from dev_dwdb.marketing.fact_sales     group by id, column_4     having count(*) > 1  )  select * from validation_errors'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:16:26.628525 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.510 seconds
[0m15:16:26.628525 [debug] [MainThread]: Using snowflake connection "master"
[0m15:16:26.629528 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.fact_sales' as model_refs,
              'dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.fact_sales' as model_refs,
              'dbt_utils_unique_combination_of_columns_fact_sales_id__column_4' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'expect_table_columns_to_match_ordered_list'::varchar(4000) as test_name,
            'with relation_columns as (                   select             1 as relation_column_idx,             cast(''ID'' as TEXT) as relation_column         union all                  select             2 as relation_column_idx,             cast(''COLUMN_1'' as TEXT) as relation_column         union all                  select             3 as relation_column_idx,             cast(''COLUMN_2'' as TEXT) as relation_column         union all                  select             4 as relation_column_idx,             cast(''COLUMN_3'' as TEXT) as relation_column         union all                  select             5 as relation_column_idx,             cast(''COLUMN_4'' as TEXT) as relation_column                       ),     input_columns as (                   select             1 as input_column_idx,             cast(''COLUMN_1'' as TEXT) as input_column         union all                  select             2 as input_column_idx,             cast(''COLUMN_2'' as TEXT) as input_column                       )     select *     from         relation_columns r         full outer join         input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx     where         -- catch any column in input list that is not in the sequence of table columns         -- or any table column that is not in the input sequence         r.relation_column is null or         i.input_column is null'::varchar(65535) as compiled_sql
          union all select
            'unique_combination_of_columns'::varchar(4000) as test_name,
            'with validation_errors as (      select         id, column_4     from dev_dwdb.marketing.fact_sales     group by id, column_4     having count(*) > 1  )  select * from validation_errors'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:16:26.935559 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.306 seconds
[0m15:16:26.936563 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.82s]
[0m15:16:26.937748 [info ] [MainThread]: 
[0m15:16:26.938752 [debug] [MainThread]: On master: Close
[0m15:16:27.056866 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:16:27.057877 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:16:27.057877 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e' was properly closed.
[0m15:16:27.057877 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f' was properly closed.
[0m15:16:27.058881 [info ] [MainThread]: 
[0m15:16:27.059884 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.78 seconds (4.78s).
[0m15:16:27.059884 [debug] [MainThread]: Command end result
[0m15:16:27.165262 [info ] [MainThread]: 
[0m15:16:27.166263 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:16:27.167396 [info ] [MainThread]: 
[0m15:16:27.168405 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper (models\example\fact_sales.yml)[0m
[0m15:16:27.168405 [error] [MainThread]:   Got 7 results, configured to fail if != 0
[0m15:16:27.169408 [info ] [MainThread]: 
[0m15:16:27.170411 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\fact_sales.yml\dbt_expectations_expect_table__4a6b319da41dfb6f4477379abdc5cc7c.sql
[0m15:16:27.170411 [info ] [MainThread]: 
[0m15:16:27.170411 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:16:27.172640 [debug] [MainThread]: Command `dbt test` failed at 15:16:27.172640 after 6.48 seconds
[0m15:16:27.172640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002093F05E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095B272DA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002095B271420>]}
[0m15:16:27.172640 [debug] [MainThread]: Flushing usage events
[0m15:17:44.436936 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2C39E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2EF96410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2EF96230>]}


============================== 15:17:44.439370 | 4c77ca0b-dcf6-47d0-ba21-b3c0839bb301 ==============================
[0m15:17:44.439370 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:17:44.440373 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:fact_sales', 'send_anonymous_usage_stats': 'True'}
[0m15:17:45.190304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c77ca0b-dcf6-47d0-ba21-b3c0839bb301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2CC58BE0>]}
[0m15:17:45.236292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c77ca0b-dcf6-47d0-ba21-b3c0839bb301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2E3DB700>]}
[0m15:17:45.237392 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:17:45.263348 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:17:45.509467 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:17:45.510491 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\fact_sales.yml
[0m15:17:45.899455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c77ca0b-dcf6-47d0-ba21-b3c0839bb301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E480DDEA0>]}
[0m15:17:46.020351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c77ca0b-dcf6-47d0-ba21-b3c0839bb301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E480DE650>]}
[0m15:17:46.020351 [info ] [MainThread]: Found 2 models, 1 operation, 5 data tests, 841 macros
[0m15:17:46.021360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c77ca0b-dcf6-47d0-ba21-b3c0839bb301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E47D50130>]}
[0m15:17:46.023445 [info ] [MainThread]: 
[0m15:17:46.023445 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:17:46.028463 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:17:46.041007 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:17:46.042008 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:17:46.042008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:17:46.746040 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.703 seconds
[0m15:17:46.747041 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:17:46.875970 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c77ca0b-dcf6-47d0-ba21-b3c0839bb301', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E480DE0B0>]}
[0m15:17:46.875970 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:17:46.877048 [info ] [MainThread]: 
[0m15:17:46.880528 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e
[0m15:17:46.880528 [debug] [Thread-2 (]: Began running node test.dbt_dataops.dbt_utils_not_accepted_values_fact_sales_column_1__value_1.30e5a102ba
[0m15:17:46.880528 [debug] [Thread-3 (]: Began running node test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f
[0m15:17:46.881538 [info ] [Thread-1 (]: 1 of 3 START test dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper  [RUN]
[0m15:17:46.881538 [info ] [Thread-2 (]: 2 of 3 START test dbt_utils_not_accepted_values_fact_sales_column_1__value_1 ... [RUN]
[0m15:17:46.882543 [info ] [Thread-3 (]: 3 of 3 START test dbt_utils_unique_combination_of_columns_fact_sales_id__column_4  [RUN]
[0m15:17:46.883547 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e'
[0m15:17:46.883547 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_not_accepted_values_fact_sales_column_1__value_1.30e5a102ba'
[0m15:17:46.884551 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f'
[0m15:17:46.884551 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e
[0m15:17:46.885556 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.dbt_utils_not_accepted_values_fact_sales_column_1__value_1.30e5a102ba
[0m15:17:46.885556 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f
[0m15:17:46.901902 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e"
[0m15:17:46.906066 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_not_accepted_values_fact_sales_column_1__value_1.30e5a102ba"
[0m15:17:46.910432 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f"
[0m15:17:46.911433 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e"} */
describe table dev_dwdb.marketing.fact_sales
[0m15:17:46.912434 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:17:46.912434 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.dbt_utils_not_accepted_values_fact_sales_column_1__value_1.30e5a102ba
[0m15:17:46.913435 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f
[0m15:17:46.931192 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_not_accepted_values_fact_sales_column_1__value_1.30e5a102ba"
[0m15:17:46.936725 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f"
[0m15:17:46.938783 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_not_accepted_values_fact_sales_column_1__value_1.30e5a102ba"
[0m15:17:46.939787 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f"
[0m15:17:46.939787 [debug] [Thread-2 (]: On test.dbt_dataops.dbt_utils_not_accepted_values_fact_sales_column_1__value_1.30e5a102ba: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_not_accepted_values_fact_sales_column_1__value_1.30e5a102ba"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
with all_values as (

    select distinct
        column_1 as value_field

    from dev_dwdb.marketing.fact_sales

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field in (
        'value_1'
        )

)

select *
from validation_errors


      
    ) dbt_internal_test
[0m15:17:46.940994 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      





with validation_errors as (

    select
        id, column_4
    from dev_dwdb.marketing.fact_sales
    group by id, column_4
    having count(*) > 1

)

select *
from validation_errors



      
    ) dbt_internal_test
[0m15:17:46.940994 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:17:46.940994 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:17:47.502698 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m15:17:47.513707 [debug] [Thread-2 (]: On test.dbt_dataops.dbt_utils_not_accepted_values_fact_sales_column_1__value_1.30e5a102ba: Close
[0m15:17:47.556281 [debug] [Thread-1 (]: SQL status: SUCCESS 5 in 0.644 seconds
[0m15:17:47.562531 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e"
[0m15:17:47.563701 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e
[0m15:17:47.566745 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e"
[0m15:17:47.569117 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e"
[0m15:17:47.570411 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      with relation_columns as (

        
        select
            1 as relation_column_idx,
            cast('ID' as TEXT) as relation_column
        union all
        
        select
            2 as relation_column_idx,
            cast('COLUMN_1' as TEXT) as relation_column
        union all
        
        select
            3 as relation_column_idx,
            cast('COLUMN_2' as TEXT) as relation_column
        union all
        
        select
            4 as relation_column_idx,
            cast('COLUMN_3' as TEXT) as relation_column
        union all
        
        select
            5 as relation_column_idx,
            cast('COLUMN_4' as TEXT) as relation_column
        
        
    ),
    input_columns as (

        
        select
            1 as input_column_idx,
            cast('COLUMN_1' as TEXT) as input_column
        union all
        
        select
            2 as input_column_idx,
            cast('COLUMN_2' as TEXT) as input_column
        
        
    )
    select *
    from
        relation_columns r
        full outer join
        input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx
    where
        -- catch any column in input list that is not in the sequence of table columns
        -- or any table column that is not in the input sequence
        r.relation_column is null or
        i.input_column is null
      
    ) dbt_internal_test
[0m15:17:47.641351 [error] [Thread-2 (]: 2 of 3 FAIL 1 dbt_utils_not_accepted_values_fact_sales_column_1__value_1 ....... [[31mFAIL 1[0m in 0.76s]
[0m15:17:47.642371 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.dbt_utils_not_accepted_values_fact_sales_column_1__value_1.30e5a102ba
[0m15:17:47.688237 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.118 seconds
[0m15:17:47.690257 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e: Close
[0m15:17:47.808973 [error] [Thread-1 (]: 1 of 3 FAIL 7 dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper  [[31mFAIL 7[0m in 0.93s]
[0m15:17:47.811115 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e
[0m15:17:48.438426 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.497 seconds
[0m15:17:48.439864 [debug] [Thread-3 (]: On test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f: Close
[0m15:17:48.564406 [info ] [Thread-3 (]: 3 of 3 PASS dbt_utils_unique_combination_of_columns_fact_sales_id__column_4 .... [[32mPASS[0m in 1.68s]
[0m15:17:48.565408 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f
[0m15:17:48.567585 [info ] [MainThread]: 
[0m15:17:48.567585 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:17:48.673248 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing'}
[0m15:17:48.679408 [debug] [MainThread]: Using snowflake connection "master"
[0m15:17:48.679408 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:17:48.680412 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:17:49.731599 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.051 seconds
[0m15:17:49.736603 [info ] [MainThread]: Test name: not_accepted_values
[0m15:17:49.737604 [info ] [MainThread]: Test type: generic
[0m15:17:49.738692 [info ] [MainThread]: Column name: column_1
[0m15:17:49.746906 [info ] [MainThread]: Test name: expect_table_columns_to_match_ordered_list
[0m15:17:49.746906 [info ] [MainThread]: Test type: generic
[0m15:17:49.747912 [info ] [MainThread]: Column name: None
[0m15:17:49.748938 [info ] [MainThread]: Test name: unique_combination_of_columns
[0m15:17:49.749943 [info ] [MainThread]: Test type: generic
[0m15:17:49.750948 [info ] [MainThread]: Column name: None
[0m15:17:49.752212 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:17:49.756722 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:17:49.762171 [debug] [MainThread]: Using snowflake connection "master"
[0m15:17:49.763173 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_accepted_values' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_accepted_values'::varchar(4000) as test_name,
            'dbt_utils_not_accepted_values_fact_sales_column_1__value_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7572948932647705'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'with all_values as (      select distinct         column_1 as value_field      from dev_dwdb.marketing.fact_sales  ),  validation_errors as (      select         value_field      from all_values     where value_field in (         ''value_1''         )  )  select * from validation_errors'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('expect_table_columns_to_match_ordered_list' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expect_table_columns_to_match_ordered_list'::varchar(4000) as test_name,
            'dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9264297485351562'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'with relation_columns as (                   select             1 as relation_column_idx,             cast(''ID'' as TEXT) as relation_column         union all                  select             2 as relation_column_idx,             cast(''COLUMN_1'' as TEXT) as relation_column         union all                  select             3 as relation_column_idx,             cast(''COLUMN_2'' as TEXT) as relation_column         union all                  select             4 as relation_column_idx,             cast(''COLUMN_3'' as TEXT) as relation_column         union all                  select             5 as relation_column_idx,             cast(''COLUMN_4'' as TEXT) as relation_column                       ),     input_columns as (                   select             1 as input_column_idx,             cast(''COLUMN_1'' as TEXT) as input_column         union all                  select             2 as input_column_idx,             cast(''COLUMN_2'' as TEXT) as input_column                       )     select *     from         relation_columns r         full outer join         input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx     where         -- catch any column in input list that is not in the sequence of table columns         -- or any table column that is not in the input sequence         r.relation_column is null or         i.input_column is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all 
          
          
          

          select
            md5(cast(coalesce(cast('unique_combination_of_columns' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique_combination_of_columns'::varchar(4000) as test_name,
            'dbt_utils_unique_combination_of_columns_fact_sales_id__column_4'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'table'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.fact_sales'::varchar(10000) as model_refs,
            split_part('marketing.fact_sales', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.fact_sales', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.6798584461212158'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\fact_sales.yml'::varchar(4000) as file_test_defined,
            'with validation_errors as (      select         id, column_4     from dev_dwdb.marketing.fact_sales     group by id, column_4     having count(*) > 1  )  select * from validation_errors'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:17:50.258020 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.494 seconds
[0m15:17:50.258020 [debug] [MainThread]: Using snowflake connection "master"
[0m15:17:50.259023 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.fact_sales' as model_refs,
              'dbt_utils_not_accepted_values_fact_sales_column_1__value_1' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.fact_sales' as model_refs,
              'dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            union all select 
              'marketing.fact_sales' as model_refs,
              'dbt_utils_unique_combination_of_columns_fact_sales_id__column_4' as test_name,
              'models\example\fact_sales.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_accepted_values'::varchar(4000) as test_name,
            'with all_values as (      select distinct         column_1 as value_field      from dev_dwdb.marketing.fact_sales  ),  validation_errors as (      select         value_field      from all_values     where value_field in (         ''value_1''         )  )  select * from validation_errors'::varchar(65535) as compiled_sql
          union all select
            'expect_table_columns_to_match_ordered_list'::varchar(4000) as test_name,
            'with relation_columns as (                   select             1 as relation_column_idx,             cast(''ID'' as TEXT) as relation_column         union all                  select             2 as relation_column_idx,             cast(''COLUMN_1'' as TEXT) as relation_column         union all                  select             3 as relation_column_idx,             cast(''COLUMN_2'' as TEXT) as relation_column         union all                  select             4 as relation_column_idx,             cast(''COLUMN_3'' as TEXT) as relation_column         union all                  select             5 as relation_column_idx,             cast(''COLUMN_4'' as TEXT) as relation_column                       ),     input_columns as (                   select             1 as input_column_idx,             cast(''COLUMN_1'' as TEXT) as input_column         union all                  select             2 as input_column_idx,             cast(''COLUMN_2'' as TEXT) as input_column                       )     select *     from         relation_columns r         full outer join         input_columns i on r.relation_column = i.input_column and r.relation_column_idx = i.input_column_idx     where         -- catch any column in input list that is not in the sequence of table columns         -- or any table column that is not in the input sequence         r.relation_column is null or         i.input_column is null'::varchar(65535) as compiled_sql
          union all select
            'unique_combination_of_columns'::varchar(4000) as test_name,
            'with validation_errors as (      select         id, column_4     from dev_dwdb.marketing.fact_sales     group by id, column_4     having count(*) > 1  )  select * from validation_errors'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:17:50.590807 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.331 seconds
[0m15:17:50.591811 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.84s]
[0m15:17:50.591811 [info ] [MainThread]: 
[0m15:17:50.592927 [debug] [MainThread]: On master: Close
[0m15:17:50.711964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:17:50.711964 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:17:50.712975 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper.2590cc9a1e' was properly closed.
[0m15:17:50.712975 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_not_accepted_values_fact_sales_column_1__value_1.30e5a102ba' was properly closed.
[0m15:17:50.713978 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_unique_combination_of_columns_fact_sales_id__column_4.b8ab01b49f' was properly closed.
[0m15:17:50.713978 [info ] [MainThread]: 
[0m15:17:50.714983 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m15:17:50.715989 [debug] [MainThread]: Command end result
[0m15:17:50.757149 [info ] [MainThread]: 
[0m15:17:50.757149 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m15:17:50.758162 [info ] [MainThread]: 
[0m15:17:50.759167 [error] [MainThread]: [31mFailure in test dbt_utils_not_accepted_values_fact_sales_column_1__value_1 (models\example\fact_sales.yml)[0m
[0m15:17:50.760176 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m15:17:50.760176 [info ] [MainThread]: 
[0m15:17:50.761181 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\fact_sales.yml\dbt_utils_not_accepted_values_fact_sales_column_1__value_1.sql
[0m15:17:50.761181 [info ] [MainThread]: 
[0m15:17:50.762186 [error] [MainThread]: [31mFailure in test dbt_expectations_expect_table_columns_to_match_ordered_list_fact_sales_COLUMN_1__COLUMN_2__upper (models\example\fact_sales.yml)[0m
[0m15:17:50.762186 [error] [MainThread]:   Got 7 results, configured to fail if != 0
[0m15:17:50.763561 [info ] [MainThread]: 
[0m15:17:50.763561 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\fact_sales.yml\dbt_expectations_expect_table__4a6b319da41dfb6f4477379abdc5cc7c.sql
[0m15:17:50.764565 [info ] [MainThread]: 
[0m15:17:50.764565 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m15:17:50.765569 [debug] [MainThread]: Command `dbt test` failed at 15:17:50.765569 after 6.39 seconds
[0m15:17:50.765569 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E2C39E890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E47F42290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022E47F41D80>]}
[0m15:17:50.767072 [debug] [MainThread]: Flushing usage events
[0m15:25:16.247635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C095D2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C0C15E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C0C15E2F0>]}


============================== 15:25:16.250832 | c8f92c39-d0df-4ca0-9a7d-94a594f75c0c ==============================
[0m15:25:16.250832 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:25:16.251834 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:markets', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:25:16.989005 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c8f92c39-d0df-4ca0-9a7d-94a594f75c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C24A6E8C0>]}
[0m15:25:17.033394 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c8f92c39-d0df-4ca0-9a7d-94a594f75c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C09E7B730>]}
[0m15:25:17.034400 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:25:17.054841 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:25:17.311461 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m15:25:17.311461 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://models\example\markets.yml
[0m15:25:17.312465 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://models\example\markets.sql
[0m15:25:17.313470 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\fact_sales.yml
[0m15:25:17.709974 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c8f92c39-d0df-4ca0-9a7d-94a594f75c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C252E0130>]}
[0m15:25:17.837810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c8f92c39-d0df-4ca0-9a7d-94a594f75c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C24F60820>]}
[0m15:25:17.838880 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:25:17.839895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8f92c39-d0df-4ca0-9a7d-94a594f75c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C252F3850>]}
[0m15:25:17.840901 [info ] [MainThread]: 
[0m15:25:17.841900 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:25:17.846348 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:25:17.859442 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:25:17.860442 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:25:17.860442 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:25:18.572530 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.712 seconds
[0m15:25:18.574540 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:25:18.700541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c8f92c39-d0df-4ca0-9a7d-94a594f75c0c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C24F60AC0>]}
[0m15:25:18.700541 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:25:18.701544 [info ] [MainThread]: 
[0m15:25:18.704560 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_2.2c4b000c73
[0m15:25:18.704560 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_2 .................................... [RUN]
[0m15:25:18.705564 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_2.2c4b000c73'
[0m15:25:18.705564 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_2.2c4b000c73
[0m15:25:18.716667 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_2.2c4b000c73"
[0m15:25:18.717677 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_2.2c4b000c73
[0m15:25:18.735438 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_2.2c4b000c73"
[0m15:25:18.736442 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_2.2c4b000c73"
[0m15:25:18.736442 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_2.2c4b000c73: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_2.2c4b000c73"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.marketing.markets
where column_2 is null



      
    ) dbt_internal_test
[0m15:25:18.737635 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:25:19.290571 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba89d3-3201-740c-000b-f69200032116
[0m15:25:19.291085 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
[0m15:25:19.292216 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_2.2c4b000c73: Close
[0m15:25:19.408132 [debug] [Thread-1 (]: Database Error in test not_null_markets_column_2 (models\example\markets.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\markets.yml\not_null_markets_column_2.sql
[0m15:25:19.409136 [error] [Thread-1 (]: 1 of 1 ERROR not_null_markets_column_2 ......................................... [[31mERROR[0m in 0.70s]
[0m15:25:19.410146 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_2.2c4b000c73
[0m15:25:19.411428 [info ] [MainThread]: 
[0m15:25:19.412437 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:25:19.449341 [info ] [MainThread]: {'fact_orders': 'marketing', 'markets': 'marketing', 'fact_sales': 'marketing'}
[0m15:25:19.454390 [debug] [MainThread]: Using snowflake connection "master"
[0m15:25:19.455396 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:25:19.455396 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:25:20.422817 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.967 seconds
[0m15:25:20.427929 [info ] [MainThread]: Test name: not_null
[0m15:25:20.427929 [info ] [MainThread]: Test type: generic
[0m15:25:20.428933 [info ] [MainThread]: Column name: column_2
[0m15:25:20.441334 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:25:20.448628 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:25:20.452030 [debug] [MainThread]: Using snowflake connection "master"
[0m15:25:20.452030 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_2'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7035717964172363'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.marketing.markets where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:25:20.909117 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.455 seconds
[0m15:25:20.909117 [debug] [MainThread]: Using snowflake connection "master"
[0m15:25:20.910128 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_2' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.marketing.markets where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:25:21.202418 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.292 seconds
[0m15:25:21.204981 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.75s]
[0m15:25:21.205987 [info ] [MainThread]: 
[0m15:25:21.206992 [debug] [MainThread]: On master: Close
[0m15:25:21.326969 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:25:21.327980 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:25:21.327980 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_2.2c4b000c73' was properly closed.
[0m15:25:21.327980 [info ] [MainThread]: 
[0m15:25:21.329125 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.49 seconds (3.49s).
[0m15:25:21.330129 [debug] [MainThread]: Command end result
[0m15:25:21.449263 [info ] [MainThread]: 
[0m15:25:21.450369 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:25:21.450369 [info ] [MainThread]: 
[0m15:25:21.451373 [error] [MainThread]:   Database Error in test not_null_markets_column_2 (models\example\markets.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\markets.yml\not_null_markets_column_2.sql
[0m15:25:21.452617 [info ] [MainThread]: 
[0m15:25:21.452617 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:25:21.454915 [debug] [MainThread]: Command `dbt test` failed at 15:25:21.453911 after 5.26 seconds
[0m15:25:21.454915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C095D2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C0843FB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000013C267EAAA0>]}
[0m15:25:21.454915 [debug] [MainThread]: Flushing usage events
[0m15:30:14.307781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8FD302920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8FFEAE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8FFEAE320>]}


============================== 15:30:14.310801 | 27b2403f-5201-4642-955d-c02f7272872f ==============================
[0m15:30:14.310801 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:30:14.311804 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:markets', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:30:15.065210 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27b2403f-5201-4642-955d-c02f7272872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8FD58BEB0>]}
[0m15:30:15.109702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27b2403f-5201-4642-955d-c02f7272872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8FCDF34F0>]}
[0m15:30:15.110707 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:30:15.131936 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:30:15.416102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:30:15.417105 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m15:30:15.818214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27b2403f-5201-4642-955d-c02f7272872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A899069090>]}
[0m15:30:15.945597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27b2403f-5201-4642-955d-c02f7272872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8989910C0>]}
[0m15:30:15.946597 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:30:15.947101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b2403f-5201-4642-955d-c02f7272872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A898D09E10>]}
[0m15:30:15.948105 [info ] [MainThread]: 
[0m15:30:15.949108 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:30:15.953120 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:30:15.966826 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:30:15.966826 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:30:15.966826 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:16.669520 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.702 seconds
[0m15:30:16.671526 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:30:17.131846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27b2403f-5201-4642-955d-c02f7272872f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A898B510C0>]}
[0m15:30:17.131846 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:30:17.132876 [info ] [MainThread]: 
[0m15:30:17.135920 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:30:17.135920 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:30:17.136926 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:30:17.136926 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:30:17.150264 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:30:17.151267 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:30:17.169851 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:30:17.170869 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:30:17.170869 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:30:17.171876 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:30:17.751499 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba89d8-3201-740a-000b-f6920003315e
[0m15:30:17.752503 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
[0m15:30:17.753506 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:30:17.876984 [debug] [Thread-1 (]: Database Error in test not_null_markets_column_1 (models\example\markets.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\markets.yml\not_null_markets_column_1.sql
[0m15:30:17.877993 [error] [Thread-1 (]: 1 of 1 ERROR not_null_markets_column_1 ......................................... [[31mERROR[0m in 0.74s]
[0m15:30:17.878996 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:30:17.881005 [info ] [MainThread]: 
[0m15:30:17.881005 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:30:17.919401 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:30:17.924428 [debug] [MainThread]: Using snowflake connection "master"
[0m15:30:17.925436 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:30:17.925436 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:18.981323 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.056 seconds
[0m15:30:18.986345 [info ] [MainThread]: Test name: not_null
[0m15:30:18.987356 [info ] [MainThread]: Test type: generic
[0m15:30:18.987356 [info ] [MainThread]: Column name: column_1
[0m15:30:18.996441 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:30:19.000476 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:30:19.003497 [debug] [MainThread]: Using snowflake connection "master"
[0m15:30:19.004500 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7410671710968018'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:30:19.618559 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.613 seconds
[0m15:30:19.618559 [debug] [MainThread]: Using snowflake connection "master"
[0m15:30:19.619570 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:30:20.041245 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.421 seconds
[0m15:30:20.042248 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 1.04s]
[0m15:30:20.042248 [info ] [MainThread]: 
[0m15:30:20.043253 [debug] [MainThread]: On master: Close
[0m15:30:20.162116 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:20.163119 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:30:20.163119 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:30:20.164125 [info ] [MainThread]: 
[0m15:30:20.164125 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 4.22 seconds (4.22s).
[0m15:30:20.165224 [debug] [MainThread]: Command end result
[0m15:30:20.270446 [info ] [MainThread]: 
[0m15:30:20.271451 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:30:20.271451 [info ] [MainThread]: 
[0m15:30:20.272762 [error] [MainThread]:   Database Error in test not_null_markets_column_1 (models\example\markets.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\markets.yml\not_null_markets_column_1.sql
[0m15:30:20.272762 [info ] [MainThread]: 
[0m15:30:20.273920 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:30:20.274923 [debug] [MainThread]: Command `dbt test` failed at 15:30:20.274923 after 6.03 seconds
[0m15:30:20.275924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8FD302920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A8993779A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A899377F70>]}
[0m15:30:20.275924 [debug] [MainThread]: Flushing usage events
[0m15:34:24.228551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020439232980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043BDEA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043BDEA2F0>]}


============================== 15:34:24.231563 | dd92c792-09cb-482d-8d3a-1a8b19e13203 ==============================
[0m15:34:24.231563 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:34:24.232652 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:markets', 'send_anonymous_usage_stats': 'True'}
[0m15:34:24.989917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dd92c792-09cb-482d-8d3a-1a8b19e13203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204546FA020>]}
[0m15:34:25.033131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dd92c792-09cb-482d-8d3a-1a8b19e13203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020439AEB730>]}
[0m15:34:25.034134 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:34:25.055476 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:34:25.293241 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:34:25.294319 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m15:34:25.468410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dd92c792-09cb-482d-8d3a-1a8b19e13203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020454C441C0>]}
[0m15:34:25.589784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dd92c792-09cb-482d-8d3a-1a8b19e13203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020454C454E0>]}
[0m15:34:25.590786 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:34:25.590786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd92c792-09cb-482d-8d3a-1a8b19e13203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020454A92980>]}
[0m15:34:25.592803 [info ] [MainThread]: 
[0m15:34:25.592803 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:34:25.597853 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:34:25.611911 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:34:25.612913 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:34:25.612913 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:34:26.458250 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.846 seconds
[0m15:34:26.460390 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:34:26.592171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dd92c792-09cb-482d-8d3a-1a8b19e13203', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020454C46A40>]}
[0m15:34:26.593188 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:34:26.594193 [info ] [MainThread]: 
[0m15:34:26.597499 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:34:26.597499 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:34:26.598505 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:34:26.598505 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:34:26.612897 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:34:26.613901 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:34:26.630019 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:34:26.631024 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:34:26.632064 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:34:26.633077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:34:27.195974 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba89dc-3201-740c-000b-f69200032152
[0m15:34:27.197024 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
[0m15:34:27.197024 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:34:27.317656 [debug] [Thread-1 (]: Database Error in test not_null_markets_column_1 (models\example\markets.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\markets.yml\not_null_markets_column_1.sql
[0m15:34:27.318660 [error] [Thread-1 (]: 1 of 1 ERROR not_null_markets_column_1 ......................................... [[31mERROR[0m in 0.72s]
[0m15:34:27.319663 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:34:27.321030 [info ] [MainThread]: 
[0m15:34:27.322121 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:34:27.365337 [info ] [MainThread]: Starting test results processing...
[0m15:34:27.366346 [info ] [MainThread]: Number of total results: 1
[0m15:34:27.371438 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:34:27.377585 [debug] [MainThread]: Using snowflake connection "master"
[0m15:34:27.378590 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:34:27.378590 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:34:28.991230 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.612 seconds
[0m15:34:28.995319 [info ] [MainThread]: Test name: not_null
[0m15:34:28.996334 [info ] [MainThread]: Test type: generic
[0m15:34:28.996334 [info ] [MainThread]: Column name: column_1
[0m15:34:28.997349 [info ] [MainThread]: Processing test: not_null_markets_column_1
[0m15:34:28.998356 [info ] [MainThread]: Status: error
[0m15:34:28.998356 [info ] [MainThread]: Execution time: 0.7201552391052246 seconds
[0m15:34:28.999363 [info ] [MainThread]: Severity: ERROR
[0m15:34:29.007511 [info ] [MainThread]: Summary of test execution:
[0m15:34:29.008519 [info ] [MainThread]: Passed tests: 0
[0m15:34:29.009525 [info ] [MainThread]: Failed tests: 0
[0m15:34:29.009525 [info ] [MainThread]: Error tests: 1
[0m15:34:29.010530 [info ] [MainThread]: Total tests: 1
[0m15:34:29.011770 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:34:29.015807 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:34:29.018821 [debug] [MainThread]: Using snowflake connection "master"
[0m15:34:29.019826 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7201552391052246'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:34:29.463714 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.443 seconds
[0m15:34:29.463714 [debug] [MainThread]: Using snowflake connection "master"
[0m15:34:29.464724 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:34:29.791538 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.327 seconds
[0m15:34:29.793551 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.78s]
[0m15:34:29.794729 [info ] [MainThread]: 
[0m15:34:29.794729 [debug] [MainThread]: On master: Close
[0m15:34:29.921671 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:34:29.922684 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:34:29.922684 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:34:29.922684 [info ] [MainThread]: 
[0m15:34:29.923688 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 4.33 seconds (4.33s).
[0m15:34:29.924692 [debug] [MainThread]: Command end result
[0m15:34:29.961461 [info ] [MainThread]: 
[0m15:34:29.962462 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:34:29.963548 [info ] [MainThread]: 
[0m15:34:29.964552 [error] [MainThread]:   Database Error in test not_null_markets_column_1 (models\example\markets.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\markets.yml\not_null_markets_column_1.sql
[0m15:34:29.964552 [info ] [MainThread]: 
[0m15:34:29.965555 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:34:29.966558 [debug] [MainThread]: Command `dbt test` failed at 15:34:29.966558 after 5.79 seconds
[0m15:34:29.967582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020439232980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204394B7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002043B20ED40>]}
[0m15:34:29.967582 [debug] [MainThread]: Flushing usage events
[0m15:36:36.413637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCA9662920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCAC21A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCAC21A320>]}


============================== 15:36:36.416647 | 9221effb-502d-4db4-b699-34441586b81e ==============================
[0m15:36:36.416647 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:36:36.416647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:markets', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:36:37.131953 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9221effb-502d-4db4-b699-34441586b81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCA98EBEB0>]}
[0m15:36:37.176455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9221effb-502d-4db4-b699-34441586b81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCA91234F0>]}
[0m15:36:37.177460 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:36:37.198217 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:36:37.439105 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:36:37.440108 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m15:36:37.625332 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9221effb-502d-4db4-b699-34441586b81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCC5054160>]}
[0m15:36:37.754742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9221effb-502d-4db4-b699-34441586b81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCC4CAE860>]}
[0m15:36:37.755744 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:36:37.755744 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9221effb-502d-4db4-b699-34441586b81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCC5028E80>]}
[0m15:36:37.756809 [info ] [MainThread]: 
[0m15:36:37.757812 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:36:37.763836 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:36:37.777038 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:36:37.778041 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:36:37.778041 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:36:38.432186 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.654 seconds
[0m15:36:38.434192 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:36:38.553564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9221effb-502d-4db4-b699-34441586b81e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCC4B02E90>]}
[0m15:36:38.553564 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:36:38.554569 [info ] [MainThread]: 
[0m15:36:38.557716 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:36:38.557716 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:36:38.558721 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:36:38.558721 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:36:38.573104 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:36:38.573104 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:36:38.589781 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:36:38.591791 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:36:38.591791 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:36:38.592790 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:36:39.096651 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba89de-3201-740a-000b-f69200033196
[0m15:36:39.097739 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
[0m15:36:39.097739 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:36:39.219245 [debug] [Thread-1 (]: Database Error in test not_null_markets_column_1 (models\example\markets.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\markets.yml\not_null_markets_column_1.sql
[0m15:36:39.220309 [error] [Thread-1 (]: 1 of 1 ERROR not_null_markets_column_1 ......................................... [[31mERROR[0m in 0.66s]
[0m15:36:39.221314 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:36:39.222330 [info ] [MainThread]: 
[0m15:36:39.223333 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:36:39.270475 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:36:39.276825 [debug] [MainThread]: Using snowflake connection "master"
[0m15:36:39.276825 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:36:39.277832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:36:40.271118 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.993 seconds
[0m15:36:40.276149 [info ] [MainThread]: Test name: not_null
[0m15:36:40.276149 [info ] [MainThread]: Test type: generic
[0m15:36:40.277152 [info ] [MainThread]: Column name: column_1
[0m15:36:40.278157 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m15:36:40.278157 [info ] [MainThread]: Test Full Node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_markets_column_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_markets_column_1.sql', original_file_path='models\\example\\markets.yml', unique_id='test.dbt_dataops.not_null_markets_column_1.e080da476c', fqn=['dbt_dataops', 'example', 'not_null_markets_column_1'], alias='not_null_markets_column_1', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', unrendered_config={}, created_at=1740132015.7469616, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect column_1\nfrom dev_dwdb.marketing.markets\nwhere column_1 is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='column_1', file_key_name='models.markets', attached_node='model.dbt_dataops.markets', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None))
[0m15:36:40.279161 [info ] [MainThread]: Test Name: not_null_markets_column_1
[0m15:36:40.280165 [info ] [MainThread]: Resource Type: test
[0m15:36:40.281171 [info ] [MainThread]: Test Status: error
[0m15:36:40.281171 [info ] [MainThread]: Execution Time: 0.6605231761932373
[0m15:36:40.282179 [info ] [MainThread]: Test Metadata: TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None)
[0m15:36:40.283184 [info ] [MainThread]: Column Name: column_1
[0m15:36:40.283184 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m15:36:40.284189 [info ] [MainThread]: Original File Path: models\example\markets.yml
[0m15:36:40.284189 [info ] [MainThread]: Compiled SQL: 
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



[0m15:36:40.285194 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m15:36:40.286259 [info ] [MainThread]: Sources: []
[0m15:36:40.286259 [info ] [MainThread]: ========================================================
[0m15:36:40.295325 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:36:40.299396 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:36:40.303602 [debug] [MainThread]: Using snowflake connection "master"
[0m15:36:40.303602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6605231761932373'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:36:40.801477 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.497 seconds
[0m15:36:40.802789 [debug] [MainThread]: Using snowflake connection "master"
[0m15:36:40.802789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:36:41.100370 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.297 seconds
[0m15:36:41.102376 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.80s]
[0m15:36:41.102376 [info ] [MainThread]: 
[0m15:36:41.103471 [debug] [MainThread]: On master: Close
[0m15:36:41.220329 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:36:41.221332 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:36:41.221332 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:36:41.222336 [info ] [MainThread]: 
[0m15:36:41.222336 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m15:36:41.223341 [debug] [MainThread]: Command end result
[0m15:36:41.259954 [info ] [MainThread]: 
[0m15:36:41.261027 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:36:41.262031 [info ] [MainThread]: 
[0m15:36:41.262031 [error] [MainThread]:   Database Error in test not_null_markets_column_1 (models\example\markets.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\markets.yml\not_null_markets_column_1.sql
[0m15:36:41.263124 [info ] [MainThread]: 
[0m15:36:41.264129 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:36:41.265480 [debug] [MainThread]: Command `dbt test` failed at 15:36:41.265480 after 4.93 seconds
[0m15:36:41.265480 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCA9662920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCC4C8ADD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FCAB642CE0>]}
[0m15:36:41.266482 [debug] [MainThread]: Flushing usage events
[0m15:39:54.061797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF9292950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDFBE4A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDFBE4A320>]}


============================== 15:39:54.065818 | 91a8eb2c-8a24-47b6-8512-f47de010318e ==============================
[0m15:39:54.065818 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:39:54.065818 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:markets', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:39:54.818724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '91a8eb2c-8a24-47b6-8512-f47de010318e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF951BA90>]}
[0m15:39:54.863140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '91a8eb2c-8a24-47b6-8512-f47de010318e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF8D63520>]}
[0m15:39:54.864143 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:39:54.884803 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:39:55.139289 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:39:55.140292 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m15:39:55.500044 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '91a8eb2c-8a24-47b6-8512-f47de010318e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED950910C0>]}
[0m15:39:55.620072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '91a8eb2c-8a24-47b6-8512-f47de010318e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED950926E0>]}
[0m15:39:55.620072 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:39:55.621080 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a8eb2c-8a24-47b6-8512-f47de010318e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED94B82DA0>]}
[0m15:39:55.622083 [info ] [MainThread]: 
[0m15:39:55.623086 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:39:55.628262 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:39:55.640319 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:39:55.640319 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:39:55.641324 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:39:56.389729 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.749 seconds
[0m15:39:56.391738 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:39:56.528619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '91a8eb2c-8a24-47b6-8512-f47de010318e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED95091BD0>]}
[0m15:39:56.528619 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:39:56.529801 [info ] [MainThread]: 
[0m15:39:56.532823 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:39:56.532823 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:39:56.533826 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:39:56.533826 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:39:56.548014 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:39:56.549017 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:39:56.570431 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:39:56.571435 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:39:56.571435 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:39:56.572441 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:39:57.129243 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba89e1-3201-740a-000b-f692000331b6
[0m15:39:57.130246 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
[0m15:39:57.130246 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:39:57.260647 [debug] [Thread-1 (]: Database Error in test not_null_markets_column_1 (models\example\markets.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\markets.yml\not_null_markets_column_1.sql
[0m15:39:57.261646 [error] [Thread-1 (]: 1 of 1 ERROR not_null_markets_column_1 ......................................... [[31mERROR[0m in 0.73s]
[0m15:39:57.263059 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:39:57.264066 [info ] [MainThread]: 
[0m15:39:57.265069 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:39:57.313077 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:39:57.319126 [debug] [MainThread]: Using snowflake connection "master"
[0m15:39:57.319126 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:39:57.320131 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:39:58.359363 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.040 seconds
[0m15:39:58.364526 [info ] [MainThread]: Test name: not_null
[0m15:39:58.365531 [info ] [MainThread]: Test type: generic
[0m15:39:58.365531 [info ] [MainThread]: Column name: column_1
[0m15:39:58.366653 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m15:39:58.367658 [info ] [MainThread]: Test Full Node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_markets_column_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_markets_column_1.sql', original_file_path='models\\example\\markets.yml', unique_id='test.dbt_dataops.not_null_markets_column_1.e080da476c', fqn=['dbt_dataops', 'example', 'not_null_markets_column_1'], alias='not_null_markets_column_1', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['high_priority'], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', unrendered_config={}, created_at=1740132595.4328911, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect column_1\nfrom dev_dwdb.marketing.markets\nwhere column_1 is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='column_1', file_key_name='models.markets', attached_node='model.dbt_dataops.markets', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None))
[0m15:39:58.367658 [info ] [MainThread]: Test Name: not_null_markets_column_1
[0m15:39:58.368662 [info ] [MainThread]: Resource Type: test
[0m15:39:58.369728 [info ] [MainThread]: Test Status: error
[0m15:39:58.369728 [info ] [MainThread]: Execution Time: 0.7278199195861816
[0m15:39:58.370735 [info ] [MainThread]: Test Metadata: TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None)
[0m15:39:58.370735 [info ] [MainThread]: Column Name: column_1
[0m15:39:58.371740 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m15:39:58.371740 [info ] [MainThread]: Original File Path: models\example\markets.yml
[0m15:39:58.372744 [info ] [MainThread]: Compiled SQL: 
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



[0m15:39:58.373749 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m15:39:58.373749 [info ] [MainThread]: Sources: []
[0m15:39:58.374754 [info ] [MainThread]: ========================================================
[0m15:39:58.384125 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:39:58.389396 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:39:58.393470 [debug] [MainThread]: Using snowflake connection "master"
[0m15:39:58.394761 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7278199195861816'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:39:58.808847 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.413 seconds
[0m15:39:58.808847 [debug] [MainThread]: Using snowflake connection "master"
[0m15:39:58.809853 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:39:59.120153 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.310 seconds
[0m15:39:59.121153 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.73s]
[0m15:39:59.122154 [info ] [MainThread]: 
[0m15:39:59.123155 [debug] [MainThread]: On master: Close
[0m15:39:59.247218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:39:59.247218 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:39:59.248356 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:39:59.249361 [info ] [MainThread]: 
[0m15:39:59.249361 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.63 seconds (3.63s).
[0m15:39:59.250361 [debug] [MainThread]: Command end result
[0m15:39:59.368894 [info ] [MainThread]: 
[0m15:39:59.369997 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:39:59.369997 [info ] [MainThread]: 
[0m15:39:59.371002 [error] [MainThread]:   Database Error in test not_null_markets_column_1 (models\example\markets.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\markets.yml\not_null_markets_column_1.sql
[0m15:39:59.371002 [info ] [MainThread]: 
[0m15:39:59.372006 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:39:59.373009 [debug] [MainThread]: Command `dbt test` failed at 15:39:59.373009 after 5.37 seconds
[0m15:39:59.374012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002EDF9292950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED953ABC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ED953AB460>]}
[0m15:39:59.374012 [debug] [MainThread]: Flushing usage events
[0m15:43:03.764997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252607429B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252632FA530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252632FA350>]}


============================== 15:43:03.768236 | ad7b5740-0712-4b91-bace-b3201f06a00b ==============================
[0m15:43:03.768236 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:43:03.769239 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:markets', 'send_anonymous_usage_stats': 'True'}
[0m15:43:04.526207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ad7b5740-0712-4b91-bace-b3201f06a00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252609C7970>]}
[0m15:43:04.570793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ad7b5740-0712-4b91-bace-b3201f06a00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002526277B820>]}
[0m15:43:04.572810 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:43:04.595967 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:43:04.843905 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:43:04.844908 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m15:43:05.210102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ad7b5740-0712-4b91-bace-b3201f06a00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527C465120>]}
[0m15:43:05.339482 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ad7b5740-0712-4b91-bace-b3201f06a00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527C0F8D60>]}
[0m15:43:05.339482 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:43:05.341683 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7b5740-0712-4b91-bace-b3201f06a00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527C406BF0>]}
[0m15:43:05.342688 [info ] [MainThread]: 
[0m15:43:05.342688 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:43:05.347967 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:43:05.359720 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:43:05.360727 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:43:05.360727 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:06.036429 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.676 seconds
[0m15:43:06.038431 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:43:06.170194 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ad7b5740-0712-4b91-bace-b3201f06a00b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527C482B60>]}
[0m15:43:06.171234 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:43:06.172238 [info ] [MainThread]: 
[0m15:43:06.175353 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:43:06.175353 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:43:06.176368 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:43:06.177396 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:43:06.194012 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:43:06.196185 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:43:06.217135 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:43:06.218135 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:43:06.218135 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:43:06.219137 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:43:06.738460 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba89e5-3201-740c-000b-f6920003217a
[0m15:43:06.739463 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
[0m15:43:06.739463 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:43:06.858427 [debug] [Thread-1 (]: Database Error in test not_null_markets_column_1 (models\example\markets.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\markets.yml\not_null_markets_column_1.sql
[0m15:43:06.859432 [error] [Thread-1 (]: 1 of 1 ERROR not_null_markets_column_1 ......................................... [[31mERROR[0m in 0.68s]
[0m15:43:06.860437 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:43:06.861440 [info ] [MainThread]: 
[0m15:43:06.862719 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:43:06.911761 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:43:06.919374 [debug] [MainThread]: Using snowflake connection "master"
[0m15:43:06.920708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:43:06.920708 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:07.895991 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.974 seconds
[0m15:43:07.901270 [info ] [MainThread]: Test name: not_null
[0m15:43:07.901270 [info ] [MainThread]: Test type: generic
[0m15:43:07.902274 [info ] [MainThread]: Column name: column_1
[0m15:43:07.903280 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m15:43:07.903280 [info ] [MainThread]: Test Full Node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_markets_column_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_markets_column_1.sql', original_file_path='models\\example\\markets.yml', unique_id='test.dbt_dataops.not_null_markets_column_1.e080da476c', fqn=['dbt_dataops', 'example', 'not_null_markets_column_1'], alias='not_null_markets_column_1', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', unrendered_config={}, created_at=1740132785.140845, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect column_1\nfrom dev_dwdb.marketing.markets\nwhere column_1 is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='column_1', file_key_name='models.markets', attached_node='model.dbt_dataops.markets', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None))
[0m15:43:07.904285 [info ] [MainThread]: Test Name: not_null_markets_column_1
[0m15:43:07.905295 [info ] [MainThread]: Resource Type: test
[0m15:43:07.905295 [info ] [MainThread]: Test Status: error
[0m15:43:07.906299 [info ] [MainThread]: Execution Time: 0.6830637454986572
[0m15:43:07.906299 [info ] [MainThread]: Test Metadata: TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None)
[0m15:43:07.907325 [info ] [MainThread]: Column Name: column_1
[0m15:43:07.908330 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m15:43:07.908330 [info ] [MainThread]: Original File Path: models\example\markets.yml
[0m15:43:07.909332 [info ] [MainThread]: Compiled SQL: 
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



[0m15:43:07.909332 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m15:43:07.910337 [info ] [MainThread]: Sources: []
[0m15:43:07.910337 [info ] [MainThread]: ========================================================
[0m15:43:07.919536 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:43:07.923552 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:43:07.927602 [debug] [MainThread]: Using snowflake connection "master"
[0m15:43:07.927602 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6830637454986572'::text as execution_time_seconds,
            'error'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:43:08.394484 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.466 seconds
[0m15:43:08.395485 [debug] [MainThread]: Using snowflake connection "master"
[0m15:43:08.395485 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:43:08.740777 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.345 seconds
[0m15:43:08.742779 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.82s]
[0m15:43:08.743780 [info ] [MainThread]: 
[0m15:43:08.743780 [debug] [MainThread]: On master: Close
[0m15:43:08.862721 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:08.862721 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:43:08.862721 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:43:08.863857 [info ] [MainThread]: 
[0m15:43:08.864907 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.52 seconds (3.52s).
[0m15:43:08.865916 [debug] [MainThread]: Command end result
[0m15:43:08.973225 [info ] [MainThread]: 
[0m15:43:08.973225 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:43:08.974226 [info ] [MainThread]: 
[0m15:43:08.975226 [error] [MainThread]:   Database Error in test not_null_markets_column_1 (models\example\markets.yml)
  002003 (42S02): SQL compilation error:
  Object 'DEV_DWDB.MARKETING.MARKETS' does not exist or not authorized.
  compiled code at target\run\dbt_dataops\models\example\markets.yml\not_null_markets_column_1.sql
[0m15:43:08.976228 [info ] [MainThread]: 
[0m15:43:08.976228 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m15:43:08.978229 [debug] [MainThread]: Command `dbt test` failed at 15:43:08.978229 after 5.27 seconds
[0m15:43:08.978229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000252607429B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527C407BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002527C777D90>]}
[0m15:43:08.979230 [debug] [MainThread]: Flushing usage events
[0m15:49:12.467172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3A3C29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3CF7A650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3CF7A470>]}


============================== 15:49:12.470269 | 393c88fc-cda4-4e45-bc18-42d64fb06236 ==============================
[0m15:49:12.470269 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:49:12.470269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:markets', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:49:13.275414 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '393c88fc-cda4-4e45-bc18-42d64fb06236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3CF36C20>]}
[0m15:49:13.321483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '393c88fc-cda4-4e45-bc18-42d64fb06236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B39E93580>]}
[0m15:49:13.322489 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:49:13.343757 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:49:13.611031 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:49:13.612037 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m15:49:13.789778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '393c88fc-cda4-4e45-bc18-42d64fb06236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B55DB4370>]}
[0m15:49:13.918706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '393c88fc-cda4-4e45-bc18-42d64fb06236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B55DB5AB0>]}
[0m15:49:13.919711 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:49:13.921719 [info ] [MainThread]: 
[0m15:49:13.921719 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:49:13.923886 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m15:49:13.935261 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m15:49:13.936267 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m15:49:13.936267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:14.638891 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 0.702 seconds
[0m15:49:14.640429 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m15:49:14.792313 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:49:14.801061 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:49:14.801061 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:49:14.802154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:49:15.395866 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.594 seconds
[0m15:49:15.397868 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:49:15.521331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '393c88fc-cda4-4e45-bc18-42d64fb06236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B55DB6020>]}
[0m15:49:15.523419 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:49:15.523419 [info ] [MainThread]: 
[0m15:49:15.528722 [debug] [Thread-1 (]: Began running node model.dbt_dataops.markets
[0m15:49:15.529725 [info ] [Thread-1 (]: 1 of 2 START sql table model marketing.markets ................................. [RUN]
[0m15:49:15.530962 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.markets'
[0m15:49:15.531589 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.markets
[0m15:49:15.543168 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.markets"
[0m15:49:15.545169 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.markets
[0m15:49:15.589668 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.markets"
[0m15:49:15.591670 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.markets"
[0m15:49:15.593672 [debug] [Thread-1 (]: On model.dbt_dataops.markets: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.markets"} */
create or replace transient table dev_dwdb.marketing.markets
         as
        (-- create some structure tablle for markets in dbt select statement.



with source_data as (
    select 1 as id
    union all
    select null as id
)
select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data
        );
[0m15:49:15.593672 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:49:16.520331 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.926 seconds
[0m15:49:16.546910 [debug] [Thread-1 (]: On model.dbt_dataops.markets: Close
[0m15:49:16.678835 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '393c88fc-cda4-4e45-bc18-42d64fb06236', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B5585FC10>]}
[0m15:49:16.679842 [info ] [Thread-1 (]: 1 of 2 OK created sql table model marketing.markets ............................ [[32mSUCCESS 1[0m in 1.15s]
[0m15:49:16.680847 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.markets
[0m15:49:16.680847 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:49:16.681853 [info ] [Thread-3 (]: 2 of 2 START test not_null_markets_column_1 .................................... [RUN]
[0m15:49:16.682856 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:49:16.682856 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:49:16.695652 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:49:16.696659 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:49:16.714339 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:49:16.715394 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:49:16.716620 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:49:16.716620 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:49:17.298023 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.581 seconds
[0m15:49:17.301045 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:49:17.438554 [info ] [Thread-3 (]: 2 of 2 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.76s]
[0m15:49:17.440555 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:49:17.441556 [info ] [MainThread]: 
[0m15:49:17.441556 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:49:17.495691 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:49:17.502445 [debug] [MainThread]: Using snowflake connection "master"
[0m15:49:17.503448 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:49:17.503448 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:49:18.595179 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.092 seconds
[0m15:49:18.603338 [info ] [MainThread]: Test name: not_null
[0m15:49:18.603338 [info ] [MainThread]: Test type: generic
[0m15:49:18.604841 [info ] [MainThread]: Column name: column_1
[0m15:49:18.604841 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m15:49:18.605878 [info ] [MainThread]: Test Full Node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_markets_column_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_markets_column_1.sql', original_file_path='models\\example\\markets.yml', unique_id='test.dbt_dataops.not_null_markets_column_1.e080da476c', fqn=['dbt_dataops', 'example', 'not_null_markets_column_1'], alias='not_null_markets_column_1', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', unrendered_config={}, created_at=1740132785.140845, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect column_1\nfrom dev_dwdb.marketing.markets\nwhere column_1 is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='column_1', file_key_name='models.markets', attached_node='model.dbt_dataops.markets', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None))
[0m15:49:18.607008 [info ] [MainThread]: Test Name: not_null_markets_column_1
[0m15:49:18.607008 [info ] [MainThread]: Resource Type: test
[0m15:49:18.608188 [info ] [MainThread]: Test Status: pass
[0m15:49:18.608188 [info ] [MainThread]: Execution Time: 0.7556979656219482
[0m15:49:18.609230 [info ] [MainThread]: Test Metadata: TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None)
[0m15:49:18.609230 [info ] [MainThread]: Column Name: column_1
[0m15:49:18.610477 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m15:49:18.610477 [info ] [MainThread]: Original File Path: models\example\markets.yml
[0m15:49:18.611591 [info ] [MainThread]: Compiled SQL: 
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



[0m15:49:18.612616 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m15:49:18.612616 [info ] [MainThread]: Sources: []
[0m15:49:18.613625 [info ] [MainThread]: ========================================================
[0m15:49:18.614660 [info ] [MainThread]: Meta Information: {}
[0m15:49:18.614660 [info ] [MainThread]: No column meta
[0m15:49:18.624677 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:49:18.627967 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:49:18.632047 [debug] [MainThread]: Using snowflake connection "master"
[0m15:49:18.632047 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7556979656219482'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:49:18.727209 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba89eb-3201-740c-000b-f692000321ba
[0m15:49:18.727209 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 63 at position 24
invalid identifier 'SOURCE.TEST_NAME'
[0m15:49:18.728210 [info ] [MainThread]: Database error while running on-run-end
[0m15:49:18.728210 [debug] [MainThread]: On master: Close
[0m15:49:18.845338 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:18.846358 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m15:49:18.846358 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:49:18.847382 [debug] [MainThread]: Connection 'model.dbt_dataops.markets' was properly closed.
[0m15:49:18.847382 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:49:18.848386 [info ] [MainThread]: 
[0m15:49:18.848386 [info ] [MainThread]: Finished running 1 table model, 1 test in 0 hours 0 minutes and 4.93 seconds (4.93s).
[0m15:49:18.850396 [debug] [MainThread]: Command end result
[0m15:49:18.890202 [info ] [MainThread]: 
[0m15:49:18.891208 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:49:18.891208 [info ] [MainThread]: 
[0m15:49:18.892216 [error] [MainThread]:   on-run-end failed, error:
 000904 (42000): SQL compilation error: error line 63 at position 24
invalid identifier 'SOURCE.TEST_NAME'
[0m15:49:18.893227 [info ] [MainThread]: 
[0m15:49:18.893227 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m15:49:18.895269 [debug] [MainThread]: Command `dbt build` failed at 15:49:18.895269 after 6.49 seconds
[0m15:49:18.895269 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3A3C29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B3C3A6260>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000024B5613EE00>]}
[0m15:49:18.896298 [debug] [MainThread]: Flushing usage events
[0m15:50:11.435040 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3918CE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39448E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39448E2F0>]}


============================== 15:50:11.438049 | 9625f213-ac12-45e9-ba2d-827e959c25b9 ==============================
[0m15:50:11.438049 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:50:11.439052 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:markets', 'send_anonymous_usage_stats': 'True'}
[0m15:50:12.163564 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9625f213-ac12-45e9-ba2d-827e959c25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3ACD9A020>]}
[0m15:50:12.208618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9625f213-ac12-45e9-ba2d-827e959c25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F39218B730>]}
[0m15:50:12.209621 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:50:12.231838 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:50:12.484040 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:50:12.484040 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m15:50:12.657880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9625f213-ac12-45e9-ba2d-827e959c25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AD2CC1C0>]}
[0m15:50:12.779108 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9625f213-ac12-45e9-ba2d-827e959c25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AD2CF820>]}
[0m15:50:12.780113 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:50:12.780113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9625f213-ac12-45e9-ba2d-827e959c25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AD136980>]}
[0m15:50:12.782625 [info ] [MainThread]: 
[0m15:50:12.782625 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:50:12.787644 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:50:12.800876 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:50:12.801880 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:50:12.801880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:13.447170 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.645 seconds
[0m15:50:13.449194 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:50:13.578076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9625f213-ac12-45e9-ba2d-827e959c25b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3AD2CE0B0>]}
[0m15:50:13.578076 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:13.579083 [info ] [MainThread]: 
[0m15:50:13.582596 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:50:13.582596 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:50:13.583602 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:50:13.584645 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:50:13.598900 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:50:13.600246 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:50:13.622357 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:50:13.623364 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:50:13.623364 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:50:13.624370 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:14.216256 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m15:50:14.222512 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:50:14.347726 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.76s]
[0m15:50:14.349070 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:50:14.350074 [info ] [MainThread]: 
[0m15:50:14.351079 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:50:14.406825 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:50:14.413155 [debug] [MainThread]: Using snowflake connection "master"
[0m15:50:14.414160 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:50:14.414160 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:15.449103 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.034 seconds
[0m15:50:15.453128 [info ] [MainThread]: Test name: not_null
[0m15:50:15.454133 [info ] [MainThread]: Test type: generic
[0m15:50:15.455138 [info ] [MainThread]: Column name: column_1
[0m15:50:15.455138 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m15:50:15.456220 [info ] [MainThread]: Test Full Node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_markets_column_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_markets_column_1.sql', original_file_path='models\\example\\markets.yml', unique_id='test.dbt_dataops.not_null_markets_column_1.e080da476c', fqn=['dbt_dataops', 'example', 'not_null_markets_column_1'], alias='not_null_markets_column_1', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', unrendered_config={}, created_at=1740132785.140845, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect column_1\nfrom dev_dwdb.marketing.markets\nwhere column_1 is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='column_1', file_key_name='models.markets', attached_node='model.dbt_dataops.markets', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None))
[0m15:50:15.457223 [info ] [MainThread]: Test Name: not_null_markets_column_1
[0m15:50:15.458308 [info ] [MainThread]: Resource Type: test
[0m15:50:15.458308 [info ] [MainThread]: Test Status: pass
[0m15:50:15.459311 [info ] [MainThread]: Execution Time: 0.7641246318817139
[0m15:50:15.459311 [info ] [MainThread]: Test Metadata: TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None)
[0m15:50:15.460329 [info ] [MainThread]: Column Name: column_1
[0m15:50:15.461334 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m15:50:15.461334 [info ] [MainThread]: Original File Path: models\example\markets.yml
[0m15:50:15.462346 [info ] [MainThread]: Compiled SQL: 
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



[0m15:50:15.462346 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m15:50:15.463352 [info ] [MainThread]: Sources: []
[0m15:50:15.464357 [info ] [MainThread]: ========================================================
[0m15:50:15.464357 [info ] [MainThread]: Meta Information: {}
[0m15:50:15.465363 [info ] [MainThread]: No column meta
[0m15:50:15.474590 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:50:15.479634 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:50:15.483650 [debug] [MainThread]: Using snowflake connection "master"
[0m15:50:15.483650 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7641246318817139'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            '{}'::varchar(1000) as test_meta,
            ''::varchar(1000) as column_meta,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, test_meta, column_meta, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.test_meta, source.column_meta, source.TIMESTAMP,
        'Y', null
      );
[0m15:50:15.564768 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba89ec-3201-740c-000b-f692000321ea
[0m15:50:15.564768 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 65 at position 41
invalid identifier 'TEST_META'
[0m15:50:15.565774 [info ] [MainThread]: Database error while running on-run-end
[0m15:50:15.566783 [debug] [MainThread]: On master: Close
[0m15:50:15.686586 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:15.687595 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:50:15.687595 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:50:15.688600 [info ] [MainThread]: 
[0m15:50:15.689605 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.91 seconds (2.91s).
[0m15:50:15.690609 [debug] [MainThread]: Command end result
[0m15:50:15.727135 [info ] [MainThread]: 
[0m15:50:15.728139 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:15.729144 [info ] [MainThread]: 
[0m15:50:15.730148 [error] [MainThread]:   on-run-end failed, error:
 000904 (42000): SQL compilation error: error line 65 at position 41
invalid identifier 'TEST_META'
[0m15:50:15.730148 [info ] [MainThread]: 
[0m15:50:15.731155 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:50:15.732256 [debug] [MainThread]: Command `dbt test` failed at 15:50:15.732256 after 4.36 seconds
[0m15:50:15.733275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3918CE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F391B57940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F3938AED40>]}
[0m15:50:15.733275 [debug] [MainThread]: Flushing usage events
[0m15:50:49.653818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4124AE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4150A6560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4150A6380>]}


============================== 15:50:49.656830 | 9b066dcb-fe5e-4a47-9c16-dc4923480ac5 ==============================
[0m15:50:49.656830 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:50:49.657948 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:markets', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:50:50.431584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9b066dcb-fe5e-4a47-9c16-dc4923480ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C412737940>]}
[0m15:50:50.475277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9b066dcb-fe5e-4a47-9c16-dc4923480ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4144B1720>]}
[0m15:50:50.476280 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:50:50.497480 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:50:50.736097 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:50:50.737100 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:50:50.783624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9b066dcb-fe5e-4a47-9c16-dc4923480ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42DEC1750>]}
[0m15:50:50.956050 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9b066dcb-fe5e-4a47-9c16-dc4923480ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42DAFC400>]}
[0m15:50:50.957053 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:50:50.958057 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b066dcb-fe5e-4a47-9c16-dc4923480ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42DD13130>]}
[0m15:50:50.959060 [info ] [MainThread]: 
[0m15:50:50.960063 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:50:50.965197 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:50:50.980306 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:50:50.980306 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:50:50.981307 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:50:51.718308 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.738 seconds
[0m15:50:51.720310 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:50:51.852536 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9b066dcb-fe5e-4a47-9c16-dc4923480ac5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42DEC3040>]}
[0m15:50:51.852536 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:50:51.853727 [info ] [MainThread]: 
[0m15:50:51.856921 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:50:51.856921 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:50:51.857942 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:50:51.858947 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:50:51.873161 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:50:51.874165 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:50:51.889703 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:50:51.890707 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:50:51.890707 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:50:51.891712 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:50:52.462181 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.570 seconds
[0m15:50:52.468218 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:50:52.588398 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.73s]
[0m15:50:52.589401 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:50:52.590405 [info ] [MainThread]: 
[0m15:50:52.591416 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:50:52.649863 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:50:52.656094 [debug] [MainThread]: Using snowflake connection "master"
[0m15:50:52.657095 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:50:52.658096 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:50:53.658853 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.000 seconds
[0m15:50:53.662866 [info ] [MainThread]: Test name: not_null
[0m15:50:53.663869 [info ] [MainThread]: Test type: generic
[0m15:50:53.664873 [info ] [MainThread]: Column name: column_1
[0m15:50:53.664873 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m15:50:53.665879 [info ] [MainThread]: Test Full Node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_markets_column_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_markets_column_1.sql', original_file_path='models\\example\\markets.yml', unique_id='test.dbt_dataops.not_null_markets_column_1.e080da476c', fqn=['dbt_dataops', 'example', 'not_null_markets_column_1'], alias='not_null_markets_column_1', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', unrendered_config={}, created_at=1740132785.140845, config_call_dict={}, relation_name=None, raw_code='{{ test_not_null(**_dbt_generic_test_kwargs) }}', language='sql', refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect column_1\nfrom dev_dwdb.marketing.markets\nwhere column_1 is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='column_1', file_key_name='models.markets', attached_node='model.dbt_dataops.markets', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None))
[0m15:50:53.666899 [info ] [MainThread]: Test Name: not_null_markets_column_1
[0m15:50:53.667909 [info ] [MainThread]: Resource Type: test
[0m15:50:53.667909 [info ] [MainThread]: Test Status: pass
[0m15:50:53.668914 [info ] [MainThread]: Execution Time: 0.7304556369781494
[0m15:50:53.668914 [info ] [MainThread]: Test Metadata: TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None)
[0m15:50:53.669917 [info ] [MainThread]: Column Name: column_1
[0m15:50:53.670918 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m15:50:53.670918 [info ] [MainThread]: Original File Path: models\example\markets.yml
[0m15:50:53.671919 [info ] [MainThread]: Compiled SQL: 
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



[0m15:50:53.671919 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m15:50:53.673072 [info ] [MainThread]: Sources: []
[0m15:50:53.674076 [info ] [MainThread]: ========================================================
[0m15:50:53.674076 [info ] [MainThread]: Meta Information: {}
[0m15:50:53.675091 [info ] [MainThread]: No column meta
[0m15:50:53.684158 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:50:53.688284 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:50:53.692304 [debug] [MainThread]: Using snowflake connection "master"
[0m15:50:53.692304 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7304556369781494'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            '{}'::varchar(1000) as test_meta,
            ''::varchar(1000) as column_meta,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, test_meta, column_meta, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.test_meta, source.column_meta, source.TIMESTAMP,
        'Y', null
      );
[0m15:50:53.790069 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba89ec-3201-740c-000b-f692000321f2
[0m15:50:53.791070 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 65 at position 41
invalid identifier 'TEST_META'
[0m15:50:53.792070 [info ] [MainThread]: Database error while running on-run-end
[0m15:50:53.792070 [debug] [MainThread]: On master: Close
[0m15:50:53.907530 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:50:53.907530 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:50:53.908531 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:50:53.908531 [info ] [MainThread]: 
[0m15:50:53.909831 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 2.95 seconds (2.95s).
[0m15:50:53.910909 [debug] [MainThread]: Command end result
[0m15:50:53.950211 [info ] [MainThread]: 
[0m15:50:53.951216 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m15:50:53.951216 [info ] [MainThread]: 
[0m15:50:53.952416 [error] [MainThread]:   on-run-end failed, error:
 000904 (42000): SQL compilation error: error line 65 at position 41
invalid identifier 'TEST_META'
[0m15:50:53.953582 [info ] [MainThread]: 
[0m15:50:53.953582 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m15:50:53.955802 [debug] [MainThread]: Command `dbt test` failed at 15:50:53.954587 after 4.36 seconds
[0m15:50:53.955802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4124AE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C4144B1720>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C42DAFC400>]}
[0m15:50:53.956945 [debug] [MainThread]: Flushing usage events
[0m15:51:05.344446 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2C0A82920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2C363E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2C363E320>]}


============================== 15:51:05.349450 | df561bae-574e-4d1d-8bf3-799cda72f169 ==============================
[0m15:51:05.349450 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:51:05.350461 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:markets', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:51:06.110628 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'df561bae-574e-4d1d-8bf3-799cda72f169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2C0D0BEB0>]}
[0m15:51:06.155204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'df561bae-574e-4d1d-8bf3-799cda72f169', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2C05534F0>]}
[0m15:51:06.156709 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:51:06.178028 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:51:06.408403 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:06.408403 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m15:51:06.417443 [error] [MainThread]: Encountered an error:
Compilation Error
  Got an unexpected control flow end tag, got endfor but expected endif next (@ 338:45)
[0m15:51:06.419599 [debug] [MainThread]: Command `dbt test` failed at 15:51:06.419599 after 1.14 seconds
[0m15:51:06.419599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2C0A82920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DC44B040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2DC44B010>]}
[0m15:51:06.420603 [debug] [MainThread]: Flushing usage events
[0m15:51:20.853159 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019659A329B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965C5EA530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965C5EA350>]}


============================== 15:51:20.855829 | f672a700-9d4b-482a-841e-930e880cf736 ==============================
[0m15:51:20.855829 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:51:20.857059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:markets', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m15:51:21.569417 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f672a700-9d4b-482a-841e-930e880cf736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019659CB7970>]}
[0m15:51:21.614951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f672a700-9d4b-482a-841e-930e880cf736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965BA6B820>]}
[0m15:51:21.616959 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:51:21.636815 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:51:21.871581 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:51:21.872585 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m15:51:22.027293 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f672a700-9d4b-482a-841e-930e880cf736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196754401F0>]}
[0m15:51:22.151052 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f672a700-9d4b-482a-841e-930e880cf736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196751C0370>]}
[0m15:51:22.152054 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:51:22.152054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f672a700-9d4b-482a-841e-930e880cf736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196753E6A40>]}
[0m15:51:22.153433 [info ] [MainThread]: 
[0m15:51:22.154439 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:51:22.159456 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:51:22.175656 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:51:22.175656 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:51:22.175656 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:51:22.829732 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.654 seconds
[0m15:51:22.831739 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:51:22.954250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f672a700-9d4b-482a-841e-930e880cf736', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000196751C0D30>]}
[0m15:51:22.955255 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:51:22.956259 [info ] [MainThread]: 
[0m15:51:22.958274 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:51:22.959279 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:51:22.960285 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:51:22.960285 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:51:22.974331 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:51:22.975332 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:51:22.993494 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:51:22.995873 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:51:22.995873 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:51:22.996879 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:51:23.554075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.559 seconds
[0m15:51:23.561606 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:51:23.689627 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.73s]
[0m15:51:23.690646 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:51:23.691664 [info ] [MainThread]: 
[0m15:51:23.692670 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:51:23.730100 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:51:23.735125 [debug] [MainThread]: Using snowflake connection "master"
[0m15:51:23.736129 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:51:23.736129 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:51:24.722414 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.986 seconds
[0m15:51:24.727435 [info ] [MainThread]: Test name: not_null
[0m15:51:24.727435 [info ] [MainThread]: Test type: generic
[0m15:51:24.728450 [info ] [MainThread]: Column name: column_1
[0m15:51:24.737586 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:51:24.740601 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:51:24.744629 [debug] [MainThread]: Using snowflake connection "master"
[0m15:51:24.744629 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7303485870361328'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:51:25.161993 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.416 seconds
[0m15:51:25.161993 [debug] [MainThread]: Using snowflake connection "master"
[0m15:51:25.162997 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:51:25.407884 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.244 seconds
[0m15:51:25.408898 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.67s]
[0m15:51:25.409988 [info ] [MainThread]: 
[0m15:51:25.409988 [debug] [MainThread]: On master: Close
[0m15:51:25.533448 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:51:25.533448 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:51:25.534559 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:51:25.534559 [info ] [MainThread]: 
[0m15:51:25.535569 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.38 seconds (3.38s).
[0m15:51:25.536573 [debug] [MainThread]: Command end result
[0m15:51:25.574192 [info ] [MainThread]: 
[0m15:51:25.575196 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:51:25.576199 [info ] [MainThread]: 
[0m15:51:25.576199 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:51:25.577213 [debug] [MainThread]: Command `dbt test` succeeded at 15:51:25.577213 after 4.78 seconds
[0m15:51:25.578217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019659A329B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001965BF21780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019674F57A60>]}
[0m15:51:25.578217 [debug] [MainThread]: Flushing usage events
[0m15:52:05.192903 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3768829E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C37943E560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C37943E380>]}


============================== 15:52:05.196489 | 9faa1338-8970-4129-81cf-81924b5694c2 ==============================
[0m15:52:05.196489 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:52:05.196489 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:markets', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:52:05.995585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9faa1338-8970-4129-81cf-81924b5694c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C376B07940>]}
[0m15:52:06.040611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9faa1338-8970-4129-81cf-81924b5694c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C378881720>]}
[0m15:52:06.041614 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:52:06.063819 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:52:06.306152 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:52:06.307155 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:52:06.354989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9faa1338-8970-4129-81cf-81924b5694c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C312351750>]}
[0m15:52:06.529981 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9faa1338-8970-4129-81cf-81924b5694c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C311F90CA0>]}
[0m15:52:06.530985 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:52:06.531989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9faa1338-8970-4129-81cf-81924b5694c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C31215F130>]}
[0m15:52:06.532993 [info ] [MainThread]: 
[0m15:52:06.532993 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:52:06.538122 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:52:06.554266 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:52:06.555327 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:52:06.555327 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:07.213859 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.659 seconds
[0m15:52:07.217029 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:52:07.359880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9faa1338-8970-4129-81cf-81924b5694c2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C312353040>]}
[0m15:52:07.359880 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:52:07.360885 [info ] [MainThread]: 
[0m15:52:07.363907 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:52:07.363907 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:52:07.364911 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:52:07.365916 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:52:07.381204 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:52:07.381204 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:52:07.400891 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:52:07.401894 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:52:07.401894 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:52:07.402895 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:52:07.931199 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.529 seconds
[0m15:52:07.938242 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:52:08.071070 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.71s]
[0m15:52:08.072071 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:52:08.073537 [info ] [MainThread]: 
[0m15:52:08.074559 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:52:08.117284 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:52:08.122620 [debug] [MainThread]: Using snowflake connection "master"
[0m15:52:08.123621 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:52:08.123621 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:09.208960 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.085 seconds
[0m15:52:09.213049 [info ] [MainThread]: Test name: not_null
[0m15:52:09.214053 [info ] [MainThread]: Test type: generic
[0m15:52:09.215055 [info ] [MainThread]: Column name: column_1
[0m15:52:09.223724 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:52:09.226744 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:52:09.231019 [debug] [MainThread]: Using snowflake connection "master"
[0m15:52:09.231019 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7051577568054199'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:52:09.557346 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.326 seconds
[0m15:52:09.558355 [debug] [MainThread]: Using snowflake connection "master"
[0m15:52:09.559361 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:52:09.909835 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.351 seconds
[0m15:52:09.910836 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.68s]
[0m15:52:09.911837 [info ] [MainThread]: 
[0m15:52:09.913074 [debug] [MainThread]: On master: Close
[0m15:52:10.033823 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:10.033823 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:52:10.035042 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:52:10.035042 [info ] [MainThread]: 
[0m15:52:10.036045 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m15:52:10.037126 [debug] [MainThread]: Command end result
[0m15:52:10.075290 [info ] [MainThread]: 
[0m15:52:10.075290 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:10.076475 [info ] [MainThread]: 
[0m15:52:10.077492 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:52:10.078494 [debug] [MainThread]: Command `dbt test` succeeded at 15:52:10.078494 after 4.94 seconds
[0m15:52:10.078494 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C3768829E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C377194CA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C378D70490>]}
[0m15:52:10.079848 [debug] [MainThread]: Flushing usage events
[0m15:53:24.904113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD1D222980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD1FDDA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD1FDDA2F0>]}


============================== 15:53:24.907123 | b08b68ce-363f-4a52-851a-6519bfdc72ff ==============================
[0m15:53:24.907123 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:53:24.908252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:markets', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:53:25.622207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b08b68ce-363f-4a52-851a-6519bfdc72ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD386EE8C0>]}
[0m15:53:25.667214 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b08b68ce-363f-4a52-851a-6519bfdc72ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD1DADA2C0>]}
[0m15:53:25.668220 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:53:25.688427 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:53:25.918290 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:53:25.919293 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m15:53:26.218633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b08b68ce-363f-4a52-851a-6519bfdc72ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD38E7C4C0>]}
[0m15:53:26.338096 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b08b68ce-363f-4a52-851a-6519bfdc72ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD38E7CA30>]}
[0m15:53:26.338096 [info ] [MainThread]: Found 3 models, 1 operation, 6 data tests, 841 macros
[0m15:53:26.339184 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b08b68ce-363f-4a52-851a-6519bfdc72ff', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD38A31720>]}
[0m15:53:26.340188 [info ] [MainThread]: 
[0m15:53:26.341191 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:53:26.342195 [debug] [MainThread]: Command end result
[0m15:53:26.377024 [debug] [MainThread]: Command `dbt test` succeeded at 15:53:26.377024 after 1.53 seconds
[0m15:53:26.378027 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD1D222980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD1D4A7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD38C38160>]}
[0m15:53:26.378027 [debug] [MainThread]: Flushing usage events
[0m15:53:55.326637 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD1BB29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD476A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD476A350>]}


============================== 15:53:55.329647 | fb473431-9c9c-4893-9a8e-6d4ecf0ca23f ==============================
[0m15:53:55.329647 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:53:55.329647 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:markets', 'send_anonymous_usage_stats': 'True'}
[0m15:53:56.081524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb473431-9c9c-4893-9a8e-6d4ecf0ca23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD1E37970>]}
[0m15:53:56.128879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb473431-9c9c-4893-9a8e-6d4ecf0ca23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD3BEB820>]}
[0m15:53:56.130887 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:53:56.153146 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:53:56.407269 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:53:56.408272 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m15:53:56.760791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb473431-9c9c-4893-9a8e-6d4ecf0ca23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DED8D1120>]}
[0m15:53:56.877381 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb473431-9c9c-4893-9a8e-6d4ecf0ca23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DED560AC0>]}
[0m15:53:56.878384 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:53:56.878384 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb473431-9c9c-4893-9a8e-6d4ecf0ca23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DED86AC50>]}
[0m15:53:56.879387 [info ] [MainThread]: 
[0m15:53:56.880478 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:53:56.885499 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:53:56.897590 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:53:56.897590 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:53:56.898594 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:53:57.556043 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.658 seconds
[0m15:53:57.557065 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:53:57.681728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb473431-9c9c-4893-9a8e-6d4ecf0ca23f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DED8EE2C0>]}
[0m15:53:57.681728 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:53:57.682734 [info ] [MainThread]: 
[0m15:53:57.685747 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:53:57.685747 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:53:57.686750 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:53:57.686750 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:53:57.700949 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:53:57.700949 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:53:57.717355 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:53:57.719548 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:53:57.719548 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:53:57.720557 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:53:58.299740 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m15:53:58.306773 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:53:58.432605 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.75s]
[0m15:53:58.434079 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:53:58.435092 [info ] [MainThread]: 
[0m15:53:58.436099 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:53:58.473750 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:53:58.478790 [debug] [MainThread]: Using snowflake connection "master"
[0m15:53:58.479796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:53:58.479796 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:53:59.515768 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.035 seconds
[0m15:53:59.520151 [info ] [MainThread]: Test name: not_null
[0m15:53:59.521153 [info ] [MainThread]: Test type: generic
[0m15:53:59.522200 [info ] [MainThread]: Column name: column_1
[0m15:53:59.530235 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:53:59.534762 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:53:59.537780 [debug] [MainThread]: Using snowflake connection "master"
[0m15:53:59.538787 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7458553314208984'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:53:59.949630 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.410 seconds
[0m15:53:59.949630 [debug] [MainThread]: Using snowflake connection "master"
[0m15:53:59.950645 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:54:00.229183 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.278 seconds
[0m15:54:00.230188 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.70s]
[0m15:54:00.231231 [info ] [MainThread]: 
[0m15:54:00.231231 [debug] [MainThread]: On master: Close
[0m15:54:00.353701 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:00.353701 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:54:00.354705 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:54:00.354705 [info ] [MainThread]: 
[0m15:54:00.355709 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.47 seconds (3.47s).
[0m15:54:00.356777 [debug] [MainThread]: Command end result
[0m15:54:00.453459 [info ] [MainThread]: 
[0m15:54:00.454464 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:54:00.455468 [info ] [MainThread]: 
[0m15:54:00.455468 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:54:00.457478 [debug] [MainThread]: Command `dbt test` succeeded at 15:54:00.457478 after 5.19 seconds
[0m15:54:00.457478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD1BB29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DD24C4B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016DEDBE7880>]}
[0m15:54:00.458482 [debug] [MainThread]: Flushing usage events
[0m15:54:21.926528 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3288A2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B32B46E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B32B46E320>]}


============================== 15:54:21.929546 | dc8f160c-5fac-4698-a186-9196082fc8f0 ==============================
[0m15:54:21.929546 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:54:21.930549 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:markets', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:54:22.647625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc8f160c-5fac-4698-a186-9196082fc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B328B2BEB0>]}
[0m15:54:22.691650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc8f160c-5fac-4698-a186-9196082fc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3283734F0>]}
[0m15:54:22.692659 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:54:22.712829 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:54:22.971979 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:54:22.972982 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m15:54:23.341175 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc8f160c-5fac-4698-a186-9196082fc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3445D1090>]}
[0m15:54:23.465909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc8f160c-5fac-4698-a186-9196082fc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B343F024D0>]}
[0m15:54:23.465909 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:54:23.466912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc8f160c-5fac-4698-a186-9196082fc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3442785B0>]}
[0m15:54:23.467915 [info ] [MainThread]: 
[0m15:54:23.467915 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:54:23.473441 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:54:23.485764 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:54:23.485764 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:54:23.486769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:54:24.162750 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.676 seconds
[0m15:54:24.164799 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:54:24.418607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc8f160c-5fac-4698-a186-9196082fc8f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B344121540>]}
[0m15:54:24.418607 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:54:24.419626 [info ] [MainThread]: 
[0m15:54:24.422735 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:54:24.423778 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:54:24.423778 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:54:24.424790 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:54:24.440296 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:54:24.441301 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:54:24.456952 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:54:24.457972 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:54:24.458979 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:54:24.458979 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:54:25.016981 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.558 seconds
[0m15:54:25.024378 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:54:25.146698 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.72s]
[0m15:54:25.147839 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:54:25.148852 [info ] [MainThread]: 
[0m15:54:25.149859 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:54:25.187643 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:54:25.193806 [debug] [MainThread]: Using snowflake connection "master"
[0m15:54:25.193806 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:54:25.194809 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:54:26.239035 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.044 seconds
[0m15:54:26.243050 [info ] [MainThread]: Test name: not_null
[0m15:54:26.244053 [info ] [MainThread]: Test type: generic
[0m15:54:26.245177 [info ] [MainThread]: Column name: column_1
[0m15:54:26.253215 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:54:26.257229 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:54:26.260330 [debug] [MainThread]: Using snowflake connection "master"
[0m15:54:26.261333 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'WARN'::varchar(250) as test_severity_config,
            '0.7229204177856445'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:54:26.661535 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.399 seconds
[0m15:54:26.661535 [debug] [MainThread]: Using snowflake connection "master"
[0m15:54:26.662611 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:54:27.032792 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.370 seconds
[0m15:54:27.033798 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.78s]
[0m15:54:27.034803 [info ] [MainThread]: 
[0m15:54:27.035806 [debug] [MainThread]: On master: Close
[0m15:54:27.156745 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:54:27.157748 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:54:27.157748 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:54:27.158751 [info ] [MainThread]: 
[0m15:54:27.158751 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m15:54:27.159754 [debug] [MainThread]: Command end result
[0m15:54:27.258270 [info ] [MainThread]: 
[0m15:54:27.259273 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:54:27.259273 [info ] [MainThread]: 
[0m15:54:27.260349 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:54:27.261354 [debug] [MainThread]: Command `dbt test` succeeded at 15:54:27.261354 after 5.39 seconds
[0m15:54:27.262357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3288A2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3448E7460>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3448E7B50>]}
[0m15:54:27.262357 [debug] [MainThread]: Flushing usage events
[0m15:54:48.474853 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD457E2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4839E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD4839E320>]}


============================== 15:54:48.477876 | 7c8092aa-8534-4d52-8d0c-5b0ea4b8fc4c ==============================
[0m15:54:48.477876 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:54:48.478879 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:markets', 'send_anonymous_usage_stats': 'True'}
[0m15:54:49.244128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7c8092aa-8534-4d52-8d0c-5b0ea4b8fc4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD45A6BEB0>]}
[0m15:54:49.289397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7c8092aa-8534-4d52-8d0c-5b0ea4b8fc4c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD452B34F0>]}
[0m15:54:49.290399 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:54:49.314969 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:54:49.566515 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:54:49.567539 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m15:54:49.859595 [error] [MainThread]: Encountered an error:
Severity must be either 'warn' or 'error'. Got 'HIGH'
[0m15:54:49.913458 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\manifest.py", line 452, in load
    self.parse_project(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\manifest.py", line 729, in parse_project
    parser.parse_file(block, dct=dct)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schemas.py", line 190, in parse_file
    self.generic_test_parser.parse_versioned_tests(versioned_test_block)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 396, in parse_versioned_tests
    self.parse_tests(block)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 389, in parse_tests
    self.parse_column_tests(block, column, None)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 80, in parse_column_tests
    self.parse_test(block, data_test, column, version)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 385, in parse_test
    self.parse_node(block)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 323, in parse_node
    node = self.parse_generic_test(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 226, in parse_generic_test
    self.render_test_update(node, config, builder, schema_file_id)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 282, in render_test_update
    self.update_parsed_node_config(node, config)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\base.py", line 319, in update_parsed_node_config
    config_dict = config.build_config_dict(patch_config_dict=patch_config_dict)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\context\context_config.py", line 362, in build_config_dict
    return src.calculate_node_config_dict(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\context\context_config.py", line 241, in calculate_node_config_dict
    finalized = config.finalize_and_validate()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt_common\contracts\config\base.py", line 179, in finalize_and_validate
    self.validate(dct)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\artifacts\resources\v1\config.py", line 256, in validate
    raise ValidationError(
dbt_common.dataclass_schema.ValidationError: Severity must be either 'warn' or 'error'. Got 'HIGH'

[0m15:54:49.915475 [debug] [MainThread]: Command `dbt test` failed at 15:54:49.915475 after 1.50 seconds
[0m15:54:49.916478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD457E2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD61207700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FD61205F90>]}
[0m15:54:49.916478 [debug] [MainThread]: Flushing usage events
[0m15:55:48.826021 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7BC722980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7BF2DA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7BF2DA2F0>]}


============================== 15:55:48.829507 | f6cd7614-da2e-4e2a-a1bd-9d99b3ee3265 ==============================
[0m15:55:48.829507 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:55:48.830651 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:markets', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:55:49.666732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f6cd7614-da2e-4e2a-a1bd-9d99b3ee3265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7D7BEA020>]}
[0m15:55:49.717039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f6cd7614-da2e-4e2a-a1bd-9d99b3ee3265', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7BCFDB730>]}
[0m15:55:49.719056 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:55:49.743784 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:55:49.981557 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:55:49.981557 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m15:55:50.237121 [error] [MainThread]: Encountered an error:
'str' object has no attribute 'pop'
[0m15:55:50.254804 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 320, in wrapper
    ctx.obj["manifest"] = parse_manifest(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\manifest.py", line 1898, in parse_manifest
    manifest = ManifestLoader.get_full_manifest(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\manifest.py", line 330, in get_full_manifest
    manifest = loader.load()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\manifest.py", line 452, in load
    self.parse_project(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\manifest.py", line 729, in parse_project
    parser.parse_file(block, dct=dct)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schemas.py", line 190, in parse_file
    self.generic_test_parser.parse_versioned_tests(versioned_test_block)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 396, in parse_versioned_tests
    self.parse_tests(block)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 389, in parse_tests
    self.parse_column_tests(block, column, None)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 80, in parse_column_tests
    self.parse_test(block, data_test, column, version)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 385, in parse_test
    self.parse_node(block)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 323, in parse_node
    node = self.parse_generic_test(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\schema_generic_tests.py", line 159, in parse_generic_test
    builder = TestBuilder(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\parser\generic_test_builders.py", line 151, in __init__
    value = self.args["config"].pop(key, None)
AttributeError: 'str' object has no attribute 'pop'

[0m15:55:50.256813 [debug] [MainThread]: Command `dbt test` failed at 15:55:50.256813 after 1.49 seconds
[0m15:55:50.256813 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7BC722980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7D82DD300>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7D82DD090>]}
[0m15:55:50.257818 [debug] [MainThread]: Flushing usage events
[0m15:56:34.769343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D017AFE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01A68A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D01A68A320>]}


============================== 15:56:34.771351 | 73ce549b-1157-45fc-838a-68aecd56b85a ==============================
[0m15:56:34.771351 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:56:34.772853 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:markets', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:56:35.463142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73ce549b-1157-45fc-838a-68aecd56b85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D017D8BEB0>]}
[0m15:56:35.507088 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73ce549b-1157-45fc-838a-68aecd56b85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0175F34F0>]}
[0m15:56:35.508095 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:56:35.529450 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:56:35.760895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:56:35.761898 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m15:56:36.111856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73ce549b-1157-45fc-838a-68aecd56b85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0337F5090>]}
[0m15:56:36.231062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73ce549b-1157-45fc-838a-68aecd56b85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D033498610>]}
[0m15:56:36.231062 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:56:36.231062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73ce549b-1157-45fc-838a-68aecd56b85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0337F5210>]}
[0m15:56:36.233425 [info ] [MainThread]: 
[0m15:56:36.234429 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:56:36.238435 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:56:36.251153 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:56:36.251153 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:56:36.252254 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:36.941017 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.689 seconds
[0m15:56:36.943117 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:56:37.078750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73ce549b-1157-45fc-838a-68aecd56b85a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D0332EC670>]}
[0m15:56:37.078750 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:56:37.078750 [info ] [MainThread]: 
[0m15:56:37.083867 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:56:37.083867 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:56:37.084873 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:56:37.084873 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:56:37.099494 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:56:37.100495 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:56:37.116691 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:56:37.117695 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:56:37.118705 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:56:37.118705 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:56:37.674988 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.556 seconds
[0m15:56:37.682035 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:56:37.797844 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.71s]
[0m15:56:37.798854 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:56:37.799867 [info ] [MainThread]: 
[0m15:56:37.800871 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:56:37.838553 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:56:37.843666 [debug] [MainThread]: Using snowflake connection "master"
[0m15:56:37.843666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:56:37.844671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:38.927668 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.083 seconds
[0m15:56:38.931684 [info ] [MainThread]: Test name: not_null
[0m15:56:38.932759 [info ] [MainThread]: Test type: generic
[0m15:56:38.933767 [info ] [MainThread]: Column name: column_1
[0m15:56:38.941803 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:56:38.945818 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:56:38.949008 [debug] [MainThread]: Using snowflake connection "master"
[0m15:56:38.950012 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7129709720611572'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:56:39.328612 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.378 seconds
[0m15:56:39.328612 [debug] [MainThread]: Using snowflake connection "master"
[0m15:56:39.329623 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:56:39.683812 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.354 seconds
[0m15:56:39.684816 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.74s]
[0m15:56:39.685820 [info ] [MainThread]: 
[0m15:56:39.685820 [debug] [MainThread]: On master: Close
[0m15:56:39.810203 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:39.811203 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:56:39.811203 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:56:39.811203 [info ] [MainThread]: 
[0m15:56:39.812204 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.58 seconds (3.58s).
[0m15:56:39.813362 [debug] [MainThread]: Command end result
[0m15:56:39.912580 [info ] [MainThread]: 
[0m15:56:39.913583 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:39.914719 [info ] [MainThread]: 
[0m15:56:39.914719 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:56:39.916746 [debug] [MainThread]: Command `dbt test` succeeded at 15:56:39.916746 after 5.20 seconds
[0m15:56:39.916746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D017AFE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D033B0B5E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002D033B0BB50>]}
[0m15:56:39.917756 [debug] [MainThread]: Flushing usage events
[0m15:56:53.999937 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001279BB028F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001279E6BA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001279E6BA230>]}


============================== 15:56:54.003953 | 6af62d82-4b0c-4793-85c9-a4220a3d01df ==============================
[0m15:56:54.003953 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:56:54.004957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:markets', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:56:54.723478 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6af62d82-4b0c-4793-85c9-a4220a3d01df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001279BD87CD0>]}
[0m15:56:54.768101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6af62d82-4b0c-4793-85c9-a4220a3d01df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001279DB3B760>]}
[0m15:56:54.769105 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:56:54.790069 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:56:55.020699 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:56:55.021702 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m15:56:55.187945 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6af62d82-4b0c-4793-85c9-a4220a3d01df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127B74F0130>]}
[0m15:56:55.307120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6af62d82-4b0c-4793-85c9-a4220a3d01df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127B714FC10>]}
[0m15:56:55.308322 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:56:55.308322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6af62d82-4b0c-4793-85c9-a4220a3d01df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127B74C8190>]}
[0m15:56:55.310331 [info ] [MainThread]: 
[0m15:56:55.310331 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:56:55.316415 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:56:55.329536 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:56:55.329536 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:56:55.330540 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:55.975568 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.645 seconds
[0m15:56:55.976991 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:56:56.096876 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6af62d82-4b0c-4793-85c9-a4220a3d01df', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000127B74C2380>]}
[0m15:56:56.096876 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:56:56.097885 [info ] [MainThread]: 
[0m15:56:56.099892 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:56:56.101323 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:56:56.102329 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:56:56.102329 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:56:56.117277 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:56:56.118280 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:56:56.133983 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:56:56.136153 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:56:56.136153 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:56:56.137159 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:56:56.654706 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.518 seconds
[0m15:56:56.662028 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:56:56.784030 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.68s]
[0m15:56:56.785192 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:56:56.786282 [info ] [MainThread]: 
[0m15:56:56.787286 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:56:56.835294 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:56:56.841320 [debug] [MainThread]: Using snowflake connection "master"
[0m15:56:56.841320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:56:56.842335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:57.907345 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.065 seconds
[0m15:56:57.912371 [info ] [MainThread]: Test name: not_null
[0m15:56:57.912371 [info ] [MainThread]: Test type: generic
[0m15:56:57.913424 [info ] [MainThread]: Column name: column_1
[0m15:56:57.914428 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m15:56:57.914428 [info ] [MainThread]: Test Full Node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_markets_column_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_markets_column_1.sql', original_file_path='models\\example\\markets.yml', unique_id='test.dbt_dataops.not_null_markets_column_1.e080da476c', fqn=['dbt_dataops', 'example', 'not_null_markets_column_1'], alias='not_null_markets_column_1', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['High'], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', unrendered_config={}, created_at=1740133596.0439706, config_call_dict={}, relation_name=None, raw_code="{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(tags=['High']) }}", language='sql', refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect column_1\nfrom dev_dwdb.marketing.markets\nwhere column_1 is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='column_1', file_key_name='models.markets', attached_node='model.dbt_dataops.markets', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None))
[0m15:56:57.915432 [info ] [MainThread]: Test Name: not_null_markets_column_1
[0m15:56:57.916439 [info ] [MainThread]: Resource Type: test
[0m15:56:57.916439 [info ] [MainThread]: Test Status: pass
[0m15:56:57.917443 [info ] [MainThread]: Execution Time: 0.6817014217376709
[0m15:56:57.917443 [info ] [MainThread]: Test Metadata: TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None)
[0m15:56:57.918448 [info ] [MainThread]: Column Name: column_1
[0m15:56:57.919452 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m15:56:57.919452 [info ] [MainThread]: Original File Path: models\example\markets.yml
[0m15:56:57.920457 [info ] [MainThread]: Compiled SQL: 
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



[0m15:56:57.921462 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m15:56:57.921462 [info ] [MainThread]: Sources: []
[0m15:56:57.922465 [info ] [MainThread]: ========================================================
[0m15:56:57.931755 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:56:57.935794 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:56:57.939815 [debug] [MainThread]: Using snowflake connection "master"
[0m15:56:57.939815 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6817014217376709'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:56:58.370962 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.430 seconds
[0m15:56:58.370962 [debug] [MainThread]: Using snowflake connection "master"
[0m15:56:58.372167 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:56:58.681666 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.309 seconds
[0m15:56:58.682671 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.75s]
[0m15:56:58.683676 [info ] [MainThread]: 
[0m15:56:58.683676 [debug] [MainThread]: On master: Close
[0m15:56:59.092177 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:59.092177 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:56:59.093181 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:56:59.093181 [info ] [MainThread]: 
[0m15:56:59.094183 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.78 seconds (3.78s).
[0m15:56:59.095204 [debug] [MainThread]: Command end result
[0m15:56:59.131436 [info ] [MainThread]: 
[0m15:56:59.132439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:56:59.132439 [info ] [MainThread]: 
[0m15:56:59.133465 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:56:59.134469 [debug] [MainThread]: Command `dbt test` succeeded at 15:56:59.134469 after 5.20 seconds
[0m15:56:59.135473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001279BB028F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001279E0B2560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001279C417A60>]}
[0m15:56:59.135473 [debug] [MainThread]: Flushing usage events
[0m15:58:40.451646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3C9DE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3F59A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3F59A350>]}


============================== 15:58:40.455169 | 18cf9621-f20a-4b9b-a658-78af99fb9db1 ==============================
[0m15:58:40.455169 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:58:40.456191 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:High', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m15:58:41.164086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '18cf9621-f20a-4b9b-a658-78af99fb9db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3CC67970>]}
[0m15:58:41.208431 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '18cf9621-f20a-4b9b-a658-78af99fb9db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3EA1B820>]}
[0m15:58:41.209434 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:58:41.230563 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:58:41.464922 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:41.465925 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:41.512181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '18cf9621-f20a-4b9b-a658-78af99fb9db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D583F1720>]}
[0m15:58:41.674327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '18cf9621-f20a-4b9b-a658-78af99fb9db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D583F3DF0>]}
[0m15:58:41.675333 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:58:41.675333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18cf9621-f20a-4b9b-a658-78af99fb9db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D583A86A0>]}
[0m15:58:41.677346 [info ] [MainThread]: 
[0m15:58:41.677346 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:58:41.682792 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:58:41.697084 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:58:41.697084 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:58:41.698151 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:42.407722 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.710 seconds
[0m15:58:42.409730 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:58:42.532816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '18cf9621-f20a-4b9b-a658-78af99fb9db1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D583F3D90>]}
[0m15:58:42.532816 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:58:42.533951 [info ] [MainThread]: 
[0m15:58:42.537021 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:58:42.537021 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:58:42.538033 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:58:42.539041 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:58:42.553090 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:58:42.553090 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:58:42.568804 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:58:42.569809 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:58:42.570814 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:58:42.571819 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:58:43.109092 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m15:58:43.116265 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:58:43.243004 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.70s]
[0m15:58:43.244014 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:58:43.245019 [info ] [MainThread]: 
[0m15:58:43.246026 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:58:43.292766 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:58:43.298796 [debug] [MainThread]: Using snowflake connection "master"
[0m15:58:43.298796 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:58:43.299801 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:44.321676 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.022 seconds
[0m15:58:44.326807 [info ] [MainThread]: Test name: not_null
[0m15:58:44.327809 [info ] [MainThread]: Test type: generic
[0m15:58:44.327809 [info ] [MainThread]: Column name: column_1
[0m15:58:44.329108 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m15:58:44.329108 [info ] [MainThread]: Test Full Node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_markets_column_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_markets_column_1.sql', original_file_path='models\\example\\markets.yml', unique_id='test.dbt_dataops.not_null_markets_column_1.e080da476c', fqn=['dbt_dataops', 'example', 'not_null_markets_column_1'], alias='not_null_markets_column_1', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['High'], description='', columns={}, meta={}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', unrendered_config={}, created_at=1740133596.0439706, config_call_dict={}, relation_name=None, raw_code="{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(tags=['High']) }}", language='sql', refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect column_1\nfrom dev_dwdb.marketing.markets\nwhere column_1 is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='column_1', file_key_name='models.markets', attached_node='model.dbt_dataops.markets', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None))
[0m15:58:44.330112 [info ] [MainThread]: Test Name: not_null_markets_column_1
[0m15:58:44.331331 [info ] [MainThread]: Resource Type: test
[0m15:58:44.331331 [info ] [MainThread]: Test Status: pass
[0m15:58:44.332475 [info ] [MainThread]: Execution Time: 0.7049705982208252
[0m15:58:44.333514 [info ] [MainThread]: Test Metadata: TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None)
[0m15:58:44.333514 [info ] [MainThread]: Column Name: column_1
[0m15:58:44.334529 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m15:58:44.335532 [info ] [MainThread]: Original File Path: models\example\markets.yml
[0m15:58:44.336710 [info ] [MainThread]: Compiled SQL: 
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



[0m15:58:44.336710 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m15:58:44.338008 [info ] [MainThread]: Sources: []
[0m15:58:44.339184 [info ] [MainThread]: ========================================================
[0m15:58:44.347754 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m15:58:44.352037 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m15:58:44.357515 [debug] [MainThread]: Using snowflake connection "master"
[0m15:58:44.358520 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7049705982208252'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m15:58:44.785891 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.427 seconds
[0m15:58:44.785891 [debug] [MainThread]: Using snowflake connection "master"
[0m15:58:44.787000 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m15:58:45.121503 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.334 seconds
[0m15:58:45.122508 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.77s]
[0m15:58:45.122508 [info ] [MainThread]: 
[0m15:58:45.123513 [debug] [MainThread]: On master: Close
[0m15:58:45.242673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:45.242673 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m15:58:45.242673 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m15:58:45.243687 [info ] [MainThread]: 
[0m15:58:45.244693 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.57 seconds (3.57s).
[0m15:58:45.245698 [debug] [MainThread]: Command end result
[0m15:58:45.281710 [info ] [MainThread]: 
[0m15:58:45.282725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:45.282725 [info ] [MainThread]: 
[0m15:58:45.283929 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m15:58:45.284975 [debug] [MainThread]: Command `dbt test` succeeded at 15:58:45.284975 after 4.89 seconds
[0m15:58:45.285980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3C9DE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3EA1B820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025D3E9BFB50>]}
[0m15:58:45.285980 [debug] [MainThread]: Flushing usage events
[0m15:59:56.102958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7C34B2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7C604A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7C604A320>]}


============================== 15:59:56.104964 | f805b3f5-9bdc-4f54-b15d-e65fa9002e7d ==============================
[0m15:59:56.104964 [info ] [MainThread]: Running with dbt=1.8.7
[0m15:59:56.105970 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:markets', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m15:59:56.809652 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f805b3f5-9bdc-4f54-b15d-e65fa9002e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7C373BA90>]}
[0m15:59:56.854454 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f805b3f5-9bdc-4f54-b15d-e65fa9002e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7C2FA3520>]}
[0m15:59:56.855455 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m15:59:56.876901 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m15:59:57.112588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:59:57.113590 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m15:59:57.477762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f805b3f5-9bdc-4f54-b15d-e65fa9002e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DF1B50C0>]}
[0m15:59:57.599673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f805b3f5-9bdc-4f54-b15d-e65fa9002e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DF1B6800>]}
[0m15:59:57.599673 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m15:59:57.600766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f805b3f5-9bdc-4f54-b15d-e65fa9002e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DECA2DD0>]}
[0m15:59:57.601960 [info ] [MainThread]: 
[0m15:59:57.603317 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m15:59:57.607323 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m15:59:57.620703 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m15:59:57.620703 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m15:59:57.620703 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:59:58.356628 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.736 seconds
[0m15:59:58.358760 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m15:59:58.484012 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f805b3f5-9bdc-4f54-b15d-e65fa9002e7d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DF1B5C30>]}
[0m15:59:58.484012 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m15:59:58.484012 [info ] [MainThread]: 
[0m15:59:58.487380 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:59:58.488384 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m15:59:58.488384 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m15:59:58.489389 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:59:58.503684 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:59:58.504692 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:59:58.521161 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:59:58.522347 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m15:59:58.522347 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m15:59:58.523355 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m15:59:59.064565 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m15:59:59.071596 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m15:59:59.199951 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.71s]
[0m15:59:59.200954 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m15:59:59.202033 [info ] [MainThread]: 
[0m15:59:59.203045 [info ] [MainThread]: Running 1 on-run-end hook
[0m15:59:59.251489 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m15:59:59.257516 [debug] [MainThread]: Using snowflake connection "master"
[0m15:59:59.258519 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m15:59:59.258519 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:00:00.318942 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.060 seconds
[0m16:00:00.323965 [info ] [MainThread]: Test name: not_null
[0m16:00:00.323965 [info ] [MainThread]: Test type: generic
[0m16:00:00.324970 [info ] [MainThread]: Column name: column_1
[0m16:00:00.326115 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m16:00:00.326115 [info ] [MainThread]: Test Full Node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_markets_column_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_markets_column_1.sql', original_file_path='models\\example\\markets.yml', unique_id='test.dbt_dataops.not_null_markets_column_1.e080da476c', fqn=['dbt_dataops', 'example', 'not_null_markets_column_1'], alias='not_null_markets_column_1', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={'rule': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={'rule': 'High'}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', unrendered_config={'meta': {'rule': 'High'}}, created_at=1740133797.4104762, config_call_dict={'meta': {'rule': 'High'}}, relation_name=None, raw_code="{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(meta={'rule': 'High'}) }}", language='sql', refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect column_1\nfrom dev_dwdb.marketing.markets\nwhere column_1 is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='column_1', file_key_name='models.markets', attached_node='model.dbt_dataops.markets', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None))
[0m16:00:00.327121 [info ] [MainThread]: Test Name: not_null_markets_column_1
[0m16:00:00.328131 [info ] [MainThread]: Resource Type: test
[0m16:00:00.328131 [info ] [MainThread]: Test Status: pass
[0m16:00:00.329136 [info ] [MainThread]: Execution Time: 0.7115669250488281
[0m16:00:00.330142 [info ] [MainThread]: Test Metadata: TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None)
[0m16:00:00.330142 [info ] [MainThread]: Column Name: column_1
[0m16:00:00.331147 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={'rule': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m16:00:00.332152 [info ] [MainThread]: Original File Path: models\example\markets.yml
[0m16:00:00.333160 [info ] [MainThread]: Compiled SQL: 
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



[0m16:00:00.333160 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m16:00:00.334165 [info ] [MainThread]: Sources: []
[0m16:00:00.335168 [info ] [MainThread]: ========================================================
[0m16:00:00.345083 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:00:00.349088 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:00:00.352285 [debug] [MainThread]: Using snowflake connection "master"
[0m16:00:00.353288 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7115669250488281'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:00:00.819106 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.466 seconds
[0m16:00:00.820608 [debug] [MainThread]: Using snowflake connection "master"
[0m16:00:00.820608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:00:01.196204 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.374 seconds
[0m16:00:01.197205 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.85s]
[0m16:00:01.198431 [info ] [MainThread]: 
[0m16:00:01.198431 [debug] [MainThread]: On master: Close
[0m16:00:01.326167 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:00:01.327170 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m16:00:01.327170 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m16:00:01.328177 [info ] [MainThread]: 
[0m16:00:01.328177 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.73 seconds (3.73s).
[0m16:00:01.329184 [debug] [MainThread]: Command end result
[0m16:00:01.434808 [info ] [MainThread]: 
[0m16:00:01.435811 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:00:01.435811 [info ] [MainThread]: 
[0m16:00:01.436816 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:00:01.437827 [debug] [MainThread]: Command `dbt test` succeeded at 16:00:01.437827 after 5.39 seconds
[0m16:00:01.438830 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7C34B2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DECA2320>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DECA17B0>]}
[0m16:00:01.438830 [debug] [MainThread]: Flushing usage events
[0m16:03:00.749466 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E2B2B2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E2DE6E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E2DE6E320>]}


============================== 16:03:00.752479 | aa0ccc37-5afa-4480-bdba-80c03f3d572f ==============================
[0m16:03:00.752479 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:03:00.753482 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:markets', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:03:01.499958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa0ccc37-5afa-4480-bdba-80c03f3d572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E2B53BEB0>]}
[0m16:03:01.545462 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa0ccc37-5afa-4480-bdba-80c03f3d572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E2AD834F0>]}
[0m16:03:01.547464 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:03:01.573724 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:03:01.838858 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m16:03:01.838858 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m16:03:01.839862 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m16:03:02.244803 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa0ccc37-5afa-4480-bdba-80c03f3d572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E46FDA170>]}
[0m16:03:02.367062 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa0ccc37-5afa-4480-bdba-80c03f3d572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E46FEA2F0>]}
[0m16:03:02.368079 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m16:03:02.369084 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa0ccc37-5afa-4480-bdba-80c03f3d572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E46C78EE0>]}
[0m16:03:02.370090 [info ] [MainThread]: 
[0m16:03:02.371095 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:03:02.375115 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m16:03:02.388335 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m16:03:02.388335 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m16:03:02.389344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:03.081896 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.693 seconds
[0m16:03:03.083905 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m16:03:03.215167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa0ccc37-5afa-4480-bdba-80c03f3d572f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E46FEB340>]}
[0m16:03:03.216176 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:03:03.217179 [info ] [MainThread]: 
[0m16:03:03.219192 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m16:03:03.220217 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m16:03:03.221220 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m16:03:03.221220 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m16:03:03.234424 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m16:03:03.235432 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m16:03:03.250889 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m16:03:03.251892 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m16:03:03.251892 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m16:03:03.252991 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:03:03.892567 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m16:03:03.898623 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m16:03:04.016424 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.80s]
[0m16:03:04.017434 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m16:03:04.019443 [info ] [MainThread]: 
[0m16:03:04.019443 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:03:04.076505 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m16:03:04.081529 [debug] [MainThread]: Using snowflake connection "master"
[0m16:03:04.082532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:03:04.082532 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:05.274918 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.193 seconds
[0m16:03:05.280086 [info ] [MainThread]: Test name: not_null
[0m16:03:05.281091 [info ] [MainThread]: Test type: generic
[0m16:03:05.282098 [info ] [MainThread]: Column name: column_1
[0m16:03:05.282098 [info ] [MainThread]: Rule Level: High
[0m16:03:05.283104 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m16:03:05.283104 [info ] [MainThread]: Test Full Node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_markets_column_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_markets_column_1.sql', original_file_path='models\\example\\markets.yml', unique_id='test.dbt_dataops.not_null_markets_column_1.e080da476c', fqn=['dbt_dataops', 'example', 'not_null_markets_column_1'], alias='not_null_markets_column_1', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={'rule_level': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={'rule_level': 'High'}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', unrendered_config={'meta': {'rule_level': 'High'}}, created_at=1740133982.1769886, config_call_dict={'meta': {'rule_level': 'High'}}, relation_name=None, raw_code="{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(meta={'rule_level': 'High'}) }}", language='sql', refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect column_1\nfrom dev_dwdb.marketing.markets\nwhere column_1 is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='column_1', file_key_name='models.markets', attached_node='model.dbt_dataops.markets', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None))
[0m16:03:05.284109 [info ] [MainThread]: Test Name: not_null_markets_column_1
[0m16:03:05.285113 [info ] [MainThread]: Resource Type: test
[0m16:03:05.286119 [info ] [MainThread]: Test Status: pass
[0m16:03:05.287120 [info ] [MainThread]: Execution Time: 0.7962071895599365
[0m16:03:05.287120 [info ] [MainThread]: Test Metadata: TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None)
[0m16:03:05.288121 [info ] [MainThread]: Column Name: column_1
[0m16:03:05.289122 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={'rule_level': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m16:03:05.289122 [info ] [MainThread]: Original File Path: models\example\markets.yml
[0m16:03:05.290123 [info ] [MainThread]: Compiled SQL: 
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



[0m16:03:05.291124 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m16:03:05.291124 [info ] [MainThread]: Sources: []
[0m16:03:05.292125 [info ] [MainThread]: ========================================================
[0m16:03:05.301217 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:03:05.305427 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:03:05.310040 [debug] [MainThread]: Using snowflake connection "master"
[0m16:03:05.310040 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'High'::varchar(50) as rule_level,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7962071895599365'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        rule_level, test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.rule_level, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:03:05.414301 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba89f9-3201-740a-000b-f692000333ba
[0m16:03:05.415303 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 62 at position 8
invalid identifier 'RULE_LEVEL'
[0m16:03:05.415303 [info ] [MainThread]: Database error while running on-run-end
[0m16:03:05.416365 [debug] [MainThread]: On master: Close
[0m16:03:05.544804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:05.545805 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m16:03:05.546807 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m16:03:05.546807 [info ] [MainThread]: 
[0m16:03:05.547807 [info ] [MainThread]: Finished running 1 test in 0 hours 0 minutes and 3.18 seconds (3.18s).
[0m16:03:05.549809 [debug] [MainThread]: Command end result
[0m16:03:05.732361 [info ] [MainThread]: 
[0m16:03:05.733474 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m16:03:05.733474 [info ] [MainThread]: 
[0m16:03:05.734478 [error] [MainThread]:   on-run-end failed, error:
 000904 (42000): SQL compilation error: error line 62 at position 8
invalid identifier 'RULE_LEVEL'
[0m16:03:05.734478 [info ] [MainThread]: 
[0m16:03:05.735482 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m16:03:05.736524 [debug] [MainThread]: Command `dbt test` failed at 16:03:05.736524 after 5.04 seconds
[0m16:03:05.737527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E2B2B2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E46FDAAD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000028E46FD8EE0>]}
[0m16:03:05.737527 [debug] [MainThread]: Flushing usage events
[0m16:03:18.808415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3B43B29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3B6F4E530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3B6F4E350>]}


============================== 16:03:18.810564 | 685b6d31-bbb5-4f97-89ae-99afe669b9e0 ==============================
[0m16:03:18.810564 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:03:18.811567 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:markets', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:03:19.539083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '685b6d31-bbb5-4f97-89ae-99afe669b9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3B4637970>]}
[0m16:03:19.585037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '685b6d31-bbb5-4f97-89ae-99afe669b9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3B63CB820>]}
[0m16:03:19.586058 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:03:19.608358 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:03:19.843750 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:03:19.843750 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:03:19.890197 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '685b6d31-bbb5-4f97-89ae-99afe669b9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CFDA1720>]}
[0m16:03:20.064166 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '685b6d31-bbb5-4f97-89ae-99afe669b9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CFDA3DF0>]}
[0m16:03:20.065463 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m16:03:20.066469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '685b6d31-bbb5-4f97-89ae-99afe669b9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CFD586A0>]}
[0m16:03:20.067485 [info ] [MainThread]: 
[0m16:03:20.068489 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:03:20.072526 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m16:03:20.086873 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m16:03:20.086873 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m16:03:20.086873 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:03:20.754403 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.667 seconds
[0m16:03:20.756405 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m16:03:20.875562 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '685b6d31-bbb5-4f97-89ae-99afe669b9e0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3CFDA3D90>]}
[0m16:03:20.875562 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:03:20.876644 [info ] [MainThread]: 
[0m16:03:20.878894 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m16:03:20.879911 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m16:03:20.880917 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m16:03:20.880917 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m16:03:20.895085 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m16:03:20.896091 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m16:03:20.911368 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m16:03:20.912373 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m16:03:20.913877 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m16:03:20.913877 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:03:21.448426 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m16:03:21.455452 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m16:03:21.583254 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.70s]
[0m16:03:21.584382 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m16:03:21.585387 [info ] [MainThread]: 
[0m16:03:21.586392 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:03:21.637350 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m16:03:21.643525 [debug] [MainThread]: Using snowflake connection "master"
[0m16:03:21.643525 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:03:21.644530 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:03:22.684159 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.039 seconds
[0m16:03:22.688196 [info ] [MainThread]: Test name: not_null
[0m16:03:22.689200 [info ] [MainThread]: Test type: generic
[0m16:03:22.690326 [info ] [MainThread]: Column name: column_1
[0m16:03:22.690326 [info ] [MainThread]: Rule Level: High
[0m16:03:22.691330 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m16:03:22.692334 [info ] [MainThread]: Test Full Node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_markets_column_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_markets_column_1.sql', original_file_path='models\\example\\markets.yml', unique_id='test.dbt_dataops.not_null_markets_column_1.e080da476c', fqn=['dbt_dataops', 'example', 'not_null_markets_column_1'], alias='not_null_markets_column_1', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={'rule_level': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={'rule_level': 'High'}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', unrendered_config={'meta': {'rule_level': 'High'}}, created_at=1740133982.1769886, config_call_dict={'meta': {'rule_level': 'High'}}, relation_name=None, raw_code="{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(meta={'rule_level': 'High'}) }}", language='sql', refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect column_1\nfrom dev_dwdb.marketing.markets\nwhere column_1 is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='column_1', file_key_name='models.markets', attached_node='model.dbt_dataops.markets', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None))
[0m16:03:22.692334 [info ] [MainThread]: Test Name: not_null_markets_column_1
[0m16:03:22.693344 [info ] [MainThread]: Resource Type: test
[0m16:03:22.694349 [info ] [MainThread]: Test Status: pass
[0m16:03:22.694349 [info ] [MainThread]: Execution Time: 0.7023372650146484
[0m16:03:22.695353 [info ] [MainThread]: Test Metadata: TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None)
[0m16:03:22.695353 [info ] [MainThread]: Column Name: column_1
[0m16:03:22.696387 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={'rule_level': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m16:03:22.696387 [info ] [MainThread]: Original File Path: models\example\markets.yml
[0m16:03:22.697467 [info ] [MainThread]: Compiled SQL: 
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



[0m16:03:22.698470 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m16:03:22.698470 [info ] [MainThread]: Sources: []
[0m16:03:22.699592 [info ] [MainThread]: ========================================================
[0m16:03:22.708687 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:03:22.712769 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:03:22.716914 [debug] [MainThread]: Using snowflake connection "master"
[0m16:03:22.716914 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'High'::varchar(50) as rule_level,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7023372650146484'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        rule_level, test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.rule_level, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:03:23.134341 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.416 seconds
[0m16:03:23.134341 [debug] [MainThread]: Using snowflake connection "master"
[0m16:03:23.135354 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:03:23.444583 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.309 seconds
[0m16:03:23.445596 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.73s]
[0m16:03:23.446602 [info ] [MainThread]: 
[0m16:03:23.446602 [debug] [MainThread]: On master: Close
[0m16:03:23.568204 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:03:23.568204 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m16:03:23.569209 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m16:03:23.569209 [info ] [MainThread]: 
[0m16:03:23.570215 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.50 seconds (3.50s).
[0m16:03:23.570215 [debug] [MainThread]: Command end result
[0m16:03:23.608081 [info ] [MainThread]: 
[0m16:03:23.609087 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:03:23.610092 [info ] [MainThread]: 
[0m16:03:23.610092 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:03:23.612516 [debug] [MainThread]: Command `dbt test` succeeded at 16:03:23.611495 after 4.86 seconds
[0m16:03:23.612516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3B43B29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3B6881780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3B4CB4B20>]}
[0m16:03:23.612516 [debug] [MainThread]: Flushing usage events
[0m16:04:46.513963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8B7F2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8E3AE4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8E3AE2F0>]}


============================== 16:04:46.518112 | 5dc3cb3e-c9c4-4c7a-bcd3-297ceb3b9647 ==============================
[0m16:04:46.518112 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:04:46.518112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:markets', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:04:47.237189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5dc3cb3e-c9c4-4c7a-bcd3-297ceb3b9647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA6CBA020>]}
[0m16:04:47.281281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5dc3cb3e-c9c4-4c7a-bcd3-297ceb3b9647', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8C0B3730>]}
[0m16:04:47.282639 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:04:47.305286 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:04:47.543233 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:04:47.543233 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://tests\main.sql
[0m16:04:47.544236 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m16:04:47.800217 [error] [MainThread]: Encountered an error:
Compilation Error in test main (tests\main.sql)
  invalid syntax for function call expression
    line 1
      {{ config(
[0m16:04:47.801235 [debug] [MainThread]: Command `dbt test` failed at 16:04:47.801235 after 1.34 seconds
[0m16:04:47.802239 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FB8B7F2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA739EE90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FBA739E680>]}
[0m16:04:47.802239 [debug] [MainThread]: Flushing usage events
[0m16:05:04.837028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B228F12920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22BB06500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22BB06320>]}


============================== 16:05:04.840037 | b5961d81-e5c0-4015-a2aa-f2ac66dd8403 ==============================
[0m16:05:04.840037 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:05:04.841169 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:markets', 'send_anonymous_usage_stats': 'True'}
[0m16:05:05.542620 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b5961d81-e5c0-4015-a2aa-f2ac66dd8403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B22919BEB0>]}
[0m16:05:05.584951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b5961d81-e5c0-4015-a2aa-f2ac66dd8403', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B2289E34F0>]}
[0m16:05:05.587022 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:05:05.607343 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:05:05.836889 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:05:05.836889 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://tests\main.sql
[0m16:05:05.837892 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m16:05:06.087419 [error] [MainThread]: Encountered an error:
Compilation Error in test main (tests\main.sql)
  expected token ',', got ':'
    line 3
      meta=[rule_level: 'High']
[0m16:05:06.088423 [debug] [MainThread]: Command `dbt test` failed at 16:05:06.088423 after 1.31 seconds
[0m16:05:06.089427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B228F12920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B244ABEEC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002B244ABE5F0>]}
[0m16:05:06.089427 [debug] [MainThread]: Flushing usage events
[0m16:05:14.582695 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BFEB2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8C2A6A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8C2A6A320>]}


============================== 16:05:14.585315 | 864ad5fa-da83-469d-9d69-00c86107262a ==============================
[0m16:05:14.585315 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:05:14.586616 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:markets', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:05:15.302942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '864ad5fa-da83-469d-9d69-00c86107262a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8C013BA90>]}
[0m16:05:15.346625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '864ad5fa-da83-469d-9d69-00c86107262a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BF983520>]}
[0m16:05:15.348632 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:05:15.368889 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:05:15.603363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:05:15.603363 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://tests\main.sql
[0m16:05:15.604367 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m16:05:15.859826 [error] [MainThread]: Encountered an error:
Compilation Error in test main (tests\main.sql)
  expected token ',', got ':'
    line 3
      meta=['rule_level': 'High']
[0m16:05:15.860830 [debug] [MainThread]: Command `dbt test` failed at 16:05:15.860830 after 1.34 seconds
[0m16:05:15.861930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8BFEB2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DBA5EE30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D8DBA5E680>]}
[0m16:05:15.861930 [debug] [MainThread]: Flushing usage events
[0m16:10:06.687967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7A44428F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7A700E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7A700E230>]}


============================== 16:10:06.691233 | 562bf9ee-28b5-4584-b263-eefc9914c9e4 ==============================
[0m16:10:06.691233 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:10:06.692387 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:markets', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m16:10:07.393357 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '562bf9ee-28b5-4584-b263-eefc9914c9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7A46CBCD0>]}
[0m16:10:07.437255 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '562bf9ee-28b5-4584-b263-eefc9914c9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7A647B760>]}
[0m16:10:07.438256 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:10:07.466150 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:10:07.699062 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:10:07.700063 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://tests\main.sql
[0m16:10:07.700063 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m16:10:08.071790 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '562bf9ee-28b5-4584-b263-eefc9914c9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C01CDF60>]}
[0m16:10:08.206329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '562bf9ee-28b5-4584-b263-eefc9914c9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7BFE0EDA0>]}
[0m16:10:08.207334 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m16:10:08.207334 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '562bf9ee-28b5-4584-b263-eefc9914c9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C01D7760>]}
[0m16:10:08.209343 [info ] [MainThread]: 
[0m16:10:08.209343 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:10:08.214360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m16:10:08.227318 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m16:10:08.227318 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m16:10:08.228323 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:10:08.959830 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.732 seconds
[0m16:10:08.961943 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m16:10:09.090282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '562bf9ee-28b5-4584-b263-eefc9914c9e4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7BFE0FC70>]}
[0m16:10:09.091773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:10:09.092776 [info ] [MainThread]: 
[0m16:10:09.095794 [debug] [Thread-1 (]: Began running node test.dbt_dataops.main
[0m16:10:09.095794 [info ] [Thread-1 (]: 1 of 1 START test main ......................................................... [RUN]
[0m16:10:09.096798 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.main'
[0m16:10:09.097802 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.main
[0m16:10:09.105285 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.main"
[0m16:10:09.106731 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.main
[0m16:10:09.123263 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.main"
[0m16:10:09.125279 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.main"
[0m16:10:09.125279 [debug] [Thread-1 (]: On test.dbt_dataops.main: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.main"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    column_1
from
    dev_dwdb.marketing.markets
where
    column_1 is null
      
    ) dbt_internal_test
[0m16:10:09.126289 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:10:09.749568 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m16:10:09.756620 [debug] [Thread-1 (]: On test.dbt_dataops.main: Close
[0m16:10:09.876796 [info ] [Thread-1 (]: 1 of 1 PASS main ............................................................... [[32mPASS[0m in 0.78s]
[0m16:10:09.878300 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.main
[0m16:10:09.879353 [info ] [MainThread]: 
[0m16:10:09.879949 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:10:09.928638 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m16:10:09.934789 [debug] [MainThread]: Using snowflake connection "master"
[0m16:10:09.934789 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:10:09.935794 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:10:11.010162 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.074 seconds
[0m16:10:11.014184 [info ] [MainThread]: Test name: main
[0m16:10:11.015186 [info ] [MainThread]: Test type: singular
[0m16:10:11.016204 [info ] [MainThread]: Column name: 
[0m16:10:11.016204 [info ] [MainThread]: Rule Level: High
[0m16:10:11.017328 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m16:10:11.018350 [info ] [MainThread]: Test Full Node: SingularTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='main', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='main.sql', original_file_path='tests\\main.sql', unique_id='test.dbt_dataops.main', fqn=['dbt_dataops', 'main'], alias='main', checksum=FileHash(name='sha256', checksum='d7f9acfb30ab88a05554c03037312b58fb9860f09e65d1fc855a9e1f5ace1446'), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=['markets'], meta={'rule_level': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['markets'], description='', columns={}, meta={'rule_level': 'High'}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\tests\\main.sql', unrendered_config={'tags': ['markets'], 'meta': {'rule_level': 'High'}}, created_at=1740134407.940207, config_call_dict={'tags': ['markets'], 'meta': {'rule_level': 'High'}}, relation_name=None, raw_code='{{ config(\r\n    tags=[\'markets\'],\r\n    meta={\r\n        "rule_level": "High"\r\n    }\r\n) }}\r\n\r\nselect\r\n    column_1\r\nfrom\r\n    dev_dwdb.marketing.markets\r\nwhere\r\n    column_1 is null', language=<ModelLanguage.sql: 'sql'>, refs=[], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=[]), compiled_path='target\\compiled\\dbt_dataops\\tests\\main.sql', compiled=True, compiled_code='\n\nselect\n    column_1\nfrom\n    dev_dwdb.marketing.markets\nwhere\n    column_1 is null', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None))
[0m16:10:11.018350 [info ] [MainThread]: Test Name: main
[0m16:10:11.019354 [info ] [MainThread]: Resource Type: test
[0m16:10:11.020358 [info ] [MainThread]: Test Status: pass
[0m16:10:11.020358 [info ] [MainThread]: Execution Time: 0.7799983024597168
[0m16:10:11.021573 [info ] [MainThread]: Test Metadata: 
[0m16:10:11.021573 [info ] [MainThread]: Column Name: 
[0m16:10:11.022583 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=['markets'], meta={'rule_level': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m16:10:11.023594 [info ] [MainThread]: Original File Path: tests\main.sql
[0m16:10:11.023594 [info ] [MainThread]: Compiled SQL: 

select
    column_1
from
    dev_dwdb.marketing.markets
where
    column_1 is null
[0m16:10:11.024599 [info ] [MainThread]: References: []
[0m16:10:11.025744 [info ] [MainThread]: Sources: []
[0m16:10:11.025744 [info ] [MainThread]: ========================================================
[0m16:10:11.035342 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:10:11.040379 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:10:11.044322 [debug] [MainThread]: Using snowflake connection "master"
[0m16:10:11.045323 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          select
            md5(cast(coalesce(cast('main' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'main'::varchar(4000) as test_name,
            'main'::varchar(10000) as test_name_long,
            'singular'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            ''::varchar(10000) as model_refs,
            split_part('', '.', 1)::varchar(255) as model_schema,
            split_part('', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'High'::varchar(50) as rule_level,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7799983024597168'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'tests\main.sql'::varchar(4000) as file_test_defined,
            'select     column_1 from     dev_dwdb.marketing.markets where     column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        rule_level, test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.rule_level, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:10:11.447936 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.402 seconds
[0m16:10:11.447936 [debug] [MainThread]: Using snowflake connection "master"
[0m16:10:11.448941 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              '' as model_refs,
              'main' as test_name,
              'tests\main.sql' as test_path,
              'singular' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'main'::varchar(4000) as test_name,
            'select     column_1 from     dev_dwdb.marketing.markets where     column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:10:11.774561 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.325 seconds
[0m16:10:11.775564 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.73s]
[0m16:10:11.776640 [info ] [MainThread]: 
[0m16:10:11.776640 [debug] [MainThread]: On master: Close
[0m16:10:11.895181 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:10:11.896182 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m16:10:11.896182 [debug] [MainThread]: Connection 'test.dbt_dataops.main' was properly closed.
[0m16:10:11.896182 [info ] [MainThread]: 
[0m16:10:11.897183 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.69 seconds (3.69s).
[0m16:10:11.898237 [debug] [MainThread]: Command end result
[0m16:10:11.994716 [info ] [MainThread]: 
[0m16:10:11.995754 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:10:11.995754 [info ] [MainThread]: 
[0m16:10:11.996759 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:10:11.997768 [debug] [MainThread]: Command `dbt test` succeeded at 16:10:11.997768 after 5.37 seconds
[0m16:10:11.998788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7A44428F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C001A290>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C7C0018100>]}
[0m16:10:11.998788 [debug] [MainThread]: Flushing usage events
[0m16:11:34.627341 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355D932950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235604EA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235604EA320>]}


============================== 16:11:34.631380 | 321617a2-b15d-4a90-b17b-7a9bd54dca44 ==============================
[0m16:11:34.631380 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:11:34.631380 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:markets', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:11:35.432362 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '321617a2-b15d-4a90-b17b-7a9bd54dca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355DBBBA90>]}
[0m16:11:35.478844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '321617a2-b15d-4a90-b17b-7a9bd54dca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355D403520>]}
[0m16:11:35.479847 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:11:35.503112 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:11:35.772109 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m16:11:35.773109 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://tests\market__not_null__col1.sql
[0m16:11:35.773109 [debug] [MainThread]: Partial parsing: deleted file: dbt_dataops://tests\main.sql
[0m16:11:35.983335 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '321617a2-b15d-4a90-b17b-7a9bd54dca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002357944A7A0>]}
[0m16:11:36.119935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '321617a2-b15d-4a90-b17b-7a9bd54dca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000235792EA1A0>]}
[0m16:11:36.120997 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 841 macros
[0m16:11:36.120997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '321617a2-b15d-4a90-b17b-7a9bd54dca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023579459510>]}
[0m16:11:36.123006 [info ] [MainThread]: 
[0m16:11:36.124012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:11:36.128278 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m16:11:36.142616 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m16:11:36.142616 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m16:11:36.143623 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:11:36.827628 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.685 seconds
[0m16:11:36.828909 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m16:11:36.951104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '321617a2-b15d-4a90-b17b-7a9bd54dca44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023579186D70>]}
[0m16:11:36.952236 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:11:36.952236 [info ] [MainThread]: 
[0m16:11:36.956343 [debug] [Thread-1 (]: Began running node test.dbt_dataops.market__not_null__col1
[0m16:11:36.957343 [info ] [Thread-1 (]: 1 of 1 START test market__not_null__col1 ....................................... [RUN]
[0m16:11:36.958344 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.market__not_null__col1'
[0m16:11:36.959346 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.market__not_null__col1
[0m16:11:36.967593 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.market__not_null__col1"
[0m16:11:36.968598 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.market__not_null__col1
[0m16:11:36.984973 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.market__not_null__col1"
[0m16:11:36.986059 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.market__not_null__col1"
[0m16:11:36.986059 [debug] [Thread-1 (]: On test.dbt_dataops.market__not_null__col1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.market__not_null__col1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    column_1
from
    dev_dwdb.marketing.markets
where
    column_1 is null
      
    ) dbt_internal_test
[0m16:11:36.987075 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:11:37.538337 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.552 seconds
[0m16:11:37.547057 [debug] [Thread-1 (]: On test.dbt_dataops.market__not_null__col1: Close
[0m16:11:37.667473 [info ] [Thread-1 (]: 1 of 1 PASS market__not_null__col1 ............................................. [[32mPASS[0m in 0.71s]
[0m16:11:37.668873 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.market__not_null__col1
[0m16:11:37.670887 [info ] [MainThread]: 
[0m16:11:37.670887 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:11:37.722491 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing'}
[0m16:11:37.727522 [debug] [MainThread]: Using snowflake connection "master"
[0m16:11:37.727522 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:11:37.728632 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:11:38.745676 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.017 seconds
[0m16:11:38.750694 [info ] [MainThread]: Test name: market__not_null__col1
[0m16:11:38.751699 [info ] [MainThread]: Test type: singular
[0m16:11:38.751699 [info ] [MainThread]: Column name: 
[0m16:11:38.752703 [info ] [MainThread]: Rule Level: High
[0m16:11:38.753736 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m16:11:38.753736 [info ] [MainThread]: Test Full Node: SingularTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='market__not_null__col1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='market__not_null__col1.sql', original_file_path='tests\\market__not_null__col1.sql', unique_id='test.dbt_dataops.market__not_null__col1', fqn=['dbt_dataops', 'market__not_null__col1'], alias='market__not_null__col1', checksum=FileHash(name='sha256', checksum='e5b39f8a8d65755c2538a5c804be2eb284499c18aa8ca3422c6bcf9ded104ef0'), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=['markets'], meta={'rule_level': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['markets'], description='', columns={}, meta={'rule_level': 'High'}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\tests\\market__not_null__col1.sql', unrendered_config={'tags': ['markets'], 'meta': {'rule_level': 'High'}}, created_at=1740134495.8878775, config_call_dict={'tags': ['markets'], 'meta': {'rule_level': 'High'}}, relation_name=None, raw_code='{{ config(\r\n    tags=[\'markets\'],\r\n    meta={\r\n        "rule_level": "High"\r\n    }\r\n) }}\r\n\r\nselect\r\n    column_1\r\nfrom\r\n    {{ref(\'markets\')}}\r\nwhere\r\n    column_1 is null', language=<ModelLanguage.sql: 'sql'>, refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\tests\\market__not_null__col1.sql', compiled=True, compiled_code='\n\nselect\n    column_1\nfrom\n    dev_dwdb.marketing.markets\nwhere\n    column_1 is null', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None))
[0m16:11:38.755076 [info ] [MainThread]: Test Name: market__not_null__col1
[0m16:11:38.756082 [info ] [MainThread]: Resource Type: test
[0m16:11:38.756082 [info ] [MainThread]: Test Status: pass
[0m16:11:38.757087 [info ] [MainThread]: Execution Time: 0.7091286182403564
[0m16:11:38.757087 [info ] [MainThread]: Test Metadata: 
[0m16:11:38.758100 [info ] [MainThread]: Column Name: 
[0m16:11:38.759127 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=['markets'], meta={'rule_level': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m16:11:38.759127 [info ] [MainThread]: Original File Path: tests\market__not_null__col1.sql
[0m16:11:38.760395 [info ] [MainThread]: Compiled SQL: 

select
    column_1
from
    dev_dwdb.marketing.markets
where
    column_1 is null
[0m16:11:38.761444 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m16:11:38.761444 [info ] [MainThread]: Sources: []
[0m16:11:38.762452 [info ] [MainThread]: ========================================================
[0m16:11:38.771965 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:11:38.776984 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:11:38.781241 [debug] [MainThread]: Using snowflake connection "master"
[0m16:11:38.782260 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          select
            md5(cast(coalesce(cast('market__not_null__col1' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'market__not_null__col1'::varchar(4000) as test_name,
            'market__not_null__col1'::varchar(10000) as test_name_long,
            'singular'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'High'::varchar(50) as rule_level,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7091286182403564'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'tests\market__not_null__col1.sql'::varchar(4000) as file_test_defined,
            'select     column_1 from     dev_dwdb.marketing.markets where     column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        rule_level, test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.rule_level, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:11:39.175604 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.393 seconds
[0m16:11:39.175604 [debug] [MainThread]: Using snowflake connection "master"
[0m16:11:39.176608 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'market__not_null__col1' as test_name,
              'tests\market__not_null__col1.sql' as test_path,
              'singular' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'market__not_null__col1'::varchar(4000) as test_name,
            'select     column_1 from     dev_dwdb.marketing.markets where     column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:11:39.479336 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.302 seconds
[0m16:11:39.480347 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.70s]
[0m16:11:39.481398 [info ] [MainThread]: 
[0m16:11:39.481398 [debug] [MainThread]: On master: Close
[0m16:11:39.596161 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:11:39.597161 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m16:11:39.597161 [debug] [MainThread]: Connection 'test.dbt_dataops.market__not_null__col1' was properly closed.
[0m16:11:39.598162 [info ] [MainThread]: 
[0m16:11:39.598162 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.48 seconds (3.48s).
[0m16:11:39.599373 [debug] [MainThread]: Command end result
[0m16:11:39.636172 [info ] [MainThread]: 
[0m16:11:39.637175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:11:39.637175 [info ] [MainThread]: 
[0m16:11:39.638181 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:11:39.639342 [debug] [MainThread]: Command `dbt test` succeeded at 16:11:39.639342 after 5.08 seconds
[0m16:11:39.640419 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355D932950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355D403520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002355F90ED10>]}
[0m16:11:39.640419 [debug] [MainThread]: Flushing usage events
[0m16:12:32.855932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF3D9E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF695E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF695E320>]}


============================== 16:12:32.859310 | 4d505411-b44a-4226-ac98-7d970f122129 ==============================
[0m16:12:32.859310 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:12:32.859310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:markets', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:12:33.565906 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4d505411-b44a-4226-ac98-7d970f122129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF402BEB0>]}
[0m16:12:33.611430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4d505411-b44a-4226-ac98-7d970f122129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF38734F0>]}
[0m16:12:33.612432 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:12:33.634178 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:12:33.886743 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:12:33.887745 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://tests\market__not_null__col1.sql
[0m16:12:34.025443 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_dataops.market__not_null__col1' (tests\market__not_null__col1.sql) depends on a source named 'marketing.fact_orders' in package '' which was not found
[0m16:12:34.097248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4d505411-b44a-4226-ac98-7d970f122129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D8F95E800>]}
[0m16:12:34.227022 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4d505411-b44a-4226-ac98-7d970f122129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D8F7FA890>]}
[0m16:12:34.228023 [info ] [MainThread]: Found 3 models, 1 operation, 6 data tests, 841 macros
[0m16:12:34.228023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4d505411-b44a-4226-ac98-7d970f122129', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D8F9654B0>]}
[0m16:12:34.229274 [info ] [MainThread]: 
[0m16:12:34.229274 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:12:34.230724 [debug] [MainThread]: Command end result
[0m16:12:34.266972 [debug] [MainThread]: Command `dbt test` succeeded at 16:12:34.266972 after 1.47 seconds
[0m16:12:34.267484 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF3D9E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023DF5DA2830>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D8F469960>]}
[0m16:12:34.268506 [debug] [MainThread]: Flushing usage events
[0m16:14:33.815725 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A6F028F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A9ABE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A9ABE230>]}


============================== 16:14:33.818738 | 3b3ab6e6-d59f-4126-a87a-615bfb1cb659 ==============================
[0m16:14:33.818738 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:14:33.819742 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:markets', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:14:34.550452 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3b3ab6e6-d59f-4126-a87a-615bfb1cb659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A718BCD0>]}
[0m16:14:34.594004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3b3ab6e6-d59f-4126-a87a-615bfb1cb659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A8F3B760>]}
[0m16:14:34.595012 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:14:34.616848 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:14:34.876180 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m16:14:34.876180 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://models\example\source.yml
[0m16:14:34.877183 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://tests\market__not_null__col1.sql
[0m16:14:35.088214 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.dbt_dataops.market__not_null__col1' (tests\market__not_null__col1.sql) depends on a source named 'marketing.fact_orders' in package '' which was not found
[0m16:14:35.173674 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3b3ab6e6-d59f-4126-a87a-615bfb1cb659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2B559C0>]}
[0m16:14:35.325487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3b3ab6e6-d59f-4126-a87a-615bfb1cb659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C28C00D0>]}
[0m16:14:35.325487 [info ] [MainThread]: Found 3 models, 1 operation, 6 data tests, 2 sources, 841 macros
[0m16:14:35.326491 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3b3ab6e6-d59f-4126-a87a-615bfb1cb659', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C27021A0>]}
[0m16:14:35.327607 [info ] [MainThread]: 
[0m16:14:35.328614 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:14:35.328614 [debug] [MainThread]: Command end result
[0m16:14:35.363995 [debug] [MainThread]: Command `dbt test` succeeded at 16:14:35.363995 after 1.61 seconds
[0m16:14:35.365002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A6F028F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3A8F3B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D3C2943220>]}
[0m16:14:35.365002 [debug] [MainThread]: Flushing usage events
[0m16:14:39.110237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E386E7A9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E389A3A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E389A3A350>]}


============================== 16:14:39.113251 | 92bec938-fc10-4eb0-add3-08dd06f7086b ==============================
[0m16:14:39.113251 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:14:39.114258 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:markets', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:14:39.827142 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '92bec938-fc10-4eb0-add3-08dd06f7086b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E387107970>]}
[0m16:14:39.870129 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '92bec938-fc10-4eb0-add3-08dd06f7086b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E388EBB820>]}
[0m16:14:39.871130 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:14:39.891772 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:14:40.149715 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:14:40.149715 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://tests\market__not_null__col1.sql
[0m16:14:40.371554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '92bec938-fc10-4eb0-add3-08dd06f7086b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A29A0130>]}
[0m16:14:40.514371 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '92bec938-fc10-4eb0-add3-08dd06f7086b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A2845E70>]}
[0m16:14:40.514371 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 2 sources, 841 macros
[0m16:14:40.515376 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92bec938-fc10-4eb0-add3-08dd06f7086b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A294EF20>]}
[0m16:14:40.516565 [info ] [MainThread]: 
[0m16:14:40.517571 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:14:40.521584 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m16:14:40.535342 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m16:14:40.536346 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m16:14:40.536346 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:14:41.192427 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.656 seconds
[0m16:14:41.193438 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m16:14:41.314716 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '92bec938-fc10-4eb0-add3-08dd06f7086b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E3A299F3D0>]}
[0m16:14:41.315719 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:14:41.315719 [info ] [MainThread]: 
[0m16:14:41.320013 [debug] [Thread-1 (]: Began running node test.dbt_dataops.market__not_null__col1
[0m16:14:41.320013 [info ] [Thread-1 (]: 1 of 1 START test market__not_null__col1 ....................................... [RUN]
[0m16:14:41.321056 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.market__not_null__col1'
[0m16:14:41.322162 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.market__not_null__col1
[0m16:14:41.328195 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.market__not_null__col1"
[0m16:14:41.329199 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.market__not_null__col1
[0m16:14:41.347153 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.market__not_null__col1"
[0m16:14:41.348158 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.market__not_null__col1"
[0m16:14:41.348158 [debug] [Thread-1 (]: On test.dbt_dataops.market__not_null__col1: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.market__not_null__col1"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      

select
    column_1
from
    dev_dwdb.marketing.fact_sales
where
    column_1 is null
      
    ) dbt_internal_test
[0m16:14:41.349168 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:14:41.917780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m16:14:41.923821 [debug] [Thread-1 (]: On test.dbt_dataops.market__not_null__col1: Close
[0m16:14:42.043860 [info ] [Thread-1 (]: 1 of 1 PASS market__not_null__col1 ............................................. [[32mPASS[0m in 0.72s]
[0m16:14:42.044875 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.market__not_null__col1
[0m16:14:42.045880 [info ] [MainThread]: 
[0m16:14:42.046992 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:14:42.096309 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing', 'customers': 'marketing'}
[0m16:14:42.102357 [debug] [MainThread]: Using snowflake connection "master"
[0m16:14:42.102357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:14:42.103360 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:14:43.071714 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.968 seconds
[0m16:14:43.075727 [info ] [MainThread]: Test name: market__not_null__col1
[0m16:14:43.076733 [info ] [MainThread]: Test type: singular
[0m16:14:43.077835 [info ] [MainThread]: Column name: 
[0m16:14:43.077835 [info ] [MainThread]: Rule Level: High
[0m16:14:43.078839 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m16:14:43.079847 [info ] [MainThread]: Test Full Node: SingularTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='market__not_null__col1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='market__not_null__col1.sql', original_file_path='tests\\market__not_null__col1.sql', unique_id='test.dbt_dataops.market__not_null__col1', fqn=['dbt_dataops', 'market__not_null__col1'], alias='market__not_null__col1', checksum=FileHash(name='sha256', checksum='685a903dc6e1bae2842f2a4f3333da2929891f3819cbf5d8c4e43165485e33d9'), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=['markets'], meta={'rule_level': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=['markets'], description='', columns={}, meta={'rule_level': 'High'}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\tests\\market__not_null__col1.sql', unrendered_config={'tags': ['markets'], 'meta': {'rule_level': 'High'}}, created_at=1740134680.2648203, config_call_dict={'tags': ['markets'], 'meta': {'rule_level': 'High'}}, relation_name=None, raw_code='{{ config(\r\n    tags=[\'markets\'],\r\n    meta={\r\n        "rule_level": "High"\r\n    }\r\n) }}\r\n\r\nselect\r\n    column_1\r\nfrom\r\n    {{ source(\'marketing\',\'fact_sales\') }}\r\nwhere\r\n    column_1 is null', language=<ModelLanguage.sql: 'sql'>, refs=[], sources=[['marketing', 'fact_sales']], metrics=[], depends_on=DependsOn(macros=['macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['source.dbt_dataops.marketing.fact_sales']), compiled_path='target\\compiled\\dbt_dataops\\tests\\market__not_null__col1.sql', compiled=True, compiled_code='\n\nselect\n    column_1\nfrom\n    dev_dwdb.marketing.fact_sales\nwhere\n    column_1 is null', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None))
[0m16:14:43.080852 [info ] [MainThread]: Test Name: market__not_null__col1
[0m16:14:43.080852 [info ] [MainThread]: Resource Type: test
[0m16:14:43.081857 [info ] [MainThread]: Test Status: pass
[0m16:14:43.081857 [info ] [MainThread]: Execution Time: 0.722804069519043
[0m16:14:43.082860 [info ] [MainThread]: Test Metadata: 
[0m16:14:43.082860 [info ] [MainThread]: Column Name: 
[0m16:14:43.083882 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=['markets'], meta={'rule_level': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m16:14:43.084887 [info ] [MainThread]: Original File Path: tests\market__not_null__col1.sql
[0m16:14:43.084887 [info ] [MainThread]: Compiled SQL: 

select
    column_1
from
    dev_dwdb.marketing.fact_sales
where
    column_1 is null
[0m16:14:43.085891 [info ] [MainThread]: References: []
[0m16:14:43.085891 [info ] [MainThread]: Sources: [['marketing', 'fact_sales']]
[0m16:14:43.086903 [info ] [MainThread]: ========================================================
[0m16:14:43.096104 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:14:43.100307 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:14:43.103333 [debug] [MainThread]: Using snowflake connection "master"
[0m16:14:43.104336 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          select
            md5(cast(coalesce(cast('market__not_null__col1' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'market__not_null__col1'::varchar(4000) as test_name,
            'market__not_null__col1'::varchar(10000) as test_name_long,
            'singular'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            ''::varchar(1000) as column_details,
            ''::varchar(10000) as model_refs,
            split_part('', '.', 1)::varchar(255) as model_schema,
            split_part('', '.', 2)::varchar(255) as model_table,
            'marketing.fact_sales'::varchar(10000) as source_refs,
            'High'::varchar(50) as rule_level,
            'ERROR'::varchar(250) as test_severity_config,
            '0.722804069519043'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'tests\market__not_null__col1.sql'::varchar(4000) as file_test_defined,
            'select     column_1 from     dev_dwdb.marketing.fact_sales where     column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        rule_level, test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.rule_level, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:14:43.531972 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.427 seconds
[0m16:14:43.531972 [debug] [MainThread]: Using snowflake connection "master"
[0m16:14:43.532978 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              '' as model_refs,
              'market__not_null__col1' as test_name,
              'tests\market__not_null__col1.sql' as test_path,
              'singular' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'market__not_null__col1'::varchar(4000) as test_name,
            'select     column_1 from     dev_dwdb.marketing.fact_sales where     column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:14:43.827682 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.294 seconds
[0m16:14:43.828698 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.73s]
[0m16:14:43.829705 [info ] [MainThread]: 
[0m16:14:43.830708 [debug] [MainThread]: On master: Close
[0m16:14:43.943900 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:14:43.945052 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m16:14:43.945052 [debug] [MainThread]: Connection 'test.dbt_dataops.market__not_null__col1' was properly closed.
[0m16:14:43.946056 [info ] [MainThread]: 
[0m16:14:43.946056 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.43 seconds (3.43s).
[0m16:14:43.947059 [debug] [MainThread]: Command end result
[0m16:14:43.985795 [info ] [MainThread]: 
[0m16:14:43.986800 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:14:43.987804 [info ] [MainThread]: 
[0m16:14:43.987804 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:14:43.988816 [debug] [MainThread]: Command `dbt test` succeeded at 16:14:43.988816 after 4.94 seconds
[0m16:14:43.989820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E386E7A9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E389371780>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E387794B20>]}
[0m16:14:43.989820 [debug] [MainThread]: Flushing usage events
[0m16:16:05.635155 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A27D43E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A27FFCA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A27FFCA2F0>]}


============================== 16:16:05.638177 | 1ab90fd9-82f4-4b2a-9bd7-0706959e4438 ==============================
[0m16:16:05.638177 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:16:05.638177 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:markets', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:16:06.347613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ab90fd9-82f4-4b2a-9bd7-0706959e4438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A21890A020>]}
[0m16:16:06.392891 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ab90fd9-82f4-4b2a-9bd7-0706959e4438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A27DCEA2C0>]}
[0m16:16:06.393896 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:16:06.415152 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:16:06.672685 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m16:16:06.672685 [debug] [MainThread]: Partial parsing: deleted file: dbt_dataops://tests\market__not_null__col1.sql
[0m16:16:06.809708 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ab90fd9-82f4-4b2a-9bd7-0706959e4438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2189310F0>]}
[0m16:16:06.940894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ab90fd9-82f4-4b2a-9bd7-0706959e4438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A218E09FF0>]}
[0m16:16:06.941917 [info ] [MainThread]: Found 3 models, 1 operation, 6 data tests, 2 sources, 841 macros
[0m16:16:06.941917 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ab90fd9-82f4-4b2a-9bd7-0706959e4438', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A2189D1000>]}
[0m16:16:06.943954 [info ] [MainThread]: 
[0m16:16:06.943954 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:16:06.945964 [debug] [MainThread]: Command end result
[0m16:16:06.979702 [debug] [MainThread]: Command `dbt test` succeeded at 16:16:06.979702 after 1.40 seconds
[0m16:16:06.980707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A27D43E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A218A03160>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A27F414C70>]}
[0m16:16:06.980707 [debug] [MainThread]: Flushing usage events
[0m16:16:24.686323 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3DFF6E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E2B664D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E2B662F0>]}


============================== 16:16:24.689739 | 22dba216-85f9-4554-8242-a27c837fe13f ==============================
[0m16:16:24.689739 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:16:24.690762 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:markets', 'send_anonymous_usage_stats': 'True'}
[0m16:16:25.408133 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '22dba216-85f9-4554-8242-a27c837fe13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3FB43A020>]}
[0m16:16:25.455960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '22dba216-85f9-4554-8242-a27c837fe13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3E0833730>]}
[0m16:16:25.457969 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:16:25.480952 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:16:25.737863 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:16:25.738864 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m16:16:26.110428 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '22dba216-85f9-4554-8242-a27c837fe13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3FBCA8130>]}
[0m16:16:26.241260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '22dba216-85f9-4554-8242-a27c837fe13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3FB708970>]}
[0m16:16:26.241260 [info ] [MainThread]: Found 3 models, 1 operation, 7 data tests, 2 sources, 841 macros
[0m16:16:26.241260 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22dba216-85f9-4554-8242-a27c837fe13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3FBCB34F0>]}
[0m16:16:26.243763 [info ] [MainThread]: 
[0m16:16:26.244782 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m16:16:26.249226 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_marketing'
[0m16:16:26.261511 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_marketing"
[0m16:16:26.261511 [debug] [ThreadPool]: On list_dev_dwdb_marketing: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_marketing"} */
show objects in dev_dwdb.marketing limit 10000
[0m16:16:26.262527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m16:16:26.900617 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 0.638 seconds
[0m16:16:26.901632 [debug] [ThreadPool]: On list_dev_dwdb_marketing: Close
[0m16:16:27.019229 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '22dba216-85f9-4554-8242-a27c837fe13f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3FB70B760>]}
[0m16:16:27.020238 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m16:16:27.021247 [info ] [MainThread]: 
[0m16:16:27.024409 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m16:16:27.025413 [info ] [Thread-1 (]: 1 of 1 START test not_null_markets_column_1 .................................... [RUN]
[0m16:16:27.025413 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c'
[0m16:16:27.026418 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m16:16:27.039725 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m16:16:27.040729 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m16:16:27.056062 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m16:16:27.058076 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_markets_column_1.e080da476c"
[0m16:16:27.058076 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_markets_column_1.e080da476c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



      
    ) dbt_internal_test
[0m16:16:27.059082 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m16:16:27.608412 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m16:16:27.616078 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_markets_column_1.e080da476c: Close
[0m16:16:27.737231 [info ] [Thread-1 (]: 1 of 1 PASS not_null_markets_column_1 .......................................... [[32mPASS[0m in 0.71s]
[0m16:16:27.738235 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_markets_column_1.e080da476c
[0m16:16:27.740244 [info ] [MainThread]: 
[0m16:16:27.740244 [info ] [MainThread]: Running 1 on-run-end hook
[0m16:16:27.790050 [info ] [MainThread]: {'fact_orders': 'marketing', 'fact_sales': 'marketing', 'markets': 'marketing', 'customers': 'marketing'}
[0m16:16:27.795784 [debug] [MainThread]: Using snowflake connection "master"
[0m16:16:27.795784 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m16:16:27.796868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m16:16:28.777667 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.980 seconds
[0m16:16:28.781680 [info ] [MainThread]: Test name: not_null
[0m16:16:28.782688 [info ] [MainThread]: Test type: generic
[0m16:16:28.783706 [info ] [MainThread]: Column name: column_1
[0m16:16:28.783706 [info ] [MainThread]: Rule Level: High
[0m16:16:28.784711 [info ] [MainThread]: =================== Test Result Debug Info ===================
[0m16:16:28.784711 [info ] [MainThread]: Test Full Node: GenericTestNode(database='dev_dwdb', schema='marketing_dbt_test__audit', name='not_null_markets_column_1', resource_type=<NodeType.Test: 'test'>, package_name='dbt_dataops', path='not_null_markets_column_1.sql', original_file_path='models\\example\\markets.yml', unique_id='test.dbt_dataops.not_null_markets_column_1.e080da476c', fqn=['dbt_dataops', 'example', 'not_null_markets_column_1'], alias='not_null_markets_column_1', checksum=FileHash(name='none', checksum=''), config=TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={'rule_level': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0'), _event_status={}, tags=[], description='', columns={}, meta={'rule_level': 'High'}, group=None, docs=Docs(show=True, node_color=None), patch_path=None, build_path='target\\run\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', unrendered_config={'meta': {'rule_level': 'High'}}, created_at=1740134786.0282357, config_call_dict={'meta': {'rule_level': 'High'}}, relation_name=None, raw_code="{{ test_not_null(**_dbt_generic_test_kwargs) }}{{ config(meta={'rule_level': 'High'}) }}", language='sql', refs=[RefArgs(name='markets', package=None, version=None)], sources=[], metrics=[], depends_on=DependsOn(macros=['macro.dbt.test_not_null', 'macro.dbt.get_where_subquery', 'macro.dbt_snowflake.set_query_tag', 'macro.dbt.materialization_test_default', 'macro.dbt_snowflake.unset_query_tag'], nodes=['model.dbt_dataops.markets']), compiled_path='target\\compiled\\dbt_dataops\\models\\example\\markets.yml\\not_null_markets_column_1.sql', compiled=True, compiled_code='\n    \n    \n\n\n\nselect column_1\nfrom dev_dwdb.marketing.markets\nwhere column_1 is null\n\n\n', extra_ctes_injected=True, extra_ctes=[], _pre_injected_sql=None, contract=Contract(enforced=False, alias_types=True, checksum=None), column_name='column_1', file_key_name='models.markets', attached_node='model.dbt_dataops.markets', test_metadata=TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None))
[0m16:16:28.785715 [info ] [MainThread]: Test Name: not_null_markets_column_1
[0m16:16:28.786717 [info ] [MainThread]: Resource Type: test
[0m16:16:28.786717 [info ] [MainThread]: Test Status: pass
[0m16:16:28.787778 [info ] [MainThread]: Execution Time: 0.7118179798126221
[0m16:16:28.788783 [info ] [MainThread]: Test Metadata: TestMetadata(name='not_null', kwargs={'column_name': 'column_1', 'model': "{{ get_where_subquery(ref('markets')) }}"}, namespace=None)
[0m16:16:28.788783 [info ] [MainThread]: Column Name: column_1
[0m16:16:28.789935 [info ] [MainThread]: Config: TestConfig(_extra={}, enabled=True, alias=None, schema='dbt_test__audit', database=None, tags=[], meta={'rule_level': 'High'}, group=None, materialized='test', severity='ERROR', store_failures=None, store_failures_as=None, where=None, limit=None, fail_calc='count(*)', warn_if='!= 0', error_if='!= 0')
[0m16:16:28.789935 [info ] [MainThread]: Original File Path: models\example\markets.yml
[0m16:16:28.790938 [info ] [MainThread]: Compiled SQL: 
    
    



select column_1
from dev_dwdb.marketing.markets
where column_1 is null



[0m16:16:28.790938 [info ] [MainThread]: References: [RefArgs(name='markets', package=None, version=None)]
[0m16:16:28.791952 [info ] [MainThread]: Sources: []
[0m16:16:28.792955 [info ] [MainThread]: ========================================================
[0m16:16:28.802101 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m16:16:28.806296 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m16:16:28.810375 [debug] [MainThread]: Using snowflake connection "master"
[0m16:16:28.810375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (
          
          
          

          
          

          
          
          
          
          
          
          
          
          
          
          
          
          
          
          

          select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_markets_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'column'::varchar(50) as test_level,
            'column_1'::varchar(1000) as column_details,
            'marketing.markets'::varchar(10000) as model_refs,
            split_part('marketing.markets', '.', 1)::varchar(255) as model_schema,
            split_part('marketing.markets', '.', 2)::varchar(255) as model_table,
            ''::varchar(10000) as source_refs,
            'High'::varchar(50) as rule_level,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7118179798126221'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\markets.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, test_level, 
        column_details, model_refs, model_schema, model_table, source_refs,
        rule_level, test_severity_config, execution_time_seconds, test_result, 
        file_test_defined, compiled_sql, TIMESTAMP, is_active, 
        deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.test_level, source.column_details,
        source.model_refs, source.model_schema, source.model_table,
        source.source_refs, source.rule_level, source.test_severity_config,
        source.execution_time_seconds, source.test_result, 
        source.file_test_defined, source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m16:16:29.310466 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.499 seconds
[0m16:16:29.310466 [debug] [MainThread]: Using snowflake connection "master"
[0m16:16:29.311482 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models and tests being tested
    

    -- Enhanced deactivation logic with better singular test handling
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and (
      exists (
        select 1 
        from (
      select distinct 
        model_name,
        test_name,
        test_path,
        test_type
      from (
        with current_models as (select 
              'marketing.markets' as model_refs,
              'not_null_markets_column_1' as test_name,
              'models\example\markets.yml' as test_path,
              'generic' as test_type
            )
        select 
          value::varchar as model_name,
          test_name,
          test_path,
          test_type
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
    ) as cm
        where (
          -- For generic tests, check model references
          (dqm.dq_dbt_test_results_central.test_type = 'generic' 
           and dqm.dq_dbt_test_results_central.model_refs like '%' || cm.model_name || '%')
          -- For singular tests, check test name and path
          or (dqm.dq_dbt_test_results_central.test_type = 'singular' 
              and dqm.dq_dbt_test_results_central.test_name = cm.test_name
              and dqm.dq_dbt_test_results_central.file_test_defined = cm.test_path)
        )
      )
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.marketing.markets where column_1 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m16:16:29.584548 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.272 seconds
[0m16:16:29.585553 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.78s]
[0m16:16:29.585553 [info ] [MainThread]: 
[0m16:16:29.586567 [debug] [MainThread]: On master: Close
[0m16:16:29.698255 [debug] [MainThread]: Connection 'master' was properly closed.
[0m16:16:29.699274 [debug] [MainThread]: Connection 'list_dev_dwdb_marketing' was properly closed.
[0m16:16:29.699274 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_markets_column_1.e080da476c' was properly closed.
[0m16:16:29.699274 [info ] [MainThread]: 
[0m16:16:29.700395 [info ] [MainThread]: Finished running 1 test, 1 project hook in 0 hours 0 minutes and 3.46 seconds (3.46s).
[0m16:16:29.701393 [debug] [MainThread]: Command end result
[0m16:16:29.803970 [info ] [MainThread]: 
[0m16:16:29.803970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m16:16:29.804974 [info ] [MainThread]: 
[0m16:16:29.805977 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m16:16:29.807028 [debug] [MainThread]: Command `dbt test` succeeded at 16:16:29.807028 after 5.18 seconds
[0m16:16:29.807028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3DFF6E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3FBCB77F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B3FBBF5960>]}
[0m16:16:29.808032 [debug] [MainThread]: Flushing usage events
[0m16:16:40.807070 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219899DE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198C59A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198C59A230>]}


============================== 16:16:40.810179 | aa49b747-d741-45be-9fb0-5baf2dfe79ad ==============================
[0m16:16:40.810179 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:16:40.811213 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:markets\\', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m16:16:41.568534 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aa49b747-d741-45be-9fb0-5baf2dfe79ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021989C6BCD0>]}
[0m16:16:41.613944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aa49b747-d741-45be-9fb0-5baf2dfe79ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198BA1B760>]}
[0m16:16:41.615951 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:16:41.635172 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:16:41.885195 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m16:16:41.886204 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\markets.yml
[0m16:16:42.195835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aa49b747-d741-45be-9fb0-5baf2dfe79ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A5631AB0>]}
[0m16:16:42.325735 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aa49b747-d741-45be-9fb0-5baf2dfe79ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A5173040>]}
[0m16:16:42.326740 [info ] [MainThread]: Found 3 models, 1 operation, 6 data tests, 2 sources, 841 macros
[0m16:16:42.327751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aa49b747-d741-45be-9fb0-5baf2dfe79ad', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219A5663AF0>]}
[0m16:16:42.327751 [warn ] [MainThread]: The selection criterion 'tag:markets\' does not match any enabled nodes
[0m16:16:42.329986 [info ] [MainThread]: 
[0m16:16:42.329986 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:16:42.330989 [debug] [MainThread]: Command end result
[0m16:16:42.365237 [debug] [MainThread]: Command `dbt test` succeeded at 16:16:42.365237 after 1.62 seconds
[0m16:16:42.365237 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219899DE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198B9E0B50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002198BF92560>]}
[0m16:16:42.366316 [debug] [MainThread]: Flushing usage events
[0m16:16:46.075567 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F950DA2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95395E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F95395E2F0>]}


============================== 16:16:46.079023 | 455e0c1a-be3f-4081-b8f1-fa1e2b99c006 ==============================
[0m16:16:46.079023 [info ] [MainThread]: Running with dbt=1.8.7
[0m16:16:46.080219 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:markets', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m16:16:46.787793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '455e0c1a-be3f-4081-b8f1-fa1e2b99c006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F96C26A020>]}
[0m16:16:46.831802 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '455e0c1a-be3f-4081-b8f1-fa1e2b99c006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F951663730>]}
[0m16:16:46.832806 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m16:16:46.853317 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m16:16:47.097808 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m16:16:47.097808 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m16:16:47.191826 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '455e0c1a-be3f-4081-b8f1-fa1e2b99c006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F953353160>]}
[0m16:16:47.323101 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '455e0c1a-be3f-4081-b8f1-fa1e2b99c006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F96C2931F0>]}
[0m16:16:47.324106 [info ] [MainThread]: Found 3 models, 1 operation, 6 data tests, 2 sources, 841 macros
[0m16:16:47.324106 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '455e0c1a-be3f-4081-b8f1-fa1e2b99c006', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F96C2C7D30>]}
[0m16:16:47.326153 [info ] [MainThread]: 
[0m16:16:47.326153 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m16:16:47.328591 [debug] [MainThread]: Command end result
[0m16:16:47.364472 [debug] [MainThread]: Command `dbt test` succeeded at 16:16:47.363385 after 1.35 seconds
[0m16:16:47.364472 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F950DA2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F951663730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F953C12140>]}
[0m16:16:47.365478 [debug] [MainThread]: Flushing usage events
