[0m21:27:31.287927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CD112980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CFC9E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CFC9E320>]}


============================== 21:27:31.291832 | 05d76bcb-74bc-4e22-8330-c10ba6f07c62 ==============================
[0m21:27:31.291832 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:27:31.291832 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m21:27:32.074572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CD397DC0>]}
[0m21:27:32.120712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CF6C6E00>]}
[0m21:27:32.122854 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:27:32.155800 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:27:32.156306 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m21:27:32.157319 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274E86E3250>]}
[0m21:27:34.264920 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274E8BE2CE0>]}
[0m21:27:34.391276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274E8B89A50>]}
[0m21:27:34.392322 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 840 macros
[0m21:27:34.392322 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274E8BDB7F0>]}
[0m21:27:34.394445 [info ] [MainThread]: 
[0m21:27:34.394445 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:27:34.399327 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:27:34.413769 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:27:34.413769 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:27:34.413769 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:27:35.133337 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.719 seconds
[0m21:27:35.135495 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:27:35.262232 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '05d76bcb-74bc-4e22-8330-c10ba6f07c62', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274E8CB1E40>]}
[0m21:27:35.263233 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:27:35.264234 [info ] [MainThread]: 
[0m21:27:35.266444 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:27:35.267796 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:27:35.267796 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:27:35.268801 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:27:35.268801 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:27:35.269818 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:27:35.270819 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:27:35.270819 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:27:35.286628 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:27:35.292323 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:27:35.294826 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:27:35.295839 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:27:35.314175 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:27:35.316221 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:27:35.318260 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:27:35.319764 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:27:35.319764 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:27:35.320786 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:27:35.320786 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:27:35.321787 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:27:35.820995 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.500 seconds
[0m21:27:35.828168 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:27:35.973900 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.70s]
[0m21:27:35.974956 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:27:36.817174 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.495 seconds
[0m21:27:36.818183 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:27:36.948084 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.68s]
[0m21:27:36.949329 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:27:36.952063 [info ] [MainThread]: 
[0m21:27:36.952063 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:27:36.956383 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:27:36.960556 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:27:36.960556 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mOK[0m in 0.00s]
[0m21:27:36.961822 [info ] [MainThread]: 
[0m21:27:36.961822 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:27:36.963173 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:27:36.964228 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:27:36.964228 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:27:36.965228 [info ] [MainThread]: 
[0m21:27:36.965228 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m21:27:36.966229 [debug] [MainThread]: Command end result
[0m21:27:37.008245 [info ] [MainThread]: 
[0m21:27:37.008245 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:27:37.009717 [info ] [MainThread]: 
[0m21:27:37.010718 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:27:37.010718 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:27:37.012074 [info ] [MainThread]: 
[0m21:27:37.012074 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:27:37.013093 [info ] [MainThread]: 
[0m21:27:37.014128 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:27:37.015382 [debug] [MainThread]: Command `dbt test` failed at 21:27:37.015382 after 5.79 seconds
[0m21:27:37.016487 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CD112980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274CF6C6E00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000274E8C7A140>]}
[0m21:27:37.017523 [debug] [MainThread]: Flushing usage events
[0m21:31:06.829671 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DBDE2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DE99A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DE99A320>]}


============================== 21:31:06.833237 | 1b28d757-bfcd-43a7-932d-83178c40b4c0 ==============================
[0m21:31:06.833237 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:31:06.834252 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:31:07.629067 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DC067DC0>]}
[0m21:31:07.676450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DE3CAE00>]}
[0m21:31:07.677482 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:31:07.700118 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:31:07.816995 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:31:07.818025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DDDBE320>]}
[0m21:31:09.335189 [info ] [MainThread]: Test run complete! Test results are available in the log.
[0m21:31:09.645602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F763EE90>]}
[0m21:31:09.776304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F77DF010>]}
[0m21:31:09.777309 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 838 macros
[0m21:31:09.778328 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F763F130>]}
[0m21:31:09.779353 [info ] [MainThread]: 
[0m21:31:09.780362 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:31:09.785318 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:31:09.798868 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:31:09.799899 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:31:09.800935 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:31:10.486296 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.686 seconds
[0m21:31:10.487799 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:31:10.644306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1b28d757-bfcd-43a7-932d-83178c40b4c0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295F75DCB20>]}
[0m21:31:10.645345 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:31:10.646357 [info ] [MainThread]: 
[0m21:31:10.649491 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:31:10.649491 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:31:10.650889 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:31:10.651948 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:31:10.651948 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:31:10.653452 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:31:10.653452 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:31:10.654501 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:31:10.669201 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:31:10.674226 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:31:10.675268 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:31:10.682012 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:31:10.692980 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:31:10.694992 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:31:10.696480 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:31:10.697502 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:31:10.697502 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:31:10.698522 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:31:10.698522 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:31:10.699543 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:31:11.283505 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m21:31:11.289986 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:31:11.407821 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.75s]
[0m21:31:11.408845 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:31:12.212650 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.512 seconds
[0m21:31:12.214162 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:31:12.334276 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.68s]
[0m21:31:12.335311 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:31:12.337357 [info ] [MainThread]: 
[0m21:31:12.337861 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:31:12.341420 [info ] [MainThread]: Test run complete! Test results are available in the log.
[0m21:31:12.341420 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:31:12.345622 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:31:12.346631 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mOK[0m in 0.00s]
[0m21:31:12.347632 [info ] [MainThread]: 
[0m21:31:12.347632 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:31:12.348661 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:31:12.348661 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:31:12.349662 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:31:12.349662 [info ] [MainThread]: 
[0m21:31:12.350799 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 2.57 seconds (2.57s).
[0m21:31:12.350799 [debug] [MainThread]: Command end result
[0m21:31:12.391722 [info ] [MainThread]: 
[0m21:31:12.391722 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:31:12.393225 [info ] [MainThread]: 
[0m21:31:12.393225 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:31:12.394518 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:31:12.395023 [info ] [MainThread]: 
[0m21:31:12.395023 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:31:12.396068 [info ] [MainThread]: 
[0m21:31:12.396068 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:31:12.397480 [debug] [MainThread]: Command `dbt test` failed at 21:31:12.397480 after 5.64 seconds
[0m21:31:12.398511 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DBDE2980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DE3CAE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000295DC654F70>]}
[0m21:31:12.398511 [debug] [MainThread]: Flushing usage events
[0m21:32:03.499033 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6EC912950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6EF4CA4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6EF4CA2C0>]}


============================== 21:32:03.502117 | ca954922-ffd4-4f16-9d85-b3e989fe23a2 ==============================
[0m21:32:03.502117 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:32:03.502117 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:32:04.233049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ca954922-ffd4-4f16-9d85-b3e989fe23a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6ECB9BA90>]}
[0m21:32:04.279356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ca954922-ffd4-4f16-9d85-b3e989fe23a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A687E097E0>]}
[0m21:32:04.280931 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:32:04.302621 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:32:04.541406 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:32:04.542417 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\display_test_results.sql
[0m21:32:04.670424 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ca954922-ffd4-4f16-9d85-b3e989fe23a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A687F020E0>]}
[0m21:32:04.791623 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ca954922-ffd4-4f16-9d85-b3e989fe23a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A687E6A9B0>]}
[0m21:32:04.792645 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 838 macros
[0m21:32:04.792645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca954922-ffd4-4f16-9d85-b3e989fe23a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A687FFE440>]}
[0m21:32:04.794147 [info ] [MainThread]: 
[0m21:32:04.795655 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:32:04.800805 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:32:04.814657 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:32:04.814657 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:32:04.815700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:32:05.511973 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.697 seconds
[0m21:32:05.514055 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:32:05.636915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ca954922-ffd4-4f16-9d85-b3e989fe23a2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6882F18A0>]}
[0m21:32:05.638420 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:32:05.639443 [info ] [MainThread]: 
[0m21:32:05.642711 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:32:05.642711 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:32:05.642711 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:32:05.643711 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:32:05.643711 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:32:05.644847 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:32:05.645880 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:32:05.645880 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:32:05.661959 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:32:05.668064 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:32:05.669436 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:32:05.669436 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:32:05.685520 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:32:05.688051 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:32:05.689554 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:32:05.689554 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:32:05.689554 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:32:05.690893 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:32:05.690893 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:32:05.692953 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:32:06.275867 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m21:32:06.284885 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:32:06.406225 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m21:32:06.407275 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:32:07.763837 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.071 seconds
[0m21:32:07.765402 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:32:07.888956 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.24s]
[0m21:32:07.889973 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:32:07.890985 [info ] [MainThread]: 
[0m21:32:07.892164 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:32:07.897419 [debug] [MainThread]: Using snowflake connection "master"
[0m21:32:07.898497 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
SELECT COUNT(*) as count FROM some_table
[0m21:32:07.898497 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:32:08.489827 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8002-3201-72d3-000b-f69200018046
[0m21:32:08.490900 [debug] [MainThread]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'SOME_TABLE' does not exist or not authorized.
[0m21:32:08.493040 [info ] [MainThread]: Database error while running on-run-end
[0m21:32:08.493040 [debug] [MainThread]: On master: Close
[0m21:32:08.611739 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:32:08.612794 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:32:08.612794 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:32:08.612794 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:32:08.613795 [info ] [MainThread]: 
[0m21:32:08.613795 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.82 seconds (3.82s).
[0m21:32:08.614819 [debug] [MainThread]: Command end result
[0m21:32:08.655719 [info ] [MainThread]: 
[0m21:32:08.656822 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:32:08.657848 [info ] [MainThread]: 
[0m21:32:08.658849 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:32:08.658849 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:32:08.659850 [info ] [MainThread]: 
[0m21:32:08.660851 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:32:08.660851 [info ] [MainThread]: 
[0m21:32:08.661852 [error] [MainThread]:   on-run-end failed, error:
 002003 (42S02): SQL compilation error:
Object 'SOME_TABLE' does not exist or not authorized.
[0m21:32:08.662853 [info ] [MainThread]: 
[0m21:32:08.662853 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:32:08.664357 [debug] [MainThread]: Command `dbt test` failed at 21:32:08.664357 after 5.22 seconds
[0m21:32:08.665359 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6EC912950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A6882A6B30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A687947760>]}
[0m21:32:08.666360 [debug] [MainThread]: Flushing usage events
[0m21:33:52.168396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988773E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988A2FA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988A2FA320>]}


============================== 21:33:52.171502 | 21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9 ==============================
[0m21:33:52.171502 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:33:52.172518 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:33:52.899271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198879C7DC0>]}
[0m21:33:52.945259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019889D2AE00>]}
[0m21:33:52.946276 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:33:52.967154 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:33:53.219615 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:33:53.220629 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\display_test_results.sql
[0m21:33:53.359752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A2D5FC10>]}
[0m21:33:53.490458 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A2C6FD00>]}
[0m21:33:53.490458 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 839 macros
[0m21:33:53.491485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A30D7E50>]}
[0m21:33:53.492536 [info ] [MainThread]: 
[0m21:33:53.493548 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:33:53.498339 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:33:53.510749 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:33:53.511936 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:33:53.511936 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:33:54.147211 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.635 seconds
[0m21:33:54.148234 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:33:54.268217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '21ad45cb-5bc3-45e8-b28c-a9d29c2d89f9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A2ED0C70>]}
[0m21:33:54.269239 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:33:54.270396 [info ] [MainThread]: 
[0m21:33:54.272574 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:33:54.273595 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:33:54.273595 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:33:54.273595 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:33:54.275099 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:33:54.275099 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:33:54.276132 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:33:54.276132 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:33:54.289930 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:33:54.296107 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:33:54.297137 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:33:54.298151 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:33:54.314849 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:33:54.317928 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:33:54.318942 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:33:54.319954 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:33:54.319954 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:33:54.321090 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:33:54.321090 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:33:54.323317 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:33:54.870238 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m21:33:54.877838 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:33:55.004260 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.73s]
[0m21:33:55.006287 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:33:55.878401 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.555 seconds
[0m21:33:55.879905 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:33:56.002904 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.73s]
[0m21:33:56.003905 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:33:56.005409 [info ] [MainThread]: 
[0m21:33:56.006433 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:33:56.010556 [info ] [MainThread]: Database error while running on-run-end
[0m21:33:56.011558 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:33:56.011558 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:33:56.011558 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:33:56.012701 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:33:56.012701 [info ] [MainThread]: 
[0m21:33:56.013713 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 2.52 seconds (2.52s).
[0m21:33:56.013713 [debug] [MainThread]: Command end result
[0m21:33:56.054410 [info ] [MainThread]: 
[0m21:33:56.055423 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:33:56.055423 [info ] [MainThread]: 
[0m21:33:56.056435 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:33:56.057490 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:33:56.057490 [info ] [MainThread]: 
[0m21:33:56.058503 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:33:56.059504 [info ] [MainThread]: 
[0m21:33:56.059504 [error] [MainThread]:   on-run-end failed, error:
 'display_test_results' is undefined
[0m21:33:56.060533 [info ] [MainThread]: 
[0m21:33:56.060533 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:33:56.061534 [debug] [MainThread]: Command `dbt test` failed at 21:33:56.061534 after 3.95 seconds
[0m21:33:56.062566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001988773E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019889D2AE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000198A3566860>]}
[0m21:33:56.062566 [debug] [MainThread]: Flushing usage events
[0m21:34:23.337396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15B8CE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15E48A4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15E48A2C0>]}


============================== 21:34:23.340599 | 2b793ecb-b35c-48bf-a651-590b24829ac1 ==============================
[0m21:34:23.340599 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:34:23.341630 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m21:34:24.081893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15BB57A90>]}
[0m21:34:24.127851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C176D997E0>]}
[0m21:34:24.129896 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:34:24.153980 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:34:24.268826 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:34:24.269846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15D8ACA60>]}
[0m21:34:26.013664 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C176F54E20>]}
[0m21:34:26.134456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1770EF2B0>]}
[0m21:34:26.134456 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 839 macros
[0m21:34:26.135457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1770E26B0>]}
[0m21:34:26.136510 [info ] [MainThread]: 
[0m21:34:26.137518 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:34:26.142640 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:34:26.155717 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:34:26.155717 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:34:26.156770 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:34:26.848187 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.691 seconds
[0m21:34:26.849196 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:34:26.969905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2b793ecb-b35c-48bf-a651-590b24829ac1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C1770EF850>]}
[0m21:34:26.970922 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:34:26.970922 [info ] [MainThread]: 
[0m21:34:26.974325 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:34:26.974325 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:34:26.975828 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:34:26.975828 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:34:26.976851 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:34:26.976851 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:34:26.978004 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:34:26.978004 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:34:26.993284 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:34:26.997843 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:34:26.998861 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:34:26.999909 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:34:27.015825 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:34:27.018844 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:34:27.019845 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:34:27.020846 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:34:27.020846 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:34:27.021847 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:34:27.021847 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:34:27.023849 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:34:27.595708 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m21:34:27.603160 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:34:27.623583 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m21:34:27.625627 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:34:27.724682 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.75s]
[0m21:34:27.725682 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:34:27.743598 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.77s]
[0m21:34:27.744627 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:34:27.745629 [info ] [MainThread]: 
[0m21:34:27.747010 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:34:27.751606 [info ] [MainThread]: Database error while running on-run-end
[0m21:34:27.751606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:34:27.752609 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:34:27.752609 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:34:27.753656 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:34:27.753656 [info ] [MainThread]: 
[0m21:34:27.754790 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 1.62 seconds (1.62s).
[0m21:34:27.755791 [debug] [MainThread]: Command end result
[0m21:34:27.795099 [info ] [MainThread]: 
[0m21:34:27.796105 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:34:27.796594 [info ] [MainThread]: 
[0m21:34:27.797597 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:34:27.797597 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:34:27.798879 [info ] [MainThread]: 
[0m21:34:27.798879 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:34:27.799907 [info ] [MainThread]: 
[0m21:34:27.799907 [error] [MainThread]:   on-run-end failed, error:
 'wwe_get_node_schemas' is undefined
[0m21:34:27.800947 [info ] [MainThread]: 
[0m21:34:27.801991 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:34:27.803004 [debug] [MainThread]: Command `dbt test` failed at 21:34:27.803004 after 4.53 seconds
[0m21:34:27.803004 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15B8CE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15B3B34F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C15C1463B0>]}
[0m21:34:27.804038 [debug] [MainThread]: Flushing usage events
[0m21:35:07.475912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004C972980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004F52A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004F52A320>]}


============================== 21:35:07.479123 | b18c7274-a390-45d1-81e7-a0cbfdd696dd ==============================
[0m21:35:07.479123 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:35:07.480125 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:35:08.260615 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b18c7274-a390-45d1-81e7-a0cbfdd696dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004CBF7DC0>]}
[0m21:35:08.308241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b18c7274-a390-45d1-81e7-a0cbfdd696dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004EF5AE00>]}
[0m21:35:08.309260 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:35:08.330211 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:35:08.589536 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m21:35:08.590548 [debug] [MainThread]: Partial parsing: added file: dbt_dataops://macros\get_node_schemas.sql
[0m21:35:08.590548 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\display_test_results.sql
[0m21:35:08.740217 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b18c7274-a390-45d1-81e7-a0cbfdd696dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020067EC32B0>]}
[0m21:35:08.875868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b18c7274-a390-45d1-81e7-a0cbfdd696dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020068325090>]}
[0m21:35:08.877285 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 840 macros
[0m21:35:08.878526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b18c7274-a390-45d1-81e7-a0cbfdd696dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020067EC30D0>]}
[0m21:35:08.879569 [info ] [MainThread]: 
[0m21:35:08.880622 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:35:08.886695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:35:08.901845 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:35:08.902862 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:35:08.902862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:35:09.554966 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.651 seconds
[0m21:35:09.556470 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:35:10.237280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b18c7274-a390-45d1-81e7-a0cbfdd696dd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020068324E80>]}
[0m21:35:10.238362 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:35:10.239657 [info ] [MainThread]: 
[0m21:35:10.243137 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:35:10.244137 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:35:10.245189 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:35:10.245189 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:35:10.246209 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:35:10.247210 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:35:10.247210 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:35:10.248569 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:35:10.262562 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:35:10.268194 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:35:10.269223 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:35:10.275475 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:35:10.287271 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:35:10.290299 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:35:10.291461 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:35:10.292480 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:35:10.292480 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:35:10.293497 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:35:10.293497 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:35:10.294704 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:35:10.861547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.568 seconds
[0m21:35:10.868974 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:35:10.986078 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.74s]
[0m21:35:10.987087 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:35:12.010182 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.715 seconds
[0m21:35:12.011685 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:35:12.131491 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.88s]
[0m21:35:12.133526 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:35:12.134527 [info ] [MainThread]: 
[0m21:35:12.135584 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:35:12.151362 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:35:12.157198 [debug] [MainThread]: Using snowflake connection "master"
[0m21:35:12.158232 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:35:12.159333 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:35:13.220361 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.061 seconds
[0m21:35:13.221412 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:35:13.227441 [info ] [MainThread]: Database error while running on-run-end
[0m21:35:13.228459 [debug] [MainThread]: On master: Close
[0m21:35:13.355309 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:35:13.356309 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:35:13.356309 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:35:13.356309 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:35:13.357386 [info ] [MainThread]: 
[0m21:35:13.358401 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m21:35:13.359418 [debug] [MainThread]: Command end result
[0m21:35:13.397826 [info ] [MainThread]: 
[0m21:35:13.398862 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:35:13.400365 [info ] [MainThread]: 
[0m21:35:13.400365 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:35:13.401574 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:35:13.401574 [info ] [MainThread]: 
[0m21:35:13.402586 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:35:13.402586 [info ] [MainThread]: 
[0m21:35:13.404089 [error] [MainThread]:   on-run-end failed, error:
 Required var 'dbt_date:time_zone' not found in config:
Vars supplied to dbt_dataops-on-run-end-0 = {}
[0m21:35:13.404089 [info ] [MainThread]: 
[0m21:35:13.405112 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:35:13.406113 [debug] [MainThread]: Command `dbt test` failed at 21:35:13.406113 after 5.99 seconds
[0m21:35:13.406113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004C972980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002004E970C70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020068361330>]}
[0m21:35:13.407135 [debug] [MainThread]: Flushing usage events
[0m21:36:54.620881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022693872980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002269642E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002269642E320>]}


============================== 21:36:54.623227 | d0d01e4f-4749-4aad-89c2-0aa9c1b9508b ==============================
[0m21:36:54.623227 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:36:54.624228 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:36:55.415516 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022693AF7DC0>]}
[0m21:36:55.461263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022695E5AE00>]}
[0m21:36:55.462352 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:36:55.485119 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:36:55.604091 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m21:36:55.604091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002269584E320>]}
[0m21:36:57.398036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AF390130>]}
[0m21:36:57.521998 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AF080E50>]}
[0m21:36:57.523011 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 840 macros
[0m21:36:57.523011 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AF3EB400>]}
[0m21:36:57.525066 [info ] [MainThread]: 
[0m21:36:57.526089 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:36:57.530637 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:36:57.543948 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:36:57.544973 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:36:57.544973 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:36:58.243145 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.698 seconds
[0m21:36:58.244175 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:36:58.371273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd0d01e4f-4749-4aad-89c2-0aa9c1b9508b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AF3120E0>]}
[0m21:36:58.372304 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:36:58.372304 [info ] [MainThread]: 
[0m21:36:58.375459 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:36:58.375459 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:36:58.376505 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:36:58.376505 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:36:58.377506 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:36:58.377506 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:36:58.379046 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:36:58.379046 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:36:58.393600 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:36:58.398772 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:36:58.400275 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:36:58.401441 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:36:58.418401 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:36:58.421942 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:36:58.423445 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:36:58.423445 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:36:58.424447 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:36:58.424447 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:36:58.425448 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:36:58.426450 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:36:59.007270 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.583 seconds
[0m21:36:59.014486 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:36:59.137319 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m21:36:59.138558 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:36:59.965682 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.539 seconds
[0m21:36:59.967188 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:37:00.095104 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.72s]
[0m21:37:00.096110 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:37:00.096110 [info ] [MainThread]: 
[0m21:37:00.097614 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:37:00.106313 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:37:00.111489 [debug] [MainThread]: Using snowflake connection "master"
[0m21:37:00.111489 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:37:00.112500 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:01.206141 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.095 seconds
[0m21:37:01.208677 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:37:01.214335 [info ] [MainThread]: Database error while running on-run-end
[0m21:37:01.215368 [debug] [MainThread]: On master: Close
[0m21:37:01.335974 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:01.335974 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:37:01.336973 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:37:01.337479 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:37:01.337479 [info ] [MainThread]: 
[0m21:37:01.338402 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m21:37:01.339443 [debug] [MainThread]: Command end result
[0m21:37:01.458781 [info ] [MainThread]: 
[0m21:37:01.459784 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:37:01.459784 [info ] [MainThread]: 
[0m21:37:01.461259 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:37:01.461259 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:37:01.462297 [info ] [MainThread]: 
[0m21:37:01.462297 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:37:01.463309 [info ] [MainThread]: 
[0m21:37:01.463309 [error] [MainThread]:   on-run-end failed, error:
 Required var 'dbt_date:time_zone' not found in config:
Vars supplied to dbt_dataops-on-run-end-0 = {
    "dbt_date": {
        "time_zone": "America/New_York"
    }
}
[0m21:37:01.464337 [info ] [MainThread]: 
[0m21:37:01.464337 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:37:01.466406 [debug] [MainThread]: Command `dbt test` failed at 21:37:01.466406 after 6.92 seconds
[0m21:37:01.466406 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022693872980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022695E5AE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226AF7AE920>]}
[0m21:37:01.467406 [debug] [MainThread]: Flushing usage events
[0m21:37:53.791247 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C28FBCE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C29278A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C29278A320>]}


============================== 21:37:53.794624 | 3798a1b5-29d4-413e-a813-e757e00bff38 ==============================
[0m21:37:53.794624 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:37:53.795648 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m21:37:54.534563 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3798a1b5-29d4-413e-a813-e757e00bff38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C28FE57DC0>]}
[0m21:37:54.579789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3798a1b5-29d4-413e-a813-e757e00bff38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2921BAE00>]}
[0m21:37:54.581541 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:37:54.603430 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:37:54.842718 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:37:54.843733 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:37:55.028196 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3798a1b5-29d4-413e-a813-e757e00bff38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AB122E00>]}
[0m21:37:55.173513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3798a1b5-29d4-413e-a813-e757e00bff38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AB5CE140>]}
[0m21:37:55.174524 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 840 macros
[0m21:37:55.175546 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3798a1b5-29d4-413e-a813-e757e00bff38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AB3CFEB0>]}
[0m21:37:55.176583 [info ] [MainThread]: 
[0m21:37:55.176583 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:37:55.181586 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:37:55.195915 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:37:55.197117 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:37:55.197117 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:37:55.881700 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.684 seconds
[0m21:37:55.882727 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:37:56.010127 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3798a1b5-29d4-413e-a813-e757e00bff38', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AB5A9210>]}
[0m21:37:56.011177 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:37:56.011177 [info ] [MainThread]: 
[0m21:37:56.014694 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:37:56.015705 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:37:56.015705 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:37:56.016789 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:37:56.016789 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:37:56.018293 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:37:56.018293 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:37:56.018293 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:37:56.033697 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:37:56.040828 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:37:56.043083 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:37:56.043083 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:37:56.058470 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:37:56.061550 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:37:56.062671 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:37:56.062671 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:37:56.064176 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:37:56.064700 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:37:56.064700 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:37:56.065727 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:37:56.568488 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.503 seconds
[0m21:37:56.576144 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:37:56.694182 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.68s]
[0m21:37:56.695278 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:37:57.568283 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.503 seconds
[0m21:37:57.570366 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:37:57.689698 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.67s]
[0m21:37:57.691798 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:37:57.692822 [info ] [MainThread]: 
[0m21:37:57.692822 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:37:57.709700 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:37:57.714909 [debug] [MainThread]: Using snowflake connection "master"
[0m21:37:57.715924 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:37:57.715924 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:37:58.752611 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.036 seconds
[0m21:37:58.753636 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:37:58.767176 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:37:58.768176 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:37:58.772728 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:37:58.774759 [debug] [MainThread]: Using snowflake connection "master"
[0m21:37:58.774759 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
insert into dqm.dq_dbt_test_results_central (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(2025-02-19T21:37:57.706697 as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.6773931980133057'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(2025-02-19T21:37:57.706697 as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.6729092597961426'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
  );
[0m21:37:58.863146 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8007-3201-72d3-000b-f69200018062
[0m21:37:58.864168 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 25 at position 116 unexpected 'T21'.
syntax error line 25 at position 119 unexpected ':'.
syntax error line 25 at position 120 unexpected '37'.
syntax error line 25 at position 123 unexpected '57.706697'.
syntax error line 25 at position 185 unexpected ')'.
[0m21:37:58.864168 [info ] [MainThread]: Database error while running on-run-end
[0m21:37:58.865197 [debug] [MainThread]: On master: Close
[0m21:37:58.986598 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:37:58.986598 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:37:58.988103 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:37:58.988103 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:37:58.989152 [info ] [MainThread]: 
[0m21:37:58.989152 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.81 seconds (3.81s).
[0m21:37:58.990166 [debug] [MainThread]: Command end result
[0m21:37:59.031635 [info ] [MainThread]: 
[0m21:37:59.031635 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:37:59.033137 [info ] [MainThread]: 
[0m21:37:59.034167 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:37:59.034167 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:37:59.035203 [info ] [MainThread]: 
[0m21:37:59.035203 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:37:59.036320 [info ] [MainThread]: 
[0m21:37:59.036320 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 25 at position 116 unexpected 'T21'.
syntax error line 25 at position 119 unexpected ':'.
syntax error line 25 at position 120 unexpected '37'.
syntax error line 25 at position 123 unexpected '57.706697'.
syntax error line 25 at position 185 unexpected ')'.
[0m21:37:59.037397 [info ] [MainThread]: 
[0m21:37:59.037901 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:37:59.038916 [debug] [MainThread]: Command `dbt test` failed at 21:37:59.038916 after 5.31 seconds
[0m21:37:59.039930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C28FBCE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AB61BC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002C2AB616F80>]}
[0m21:37:59.039930 [debug] [MainThread]: Flushing usage events
[0m21:41:24.499236 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308E54E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309110E4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002309110E2C0>]}


============================== 21:41:24.502296 | 8f27274a-9ba7-4709-b8b3-a8f9073eea93 ==============================
[0m21:41:24.502296 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:41:24.503343 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:41:25.252009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8f27274a-9ba7-4709-b8b3-a8f9073eea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308E7D7A90>]}
[0m21:41:25.296874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8f27274a-9ba7-4709-b8b3-a8f9073eea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A9A197E0>]}
[0m21:41:25.296874 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:41:25.319194 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:41:25.586117 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:41:25.586117 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:41:25.745605 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8f27274a-9ba7-4709-b8b3-a8f9073eea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A9AA34C0>]}
[0m21:41:25.887593 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8f27274a-9ba7-4709-b8b3-a8f9073eea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A9F4A440>]}
[0m21:41:25.888598 [info ] [MainThread]: Found 2 models, 1 operation, 4 data tests, 840 macros
[0m21:41:25.889624 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f27274a-9ba7-4709-b8b3-a8f9073eea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A9D4FE20>]}
[0m21:41:25.890624 [info ] [MainThread]: 
[0m21:41:25.891808 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:41:25.896928 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:41:25.911138 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:41:25.911138 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:41:25.912538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:41:26.576344 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.664 seconds
[0m21:41:26.578384 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:41:26.700769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8f27274a-9ba7-4709-b8b3-a8f9073eea93', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A9F26B60>]}
[0m21:41:26.702294 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:41:26.703321 [info ] [MainThread]: 
[0m21:41:26.706489 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:41:26.706489 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:41:26.707546 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:41:26.707546 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:41:26.708547 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:41:26.708547 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:41:26.709847 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:41:26.710350 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:41:26.724041 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:41:26.730660 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:41:26.730660 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:41:26.737709 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:41:26.749940 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:41:26.753393 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:41:26.755766 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:41:26.755766 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:41:26.756794 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:41:26.757810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:41:26.757810 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:41:26.758877 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:41:27.328571 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m21:41:27.336220 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:41:27.464704 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m21:41:27.465717 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:41:28.328643 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.569 seconds
[0m21:41:28.331341 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:41:28.453944 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.74s]
[0m21:41:28.456045 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:41:28.457211 [info ] [MainThread]: 
[0m21:41:28.458470 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:41:28.499373 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:41:28.531730 [debug] [MainThread]: Using snowflake connection "master"
[0m21:41:28.531730 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:41:28.543802 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:41:29.608919 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.067 seconds
[0m21:41:29.611452 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:41:29.632791 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:41:29.635137 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:41:29.642152 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:41:29.655707 [debug] [MainThread]: Using snowflake connection "master"
[0m21:41:29.656708 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
insert into dqm.dq_dbt_test_results_central (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.756157398223877'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7441558837890625'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
  );
[0m21:41:30.018591 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.361 seconds
[0m21:41:30.019596 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.37s]
[0m21:41:30.020632 [info ] [MainThread]: 
[0m21:41:30.021654 [debug] [MainThread]: On master: Close
[0m21:41:30.140142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:41:30.141152 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:41:30.141152 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:41:30.142181 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:41:30.142181 [info ] [MainThread]: 
[0m21:41:30.143206 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.25 seconds (4.25s).
[0m21:41:30.144219 [debug] [MainThread]: Command end result
[0m21:41:30.184617 [info ] [MainThread]: 
[0m21:41:30.185629 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:41:30.186797 [info ] [MainThread]: 
[0m21:41:30.187847 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:41:30.187847 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:41:30.188892 [info ] [MainThread]: 
[0m21:41:30.189891 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:41:30.190396 [info ] [MainThread]: 
[0m21:41:30.190396 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:41:30.192455 [debug] [MainThread]: Command `dbt test` failed at 21:41:30.192455 after 5.75 seconds
[0m21:41:30.192455 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002308E54E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230A9F96200>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000230AA3504F0>]}
[0m21:41:30.193502 [debug] [MainThread]: Flushing usage events
[0m21:45:07.445766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217709BE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177357E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002177357E320>]}


============================== 21:45:07.448785 | be0fa207-e6a0-4397-9ea9-d846260e536e ==============================
[0m21:45:07.448785 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:45:07.449788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:45:08.186805 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'be0fa207-e6a0-4397-9ea9-d846260e536e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021770C47970>]}
[0m21:45:08.231783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'be0fa207-e6a0-4397-9ea9-d846260e536e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217729C16F0>]}
[0m21:45:08.232787 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:45:08.253020 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:45:08.489838 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:45:08.489838 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m21:45:08.740726 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'be0fa207-e6a0-4397-9ea9-d846260e536e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170C564100>]}
[0m21:45:08.859575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'be0fa207-e6a0-4397-9ea9-d846260e536e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170C5322C0>]}
[0m21:45:08.860750 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:45:08.860750 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be0fa207-e6a0-4397-9ea9-d846260e536e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170C24B2B0>]}
[0m21:45:08.862773 [info ] [MainThread]: 
[0m21:45:08.862773 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:45:08.867793 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:45:08.880023 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:45:08.880023 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:45:08.881026 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:45:09.566943 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.686 seconds
[0m21:45:09.567951 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:45:09.696002 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'be0fa207-e6a0-4397-9ea9-d846260e536e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170BEE23B0>]}
[0m21:45:09.696002 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:45:09.697016 [info ] [MainThread]: 
[0m21:45:09.699354 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:45:09.700358 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:45:09.700358 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:45:09.701362 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:45:09.702367 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:45:09.702367 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:45:09.703377 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:45:09.703377 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:45:09.716738 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:45:09.722145 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:45:09.723149 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:45:09.724155 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:45:09.739502 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:45:09.742842 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:45:09.743847 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:45:09.744855 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:45:09.744855 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:45:09.745860 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:45:09.746864 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:45:09.746864 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:45:10.311758 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m21:45:10.318812 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:45:10.441045 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.74s]
[0m21:45:10.442049 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:45:11.241530 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.495 seconds
[0m21:45:11.243625 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:45:11.361875 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.66s]
[0m21:45:11.363891 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:45:11.364895 [info ] [MainThread]: 
[0m21:45:11.364895 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:45:11.381061 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:45:11.387085 [debug] [MainThread]: Using snowflake connection "master"
[0m21:45:11.387085 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:45:11.388342 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:45:12.378326 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.990 seconds
[0m21:45:12.379330 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:45:12.391509 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:45:12.392514 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:45:12.397717 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:45:12.398723 [debug] [MainThread]: Using snowflake connection "master"
[0m21:45:12.399754 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
insert into dqm.dq_dbt_test_results_central (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7386777400970459'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.6605141162872314'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
  );
[0m21:45:12.784380 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.384 seconds
[0m21:45:12.785384 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.39s]
[0m21:45:12.786395 [info ] [MainThread]: 
[0m21:45:12.786395 [debug] [MainThread]: On master: Close
[0m21:45:12.904571 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:45:12.906075 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:45:12.906075 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:45:12.906075 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:45:12.907243 [info ] [MainThread]: 
[0m21:45:12.908249 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.04 seconds (4.04s).
[0m21:45:12.909253 [debug] [MainThread]: Command end result
[0m21:45:12.944919 [info ] [MainThread]: 
[0m21:45:12.944919 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:45:12.946383 [info ] [MainThread]: 
[0m21:45:12.947388 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:45:12.948437 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:45:12.948437 [info ] [MainThread]: 
[0m21:45:12.949441 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:45:12.950449 [info ] [MainThread]: 
[0m21:45:12.950449 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:45:12.951491 [debug] [MainThread]: Command `dbt test` failed at 21:45:12.951491 after 5.56 seconds
[0m21:45:12.952495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217709BE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000217729C16F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002170CA347C0>]}
[0m21:45:12.952495 [debug] [MainThread]: Flushing usage events
[0m21:47:32.150894 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DFF22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256E2ADA4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256E2ADA2C0>]}


============================== 21:47:32.154472 | 66e036e4-4589-404c-b898-887963c70400 ==============================
[0m21:47:32.154472 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:47:32.155492 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m21:47:32.882946 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '66e036e4-4589-404c-b898-887963c70400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256E01A7A90>]}
[0m21:47:32.927603 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '66e036e4-4589-404c-b898-887963c70400', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FB3E97E0>]}
[0m21:47:32.928607 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:47:32.949924 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:47:33.196728 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:47:33.196728 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:47:33.203762 [error] [MainThread]: Encountered an error:
Compilation Error
  Got a block definition inside control flow at 139:0. All dbt block definitions must be at the top level
[0m21:47:33.204778 [debug] [MainThread]: Command `dbt test` failed at 21:47:33.204778 after 1.11 seconds
[0m21:47:33.204778 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256DFF22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FB8C97E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256FB8C9750>]}
[0m21:47:33.205783 [debug] [MainThread]: Flushing usage events
[0m21:48:41.228689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014132DD28F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001413598E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001413598E230>]}


============================== 21:48:41.231699 | 75ab98dc-989f-443d-a2ee-50ca336ea8d3 ==============================
[0m21:48:41.231699 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:48:41.232810 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:48:41.949770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '75ab98dc-989f-443d-a2ee-50ca336ea8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001414E2FFBB0>]}
[0m21:48:41.994625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '75ab98dc-989f-443d-a2ee-50ca336ea8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014134E0B760>]}
[0m21:48:41.995628 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:48:42.015895 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:48:42.251513 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:48:42.251513 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:48:42.387172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '75ab98dc-989f-443d-a2ee-50ca336ea8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001414E77F7C0>]}
[0m21:48:42.509870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '75ab98dc-989f-443d-a2ee-50ca336ea8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001414E3207F0>]}
[0m21:48:42.509870 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:48:42.510875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ab98dc-989f-443d-a2ee-50ca336ea8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001414E76D4B0>]}
[0m21:48:42.511879 [info ] [MainThread]: 
[0m21:48:42.512883 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:48:42.516905 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:48:42.531157 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:48:42.532171 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:48:42.532171 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:48:43.196156 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.664 seconds
[0m21:48:43.198165 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:48:43.327090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '75ab98dc-989f-443d-a2ee-50ca336ea8d3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001414E2FF700>]}
[0m21:48:43.328094 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:48:43.329098 [info ] [MainThread]: 
[0m21:48:43.331109 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:48:43.332115 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:48:43.332115 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:48:43.333121 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:48:43.333121 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:48:43.334127 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:48:43.334127 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:48:43.348331 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:48:43.348331 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:48:43.355581 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:48:43.355581 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:48:43.371159 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:48:43.372275 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:48:43.375518 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:48:43.376525 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:48:43.376525 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:48:43.377532 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:48:43.378542 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:48:43.378542 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:48:43.380553 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:48:44.018359 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.640 seconds
[0m21:48:44.018359 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.639 seconds
[0m21:48:44.025400 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:48:44.027413 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:48:44.154137 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.82s]
[0m21:48:44.155144 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:48:44.164632 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.83s]
[0m21:48:44.165639 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:48:44.166658 [info ] [MainThread]: 
[0m21:48:44.167755 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:48:44.184455 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:48:44.189619 [debug] [MainThread]: Using snowflake connection "master"
[0m21:48:44.189619 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:48:44.190624 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:48:45.338403 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.149 seconds
[0m21:48:45.340553 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:48:45.352871 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:48:45.353876 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:48:45.358888 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:48:45.360115 [debug] [MainThread]: Using snowflake connection "master"
[0m21:48:45.361116 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
insert into dqm.dq_dbt_test_results_central (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8198411464691162'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8305048942565918'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  

  
    ) on conflict (test_sk) do nothing;
[0m21:48:45.662248 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8012-3201-7237-000b-f6920001469e
[0m21:48:45.662248 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 103 at position 6 unexpected 'on'.
[0m21:48:45.663251 [info ] [MainThread]: Database error while running on-run-end
[0m21:48:45.664255 [debug] [MainThread]: On master: Close
[0m21:48:45.783218 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:48:45.784222 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:48:45.784222 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:48:45.784222 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:48:45.785298 [info ] [MainThread]: 
[0m21:48:45.785298 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m21:48:45.787312 [debug] [MainThread]: Command end result
[0m21:48:45.823762 [info ] [MainThread]: 
[0m21:48:45.824767 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:48:45.824767 [info ] [MainThread]: 
[0m21:48:45.825771 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:48:45.826774 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:48:45.827777 [info ] [MainThread]: 
[0m21:48:45.827777 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:48:45.828782 [info ] [MainThread]: 
[0m21:48:45.828782 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 103 at position 6 unexpected 'on'.
[0m21:48:45.829786 [info ] [MainThread]: 
[0m21:48:45.829786 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:48:45.831976 [debug] [MainThread]: Command `dbt test` failed at 21:48:45.831976 after 4.66 seconds
[0m21:48:45.831976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000014132DD28F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141330F27A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000141352C1AB0>]}
[0m21:48:45.832979 [debug] [MainThread]: Flushing usage events
[0m21:50:53.007157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002945F10E8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029461CCA410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000029461CCA230>]}


============================== 21:50:53.010414 | 8257b523-54fc-4d0e-ae25-f089c7a1dea4 ==============================
[0m21:50:53.010414 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:50:53.011589 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:50:53.776064 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8257b523-54fc-4d0e-ae25-f089c7a1dea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002945F397340>]}
[0m21:50:53.824213 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8257b523-54fc-4d0e-ae25-f089c7a1dea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002946114B730>]}
[0m21:50:53.825214 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:50:53.848860 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:50:54.097264 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:50:54.097264 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:50:54.238178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8257b523-54fc-4d0e-ae25-f089c7a1dea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947A660BE0>]}
[0m21:50:54.380034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8257b523-54fc-4d0e-ae25-f089c7a1dea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947AABEE60>]}
[0m21:50:54.381035 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:50:54.381035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8257b523-54fc-4d0e-ae25-f089c7a1dea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947AAB1450>]}
[0m21:50:54.383501 [info ] [MainThread]: 
[0m21:50:54.383501 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:50:54.389045 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:50:54.405871 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:50:54.407154 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:50:54.407154 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:50:55.078805 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.671 seconds
[0m21:50:55.079809 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:50:55.218243 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8257b523-54fc-4d0e-ae25-f089c7a1dea4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947AB047C0>]}
[0m21:50:55.218243 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:50:55.219445 [info ] [MainThread]: 
[0m21:50:55.222598 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:55.223605 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:50:55.223605 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:50:55.224688 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:50:55.224688 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:50:55.225694 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:50:55.225694 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:55.226743 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:50:55.241118 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:55.248588 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:55.249593 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:55.260675 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:50:55.267175 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:55.270197 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:55.271203 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:50:55.272207 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:50:55.273212 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:50:55.273212 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:50:55.274216 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:50:55.274216 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:50:55.839669 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m21:50:55.847048 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:50:55.975166 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.75s]
[0m21:50:55.976172 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:50:56.835841 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.561 seconds
[0m21:50:56.836846 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:50:56.967775 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.74s]
[0m21:50:56.969782 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:50:56.970786 [info ] [MainThread]: 
[0m21:50:56.970786 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:50:56.987415 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:50:56.994678 [debug] [MainThread]: Using snowflake connection "master"
[0m21:50:56.994678 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:50:56.995683 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:50:58.019429 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.024 seconds
[0m21:50:58.021431 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:50:58.034473 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:50:58.035933 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:50:58.039025 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:50:58.042239 [debug] [MainThread]: Using snowflake connection "master"
[0m21:50:58.042239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
insert into dqm.dq_dbt_test_results_central
    select * from (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7494726181030273'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.743086576461792'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  

  
    ) as new_data
    where not exists (
         select 1 from dqm.dq_dbt_test_results_central t where t.test_sk = new_data.test_sk
    );
[0m21:50:58.457466 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.414 seconds
[0m21:50:58.458471 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.42s]
[0m21:50:58.459475 [info ] [MainThread]: 
[0m21:50:58.459475 [debug] [MainThread]: On master: Close
[0m21:50:58.580494 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:50:58.580494 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:50:58.580494 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:50:58.581705 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:50:58.581705 [info ] [MainThread]: 
[0m21:50:58.582797 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.20 seconds (4.20s).
[0m21:50:58.583822 [debug] [MainThread]: Command end result
[0m21:50:58.622531 [info ] [MainThread]: 
[0m21:50:58.623564 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:50:58.624081 [info ] [MainThread]: 
[0m21:50:58.625100 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:50:58.626143 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:50:58.626657 [info ] [MainThread]: 
[0m21:50:58.627683 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:50:58.628193 [info ] [MainThread]: 
[0m21:50:58.628706 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:50:58.629747 [debug] [MainThread]: Command `dbt test` failed at 21:50:58.629747 after 5.68 seconds
[0m21:50:58.629747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002945F10E8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947AB55390>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002947AABE0E0>]}
[0m21:50:58.630778 [debug] [MainThread]: Flushing usage events
[0m21:51:45.325985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DFD9E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E293E440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E293E260>]}


============================== 21:51:45.328994 | 20a1a5cb-7c80-4f59-b565-d76004f36537 ==============================
[0m21:51:45.328994 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:51:45.329998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:51:46.079721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '20a1a5cb-7c80-4f59-b565-d76004f36537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E0653F10>]}
[0m21:51:46.125242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '20a1a5cb-7c80-4f59-b565-d76004f36537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238E1D609A0>]}
[0m21:51:46.127249 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:51:46.147799 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:51:46.391721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m21:51:46.392724 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m21:51:46.443092 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '20a1a5cb-7c80-4f59-b565-d76004f36537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FB778130>]}
[0m21:51:46.613405 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '20a1a5cb-7c80-4f59-b565-d76004f36537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FB740BE0>]}
[0m21:51:46.613405 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:51:46.614410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20a1a5cb-7c80-4f59-b565-d76004f36537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FB72D0C0>]}
[0m21:51:46.615413 [info ] [MainThread]: 
[0m21:51:46.616426 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:51:46.620442 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:51:46.634313 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:51:46.635816 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:51:46.635816 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:51:47.350828 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.715 seconds
[0m21:51:47.352920 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:51:47.491659 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '20a1a5cb-7c80-4f59-b565-d76004f36537', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FB743760>]}
[0m21:51:47.491659 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:51:47.492666 [info ] [MainThread]: 
[0m21:51:47.495688 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:51:47.495688 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:51:47.496700 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:51:47.496700 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:51:47.496700 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:51:47.497979 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:51:47.498985 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:51:47.498985 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:51:47.514137 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:51:47.519144 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:51:47.520355 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:51:47.535656 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:51:47.536756 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:51:47.539209 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:51:47.541219 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:51:47.541219 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:51:47.542237 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:51:47.542237 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:51:47.543382 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:51:47.543382 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:51:48.145078 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.601 seconds
[0m21:51:48.152105 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:51:48.284667 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.79s]
[0m21:51:48.286674 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:51:49.286825 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.743 seconds
[0m21:51:49.287829 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:51:49.403482 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.91s]
[0m21:51:49.404494 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:51:49.406504 [info ] [MainThread]: 
[0m21:51:49.406504 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:51:49.422711 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:51:49.427851 [debug] [MainThread]: Using snowflake connection "master"
[0m21:51:49.427851 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:51:49.428855 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:51:50.567120 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.138 seconds
[0m21:51:50.568124 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:51:50.581509 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:51:50.582514 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:51:50.586673 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:51:50.588738 [debug] [MainThread]: Using snowflake connection "master"
[0m21:51:50.589751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
insert into dqm.dq_dbt_test_results_central
    select * from (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7866880893707275'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.9067811965942383'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  

  
    ) as new_data
    where not exists (
         select 1 from dqm.dq_dbt_test_results_central t where t.test_sk = new_data.test_sk
    );
[0m21:51:51.290818 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.701 seconds
[0m21:51:51.291838 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.70s]
[0m21:51:51.292856 [info ] [MainThread]: 
[0m21:51:51.293860 [debug] [MainThread]: On master: Close
[0m21:51:51.410564 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:51:51.410564 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:51:51.411565 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:51:51.411565 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:51:51.411565 [info ] [MainThread]: 
[0m21:51:51.413043 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.80 seconds (4.80s).
[0m21:51:51.414046 [debug] [MainThread]: Command end result
[0m21:51:51.450379 [info ] [MainThread]: 
[0m21:51:51.450379 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:51:51.451514 [info ] [MainThread]: 
[0m21:51:51.452516 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:51:51.453548 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:51:51.453548 [info ] [MainThread]: 
[0m21:51:51.454553 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:51:51.455642 [info ] [MainThread]: 
[0m21:51:51.455642 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:51:51.456860 [debug] [MainThread]: Command `dbt test` failed at 21:51:51.456860 after 6.19 seconds
[0m21:51:51.457887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DFD9E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238DFC31B40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000238FB2AFA60>]}
[0m21:51:51.458894 [debug] [MainThread]: Flushing usage events
[0m21:53:58.487821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023316BEE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002331978E440>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002331978E260>]}


============================== 21:53:58.490870 | 83ccadd2-4441-4b30-a88e-594ed00bdade ==============================
[0m21:53:58.490870 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:53:58.492007 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m21:53:59.262537 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '83ccadd2-4441-4b30-a88e-594ed00bdade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023317497F10>]}
[0m21:53:59.310387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '83ccadd2-4441-4b30-a88e-594ed00bdade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023318BAC9A0>]}
[0m21:53:59.311391 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:53:59.332438 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:53:59.572816 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:53:59.573819 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:53:59.721271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '83ccadd2-4441-4b30-a88e-594ed00bdade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333259CA90>]}
[0m21:53:59.850589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '83ccadd2-4441-4b30-a88e-594ed00bdade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233320FF730>]}
[0m21:53:59.851772 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:53:59.852776 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ccadd2-4441-4b30-a88e-594ed00bdade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002333256D7B0>]}
[0m21:53:59.853783 [info ] [MainThread]: 
[0m21:53:59.855008 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:53:59.859185 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:53:59.873510 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:53:59.873510 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:53:59.874958 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:00.577220 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.703 seconds
[0m21:54:00.579229 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:54:00.713000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '83ccadd2-4441-4b30-a88e-594ed00bdade', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000233325C5F30>]}
[0m21:54:00.713000 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:54:00.714001 [info ] [MainThread]: 
[0m21:54:00.717004 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:00.717004 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:00.718005 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:54:00.719006 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:54:00.719006 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:54:00.720082 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:54:00.720082 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:00.721086 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:00.735092 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:00.740158 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:00.742161 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:00.742161 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:00.757601 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:00.760797 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:00.761807 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:00.762813 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:54:00.762813 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:00.763819 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:54:00.763819 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:54:00.765830 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:54:01.348653 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m21:54:01.354696 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:54:01.478806 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m21:54:01.479810 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:02.302230 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.537 seconds
[0m21:54:02.304247 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:54:02.435591 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.72s]
[0m21:54:02.436604 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:02.437610 [info ] [MainThread]: 
[0m21:54:02.438620 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:54:02.456310 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:54:02.462574 [debug] [MainThread]: Using snowflake connection "master"
[0m21:54:02.463579 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:54:02.463579 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:03.677135 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.213 seconds
[0m21:54:03.678138 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:54:03.691275 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:54:03.692279 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:54:03.696305 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:54:03.699479 [debug] [MainThread]: Using snowflake connection "master"
[0m21:54:03.699479 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7597999572753906'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7155086994171143'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target._timestamp::date = source._timestamp::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, _timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source._timestamp
      )
  
  ;
[0m21:54:03.784222 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8018-3201-72d0-000b-f692000173a2
[0m21:54:03.785505 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 111 at position 54
invalid identifier '_TIMESTAMP'
[0m21:54:03.785505 [info ] [MainThread]: Database error while running on-run-end
[0m21:54:03.786526 [debug] [MainThread]: On master: Close
[0m21:54:03.912910 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:03.913913 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:54:03.913913 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:54:03.913913 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:54:03.915092 [info ] [MainThread]: 
[0m21:54:03.916096 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 4.06 seconds (4.06s).
[0m21:54:03.917099 [debug] [MainThread]: Command end result
[0m21:54:03.968044 [info ] [MainThread]: 
[0m21:54:03.969046 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:54:03.970046 [info ] [MainThread]: 
[0m21:54:03.971110 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:54:03.972115 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:54:03.972115 [info ] [MainThread]: 
[0m21:54:03.973119 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:54:03.973119 [info ] [MainThread]: 
[0m21:54:03.974123 [error] [MainThread]:   on-run-end failed, error:
 000904 (42000): SQL compilation error: error line 111 at position 54
invalid identifier '_TIMESTAMP'
[0m21:54:03.975127 [info ] [MainThread]: 
[0m21:54:03.975127 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:54:03.976295 [debug] [MainThread]: Command `dbt test` failed at 21:54:03.976295 after 5.55 seconds
[0m21:54:03.977299 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023316BEE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023318BAF4C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023318BAC9A0>]}
[0m21:54:03.977299 [debug] [MainThread]: Flushing usage events
[0m21:54:23.386097 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221553CE8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022157F8A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022157F8A230>]}


============================== 21:54:23.389312 | c65ce340-a090-49ad-84f0-470723aa7cf5 ==============================
[0m21:54:23.389312 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:54:23.390543 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m21:54:24.120684 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c65ce340-a090-49ad-84f0-470723aa7cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022155657340>]}
[0m21:54:24.165081 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c65ce340-a090-49ad-84f0-470723aa7cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002215740B730>]}
[0m21:54:24.166231 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:54:24.187549 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:54:24.453131 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:54:24.454135 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:54:24.597049 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c65ce340-a090-49ad-84f0-470723aa7cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022170920BE0>]}
[0m21:54:24.719283 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c65ce340-a090-49ad-84f0-470723aa7cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022170B62E60>]}
[0m21:54:24.720288 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:54:24.721295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65ce340-a090-49ad-84f0-470723aa7cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022170D71450>]}
[0m21:54:24.722467 [info ] [MainThread]: 
[0m21:54:24.723470 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:54:24.727785 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:54:24.740928 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:54:24.741941 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:54:24.741941 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:25.429408 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.688 seconds
[0m21:54:25.431538 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:54:25.549947 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c65ce340-a090-49ad-84f0-470723aa7cf5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022170DC0580>]}
[0m21:54:25.549947 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:54:25.550951 [info ] [MainThread]: 
[0m21:54:25.553972 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:25.553972 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:25.555141 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:54:25.555141 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:54:25.556144 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:54:25.556144 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:54:25.557188 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:25.558193 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:25.572324 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:25.578852 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:25.579856 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:25.579856 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:25.596137 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:25.599173 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:25.600176 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:25.601295 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:25.602301 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:54:25.602301 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:54:25.603304 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:54:25.603304 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:54:26.136496 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m21:54:26.144726 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:54:26.272138 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.72s]
[0m21:54:26.273161 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:27.198465 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.595 seconds
[0m21:54:27.199469 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:54:27.318800 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.76s]
[0m21:54:27.319806 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:27.321821 [info ] [MainThread]: 
[0m21:54:27.321821 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:54:27.337950 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:54:27.343975 [debug] [MainThread]: Using snowflake connection "master"
[0m21:54:27.343975 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:54:27.344979 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:28.390940 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.046 seconds
[0m21:54:28.391944 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:54:28.404104 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:54:28.406113 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:54:28.411223 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:54:28.413233 [debug] [MainThread]: Using snowflake connection "master"
[0m21:54:28.414236 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7169976234436035'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', currentTIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.76265549659729'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', currentTIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m21:54:28.500513 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8018-3201-7237-000b-f692000146ee
[0m21:54:28.501514 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 48 at position 45
invalid identifier 'CURRENTTIMESTAMP'
[0m21:54:28.502688 [info ] [MainThread]: Database error while running on-run-end
[0m21:54:28.502688 [debug] [MainThread]: On master: Close
[0m21:54:28.623595 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:28.623595 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:54:28.624660 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:54:28.624660 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:54:28.624660 [info ] [MainThread]: 
[0m21:54:28.625915 [info ] [MainThread]: Finished running 2 data tests in 0 hours 0 minutes and 3.90 seconds (3.90s).
[0m21:54:28.626926 [debug] [MainThread]: Command end result
[0m21:54:28.663491 [info ] [MainThread]: 
[0m21:54:28.664496 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m21:54:28.665499 [info ] [MainThread]: 
[0m21:54:28.666507 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:54:28.666507 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:54:28.667512 [info ] [MainThread]: 
[0m21:54:28.667512 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:54:28.668517 [info ] [MainThread]: 
[0m21:54:28.669522 [error] [MainThread]:   on-run-end failed, error:
 000904 (42000): SQL compilation error: error line 48 at position 45
invalid identifier 'CURRENTTIMESTAMP'
[0m21:54:28.669522 [info ] [MainThread]: 
[0m21:54:28.670697 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=2 SKIP=0 TOTAL=3
[0m21:54:28.671710 [debug] [MainThread]: Command `dbt test` failed at 21:54:28.671710 after 5.35 seconds
[0m21:54:28.671710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221553CE8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000221578C19F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022170DC1F00>]}
[0m21:54:28.672736 [debug] [MainThread]: Flushing usage events
[0m21:54:40.703252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CC02E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CEBDA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CEBDA320>]}


============================== 21:54:40.706255 | c18a6290-55de-4c8e-8213-7ca8234036b9 ==============================
[0m21:54:40.706255 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:54:40.707255 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m21:54:41.434409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c18a6290-55de-4c8e-8213-7ca8234036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CC2B7DC0>]}
[0m21:54:41.479705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c18a6290-55de-4c8e-8213-7ca8234036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CE606E00>]}
[0m21:54:41.480708 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:54:41.501948 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:54:41.747201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:54:41.748204 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m21:54:41.889211 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c18a6290-55de-4c8e-8213-7ca8234036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E79EDC90>]}
[0m21:54:42.009342 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c18a6290-55de-4c8e-8213-7ca8234036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E75722C0>]}
[0m21:54:42.010347 [info ] [MainThread]: Found 2 models, 1 operation, 2 data tests, 840 macros
[0m21:54:42.011351 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c18a6290-55de-4c8e-8213-7ca8234036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E79BD5D0>]}
[0m21:54:42.012358 [info ] [MainThread]: 
[0m21:54:42.013361 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:54:42.018515 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:54:42.032130 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:54:42.032130 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:54:42.033137 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:54:42.660824 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.628 seconds
[0m21:54:42.663005 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:54:42.797360 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c18a6290-55de-4c8e-8213-7ca8234036b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E74C3B50>]}
[0m21:54:42.797360 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:54:42.798369 [info ] [MainThread]: 
[0m21:54:42.801390 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:42.801390 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:42.802394 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:54:42.802394 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:54:42.803829 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:54:42.803829 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:54:42.803829 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:42.805276 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:42.818140 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:42.824945 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:42.825949 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:42.825949 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:42.842633 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:42.845635 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:42.846719 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:54:42.848080 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:54:42.848080 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:54:42.848080 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:54:42.849461 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:54:42.849461 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:54:43.363404 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.515 seconds
[0m21:54:43.370856 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:54:43.494166 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.69s]
[0m21:54:43.495177 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:54:44.415505 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.566 seconds
[0m21:54:44.417515 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:54:44.548637 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.74s]
[0m21:54:44.549642 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:54:44.550646 [info ] [MainThread]: 
[0m21:54:44.550646 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:54:44.568259 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m21:54:44.573435 [debug] [MainThread]: Using snowflake connection "master"
[0m21:54:44.573435 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:54:44.574439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:54:46.006134 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.431 seconds
[0m21:54:46.007138 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:54:46.020332 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:54:46.021335 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:54:46.025568 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:54:46.027586 [debug] [MainThread]: Using snowflake connection "master"
[0m21:54:46.028593 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.6917722225189209'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7438018321990967'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m21:54:46.425821 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.397 seconds
[0m21:54:46.426822 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.40s]
[0m21:54:46.427870 [info ] [MainThread]: 
[0m21:54:46.427870 [debug] [MainThread]: On master: Close
[0m21:54:46.546798 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:54:46.547801 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:54:46.547801 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:54:46.547801 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:54:46.548829 [info ] [MainThread]: 
[0m21:54:46.548829 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.54 seconds (4.54s).
[0m21:54:46.549834 [debug] [MainThread]: Command end result
[0m21:54:46.586475 [info ] [MainThread]: 
[0m21:54:46.586475 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:54:46.587556 [info ] [MainThread]: 
[0m21:54:46.588562 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:54:46.589570 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:54:46.589570 [info ] [MainThread]: 
[0m21:54:46.590575 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:54:46.591578 [info ] [MainThread]: 
[0m21:54:46.591578 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m21:54:46.593617 [debug] [MainThread]: Command `dbt test` failed at 21:54:46.592612 after 5.95 seconds
[0m21:54:46.593617 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CC02E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245CC2B7940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000245E7570760>]}
[0m21:54:46.593617 [debug] [MainThread]: Flushing usage events
[0m21:56:16.167409 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153A10EE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153A3CAA530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153A3CAA350>]}


============================== 21:56:16.170419 | 5b17602c-43dd-4832-992a-8ee81fd07899 ==============================
[0m21:56:16.170419 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:56:16.171569 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m21:56:16.899119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5b17602c-43dd-4832-992a-8ee81fd07899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153A1377970>]}
[0m21:56:16.944116 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5b17602c-43dd-4832-992a-8ee81fd07899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153A0BC3580>]}
[0m21:56:16.946129 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m21:56:16.966287 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m21:56:17.207753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m21:56:17.208756 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m21:56:17.579271 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5b17602c-43dd-4832-992a-8ee81fd07899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153BCE1BE50>]}
[0m21:56:17.702048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5b17602c-43dd-4832-992a-8ee81fd07899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153BC7C26E0>]}
[0m21:56:17.703051 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m21:56:17.704060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b17602c-43dd-4832-992a-8ee81fd07899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153BC8DE590>]}
[0m21:56:17.705065 [info ] [MainThread]: 
[0m21:56:17.706069 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m21:56:17.710301 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m21:56:17.723412 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m21:56:17.724420 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m21:56:17.724420 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m21:56:18.364496 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.640 seconds
[0m21:56:18.365497 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m21:56:18.488801 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5b17602c-43dd-4832-992a-8ee81fd07899', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153BC7C19F0>]}
[0m21:56:18.489814 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m21:56:18.489814 [info ] [MainThread]: 
[0m21:56:18.494225 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m21:56:18.494225 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:56:18.495231 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:56:18.495231 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m21:56:18.496314 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m21:56:18.496314 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m21:56:18.497817 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m21:56:18.497817 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m21:56:18.499190 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m21:56:18.499190 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m21:56:18.500198 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:56:18.500198 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:56:18.508263 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m21:56:18.514384 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:56:18.520506 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:56:18.521509 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m21:56:18.526533 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:56:18.526533 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:56:18.537106 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m21:56:18.540116 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:56:18.543126 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:56:18.544176 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m21:56:18.545182 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m21:56:18.546189 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m21:56:18.546189 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m21:56:18.547202 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m21:56:18.548236 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m21:56:18.548236 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m21:56:18.549240 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m21:56:18.550276 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m21:56:19.107059 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.556 seconds
[0m21:56:19.113259 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m21:56:19.232753 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.73s]
[0m21:56:19.233756 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m21:56:20.151821 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.603 seconds
[0m21:56:20.152831 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m21:56:20.268081 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.77s]
[0m21:56:20.269085 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m21:56:21.347616 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.800 seconds
[0m21:56:21.349638 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m21:56:21.468261 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 2.97s]
[0m21:56:21.469267 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m21:56:21.471294 [info ] [MainThread]: 
[0m21:56:21.471294 [info ] [MainThread]: Running 1 on-run-end hook
[0m21:56:21.495419 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m21:56:21.501980 [debug] [MainThread]: Using snowflake connection "master"
[0m21:56:21.502987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m21:56:21.502987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m21:56:22.512283 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.009 seconds
[0m21:56:22.513905 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:56:22.527018 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:56:22.528023 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m21:56:22.529190 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m21:56:22.533363 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m21:56:22.536419 [debug] [MainThread]: Using snowflake connection "master"
[0m21:56:22.536419 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7349364757537842'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7688910961151123'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '2.9704439640045166'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m21:56:22.901283 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.364 seconds
[0m21:56:22.902310 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.37s]
[0m21:56:22.903313 [info ] [MainThread]: 
[0m21:56:22.903313 [debug] [MainThread]: On master: Close
[0m21:56:23.062153 [debug] [MainThread]: Connection 'master' was properly closed.
[0m21:56:23.062153 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m21:56:23.063157 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m21:56:23.063157 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m21:56:23.064162 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m21:56:23.064162 [info ] [MainThread]: 
[0m21:56:23.065175 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 5.36 seconds (5.36s).
[0m21:56:23.066178 [debug] [MainThread]: Command end result
[0m21:56:23.175698 [info ] [MainThread]: 
[0m21:56:23.175698 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m21:56:23.176971 [info ] [MainThread]: 
[0m21:56:23.177983 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m21:56:23.178988 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m21:56:23.178988 [info ] [MainThread]: 
[0m21:56:23.179993 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m21:56:23.179993 [info ] [MainThread]: 
[0m21:56:23.180998 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m21:56:23.183016 [debug] [MainThread]: Command `dbt test` failed at 21:56:23.183016 after 7.07 seconds
[0m21:56:23.183016 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153A10EE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153BCD45600>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000153BCD78460>]}
[0m21:56:23.184020 [debug] [MainThread]: Flushing usage events
[0m21:59:59.247512 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00B6AE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00E23A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00E23A230>]}


============================== 21:59:59.250521 | 40620018-dfb0-4dc8-847b-a9dfd29e709d ==============================
[0m21:59:59.250521 [info ] [MainThread]: Running with dbt=1.8.7
[0m21:59:59.251529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m21:59:59.972869 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '40620018-dfb0-4dc8-847b-a9dfd29e709d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00B937CD0>]}
[0m22:00:00.018397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '40620018-dfb0-4dc8-847b-a9dfd29e709d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00D6BB760>]}
[0m22:00:00.019400 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:00:00.040696 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:00:00.284011 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:00:00.285069 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:00:00.427601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '40620018-dfb0-4dc8-847b-a9dfd29e709d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D026C43880>]}
[0m22:00:00.550275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '40620018-dfb0-4dc8-847b-a9dfd29e709d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D02706EB60>]}
[0m22:00:00.550275 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:00:00.551280 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40620018-dfb0-4dc8-847b-a9dfd29e709d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D0270174C0>]}
[0m22:00:00.553290 [info ] [MainThread]: 
[0m22:00:00.553290 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:00:00.558330 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:00:00.572224 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:00:00.572224 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:00:00.573228 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:00:01.265305 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.692 seconds
[0m22:00:01.266314 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:00:01.392087 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '40620018-dfb0-4dc8-847b-a9dfd29e709d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D026D618D0>]}
[0m22:00:01.392087 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:00:01.393202 [info ] [MainThread]: 
[0m22:00:01.396250 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:00:01.396250 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:00:01.396250 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:00:01.397256 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:00:01.397256 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:00:01.398262 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:00:01.399268 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:00:01.399268 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:00:01.400274 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:00:01.400274 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:00:01.401291 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:00:01.401291 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:00:01.415842 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:00:01.423002 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:00:01.428056 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:00:01.429130 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:00:01.436198 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:00:01.446418 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:00:01.449431 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:00:01.449431 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:00:01.453443 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:00:01.453443 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:00:01.454860 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:00:01.454860 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:00:01.455861 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:00:01.455861 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:00:01.456862 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:00:01.457864 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:00:01.457864 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:00:01.459866 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:00:02.054381 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m22:00:02.061622 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:00:02.070765 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m22:00:02.071770 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:00:02.213197 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.81s]
[0m22:00:02.214738 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:00:02.216125 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.82s]
[0m22:00:02.217142 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:00:02.962829 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.503 seconds
[0m22:00:02.963969 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:00:03.081665 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.68s]
[0m22:00:03.083670 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:00:03.084173 [info ] [MainThread]: 
[0m22:00:03.085202 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:00:03.101303 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:00:03.106327 [debug] [MainThread]: Using snowflake connection "master"
[0m22:00:03.106327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:00:03.106327 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:00:04.067356 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.960 seconds
[0m22:00:04.068365 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:00:04.082435 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:00:04.083979 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:00:04.085525 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:00:04.089629 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:00:04.094721 [debug] [MainThread]: Using snowflake connection "master"
[0m22:00:04.095231 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
      with current_test_runs as (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8139290809631348'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
       true as is_active,
       convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified,
       convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8178637027740479'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
       true as is_active,
       convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified,
       convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.6813907623291016'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
       true as is_active,
       convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified,
       convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
      )
      select * from current_test_runs
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set is_active = true,
                last_modified = source.last_modified
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_modified
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_modified
      );
[0m22:00:04.565223 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.469 seconds
[0m22:00:04.565223 [debug] [MainThread]: Using snowflake connection "master"
[0m22:00:04.566230 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Mark tests as inactive if they weren't part of current run
    update dqm.dq_dbt_test_results_central
    set is_active = false,
        last_modified = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where test_name not in (
      select distinct test_name 
      from current_test_runs
    )
    and is_active = true;
[0m22:00:04.659461 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba801e-3201-7237-000b-f6920001470a
[0m22:00:04.660463 [debug] [MainThread]: Snowflake adapter: Snowflake error: 002003 (42S02): SQL compilation error:
Object 'CURRENT_TEST_RUNS' does not exist or not authorized.
[0m22:00:04.660463 [info ] [MainThread]: Database error while running on-run-end
[0m22:00:04.661648 [debug] [MainThread]: On master: Close
[0m22:00:04.785844 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:00:04.786870 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:00:04.786870 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:00:04.786870 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:00:04.787874 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:00:04.787874 [info ] [MainThread]: 
[0m22:00:04.788877 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.23 seconds (4.23s).
[0m22:00:04.789880 [debug] [MainThread]: Command end result
[0m22:00:04.826014 [info ] [MainThread]: 
[0m22:00:04.827076 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:00:04.828149 [info ] [MainThread]: 
[0m22:00:04.828149 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:00:04.829384 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:00:04.829384 [info ] [MainThread]: 
[0m22:00:04.830388 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:00:04.831506 [info ] [MainThread]: 
[0m22:00:04.831506 [error] [MainThread]:   on-run-end failed, error:
 002003 (42S02): SQL compilation error:
Object 'CURRENT_TEST_RUNS' does not exist or not authorized.
[0m22:00:04.831506 [info ] [MainThread]: 
[0m22:00:04.832980 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:00:04.833983 [debug] [MainThread]: Command `dbt test` failed at 22:00:04.833983 after 5.65 seconds
[0m22:00:04.833983 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00B6AE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D00D6BB760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001D02706F670>]}
[0m22:00:04.835310 [debug] [MainThread]: Flushing usage events
[0m22:01:50.349914 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168053529B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016807F0A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016807F0A350>]}


============================== 22:01:50.353388 | db982a1c-c030-475a-a56a-0a67916ad51f ==============================
[0m22:01:50.353388 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:01:50.353388 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:01:51.100172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'db982a1c-c030-475a-a56a-0a67916ad51f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168055D7970>]}
[0m22:01:51.144997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'db982a1c-c030-475a-a56a-0a67916ad51f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016804E23580>]}
[0m22:01:51.146537 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:01:51.165511 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:01:51.424637 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:01:51.424637 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:01:51.569079 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'db982a1c-c030-475a-a56a-0a67916ad51f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168209D0940>]}
[0m22:01:51.691501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'db982a1c-c030-475a-a56a-0a67916ad51f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016820AD11E0>]}
[0m22:01:51.691501 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:01:51.692712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db982a1c-c030-475a-a56a-0a67916ad51f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016820CED5D0>]}
[0m22:01:51.694738 [info ] [MainThread]: 
[0m22:01:51.694738 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:01:51.699583 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:01:51.714861 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:01:51.716184 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:01:51.717186 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:01:52.399320 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.683 seconds
[0m22:01:52.401333 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:01:52.521370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'db982a1c-c030-475a-a56a-0a67916ad51f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016820AD20B0>]}
[0m22:01:52.521370 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:01:52.522503 [info ] [MainThread]: 
[0m22:01:52.525516 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:01:52.525516 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:01:52.525516 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:01:52.525516 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:01:52.527020 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:01:52.528034 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:01:52.528034 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:01:52.528034 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:01:52.529387 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:01:52.530396 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:01:52.530396 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:01:52.531404 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:01:52.547131 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:01:52.553242 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:01:52.557930 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:01:52.559943 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:01:52.559943 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:01:52.575899 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:01:52.577402 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:01:52.580431 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:01:52.583434 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:01:52.584605 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:01:52.585611 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:01:52.585611 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:01:52.587115 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:01:52.587115 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:01:52.588132 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:01:52.588132 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:01:52.589138 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:01:52.592157 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:01:53.180338 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m22:01:53.187866 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:01:53.239483 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.652 seconds
[0m22:01:53.241512 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:01:53.313449 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.78s]
[0m22:01:53.315307 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:01:53.363839 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.84s]
[0m22:01:53.366008 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:01:54.431540 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.843 seconds
[0m22:01:54.434547 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:01:54.562931 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.03s]
[0m22:01:54.563935 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:01:54.564959 [info ] [MainThread]: 
[0m22:01:54.565966 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:01:54.584513 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:01:54.590156 [debug] [MainThread]: Using snowflake connection "master"
[0m22:01:54.590156 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:01:54.591274 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:01:55.694452 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.104 seconds
[0m22:01:55.696456 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:01:55.711225 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:01:55.712533 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:01:55.714543 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:01:55.718077 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:01:55.722107 [debug] [MainThread]: Using snowflake connection "master"
[0m22:01:55.723110 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.784062385559082'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8358051776885986'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '2.0348968505859375'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set 
        last_modified_at = source.last_modified_at,
        is_active = true,
        test_result = source.test_result,
        execution_time_seconds = source.execution_time_seconds
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_modified_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_modified_at
      );
[0m22:01:56.114870 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.392 seconds
[0m22:01:56.115987 [debug] [MainThread]: Using snowflake connection "master"
[0m22:01:56.115987 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Mark tests as inactive if they're not in the current run
    update dqm.dq_dbt_test_results_central
    set is_active = false,
        last_modified_at = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where test_name not in (
      
        'unique'
        ,
      
        'expression_is_true'
        ,
      
        'not_null'
        
      
    )
    and is_active = true;
[0m22:01:56.435580 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.320 seconds
[0m22:01:56.437084 [debug] [MainThread]: Using snowflake connection "master"
[0m22:01:56.438094 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
;
[0m22:01:56.523313 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba801f-3201-72d0-000b-f692000173d2
[0m22:01:56.524314 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000900 (42601): SQL compilation error:
Empty SQL statement.
[0m22:01:56.524314 [debug] [MainThread]: Snowflake adapter: got empty sql statement, moving on
[0m22:01:56.525433 [debug] [MainThread]: On master: Close
[0m22:01:56.657333 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:01:56.658415 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:01:56.658415 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:01:56.658415 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:01:56.659419 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:01:56.659419 [info ] [MainThread]: 
[0m22:01:56.660422 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.96 seconds (4.96s).
[0m22:01:56.661437 [error] [MainThread]: Encountered an error:
cannot unpack non-iterable NoneType object
[0m22:01:56.662443 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 816, in test
    results = task.run()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 488, in execute_with_hooks
    self.after_run(adapter, res)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 484, in after_run
    self.safe_run_hooks(adapter, RunHookType.End, extras)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 423, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 391, in run_hooks
    response, _ = adapter.execute(sql, auto_begin=False, fetch=False)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 379, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 471, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 506, in add_query
    connection, cursor = self._add_standard_queries(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 562, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
TypeError: cannot unpack non-iterable NoneType object

[0m22:01:56.663447 [debug] [MainThread]: Command `dbt test` failed at 22:01:56.663447 after 6.37 seconds
[0m22:01:56.664450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000168053529B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016820AE7820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000016820CED5D0>]}
[0m22:01:56.664450 [debug] [MainThread]: Flushing usage events
[0m22:03:37.070289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725BE12980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725E9BA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725E9BA2F0>]}


============================== 22:03:37.073307 | 34963b47-506b-425c-90f9-a04e621b8c97 ==============================
[0m22:03:37.073307 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:03:37.074310 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m22:03:37.814131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '34963b47-506b-425c-90f9-a04e621b8c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725E976980>]}
[0m22:03:37.864282 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '34963b47-506b-425c-90f9-a04e621b8c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725C6C3730>]}
[0m22:03:37.865287 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:03:37.887579 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:03:38.132134 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:03:38.133138 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:03:38.303909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '34963b47-506b-425c-90f9-a04e621b8c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027277484B20>]}
[0m22:03:38.433566 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '34963b47-506b-425c-90f9-a04e621b8c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002727760EE00>]}
[0m22:03:38.434571 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:03:38.434571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34963b47-506b-425c-90f9-a04e621b8c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002727779D690>]}
[0m22:03:38.436574 [info ] [MainThread]: 
[0m22:03:38.436574 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:03:38.442069 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:03:38.457306 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:03:38.458310 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:03:38.458310 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:39.122983 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.665 seconds
[0m22:03:39.124985 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:03:39.245632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '34963b47-506b-425c-90f9-a04e621b8c97', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002727760FC10>]}
[0m22:03:39.246644 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:03:39.247652 [info ] [MainThread]: 
[0m22:03:39.249707 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:39.250711 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:39.250711 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:39.251715 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:03:39.251715 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:03:39.252720 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:03:39.252720 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:03:39.253724 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:03:39.253724 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:03:39.254729 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:39.254729 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:39.255735 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:39.271270 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:03:39.277507 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:03:39.282991 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:03:39.283998 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:39.285002 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:39.301127 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:03:39.302131 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:39.305189 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:03:39.307207 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:03:39.308210 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:03:39.309214 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:03:39.309214 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:03:39.310223 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:03:39.310223 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:03:39.311228 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:03:39.313427 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:03:39.313427 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:03:39.314665 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:03:39.907413 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m22:03:39.914447 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:03:40.141626 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.89s]
[0m22:03:40.142632 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:40.269810 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.955 seconds
[0m22:03:40.270813 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:03:40.397089 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.14s]
[0m22:03:40.398188 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:40.861861 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.548 seconds
[0m22:03:40.863868 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:03:40.984740 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.73s]
[0m22:03:40.985744 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:40.986755 [info ] [MainThread]: 
[0m22:03:40.986755 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:03:41.005681 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:03:41.006684 [debug] [MainThread]: Using snowflake connection "master"
[0m22:03:41.006684 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select count(*) as count 
    from information_schema.tables 
    where table_schema = upper('dqm')
    and table_name = 'DQ_DBT_TEST_RESULTS_CENTRAL'
[0m22:03:41.007713 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:03:42.054859 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.047 seconds
[0m22:03:42.056883 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:03:42.069546 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:03:42.070551 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:03:42.071558 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:03:42.075582 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:03:42.080751 [debug] [MainThread]: Using snowflake connection "master"
[0m22:03:42.080751 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8889064788818359'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.1433649063110352'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7300045490264893'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set 
        last_modified_at = source.last_modified_at,
        is_active = true,
        test_result = source.test_result,
        execution_time_seconds = source.execution_time_seconds
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_modified_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_modified_at
      );
[0m22:03:42.579938 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.498 seconds
[0m22:03:42.579938 [debug] [MainThread]: Using snowflake connection "master"
[0m22:03:42.581247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Mark tests as inactive if they're not in the current run
    update dqm.dq_dbt_test_results_central
    set is_active = false,
        last_modified_at = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where test_name not in (
      
        'expression_is_true'
        ,
      
        'not_null'
        ,
      
        'unique'
        
      
    )
    and is_active = true;
[0m22:03:42.850845 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.269 seconds
[0m22:03:42.850845 [debug] [MainThread]: Using snowflake connection "master"
[0m22:03:42.851849 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
;
[0m22:03:42.928354 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8021-3201-72f0-000b-f6920001b062
[0m22:03:42.929359 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000900 (42601): SQL compilation error:
Empty SQL statement.
[0m22:03:42.929359 [debug] [MainThread]: Snowflake adapter: got empty sql statement, moving on
[0m22:03:42.930363 [debug] [MainThread]: On master: Close
[0m22:03:43.058767 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:03:43.058767 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:03:43.059767 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:03:43.059767 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:03:43.059767 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:03:43.060891 [info ] [MainThread]: 
[0m22:03:43.060891 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.62 seconds (4.62s).
[0m22:03:43.061895 [error] [MainThread]: Encountered an error:
cannot unpack non-iterable NoneType object
[0m22:03:43.062900 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 816, in test
    results = task.run()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 488, in execute_with_hooks
    self.after_run(adapter, res)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 484, in after_run
    self.safe_run_hooks(adapter, RunHookType.End, extras)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 423, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 391, in run_hooks
    response, _ = adapter.execute(sql, auto_begin=False, fetch=False)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 379, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 471, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 506, in add_query
    connection, cursor = self._add_standard_queries(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 562, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
TypeError: cannot unpack non-iterable NoneType object

[0m22:03:43.065072 [debug] [MainThread]: Command `dbt test` failed at 22:03:43.065072 after 6.05 seconds
[0m22:03:43.065072 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002725BE12980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027277CA0B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027277CA0D90>]}
[0m22:03:43.066089 [debug] [MainThread]: Flushing usage events
[0m22:03:56.395672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF2ADE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF569A4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF569A2F0>]}


============================== 22:03:56.398860 | 8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8 ==============================
[0m22:03:56.398860 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:03:56.398860 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m22:03:57.103579 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF5656980>]}
[0m22:03:57.147119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF33A3730>]}
[0m22:03:57.148123 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:03:57.169349 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:03:57.404457 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:03:57.404457 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:03:57.542742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E1C5600>]}
[0m22:03:57.672602 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E2212D0>]}
[0m22:03:57.673606 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:03:57.674609 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E4E5660>]}
[0m22:03:57.675611 [info ] [MainThread]: 
[0m22:03:57.676611 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:03:57.680813 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:03:57.696204 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:03:57.696204 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:03:57.697227 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:03:58.353971 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.657 seconds
[0m22:03:58.354975 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:03:58.471527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8fa01a1e-5e9d-4ead-bf40-0a0dc3d706e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E222110>]}
[0m22:03:58.472532 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:03:58.472532 [info ] [MainThread]: 
[0m22:03:58.475555 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:58.476568 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:58.476568 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:58.476568 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:03:58.477574 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:03:58.478579 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:03:58.478579 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:03:58.479584 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:03:58.479584 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:58.480588 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:03:58.480588 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:58.494851 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:03:58.495856 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:58.502006 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:03:58.507144 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:03:58.508648 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:58.514802 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:03:58.524049 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:03:58.527069 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:03:58.527069 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:03:58.530248 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:03:58.531292 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:03:58.532296 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:03:58.533305 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:03:58.534311 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:03:58.534311 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:03:58.534311 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:03:58.535317 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:03:58.535317 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:03:58.537338 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:03:59.130211 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m22:03:59.137454 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:03:59.138458 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.604 seconds
[0m22:03:59.141476 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:03:59.286538 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.81s]
[0m22:03:59.288634 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:03:59.287550 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.81s]
[0m22:03:59.289639 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:04:00.326621 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.789 seconds
[0m22:04:00.328631 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:04:00.448475 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.97s]
[0m22:04:00.449478 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:04:00.451486 [info ] [MainThread]: 
[0m22:04:00.451486 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:04:00.468830 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:04:00.473867 [debug] [MainThread]: Using snowflake connection "master"
[0m22:04:00.474871 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:04:00.474871 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:04:01.436745 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.961 seconds
[0m22:04:01.437755 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:04:01.450937 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:04:01.451942 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:04:01.453951 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:04:01.458050 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:04:01.462103 [debug] [MainThread]: Using snowflake connection "master"
[0m22:04:01.463106 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8079583644866943'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8079664707183838'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.9678864479064941'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      True as is_active,
      convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as last_modified_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set 
        last_modified_at = source.last_modified_at,
        is_active = true,
        test_result = source.test_result,
        execution_time_seconds = source.execution_time_seconds
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_modified_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_modified_at
      );
[0m22:04:01.921421 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.457 seconds
[0m22:04:01.921421 [debug] [MainThread]: Using snowflake connection "master"
[0m22:04:01.922422 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Mark tests as inactive if they're not in the current run
    update dqm.dq_dbt_test_results_central
    set is_active = false,
        last_modified_at = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where test_name not in (
      
        'expression_is_true'
        ,
      
        'not_null'
        ,
      
        'unique'
        
      
    )
    and is_active = true;
[0m22:04:02.135741 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.212 seconds
[0m22:04:02.135741 [debug] [MainThread]: Using snowflake connection "master"
[0m22:04:02.136774 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
;
[0m22:04:02.233071 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8022-3201-72f0-000b-f6920001b06a
[0m22:04:02.233071 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000900 (42601): SQL compilation error:
Empty SQL statement.
[0m22:04:02.234155 [debug] [MainThread]: Snowflake adapter: got empty sql statement, moving on
[0m22:04:02.234155 [debug] [MainThread]: On master: Close
[0m22:04:02.361948 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:04:02.363122 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:04:02.363122 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:04:02.363122 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:04:02.364150 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:04:02.364150 [info ] [MainThread]: 
[0m22:04:02.365153 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m22:04:02.365153 [error] [MainThread]: Encountered an error:
cannot unpack non-iterable NoneType object
[0m22:04:02.366326 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 816, in test
    results = task.run()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 488, in execute_with_hooks
    self.after_run(adapter, res)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 484, in after_run
    self.safe_run_hooks(adapter, RunHookType.End, extras)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 423, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 391, in run_hooks
    response, _ = adapter.execute(sql, auto_begin=False, fetch=False)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 379, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 471, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 506, in add_query
    connection, cursor = self._add_standard_queries(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 562, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
TypeError: cannot unpack non-iterable NoneType object

[0m22:04:02.368337 [debug] [MainThread]: Command `dbt test` failed at 22:04:02.368337 after 6.03 seconds
[0m22:04:02.368337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FFF2ADE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8E872C50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF8EA12560>]}
[0m22:04:02.369341 [debug] [MainThread]: Flushing usage events
[0m22:05:06.094372 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC7E7E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCAA3A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBCAA3A320>]}


============================== 22:05:06.097556 | d3ee074d-ef89-4d8a-9079-38043738bd3a ==============================
[0m22:05:06.097556 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:05:06.098559 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:05:06.819967 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd3ee074d-ef89-4d8a-9079-38043738bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC8107EB0>]}
[0m22:05:06.864107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd3ee074d-ef89-4d8a-9079-38043738bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE33497E0>]}
[0m22:05:06.866202 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:05:06.887361 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:05:07.120675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:05:07.121678 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:05:07.263704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd3ee074d-ef89-4d8a-9079-38043738bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE3443AF0>]}
[0m22:05:07.387105 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd3ee074d-ef89-4d8a-9079-38043738bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE33AFC40>]}
[0m22:05:07.387105 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:05:07.388284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3ee074d-ef89-4d8a-9079-38043738bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE353E440>]}
[0m22:05:07.390298 [info ] [MainThread]: 
[0m22:05:07.390298 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:05:07.395315 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:05:07.409502 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:05:07.410509 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:05:07.410509 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:05:08.091478 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.681 seconds
[0m22:05:08.093493 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:05:08.220963 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd3ee074d-ef89-4d8a-9079-38043738bd3a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE33AC5E0>]}
[0m22:05:08.220963 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:05:08.221964 [info ] [MainThread]: 
[0m22:05:08.224967 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:05:08.225968 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:05:08.225968 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:05:08.227030 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:05:08.227030 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:05:08.228036 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:05:08.228036 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:05:08.228036 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:05:08.229541 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:05:08.229541 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:05:08.230620 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:05:08.230620 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:05:08.244857 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:05:08.251035 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:05:08.256052 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:05:08.257066 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:05:08.265429 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:05:08.272550 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:05:08.275564 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:05:08.276569 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:05:08.279593 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:05:08.280598 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:05:08.281795 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:05:08.281795 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:05:08.282800 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:05:08.283810 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:05:08.283810 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:05:08.284816 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:05:08.284816 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:05:08.286864 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:05:08.920017 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.636 seconds
[0m22:05:08.927052 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:05:08.945969 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.659 seconds
[0m22:05:08.947986 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:05:09.046984 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.82s]
[0m22:05:09.047987 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:05:09.063707 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.83s]
[0m22:05:09.064824 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:05:09.855321 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.570 seconds
[0m22:05:09.857335 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:05:09.989505 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.76s]
[0m22:05:09.990508 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:05:09.992144 [info ] [MainThread]: 
[0m22:05:09.992144 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:05:10.008461 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:05:10.013486 [debug] [MainThread]: Using snowflake connection "master"
[0m22:05:10.013486 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:05:10.014486 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:05:11.096123 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.082 seconds
[0m22:05:11.097146 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:05:11.110279 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:05:11.111284 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:05:11.112287 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:05:11.116435 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:05:11.120453 [debug] [MainThread]: Using snowflake connection "master"
[0m22:05:11.121465 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8189480304718018'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.834165096282959'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7614691257476807'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m22:05:11.523813 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.401 seconds
[0m22:05:11.524819 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.41s]
[0m22:05:11.524819 [info ] [MainThread]: 
[0m22:05:11.525833 [debug] [MainThread]: On master: Close
[0m22:05:11.646626 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:05:11.647631 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:05:11.647631 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:05:11.647631 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:05:11.648636 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:05:11.648636 [info ] [MainThread]: 
[0m22:05:11.649640 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 4.26 seconds (4.26s).
[0m22:05:11.650644 [debug] [MainThread]: Command end result
[0m22:05:11.686085 [info ] [MainThread]: 
[0m22:05:11.687090 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:05:11.688118 [info ] [MainThread]: 
[0m22:05:11.688118 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:05:11.689122 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:05:11.690188 [info ] [MainThread]: 
[0m22:05:11.690188 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:05:11.691191 [info ] [MainThread]: 
[0m22:05:11.691191 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:05:11.692210 [debug] [MainThread]: Command `dbt test` failed at 22:05:11.692210 after 5.65 seconds
[0m22:05:11.693223 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC7E7E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBC9E634C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CBE33ACFD0>]}
[0m22:05:11.693223 [debug] [MainThread]: Flushing usage events
[0m22:06:49.656699 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74B2128F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74DDCE410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74DDCE230>]}


============================== 22:06:49.658707 | d7abaec7-5f1a-4c58-8be4-7111e84ffd51 ==============================
[0m22:06:49.658707 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:06:49.659710 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:06:50.362663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd7abaec7-5f1a-4c58-8be4-7111e84ffd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74B49BCD0>]}
[0m22:06:50.408300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd7abaec7-5f1a-4c58-8be4-7111e84ffd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74D24B760>]}
[0m22:06:50.409307 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:06:50.430688 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:06:50.675528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:06:50.676647 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:06:50.823392 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd7abaec7-5f1a-4c58-8be4-7111e84ffd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7667D3880>]}
[0m22:06:50.943934 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd7abaec7-5f1a-4c58-8be4-7111e84ffd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766BFEB60>]}
[0m22:06:50.945170 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:06:50.945170 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7abaec7-5f1a-4c58-8be4-7111e84ffd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766BA74C0>]}
[0m22:06:50.946623 [info ] [MainThread]: 
[0m22:06:50.947624 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:06:50.951718 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:06:50.966646 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:06:50.966646 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:06:50.967651 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:06:51.600164 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.633 seconds
[0m22:06:51.602337 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:06:51.724291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd7abaec7-5f1a-4c58-8be4-7111e84ffd51', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F7668ED8D0>]}
[0m22:06:51.725294 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:06:51.725294 [info ] [MainThread]: 
[0m22:06:51.728393 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:06:51.729398 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:06:51.729398 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:06:51.729398 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:06:51.730403 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:06:51.731407 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:06:51.730403 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:06:51.732412 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:06:51.732412 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:06:51.733418 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:06:51.733418 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:06:51.747753 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:06:51.748910 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:06:51.754964 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:06:51.760186 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:06:51.761188 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:06:51.771477 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:06:51.776615 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:06:51.779634 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:06:51.779634 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:06:51.780638 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:06:51.783692 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:06:51.783692 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:06:51.784702 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:06:51.785708 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:06:51.786723 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:06:51.786723 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:06:51.788836 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:06:51.788836 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:06:51.789841 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:06:52.382797 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m22:06:52.391495 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:06:52.392500 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.603 seconds
[0m22:06:52.395516 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:06:52.518444 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.79s]
[0m22:06:52.520453 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:06:52.519447 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.79s]
[0m22:06:52.521461 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:06:53.319314 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.530 seconds
[0m22:06:53.321317 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:06:53.441967 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.71s]
[0m22:06:53.442970 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:06:53.444978 [info ] [MainThread]: 
[0m22:06:53.444978 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:06:53.461173 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:06:53.467294 [debug] [MainThread]: Using snowflake connection "master"
[0m22:06:53.467294 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:06:53.467294 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:06:54.452233 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.984 seconds
[0m22:06:54.453774 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:06:54.466067 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:06:54.467070 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:06:54.468441 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:06:54.472471 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:06:54.476511 [debug] [MainThread]: Using snowflake connection "master"
[0m22:06:54.476511 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7860321998596191'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7880399227142334'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7105591297149658'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set 
        target.compiled_sql = source.compiled_sql,
        target.test_result = source.test_result,
        target.execution_time_seconds = source.execution_time_seconds,
        target.is_active = true,
        target.last_updated_at = source.last_updated_at
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_updated_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_updated_at
      )
    when not matched by source then
      update set 
        target.is_active = false,
        target.last_updated_at = convert_timezone('America/New_York', current_TIMESTAMP::timestamp_ntz)
  
  ;
[0m22:06:54.560562 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8024-3201-72d3-000b-f6920001814a
[0m22:06:54.561572 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 180 at position 21 unexpected 'by'.
[0m22:06:54.561572 [info ] [MainThread]: Database error while running on-run-end
[0m22:06:54.562576 [debug] [MainThread]: On master: Close
[0m22:06:54.688838 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:06:54.688838 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:06:54.689844 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:06:54.689844 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:06:54.690850 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:06:54.690850 [info ] [MainThread]: 
[0m22:06:54.691853 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.74 seconds (3.74s).
[0m22:06:54.692900 [debug] [MainThread]: Command end result
[0m22:06:54.728204 [info ] [MainThread]: 
[0m22:06:54.729280 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:06:54.730284 [info ] [MainThread]: 
[0m22:06:54.731287 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:06:54.731287 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:06:54.732348 [info ] [MainThread]: 
[0m22:06:54.733354 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:06:54.733354 [info ] [MainThread]: 
[0m22:06:54.734362 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 180 at position 21 unexpected 'by'.
[0m22:06:54.734362 [info ] [MainThread]: 
[0m22:06:54.735401 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:06:54.736406 [debug] [MainThread]: Command `dbt test` failed at 22:06:54.736406 after 5.14 seconds
[0m22:06:54.737410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74B2128F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F74D24B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F766BFF670>]}
[0m22:06:54.737410 [debug] [MainThread]: Flushing usage events
[0m22:10:23.539144 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E5322E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E55DEA500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E55DEA320>]}


============================== 22:10:23.542090 | 408657c5-50a8-44ff-85b8-fd7821fa6a09 ==============================
[0m22:10:23.542090 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:10:23.543206 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:10:24.267182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '408657c5-50a8-44ff-85b8-fd7821fa6a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E534B7EB0>]}
[0m22:10:24.311578 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '408657c5-50a8-44ff-85b8-fd7821fa6a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E6F97E0>]}
[0m22:10:24.313586 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:10:24.334329 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:10:24.581934 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:10:24.582938 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:10:24.727758 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '408657c5-50a8-44ff-85b8-fd7821fa6a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E7F3AF0>]}
[0m22:10:24.851242 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '408657c5-50a8-44ff-85b8-fd7821fa6a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E757C40>]}
[0m22:10:24.851242 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:10:24.852246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408657c5-50a8-44ff-85b8-fd7821fa6a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E8EE440>]}
[0m22:10:24.853272 [info ] [MainThread]: 
[0m22:10:24.854276 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:10:24.858310 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:10:24.872473 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:10:24.872473 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:10:24.873474 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:10:25.586552 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.713 seconds
[0m22:10:25.588560 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:10:25.712505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '408657c5-50a8-44ff-85b8-fd7821fa6a09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E7545E0>]}
[0m22:10:25.713508 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:10:25.714511 [info ] [MainThread]: 
[0m22:10:25.717527 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:10:25.717527 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:10:25.718528 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:10:25.718528 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:10:25.719590 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:10:25.719590 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:10:25.721098 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:10:25.721098 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:10:25.722103 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:10:25.723108 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:10:25.723108 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:10:25.724112 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:10:25.738891 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:10:25.745916 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:10:25.750571 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:10:25.751585 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:10:25.763160 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:10:25.768373 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:10:25.770881 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:10:25.771884 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:10:25.774897 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:10:25.775900 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:10:25.775900 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:10:25.776913 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:10:25.777918 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:10:25.777918 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:10:25.777918 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:10:25.778924 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:10:25.778924 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:10:25.780428 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:10:26.336796 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.555 seconds
[0m22:10:26.343334 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:10:26.468261 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.75s]
[0m22:10:26.469265 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:10:27.366748 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.588 seconds
[0m22:10:27.367758 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:10:27.488903 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 1.77s]
[0m22:10:27.490407 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:10:27.521414 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.743 seconds
[0m22:10:27.523422 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:10:27.647325 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.93s]
[0m22:10:27.648335 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:10:27.650340 [info ] [MainThread]: 
[0m22:10:27.650340 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:10:27.666493 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:10:27.672097 [debug] [MainThread]: Using snowflake connection "master"
[0m22:10:27.673186 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:10:27.673186 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:10:28.677623 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.004 seconds
[0m22:10:28.678628 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:10:28.691950 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:10:28.692956 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:10:28.694121 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:10:28.699163 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:10:28.702415 [debug] [MainThread]: Using snowflake connection "master"
[0m22:10:28.703537 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7461588382720947'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.768310308456421'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.9262275695800781'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set 
        target.compiled_sql = source.compiled_sql,
        target.test_result = source.test_result,
        target.execution_time_seconds = source.execution_time_seconds,
        target.is_active = true,
        target.last_updated_at = source.last_updated_at
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_updated_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_updated_at
      )
    when not matched by source and target.is_active = true then
      update set 
        target.is_active = false,
        target.last_updated_at = convert_timezone('America/New_York', current_TIMESTAMP::timestamp_ntz)
  
  ;
[0m22:10:28.789028 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8028-3201-72d0-000b-f692000173fa
[0m22:10:28.790532 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 180 at position 21 unexpected 'by'.
[0m22:10:28.791547 [info ] [MainThread]: Database error while running on-run-end
[0m22:10:28.791547 [debug] [MainThread]: On master: Close
[0m22:10:28.924388 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:10:28.925391 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:10:28.925391 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:10:28.925391 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:10:28.926409 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:10:28.926409 [info ] [MainThread]: 
[0m22:10:28.927413 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m22:10:28.928416 [debug] [MainThread]: Command end result
[0m22:10:28.963933 [info ] [MainThread]: 
[0m22:10:28.964936 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:10:28.965937 [info ] [MainThread]: 
[0m22:10:28.967117 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:10:28.967117 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:10:28.968124 [info ] [MainThread]: 
[0m22:10:28.969130 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:10:28.969130 [info ] [MainThread]: 
[0m22:10:28.969130 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 180 at position 21 unexpected 'by'.
[0m22:10:28.970633 [info ] [MainThread]: 
[0m22:10:28.970633 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:10:28.972654 [debug] [MainThread]: Command `dbt test` failed at 22:10:28.971650 after 5.49 seconds
[0m22:10:28.972654 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E5322E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E754940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019E6E7579D0>]}
[0m22:10:28.972654 [debug] [MainThread]: Flushing usage events
[0m22:11:39.252529 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001500695E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001500952A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001500952A350>]}


============================== 22:11:39.255540 | 4c07b83c-b804-4183-af53-1d97ad77e468 ==============================
[0m22:11:39.255540 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:11:39.255540 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:11:39.967930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4c07b83c-b804-4183-af53-1d97ad77e468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015006BE7970>]}
[0m22:11:40.011506 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4c07b83c-b804-4183-af53-1d97ad77e468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015006433580>]}
[0m22:11:40.013512 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:11:40.033940 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:11:40.284129 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:11:40.285132 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:11:40.427221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4c07b83c-b804-4183-af53-1d97ad77e468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015021E9C550>]}
[0m22:11:40.549290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4c07b83c-b804-4183-af53-1d97ad77e468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502233DDE0>]}
[0m22:11:40.549290 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:11:40.550794 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c07b83c-b804-4183-af53-1d97ad77e468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502202E0B0>]}
[0m22:11:40.552938 [info ] [MainThread]: 
[0m22:11:40.552938 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:11:40.557957 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:11:40.571197 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:11:40.572203 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:11:40.572203 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:11:41.194575 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.622 seconds
[0m22:11:41.195581 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:11:41.338752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4c07b83c-b804-4183-af53-1d97ad77e468', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502233E4A0>]}
[0m22:11:41.339755 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:11:41.340757 [info ] [MainThread]: 
[0m22:11:41.343207 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:11:41.344302 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:11:41.344302 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:11:41.344302 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:11:41.345311 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:11:41.346324 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:11:41.346324 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:11:41.347330 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:11:41.347330 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:11:41.348336 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:11:41.348336 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:11:41.349341 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:11:41.363763 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:11:41.369827 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:11:41.374353 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:11:41.375490 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:11:41.390093 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:11:41.391600 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:11:41.393610 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:11:41.394616 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:11:41.397636 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:11:41.399141 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:11:41.399141 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:11:41.400159 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:11:41.400159 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:11:41.401160 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:11:41.401666 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:11:41.401666 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:11:41.402671 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:11:41.405688 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:11:41.962688 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m22:11:41.969323 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:11:42.095682 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.75s]
[0m22:11:42.096690 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:11:43.175743 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.770 seconds
[0m22:11:43.177759 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:11:43.295238 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.95s]
[0m22:11:43.296242 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:11:44.140769 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.738 seconds
[0m22:11:44.141784 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:11:44.262154 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.91s]
[0m22:11:44.263159 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:11:44.264165 [info ] [MainThread]: 
[0m22:11:44.265189 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:11:44.280844 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:11:44.286456 [debug] [MainThread]: Using snowflake connection "master"
[0m22:11:44.287461 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:11:44.287461 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:11:45.349200 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.062 seconds
[0m22:11:45.350928 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:11:45.363479 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:11:45.364482 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:11:45.365677 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:11:45.371213 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:11:45.374428 [debug] [MainThread]: Using snowflake connection "master"
[0m22:11:45.375431 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7493572235107422'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.9479081630706787'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '2.9148244857788086'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    WHEN MATCHED THEN
      update set 
        target.compiled_sql = source.compiled_sql,
        target.test_result = source.test_result,
        target.execution_time_seconds = source.execution_time_seconds,
        target.is_active = true,
        target.last_updated_at = source.last_updated_at
    WHEN NOT MATCHED BY SOURCE AND target.is_active = true THEN
      update set 
        target.is_active = false,
        target.last_updated_at = convert_timezone('America/New_York', current_TIMESTAMP::timestamp_ntz)
    WHEN NOT MATCHED THEN
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_updated_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_updated_at
      )
  
  ;
[0m22:11:45.465422 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8029-3201-72e6-000b-f6920001a0ba
[0m22:11:45.465422 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 165 at position 21 unexpected 'BY'.
[0m22:11:45.466433 [info ] [MainThread]: Database error while running on-run-end
[0m22:11:45.467439 [debug] [MainThread]: On master: Close
[0m22:11:45.587134 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:11:45.588137 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:11:45.588137 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:11:45.588137 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:11:45.589160 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:11:45.589160 [info ] [MainThread]: 
[0m22:11:45.590164 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 5.04 seconds (5.04s).
[0m22:11:45.591166 [debug] [MainThread]: Command end result
[0m22:11:45.627124 [info ] [MainThread]: 
[0m22:11:45.627124 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:11:45.628129 [info ] [MainThread]: 
[0m22:11:45.629252 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:11:45.629252 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:11:45.630757 [info ] [MainThread]: 
[0m22:11:45.631774 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:11:45.631774 [info ] [MainThread]: 
[0m22:11:45.632783 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 165 at position 21 unexpected 'BY'.
[0m22:11:45.633789 [info ] [MainThread]: 
[0m22:11:45.633789 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:11:45.635800 [debug] [MainThread]: Command `dbt test` failed at 22:11:45.635800 after 6.44 seconds
[0m22:11:45.635800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001500695E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000015006433580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001502233FA60>]}
[0m22:11:45.636813 [debug] [MainThread]: Flushing usage events
[0m22:13:39.970661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224D3C2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224FFB6500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224FFB6320>]}


============================== 22:13:39.973867 | 6c9a923a-855d-4436-badb-4a92e305be09 ==============================
[0m22:13:39.973867 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:13:39.974870 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m22:13:40.687104 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6c9a923a-855d-4436-badb-4a92e305be09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224D64BEB0>]}
[0m22:13:40.732086 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6c9a923a-855d-4436-badb-4a92e305be09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222688897E0>]}
[0m22:13:40.734092 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:13:40.756240 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:13:41.003258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:13:41.004262 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:13:41.146434 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6c9a923a-855d-4436-badb-4a92e305be09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022268983AF0>]}
[0m22:13:41.292978 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6c9a923a-855d-4436-badb-4a92e305be09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222688EFC40>]}
[0m22:13:41.293986 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:13:41.294988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c9a923a-855d-4436-badb-4a92e305be09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022268A82440>]}
[0m22:13:41.297063 [info ] [MainThread]: 
[0m22:13:41.298451 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:13:41.303828 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:13:41.317023 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:13:41.317023 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:13:41.318028 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:13:41.974923 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.657 seconds
[0m22:13:41.975928 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:13:42.097999 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6c9a923a-855d-4436-badb-4a92e305be09', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222688EC5E0>]}
[0m22:13:42.099004 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:13:42.099004 [info ] [MainThread]: 
[0m22:13:42.102018 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:13:42.103059 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:13:42.103059 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:13:42.103059 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:13:42.104238 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:13:42.105240 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:13:42.104238 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:13:42.105240 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:13:42.106315 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:13:42.106315 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:13:42.107319 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:13:42.121522 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:13:42.121522 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:13:42.128722 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:13:42.134728 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:13:42.136099 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:13:42.152809 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:13:42.152809 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:13:42.153814 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:13:42.155830 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:13:42.156848 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:13:42.160076 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:13:42.161080 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:13:42.162085 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:13:42.162085 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:13:42.162085 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:13:42.163088 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:13:42.164186 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:13:42.165465 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:13:42.167480 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:13:42.721761 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.556 seconds
[0m22:13:42.727862 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:13:42.745789 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.579 seconds
[0m22:13:42.747887 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:13:42.848607 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.74s]
[0m22:13:42.850110 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:13:42.864658 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.76s]
[0m22:13:42.866806 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:13:43.897103 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.735 seconds
[0m22:13:43.898104 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:13:44.019164 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 1.91s]
[0m22:13:44.020857 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:13:44.022043 [info ] [MainThread]: 
[0m22:13:44.023050 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:13:44.038177 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:13:44.044344 [debug] [MainThread]: Using snowflake connection "master"
[0m22:13:44.045348 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:13:44.045348 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:13:45.013395 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.968 seconds
[0m22:13:45.014398 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:13:45.026550 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:13:45.028557 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:13:45.029561 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:13:45.033717 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:13:45.037719 [debug] [MainThread]: Using snowflake connection "master"
[0m22:13:45.037719 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7433667182922363'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7583422660827637'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.913924217224121'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as TIMESTAMP,
      true as is_active,
      convert_timezone( 'America/New_York', current_TIMESTAMP::timestamp_ntz) as last_updated_at
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    WHEN MATCHED THEN
      update set 
        target.compiled_sql = source.compiled_sql,
        target.test_result = source.test_result,
        target.execution_time_seconds = source.execution_time_seconds,
        target.is_active = true,
        target.last_updated_at = source.last_updated_at
    WHEN NOT MATCHED BY TARGET THEN
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, last_updated_at
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        source.is_active, source.last_updated_at
      )
    WHEN NOT MATCHED BY SOURCE THEN
      update set 
        target.is_active = false,
        target.last_updated_at = convert_timezone('America/New_York', current_TIMESTAMP::timestamp_ntz)
  
  ;
[0m22:13:45.124577 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba802b-3201-727e-000b-f69200019126
[0m22:13:45.125584 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 163 at position 21 unexpected 'BY'.
syntax error line 178 at position 21 unexpected 'BY'.
[0m22:13:45.125584 [info ] [MainThread]: Database error while running on-run-end
[0m22:13:45.126593 [debug] [MainThread]: On master: Close
[0m22:13:45.277109 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:13:45.278121 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:13:45.278121 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:13:45.278121 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:13:45.279127 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:13:45.279127 [info ] [MainThread]: 
[0m22:13:45.280222 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.98 seconds (3.98s).
[0m22:13:45.281230 [debug] [MainThread]: Command end result
[0m22:13:45.317921 [info ] [MainThread]: 
[0m22:13:45.317921 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:13:45.318928 [info ] [MainThread]: 
[0m22:13:45.319933 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:13:45.320938 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:13:45.320938 [info ] [MainThread]: 
[0m22:13:45.321974 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:13:45.321974 [info ] [MainThread]: 
[0m22:13:45.322979 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 163 at position 21 unexpected 'BY'.
syntax error line 178 at position 21 unexpected 'BY'.
[0m22:13:45.322979 [info ] [MainThread]: 
[0m22:13:45.323984 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:13:45.324988 [debug] [MainThread]: Command `dbt test` failed at 22:13:45.324988 after 5.41 seconds
[0m22:13:45.324988 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002224D3C2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222688EC940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222688EF9D0>]}
[0m22:13:45.326054 [debug] [MainThread]: Flushing usage events
[0m22:15:18.578944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC53EDE860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC56A8E3B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC56A8E1D0>]}


============================== 22:15:18.582318 | 099fe1da-0227-4a52-8f06-f218ba5c501c ==============================
[0m22:15:18.582318 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:15:18.582318 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:15:19.290522 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '099fe1da-0227-4a52-8f06-f218ba5c501c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC5416B730>]}
[0m22:15:19.335034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '099fe1da-0227-4a52-8f06-f218ba5c501c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC56482EC0>]}
[0m22:15:19.336037 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:15:19.356788 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:15:19.603417 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:15:19.604422 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:15:19.741433 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '099fe1da-0227-4a52-8f06-f218ba5c501c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC6F550790>]}
[0m22:15:19.862045 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '099fe1da-0227-4a52-8f06-f218ba5c501c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC6F8B2F80>]}
[0m22:15:19.862045 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:15:19.863054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099fe1da-0227-4a52-8f06-f218ba5c501c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC6F8F6EC0>]}
[0m22:15:19.864058 [info ] [MainThread]: 
[0m22:15:19.865062 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:15:19.870165 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:15:19.883405 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:15:19.883405 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:15:19.884519 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:15:20.524049 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.640 seconds
[0m22:15:20.526058 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:15:20.644895 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '099fe1da-0227-4a52-8f06-f218ba5c501c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC6F8B3AC0>]}
[0m22:15:20.645898 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:15:20.645898 [info ] [MainThread]: 
[0m22:15:20.649751 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:15:20.649751 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:15:20.649751 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:15:20.650752 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:15:20.651257 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:15:20.651257 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:15:20.652262 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:15:20.653270 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:15:20.653270 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:15:20.654275 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:15:20.654275 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:15:20.654275 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:15:20.668507 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:15:20.675613 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:15:20.680673 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:15:20.681682 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:15:20.681682 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:15:20.697935 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:15:20.701211 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:15:20.701211 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:15:20.702410 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:15:20.705555 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:15:20.705555 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:15:20.706580 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:15:20.707584 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:15:20.707584 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:15:20.708631 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:15:20.709957 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:15:20.711244 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:15:20.712579 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:15:21.318637 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m22:15:21.319644 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m22:15:21.326698 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:15:21.327704 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m22:15:21.328710 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:15:21.331728 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:15:21.453991 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.80s]
[0m22:15:21.454997 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:15:21.456127 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.80s]
[0m22:15:21.457142 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:15:21.457142 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.80s]
[0m22:15:21.458146 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:15:21.459168 [info ] [MainThread]: 
[0m22:15:21.460172 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:15:21.476936 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:15:21.483387 [debug] [MainThread]: Using snowflake connection "master"
[0m22:15:21.483387 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:15:21.483387 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:15:22.468018 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.984 seconds
[0m22:15:22.469027 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:15:22.482203 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:15:22.483210 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:15:22.485241 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:15:22.490341 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:15:22.493367 [debug] [MainThread]: Using snowflake connection "master"
[0m22:15:22.493367 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8017292022705078'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8028576374053955'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8048801422119141'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target._timestamp::date = source._timestamp::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, _timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source._timestamp
      )
    when matched then
      update set
        test_result = source.test_result,
        execution_time_seconds = source.execution_time_seconds,
        _timestamp = source._timestamp
    when not matched by source and target.test_name not in ('not_null_my_first_dbt_model_id','unique_my_first_dbt_model_id','dbt_utils_expression_is_true_my_first_dbt_model_id___1') then
      update set
        test_result = 'inactive',
        _timestamp = current_timestamp
  
  ;
[0m22:15:22.577051 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba802d-3201-72e6-000b-f6920001a0f2
[0m22:15:22.578057 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 170 at position 21 unexpected 'by'.
[0m22:15:22.578057 [info ] [MainThread]: Database error while running on-run-end
[0m22:15:22.579063 [debug] [MainThread]: On master: Close
[0m22:15:22.704403 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:15:22.705409 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:15:22.705409 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:15:22.705409 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:15:22.706415 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:15:22.706415 [info ] [MainThread]: 
[0m22:15:22.707420 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 2.84 seconds (2.84s).
[0m22:15:22.708425 [debug] [MainThread]: Command end result
[0m22:15:22.746347 [info ] [MainThread]: 
[0m22:15:22.747351 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:15:22.747351 [info ] [MainThread]: 
[0m22:15:22.748356 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:15:22.749358 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:15:22.749358 [info ] [MainThread]: 
[0m22:15:22.750375 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:15:22.751381 [info ] [MainThread]: 
[0m22:15:22.751381 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 170 at position 21 unexpected 'by'.
[0m22:15:22.752386 [info ] [MainThread]: 
[0m22:15:22.752386 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:15:22.754407 [debug] [MainThread]: Command `dbt test` failed at 22:15:22.754407 after 4.23 seconds
[0m22:15:22.754407 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC53EDE860>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC56482EC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002BC6F8B0FD0>]}
[0m22:15:22.755484 [debug] [MainThread]: Flushing usage events
[0m22:16:19.882316 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F187E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F443E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F443E320>]}


============================== 22:16:19.885915 | 02c5a1f1-9939-4fb1-a4e2-b454fa59ed75 ==============================
[0m22:16:19.885915 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:16:19.886921 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:16:20.611611 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '02c5a1f1-9939-4fb1-a4e2-b454fa59ed75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F1B07A90>]}
[0m22:16:20.661367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '02c5a1f1-9939-4fb1-a4e2-b454fa59ed75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F1353520>]}
[0m22:16:20.662368 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:16:20.685705 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:16:20.934779 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:16:20.934779 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:16:21.080858 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '02c5a1f1-9939-4fb1-a4e2-b454fa59ed75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FFF35360>]}
[0m22:16:21.203950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '02c5a1f1-9939-4fb1-a4e2-b454fa59ed75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E48D13CCA0>]}
[0m22:16:21.205227 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:16:21.205227 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02c5a1f1-9939-4fb1-a4e2-b454fa59ed75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E48D2DFA60>]}
[0m22:16:21.206670 [info ] [MainThread]: 
[0m22:16:21.207976 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:16:21.212011 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:16:21.225702 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:16:21.226706 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:16:21.226706 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:16:21.883153 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.656 seconds
[0m22:16:21.884164 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:16:22.022613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '02c5a1f1-9939-4fb1-a4e2-b454fa59ed75', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E48D309FF0>]}
[0m22:16:22.023617 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:16:22.024621 [info ] [MainThread]: 
[0m22:16:22.027707 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:16:22.027707 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:16:22.027707 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:16:22.027707 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:16:22.029153 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:16:22.029153 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:16:22.030165 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:16:22.031168 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:16:22.031168 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:16:22.031168 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:16:22.032602 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:16:22.032602 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:16:22.048052 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:16:22.054060 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:16:22.060430 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:16:22.061444 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:16:22.072941 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:16:22.078099 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:16:22.082102 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:16:22.082102 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:16:22.083103 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:16:22.086106 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:16:22.086106 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:16:22.087109 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:16:22.088110 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:16:22.088110 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:16:22.089110 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:16:22.090246 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:16:22.091252 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:16:22.093268 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:16:22.670939 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.578 seconds
[0m22:16:22.678028 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:16:22.687182 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.600 seconds
[0m22:16:22.688185 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:16:22.796817 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.77s]
[0m22:16:22.798067 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:16:22.816282 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.79s]
[0m22:16:22.817289 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:16:23.615815 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.526 seconds
[0m22:16:23.618043 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:16:23.743959 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.71s]
[0m22:16:23.744963 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:16:23.745969 [info ] [MainThread]: 
[0m22:16:23.747123 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:16:23.764332 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:16:23.770531 [debug] [MainThread]: Using snowflake connection "master"
[0m22:16:23.771539 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:16:23.771539 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:16:24.750974 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.979 seconds
[0m22:16:24.751978 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:16:24.764153 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:16:24.766169 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:16:24.767180 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:16:24.772284 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:16:24.775295 [debug] [MainThread]: Using snowflake connection "master"
[0m22:16:24.776299 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.765648603439331'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7861175537109375'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.713794231414795'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target._timestamp::date = source._timestamp::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, _timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source._timestamp
      )
    when matched then
      update set
        test_result = source.test_result,
        execution_time_seconds = source.execution_time_seconds,
        _timestamp = source._timestamp
    when not matched by source then
      update set
        test_result = 'inactive',
        _timestamp = current_timestamp
    where target.test_name not in ('unique_my_first_dbt_model_id','dbt_utils_expression_is_true_my_first_dbt_model_id___1','not_null_my_first_dbt_model_id')
  
  ;
[0m22:16:24.859533 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba802e-3201-7237-000b-f6920001477e
[0m22:16:24.859533 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 170 at position 21 unexpected 'by'.
[0m22:16:24.860534 [info ] [MainThread]: Database error while running on-run-end
[0m22:16:24.860534 [debug] [MainThread]: On master: Close
[0m22:16:24.976189 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:16:24.977192 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:16:24.977192 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:16:24.978196 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:16:24.978196 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:16:24.978196 [info ] [MainThread]: 
[0m22:16:24.979200 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.77 seconds (3.77s).
[0m22:16:24.980204 [debug] [MainThread]: Command end result
[0m22:16:25.015721 [info ] [MainThread]: 
[0m22:16:25.016723 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:16:25.017920 [info ] [MainThread]: 
[0m22:16:25.018924 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:16:25.018924 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:16:25.019929 [info ] [MainThread]: 
[0m22:16:25.019929 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:16:25.021195 [info ] [MainThread]: 
[0m22:16:25.022221 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 170 at position 21 unexpected 'by'.
[0m22:16:25.022221 [info ] [MainThread]: 
[0m22:16:25.023225 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:16:25.024231 [debug] [MainThread]: Command `dbt test` failed at 22:16:25.024231 after 5.20 seconds
[0m22:16:25.025234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F187E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4FFD7B880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4F385ED10>]}
[0m22:16:25.025234 [debug] [MainThread]: Flushing usage events
[0m22:18:51.730980 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D3345E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D35FEA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D35FEA2F0>]}


============================== 22:18:51.733993 | fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9 ==============================
[0m22:18:51.733993 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:18:51.734996 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:18:52.503636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D35FA6980>]}
[0m22:18:52.550666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D33D07730>]}
[0m22:18:52.551667 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:18:52.575418 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:18:52.818266 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:18:52.819267 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:18:52.961839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4E955840>]}
[0m22:18:53.082411 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4EDF9990>]}
[0m22:18:53.083416 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:18:53.083416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4EDC7D30>]}
[0m22:18:53.085583 [info ] [MainThread]: 
[0m22:18:53.086590 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:18:53.092642 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:18:53.106884 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:18:53.106884 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:18:53.106884 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:18:53.762014 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.655 seconds
[0m22:18:53.764026 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:18:53.886095 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc4c8e26-d9e8-4bcf-b6d2-2c670a3f20b9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4E8D2DA0>]}
[0m22:18:53.887110 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:18:53.887110 [info ] [MainThread]: 
[0m22:18:53.890250 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:18:53.891255 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:18:53.891255 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:18:53.892292 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:18:53.892292 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:18:53.893297 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:18:53.894302 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:18:53.894302 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:18:53.895306 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:18:53.895306 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:18:53.896311 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:18:53.896311 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:18:53.912829 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:18:53.918873 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:18:53.926212 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:18:53.927218 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:18:53.927218 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:18:53.944767 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:18:53.944767 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:18:53.947788 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:18:53.950802 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:18:53.951951 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:18:53.952953 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:18:53.952953 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:18:53.953978 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:18:53.953978 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:18:53.954984 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:18:53.956995 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:18:53.956995 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:18:53.958000 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:18:54.539130 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m22:18:54.546158 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:18:54.547169 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.589 seconds
[0m22:18:54.549181 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:18:54.666137 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.77s]
[0m22:18:54.668149 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:18:54.671210 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m22:18:54.672215 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:18:55.527455 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.569 seconds
[0m22:18:55.528455 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:18:55.662578 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.77s]
[0m22:18:55.663586 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:18:55.664590 [info ] [MainThread]: 
[0m22:18:55.665595 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:18:55.680752 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:18:55.686412 [debug] [MainThread]: Using snowflake connection "master"
[0m22:18:55.687432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:18:55.687432 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:18:56.678379 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.991 seconds
[0m22:18:56.680381 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:18:56.693384 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:18:56.694393 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:18:56.695843 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:18:56.700365 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:18:56.705526 [debug] [MainThread]: Using snowflake connection "master"
[0m22:18:56.705526 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7728395462036133'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7769088745117188'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7672719955444336'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as _timestamp
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target._timestamp::date = source._timestamp::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, _timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source._timestamp
      )
  
  ;
[0m22:18:56.809636 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8030-3201-72d0-000b-f6920001742a
[0m22:18:56.810640 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 156 at position 54
invalid identifier '_TIMESTAMP'
[0m22:18:56.810640 [info ] [MainThread]: Database error while running on-run-end
[0m22:18:56.811651 [debug] [MainThread]: On master: Close
[0m22:18:56.928301 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:18:56.928301 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:18:56.929307 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:18:56.929307 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:18:56.930310 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:18:56.930310 [info ] [MainThread]: 
[0m22:18:56.931320 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.84 seconds (3.84s).
[0m22:18:56.932386 [debug] [MainThread]: Command end result
[0m22:18:56.970017 [info ] [MainThread]: 
[0m22:18:56.970017 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:18:56.971021 [info ] [MainThread]: 
[0m22:18:56.972022 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:18:56.972022 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:18:56.973388 [info ] [MainThread]: 
[0m22:18:56.973388 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:18:56.974392 [info ] [MainThread]: 
[0m22:18:56.974392 [error] [MainThread]:   on-run-end failed, error:
 000904 (42000): SQL compilation error: error line 156 at position 54
invalid identifier '_TIMESTAMP'
[0m22:18:56.975396 [info ] [MainThread]: 
[0m22:18:56.975396 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:18:56.977412 [debug] [MainThread]: Command `dbt test` failed at 22:18:56.976409 after 5.31 seconds
[0m22:18:56.977412 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D3345E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D33D07730>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D4EDF90C0>]}
[0m22:18:56.978537 [debug] [MainThread]: Flushing usage events
[0m22:19:22.962193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB64AE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB906A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB906A320>]}


============================== 22:19:22.965598 | fb9a4068-f7dd-4d42-af55-482c5bb591c5 ==============================
[0m22:19:22.965598 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:19:22.966601 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:19:23.689976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb9a4068-f7dd-4d42-af55-482c5bb591c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB6737A90>]}
[0m22:19:23.734961 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb9a4068-f7dd-4d42-af55-482c5bb591c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB5F83520>]}
[0m22:19:23.735964 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:19:23.757291 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:19:24.011749 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:19:24.011749 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:19:24.153764 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb9a4068-f7dd-4d42-af55-482c5bb591c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD1AD91B0>]}
[0m22:19:24.275400 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb9a4068-f7dd-4d42-af55-482c5bb591c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD19DEDD0>]}
[0m22:19:24.275400 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:19:24.276410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb9a4068-f7dd-4d42-af55-482c5bb591c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD1B6E470>]}
[0m22:19:24.278419 [info ] [MainThread]: 
[0m22:19:24.278419 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:19:24.283491 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:19:24.297696 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:19:24.298701 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:19:24.298701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:24.930527 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.632 seconds
[0m22:19:24.931531 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:19:25.059199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb9a4068-f7dd-4d42-af55-482c5bb591c5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD19DF130>]}
[0m22:19:25.059199 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:19:25.060201 [info ] [MainThread]: 
[0m22:19:25.063312 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:25.063312 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:25.063312 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:25.064316 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:19:25.064316 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:19:25.065820 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:19:25.066428 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:19:25.066428 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:19:25.067440 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:19:25.067440 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:25.068446 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:25.068446 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:25.085928 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:19:25.094770 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:19:25.100054 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:19:25.101058 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:25.112140 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:25.118288 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:19:25.122390 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:19:25.122390 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:25.123465 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:19:25.126495 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:19:25.127511 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:19:25.128108 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:19:25.129114 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:19:25.129114 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:19:25.130119 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:19:25.130119 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:19:25.131123 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:19:25.133541 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:19:25.717122 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m22:19:25.724155 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:19:25.726953 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m22:19:25.728739 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:19:25.849330 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.78s]
[0m22:19:25.850804 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:25.855933 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.79s]
[0m22:19:25.856937 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:26.693201 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.563 seconds
[0m22:19:26.695208 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:19:26.822131 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.76s]
[0m22:19:26.823135 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:26.825353 [info ] [MainThread]: 
[0m22:19:26.825353 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:19:26.841793 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:19:26.846813 [debug] [MainThread]: Using snowflake connection "master"
[0m22:19:26.846813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:19:26.847816 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:19:27.820433 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.973 seconds
[0m22:19:27.822446 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:19:27.834465 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:19:27.836610 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:19:27.837837 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:19:27.842868 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:19:27.847086 [debug] [MainThread]: Using snowflake connection "master"
[0m22:19:27.847086 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7818901538848877'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7901122570037842'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7557024955749512'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m22:19:28.230223 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.382 seconds
[0m22:19:28.231373 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 3[0m in 0.39s]
[0m22:19:28.232376 [info ] [MainThread]: 
[0m22:19:28.232376 [debug] [MainThread]: On master: Close
[0m22:19:28.358540 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:28.359550 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:19:28.359550 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:19:28.360553 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:19:28.360553 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:19:28.360553 [info ] [MainThread]: 
[0m22:19:28.361559 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 4.08 seconds (4.08s).
[0m22:19:28.362565 [debug] [MainThread]: Command end result
[0m22:19:28.399657 [info ] [MainThread]: 
[0m22:19:28.400781 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:19:28.400781 [info ] [MainThread]: 
[0m22:19:28.401793 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:19:28.402796 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:19:28.402796 [info ] [MainThread]: 
[0m22:19:28.403804 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:19:28.404809 [info ] [MainThread]: 
[0m22:19:28.404809 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:19:28.406821 [debug] [MainThread]: Command `dbt test` failed at 22:19:28.406821 after 5.50 seconds
[0m22:19:28.407825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB64AE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DB848F490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019DD233C340>]}
[0m22:19:28.407825 [debug] [MainThread]: Flushing usage events
[0m22:19:50.720048 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D79EE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213DA5AE530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213DA5AE350>]}


============================== 22:19:50.723269 | 2cd9f384-3270-4969-8447-b6ecedcaed7c ==============================
[0m22:19:50.723269 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:19:50.723269 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:19:51.443479 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2cd9f384-3270-4969-8447-b6ecedcaed7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D7C77970>]}
[0m22:19:51.488167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2cd9f384-3270-4969-8447-b6ecedcaed7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D74C3580>]}
[0m22:19:51.490176 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:19:51.511558 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:19:51.750016 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m22:19:51.750016 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m22:19:51.797657 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2cd9f384-3270-4969-8447-b6ecedcaed7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F33F0130>]}
[0m22:19:51.964672 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2cd9f384-3270-4969-8447-b6ecedcaed7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F2EE02E0>]}
[0m22:19:51.965679 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:19:51.965679 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd9f384-3270-4969-8447-b6ecedcaed7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213DA0A4760>]}
[0m22:19:51.968012 [info ] [MainThread]: 
[0m22:19:51.968012 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:19:51.973204 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:19:51.986935 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:19:51.988008 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:19:51.988008 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:19:52.661413 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.673 seconds
[0m22:19:52.663415 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:19:52.782186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2cd9f384-3270-4969-8447-b6ecedcaed7c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F2EE39A0>]}
[0m22:19:52.782186 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:19:52.783191 [info ] [MainThread]: 
[0m22:19:52.786214 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:52.787216 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:52.787216 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:52.787216 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:19:52.788238 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:19:52.788238 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:19:52.789241 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:19:52.790242 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:19:52.790242 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:19:52.791242 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:52.791242 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:52.792243 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:52.807611 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:19:52.813801 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:19:52.818812 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:19:52.818812 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:52.837992 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:19:52.838996 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:52.838996 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:52.842153 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:19:52.843317 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:19:52.845321 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:19:52.845321 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:19:52.846805 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:19:52.846805 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:19:52.847999 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:19:52.847999 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:19:52.850227 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:19:52.851317 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:19:52.851317 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:19:53.378980 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m22:19:53.386219 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:19:53.418433 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m22:19:53.420445 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:19:53.505592 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.72s]
[0m22:19:53.506596 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:19:53.542382 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.75s]
[0m22:19:53.543393 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:19:54.386015 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.535 seconds
[0m22:19:54.388023 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:19:54.505892 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.72s]
[0m22:19:54.507039 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:19:54.508042 [info ] [MainThread]: 
[0m22:19:54.509126 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:19:54.525562 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:19:54.530572 [debug] [MainThread]: Using snowflake connection "master"
[0m22:19:54.530572 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:19:54.531573 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:19:55.532070 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.000 seconds
[0m22:19:55.533073 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:19:55.546356 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:19:55.547708 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:19:55.549258 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:19:55.553902 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:19:55.557512 [debug] [MainThread]: Using snowflake connection "master"
[0m22:19:55.558535 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7163510322570801'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7531418800354004'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7156500816345215'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m22:19:55.919470 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.360 seconds
[0m22:19:55.920476 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.37s]
[0m22:19:55.921483 [info ] [MainThread]: 
[0m22:19:55.921483 [debug] [MainThread]: On master: Close
[0m22:19:56.038097 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:19:56.038097 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:19:56.039105 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:19:56.039105 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:19:56.040109 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:19:56.040109 [info ] [MainThread]: 
[0m22:19:56.041112 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 4.07 seconds (4.07s).
[0m22:19:56.043316 [debug] [MainThread]: Command end result
[0m22:19:56.079153 [info ] [MainThread]: 
[0m22:19:56.079153 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:19:56.080156 [info ] [MainThread]: 
[0m22:19:56.081392 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:19:56.081392 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:19:56.081392 [info ] [MainThread]: 
[0m22:19:56.082791 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:19:56.083796 [info ] [MainThread]: 
[0m22:19:56.083796 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:19:56.085042 [debug] [MainThread]: Command `dbt test` failed at 22:19:56.085042 after 5.42 seconds
[0m22:19:56.085042 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D79EE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213D74C3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000213F3765930>]}
[0m22:19:56.086340 [debug] [MainThread]: Flushing usage events
[0m22:21:34.935598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC40E02950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC439BE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC439BE320>]}


============================== 22:21:34.938607 | 0c423a0a-0e85-4189-a531-25c4698aa656 ==============================
[0m22:21:34.938607 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:21:34.939610 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:21:35.680809 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0c423a0a-0e85-4189-a531-25c4698aa656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC41087A90>]}
[0m22:21:35.723450 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0c423a0a-0e85-4189-a531-25c4698aa656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC408D3520>]}
[0m22:21:35.724453 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:21:35.744672 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:21:35.973891 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:21:35.974894 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:21:36.112238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0c423a0a-0e85-4189-a531-25c4698aa656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5C4291B0>]}
[0m22:21:36.232993 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0c423a0a-0e85-4189-a531-25c4698aa656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5C326DD0>]}
[0m22:21:36.232993 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:21:36.233997 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c423a0a-0e85-4189-a531-25c4698aa656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5C4BE470>]}
[0m22:21:36.235004 [info ] [MainThread]: 
[0m22:21:36.236007 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:21:36.240020 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:21:36.254576 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:21:36.254576 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:21:36.255595 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:21:36.985780 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.730 seconds
[0m22:21:36.986781 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:21:37.109952 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0c423a0a-0e85-4189-a531-25c4698aa656', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5C327130>]}
[0m22:21:37.111751 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:21:37.111751 [info ] [MainThread]: 
[0m22:21:37.115468 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:21:37.115468 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:21:37.116591 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:21:37.116591 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:21:37.117597 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:21:37.118605 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:21:37.118605 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:21:37.119611 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:21:37.120619 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:21:37.120619 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:21:37.120619 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:21:37.122124 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:21:37.137420 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:21:37.142869 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:21:37.149071 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:21:37.150082 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:21:37.150082 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:21:37.165715 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:21:37.167722 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:21:37.168725 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:21:37.171744 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:21:37.172849 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:21:37.172849 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:21:37.173854 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:21:37.173854 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:21:37.174857 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:21:37.174857 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:21:37.175982 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:21:37.175982 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:21:37.178003 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:21:37.784060 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.607 seconds
[0m22:21:37.791105 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:21:37.941434 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.82s]
[0m22:21:37.942442 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:21:38.726980 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.552 seconds
[0m22:21:38.728990 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:21:38.851705 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 1.73s]
[0m22:21:38.852711 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:21:39.869126 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.693 seconds
[0m22:21:39.871136 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:21:39.994648 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.88s]
[0m22:21:39.995655 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:21:39.996667 [info ] [MainThread]: 
[0m22:21:39.997670 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:21:40.012798 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:21:40.018989 [debug] [MainThread]: Using snowflake connection "master"
[0m22:21:40.018989 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:21:40.019990 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:21:41.043867 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.024 seconds
[0m22:21:41.044870 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:21:41.058021 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:21:41.059026 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:21:41.060048 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:21:41.065086 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:21:41.067097 [debug] [MainThread]: Using snowflake connection "master"
[0m22:21:41.068114 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.8218221664428711'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.7330996990203857'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '2.8750362396240234'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m22:21:41.534917 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.466 seconds
[0m22:21:41.535918 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 3[0m in 0.47s]
[0m22:21:41.535918 [info ] [MainThread]: 
[0m22:21:41.537319 [debug] [MainThread]: On master: Close
[0m22:21:41.693963 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:21:41.693963 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:21:41.693963 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:21:41.695173 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:21:41.695173 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:21:41.696178 [info ] [MainThread]: 
[0m22:21:41.696178 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 5.46 seconds (5.46s).
[0m22:21:41.697181 [debug] [MainThread]: Command end result
[0m22:21:41.734812 [info ] [MainThread]: 
[0m22:21:41.735817 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:21:41.736828 [info ] [MainThread]: 
[0m22:21:41.737861 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:21:41.737861 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:21:41.738889 [info ] [MainThread]: 
[0m22:21:41.739894 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:21:41.739894 [info ] [MainThread]: 
[0m22:21:41.740975 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:21:41.743203 [debug] [MainThread]: Command `dbt test` failed at 22:21:41.742193 after 6.86 seconds
[0m22:21:41.743203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC40E02950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC42DE2D10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FC5C326740>]}
[0m22:21:41.743203 [debug] [MainThread]: Flushing usage events
[0m22:22:46.999856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F35672980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3826A680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F3826A4A0>]}


============================== 22:22:47.002938 | 13a833c1-92bd-49c1-a5ff-7b2c5ad3060f ==============================
[0m22:22:47.002938 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:22:47.004152 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:22:47.712181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '13a833c1-92bd-49c1-a5ff-7b2c5ad3060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F358F7DC0>]}
[0m22:22:47.760469 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '13a833c1-92bd-49c1-a5ff-7b2c5ad3060f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F35173550>]}
[0m22:22:47.761474 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:22:47.783078 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:22:48.027443 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:22:48.027443 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m22:22:48.028447 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_second_dbt_model.sql
[0m22:22:48.202809 [error] [MainThread]: Encountered an error:
Compilation Error in model my_second_dbt_model (models\example\my_second_dbt_model.sql)
  expected token ',', got 'tags'
    line 3
      tags=['example_1']
[0m22:22:48.204203 [debug] [MainThread]: Command `dbt build` failed at 22:22:48.204203 after 1.26 seconds
[0m22:22:48.204203 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F35672980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F510EB940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021F510EBB80>]}
[0m22:22:48.205220 [debug] [MainThread]: Flushing usage events
[0m22:22:56.936274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021203CFE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212068C26B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212068C24D0>]}


============================== 22:22:56.939287 | 6d2711ed-11bf-4570-bcc2-83ed6a770d3c ==============================
[0m22:22:56.939287 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:22:56.940294 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:22:57.653589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6d2711ed-11bf-4570-bcc2-83ed6a770d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021203F87940>]}
[0m22:22:57.698457 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6d2711ed-11bf-4570-bcc2-83ed6a770d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000212037D35B0>]}
[0m22:22:57.699460 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:22:57.719907 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:22:57.948286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:22:57.949289 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m22:22:57.949289 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_second_dbt_model.sql
[0m22:22:58.309206 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6d2711ed-11bf-4570-bcc2-83ed6a770d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121FA20130>]}
[0m22:22:58.429625 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6d2711ed-11bf-4570-bcc2-83ed6a770d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121FA23580>]}
[0m22:22:58.430626 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m22:22:58.432662 [info ] [MainThread]: 
[0m22:22:58.432662 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:22:58.434671 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m22:22:58.444855 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m22:22:58.445860 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m22:22:58.445860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:59.058732 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.613 seconds
[0m22:22:59.059736 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m22:22:59.190202 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:22:59.197238 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:22:59.197238 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:22:59.198241 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:22:59.768798 [debug] [ThreadPool]: SQL status: SUCCESS 1 in 0.571 seconds
[0m22:22:59.770810 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:22:59.888149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6d2711ed-11bf-4570-bcc2-83ed6a770d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121F9B4BB0>]}
[0m22:22:59.889158 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:22:59.889158 [info ] [MainThread]: 
[0m22:22:59.892385 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m22:22:59.893391 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m22:22:59.893391 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m22:22:59.894397 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m22:22:59.901574 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m22:22:59.902579 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m22:22:59.925855 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m22:22:59.926861 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m22:22:59.926861 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m22:22:59.927867 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:23:00.798693 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.870 seconds
[0m22:23:00.813872 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m22:23:00.932213 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '6d2711ed-11bf-4570-bcc2-83ed6a770d3c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121F19FC40>]}
[0m22:23:00.933216 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.04s]
[0m22:23:00.934229 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m22:23:00.935372 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m22:23:00.935372 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m22:23:00.936385 [info ] [Thread-3 (]: 2 of 3 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m22:23:00.936385 [info ] [Thread-4 (]: 3 of 3 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m22:23:00.937464 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778'
[0m22:23:00.938494 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m22:23:00.938494 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m22:23:00.939497 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m22:23:00.948536 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m22:23:00.954720 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:23:00.956730 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m22:23:00.956730 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m22:23:00.971991 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m22:23:00.974995 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:23:00.976107 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"
[0m22:23:00.977110 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m22:23:00.977110 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:23:00.977110 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:23:00.978526 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:23:00.978526 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m22:23:01.598746 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m22:23:01.601874 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m22:23:01.731913 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.79s]
[0m22:23:01.732920 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m22:23:02.535155 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.557 seconds
[0m22:23:02.537164 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778: Close
[0m22:23:02.655439 [info ] [Thread-3 (]: 2 of 3 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.72s]
[0m22:23:02.656921 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778
[0m22:23:02.657928 [info ] [MainThread]: 
[0m22:23:02.658933 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:23:02.675148 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:23:02.681581 [debug] [MainThread]: Using snowflake connection "master"
[0m22:23:02.681581 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:23:02.682732 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:23:03.646064 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.963 seconds
[0m22:23:03.647072 [info ] [MainThread]: extracted_names [['my_second_dbt_model']]
[0m22:23:03.660200 [info ] [MainThread]: extracted_names [['my_second_dbt_model']]
[0m22:23:03.661205 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:23:03.666232 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:23:03.730527 [debug] [MainThread]: Using snowflake connection "master"
[0m22:23:03.731532 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7944488525390625'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_second_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.717975378036499'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_second_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    
  
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.TIMESTAMP::date = source.TIMESTAMP::date
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP
      )
  
  ;
[0m22:23:04.244009 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.512 seconds
[0m22:23:04.245013 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.58s]
[0m22:23:04.246017 [info ] [MainThread]: 
[0m22:23:04.246017 [debug] [MainThread]: On master: Close
[0m22:23:04.366164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:23:04.367169 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m22:23:04.367169 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:23:04.367169 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m22:23:04.368175 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m22:23:04.368175 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m22:23:04.368175 [info ] [MainThread]: 
[0m22:23:04.369179 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 5.94 seconds (5.94s).
[0m22:23:04.371199 [debug] [MainThread]: Command end result
[0m22:23:04.408014 [info ] [MainThread]: 
[0m22:23:04.408014 [info ] [MainThread]: [32mCompleted successfully[0m
[0m22:23:04.409019 [info ] [MainThread]: 
[0m22:23:04.409019 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
[0m22:23:04.411028 [debug] [MainThread]: Command `dbt build` succeeded at 22:23:04.411028 after 7.53 seconds
[0m22:23:04.411028 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021203CFE9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121F7FCC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002121F7FCCD0>]}
[0m22:23:04.412059 [debug] [MainThread]: Flushing usage events
[0m22:45:16.155275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C4EB6E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C5172E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C5172E2F0>]}


============================== 22:45:16.157426 | 9fd319bd-bb6a-4078-a22f-e4fda18a2233 ==============================
[0m22:45:16.157426 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:45:16.158429 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:45:16.882043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '9fd319bd-bb6a-4078-a22f-e4fda18a2233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C516E6980>]}
[0m22:45:16.926675 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '9fd319bd-bb6a-4078-a22f-e4fda18a2233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C4F42A2C0>]}
[0m22:45:16.928682 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:45:16.949934 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:45:17.195488 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m22:45:17.196491 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m22:45:17.197494 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:45:17.560875 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '9fd319bd-bb6a-4078-a22f-e4fda18a2233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6A88BE50>]}
[0m22:45:17.678818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '9fd319bd-bb6a-4078-a22f-e4fda18a2233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6A88B8B0>]}
[0m22:45:17.678818 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:45:17.679825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd319bd-bb6a-4078-a22f-e4fda18a2233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6A2F3D60>]}
[0m22:45:17.681839 [info ] [MainThread]: 
[0m22:45:17.681839 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:45:17.686857 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:45:17.699881 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:45:17.699881 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:45:17.700882 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:45:18.374438 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.674 seconds
[0m22:45:18.375442 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:45:18.494769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '9fd319bd-bb6a-4078-a22f-e4fda18a2233', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6A888C10>]}
[0m22:45:18.495773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:45:18.496777 [info ] [MainThread]: 
[0m22:45:18.498877 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:45:18.499881 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:45:18.499881 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:45:18.500886 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:45:18.500886 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:45:18.501892 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:45:18.502900 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:45:18.502900 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:45:18.503900 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:45:18.503900 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:45:18.504901 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:45:18.504901 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:45:18.520545 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:45:18.526584 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:45:18.532709 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:45:18.533717 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:45:18.543802 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:45:18.549964 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:45:18.551980 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:45:18.552984 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:45:18.554998 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:45:18.556004 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:45:18.557010 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:45:18.557010 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:45:18.558016 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:45:18.558016 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:45:18.559021 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:45:18.559021 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:45:18.560172 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:45:18.563207 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:45:19.153049 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m22:45:19.161081 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:45:19.161081 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.602 seconds
[0m22:45:19.164224 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:45:19.283290 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m22:45:19.284295 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:45:19.295345 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.79s]
[0m22:45:19.296350 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:45:20.317640 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.754 seconds
[0m22:45:20.318652 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:45:20.437496 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.93s]
[0m22:45:20.438499 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:45:20.439537 [info ] [MainThread]: 
[0m22:45:20.440549 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:45:20.457266 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:45:20.462572 [debug] [MainThread]: Using snowflake connection "master"
[0m22:45:20.463648 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:45:20.463648 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:45:21.791186 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.327 seconds
[0m22:45:21.792197 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:45:21.804325 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:45:21.806342 [info ] [MainThread]: extracted_names [['my_first_dbt_model']]
[0m22:45:21.807347 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:45:21.811471 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:45:21.815495 [debug] [MainThread]: Using snowflake connection "master"
[0m22:45:21.816501 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target
    using (
  

  with current_test_runs as (
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'not_null'::varchar(4000) as test_name,
      'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.780390739440918'::text as execution_time_seconds,
      'fail'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'expression_is_true'::varchar(4000) as test_name,
      'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '0.7934534549713135'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)

'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    union all
  
  

    
    

    
      
      
    


    
    
      
    

    

    
    select
      md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk, 
      'unique'::varchar(4000) as test_name,
      'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
      'generic'::varchar(250) as test_type,
      'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
      ''::varchar(10000) as source_refs,
      'ERROR'::varchar(250) as test_severity_config,
      '1.9335956573486328'::text as execution_time_seconds,
      'pass'::varchar(125) as test_result,
      'models\example\schema.yml'::varchar(4000) as file_test_defined,
      '
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1


'::varchar(65535) as compiled_sql,
       convert_timezone( 'America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
    
    
  
  
  )
  select 
    s.*,
    'Y' as is_active,
    current_timestamp as created_timestamp,
    null as deactivated_timestamp
  from current_test_runs s
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      )
    when not matched by source and target.is_active = 'Y' then
      update set 
        is_active = 'N',
        deactivated_timestamp = current_timestamp
  
  ;
[0m22:45:21.902076 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba804b-3201-7237-000b-f692000147ae
[0m22:45:21.902076 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 177 at position 21 unexpected 'by'.
[0m22:45:21.903080 [info ] [MainThread]: Database error while running on-run-end
[0m22:45:21.903080 [debug] [MainThread]: On master: Close
[0m22:45:22.020562 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:45:22.021565 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:45:22.021565 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:45:22.021565 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:45:22.022569 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:45:22.022569 [info ] [MainThread]: 
[0m22:45:22.023575 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m22:45:22.024579 [debug] [MainThread]: Command end result
[0m22:45:22.122359 [info ] [MainThread]: 
[0m22:45:22.123364 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:45:22.123364 [info ] [MainThread]: 
[0m22:45:22.124370 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:45:22.125374 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:45:22.126401 [info ] [MainThread]: 
[0m22:45:22.126401 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:45:22.127405 [info ] [MainThread]: 
[0m22:45:22.128437 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 177 at position 21 unexpected 'by'.
[0m22:45:22.128437 [info ] [MainThread]: 
[0m22:45:22.129440 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:45:22.130457 [debug] [MainThread]: Command `dbt test` failed at 22:45:22.130457 after 6.03 seconds
[0m22:45:22.131461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C4EB6E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6AC895D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000012C6AC8AE00>]}
[0m22:45:22.131461 [debug] [MainThread]: Flushing usage events
[0m22:47:37.980429 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFA992920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFD54A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFD54A320>]}


============================== 22:47:37.983027 | 8e594462-4e7b-4cb9-9902-1278d22c6d5b ==============================
[0m22:47:37.983027 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:47:37.984222 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:47:38.760279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8e594462-4e7b-4cb9-9902-1278d22c6d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFAC17EB0>]}
[0m22:47:38.805698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8e594462-4e7b-4cb9-9902-1278d22c6d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C95F097E0>]}
[0m22:47:38.807704 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:47:38.829246 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:47:39.077961 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:47:39.078962 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:47:39.218207 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8e594462-4e7b-4cb9-9902-1278d22c6d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C96439750>]}
[0m22:47:39.367284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8e594462-4e7b-4cb9-9902-1278d22c6d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C961C83A0>]}
[0m22:47:39.367284 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:47:39.368285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e594462-4e7b-4cb9-9902-1278d22c6d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C963ED7B0>]}
[0m22:47:39.370318 [info ] [MainThread]: 
[0m22:47:39.371334 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:47:39.376360 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:47:39.390705 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:47:39.391709 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:47:39.391709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:47:40.066813 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.675 seconds
[0m22:47:40.068835 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:47:40.194297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8e594462-4e7b-4cb9-9902-1278d22c6d5b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C96433AC0>]}
[0m22:47:40.195335 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:47:40.196347 [info ] [MainThread]: 
[0m22:47:40.199366 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:47:40.199366 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:47:40.200760 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:47:40.200760 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:47:40.202001 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:47:40.203038 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:47:40.204044 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:47:40.204044 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:47:40.205050 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:47:40.205050 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:47:40.206553 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:47:40.206553 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:47:40.222019 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:47:40.229251 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:47:40.235392 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:47:40.236400 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:47:40.252794 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:47:40.253803 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:47:40.253803 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:47:40.257833 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:47:40.259846 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:47:40.260850 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:47:40.261984 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:47:40.261984 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:47:40.262990 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:47:40.263998 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:47:40.263998 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:47:40.266010 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:47:40.267017 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:47:40.267017 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:47:40.905137 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.642 seconds
[0m22:47:40.911685 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:47:40.935455 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.669 seconds
[0m22:47:40.937473 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:47:41.033121 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.83s]
[0m22:47:41.035131 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:47:41.056392 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.85s]
[0m22:47:41.057396 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:47:41.784096 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.517 seconds
[0m22:47:41.786114 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:47:41.909277 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.70s]
[0m22:47:41.911322 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:47:41.913336 [info ] [MainThread]: 
[0m22:47:41.913336 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:47:41.930065 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:47:41.936100 [debug] [MainThread]: Using snowflake connection "master"
[0m22:47:41.936100 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:47:41.937103 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:47:42.980635 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.043 seconds
[0m22:47:42.994693 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:47:42.999779 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:47:43.002798 [debug] [MainThread]: Using snowflake connection "master"
[0m22:47:43.003801 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
  

  with current_test_runs as (select
        md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
        'expression_is_true'::varchar(4000) as test_name,
        'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
        'generic'::varchar(250) as test_type,
        'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
        ''::varchar(10000) as source_refs,
        'ERROR'::varchar(250) as test_severity_config,
        '0.8300833702087402'::text as execution_time_seconds,
        'pass'::varchar(125) as test_result,
        'models\example\schema.yml'::varchar(4000) as file_test_defined,
        'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
        convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP union allselect
        md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
        'not_null'::varchar(4000) as test_name,
        'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
        'generic'::varchar(250) as test_type,
        'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
        ''::varchar(10000) as source_refs,
        'ERROR'::varchar(250) as test_severity_config,
        '0.8523480892181396'::text as execution_time_seconds,
        'fail'::varchar(125) as test_result,
        'models\example\schema.yml'::varchar(4000) as file_test_defined,
        'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
        convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP union allselect
        md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
        'unique'::varchar(4000) as test_name,
        'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
        'generic'::varchar(250) as test_type,
        'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
        ''::varchar(10000) as source_refs,
        'ERROR'::varchar(250) as test_severity_config,
        '1.7042264938354492'::text as execution_time_seconds,
        'pass'::varchar(125) as test_result,
        'models\example\schema.yml'::varchar(4000) as file_test_defined,
        'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
        convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP)
  select 
    s.*,
    'Y' as is_active,
    current_timestamp as created_timestamp,
    null as deactivated_timestamp
  from current_test_runs s
  
  
    ) as source
    on target.test_name = source.test_name 
    and target.compiled_sql = source.compiled_sql
    and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      )
    when not matched by source and target.is_active = 'Y' then
      update set 
        is_active = 'N',
        deactivated_timestamp = current_timestamp
  
  ;
[0m22:47:43.097365 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba804d-3201-72f0-000b-f6920001b0ee
[0m22:47:43.098371 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 98 unexpected 'allselect'.
syntax error line 70 at position 21 unexpected 'by'.
[0m22:47:43.098371 [info ] [MainThread]: Database error while running on-run-end
[0m22:47:43.099377 [debug] [MainThread]: On master: Close
[0m22:47:43.229932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:47:43.230933 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:47:43.230933 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:47:43.231934 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:47:43.231934 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:47:43.232935 [info ] [MainThread]: 
[0m22:47:43.232935 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.86 seconds (3.86s).
[0m22:47:43.234162 [debug] [MainThread]: Command end result
[0m22:47:43.275420 [info ] [MainThread]: 
[0m22:47:43.276430 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:47:43.276430 [info ] [MainThread]: 
[0m22:47:43.277443 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:47:43.278500 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:47:43.279599 [info ] [MainThread]: 
[0m22:47:43.280704 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:47:43.280704 [info ] [MainThread]: 
[0m22:47:43.281707 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 16 at position 98 unexpected 'allselect'.
syntax error line 70 at position 21 unexpected 'by'.
[0m22:47:43.281707 [info ] [MainThread]: 
[0m22:47:43.282721 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:47:43.283726 [debug] [MainThread]: Command `dbt test` failed at 22:47:43.283726 after 5.36 seconds
[0m22:47:43.284732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFA992920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021CFC96ECE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021C968D8790>]}
[0m22:47:43.284732 [debug] [MainThread]: Flushing usage events
[0m22:50:22.048284 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D2102980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D4C8E4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D4C8E2F0>]}


============================== 22:50:22.051835 | e626daf8-d464-4663-91df-45e9b00a3412 ==============================
[0m22:50:22.051835 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:50:22.052847 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:50:22.781481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e626daf8-d464-4663-91df-45e9b00a3412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D4C46980>]}
[0m22:50:22.827618 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e626daf8-d464-4663-91df-45e9b00a3412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D29B3730>]}
[0m22:50:22.828623 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:50:22.848846 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:50:23.089872 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:50:23.090875 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:50:23.239746 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e626daf8-d464-4663-91df-45e9b00a3412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EDAE8130>]}
[0m22:50:23.356619 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e626daf8-d464-4663-91df-45e9b00a3412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EDA67BE0>]}
[0m22:50:23.357908 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:50:23.358910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e626daf8-d464-4663-91df-45e9b00a3412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D248BA90>]}
[0m22:50:23.359911 [info ] [MainThread]: 
[0m22:50:23.361060 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:50:23.366090 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:50:23.380173 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:50:23.380173 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:50:23.381177 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:50:24.059519 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.678 seconds
[0m22:50:24.060526 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:50:24.185187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e626daf8-d464-4663-91df-45e9b00a3412', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6EDA66B60>]}
[0m22:50:24.185187 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:50:24.186567 [info ] [MainThread]: 
[0m22:50:24.189610 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:50:24.190628 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:50:24.190628 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:50:24.191633 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:50:24.191633 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:50:24.192638 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:50:24.193639 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:50:24.193639 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:50:24.194689 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:50:24.195693 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:50:24.195693 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:50:24.195693 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:50:24.212943 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:50:24.218677 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:50:24.223813 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:50:24.224822 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:50:24.224822 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:50:24.240147 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:50:24.241150 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:50:24.244164 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:50:24.247329 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:50:24.248333 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:50:24.249338 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:50:24.249338 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:50:24.250344 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:50:24.251359 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:50:24.251359 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:50:24.251359 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:50:24.252365 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:50:24.255383 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:50:24.826534 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.576 seconds
[0m22:50:24.833563 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:50:24.954574 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.76s]
[0m22:50:24.955660 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:50:25.789803 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.535 seconds
[0m22:50:25.792358 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:50:25.911894 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.72s]
[0m22:50:25.912898 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:50:26.999932 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.748 seconds
[0m22:50:27.001943 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:50:27.123836 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.93s]
[0m22:50:27.125858 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:50:27.126910 [info ] [MainThread]: 
[0m22:50:27.126910 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:50:27.154928 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:50:27.160245 [debug] [MainThread]: Using snowflake connection "master"
[0m22:50:27.161247 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:50:27.162520 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:50:28.122518 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.960 seconds
[0m22:50:28.136036 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:50:28.140625 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:50:28.143642 [debug] [MainThread]: Using snowflake connection "master"
[0m22:50:28.144646 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7609348297119141'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP union allselect
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7172050476074219'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP union allselect
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.93019700050354'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP)
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:50:28.236075 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8050-3201-7237-000b-f692000147d2
[0m22:50:28.236075 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 102 unexpected 'allselect'.
[0m22:50:28.237079 [info ] [MainThread]: Database error while running on-run-end
[0m22:50:28.237079 [debug] [MainThread]: On master: Close
[0m22:50:28.360681 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:50:28.360681 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:50:28.361691 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:50:28.361691 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:50:28.362694 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:50:28.362694 [info ] [MainThread]: 
[0m22:50:28.363698 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m22:50:28.364701 [debug] [MainThread]: Command end result
[0m22:50:28.402915 [info ] [MainThread]: 
[0m22:50:28.404003 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:50:28.405016 [info ] [MainThread]: 
[0m22:50:28.405016 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:50:28.406302 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:50:28.406302 [info ] [MainThread]: 
[0m22:50:28.406302 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:50:28.407570 [info ] [MainThread]: 
[0m22:50:28.407570 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 14 at position 102 unexpected 'allselect'.
[0m22:50:28.408573 [info ] [MainThread]: 
[0m22:50:28.408573 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:50:28.409594 [debug] [MainThread]: Command `dbt test` failed at 22:50:28.409594 after 6.42 seconds
[0m22:50:28.410597 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D2102980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D4C46980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6D40AF100>]}
[0m22:50:28.410597 [debug] [MainThread]: Flushing usage events
[0m22:51:49.668734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CB18A9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CDD4A530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CDD4A350>]}


============================== 22:51:49.672020 | eb635deb-d875-4448-b333-a7de29e52f68 ==============================
[0m22:51:49.672020 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:51:49.673234 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:51:50.484899 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eb635deb-d875-4448-b333-a7de29e52f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CB417970>]}
[0m22:51:50.529435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eb635deb-d875-4448-b333-a7de29e52f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CAC83580>]}
[0m22:51:50.530443 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:51:50.551660 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:51:50.798393 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:51:50.799396 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:51:50.949732 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eb635deb-d875-4448-b333-a7de29e52f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E6BA8130>]}
[0m22:51:51.077209 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eb635deb-d875-4448-b333-a7de29e52f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E6BAB3A0>]}
[0m22:51:51.078214 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:51:51.079218 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb635deb-d875-4448-b333-a7de29e52f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E6B44460>]}
[0m22:51:51.080223 [info ] [MainThread]: 
[0m22:51:51.081227 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:51:51.086275 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:51:51.101070 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:51:51.101070 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:51:51.102075 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:51:51.796048 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.694 seconds
[0m22:51:51.798195 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:51:51.922893 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eb635deb-d875-4448-b333-a7de29e52f68', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280E6BABE20>]}
[0m22:51:51.923893 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:51:51.924903 [info ] [MainThread]: 
[0m22:51:51.927925 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:51:51.927925 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:51:51.928930 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:51:51.928930 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:51:51.930229 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:51:51.930229 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:51:51.931263 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:51:51.932266 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:51:51.932266 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:51:51.933321 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:51:51.933321 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:51:51.934326 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:51:51.949568 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:51:51.955780 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:51:51.961820 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:51:51.962824 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:51:51.979847 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:51:51.981001 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:51:51.982006 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:51:51.985144 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:51:51.988169 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:51:51.988169 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:51:51.989172 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:51:51.990174 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:51:51.990174 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:51:51.991447 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:51:51.991447 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:51:51.993746 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:51:51.994750 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:51:51.994750 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:51:52.494941 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m22:51:52.501996 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:51:52.619075 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.69s]
[0m22:51:52.620078 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:51:53.497258 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.502 seconds
[0m22:51:53.499390 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:51:53.627137 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.69s]
[0m22:51:53.628157 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:51:54.758012 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.763 seconds
[0m22:51:54.759016 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:51:54.880197 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 2.95s]
[0m22:51:54.882216 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:51:54.883221 [info ] [MainThread]: 
[0m22:51:54.884227 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:51:54.903587 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:51:54.909933 [debug] [MainThread]: Using snowflake connection "master"
[0m22:51:54.910948 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:51:54.911952 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:51:55.938996 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.028 seconds
[0m22:51:55.953484 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:51:55.957524 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:51:55.960544 [debug] [MainThread]: Using snowflake connection "master"
[0m22:51:55.961649 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6878116130828857'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          
          UNION ALLselect
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.6948704719543457'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          
          UNION ALLselect
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.9479305744171143'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP)
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:51:56.045839 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8051-3201-72e6-000b-f6920001a162
[0m22:51:56.046843 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 16 unexpected 'ALLselect'.
[0m22:51:56.046843 [info ] [MainThread]: Database error while running on-run-end
[0m22:51:56.047847 [debug] [MainThread]: On master: Close
[0m22:51:56.165180 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:51:56.165180 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:51:56.166184 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:51:56.166184 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:51:56.167188 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:51:56.167188 [info ] [MainThread]: 
[0m22:51:56.168192 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 5.09 seconds (5.09s).
[0m22:51:56.169197 [debug] [MainThread]: Command end result
[0m22:51:56.203940 [info ] [MainThread]: 
[0m22:51:56.204941 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:51:56.206085 [info ] [MainThread]: 
[0m22:51:56.206085 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:51:56.207088 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:51:56.207088 [info ] [MainThread]: 
[0m22:51:56.207088 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:51:56.208548 [info ] [MainThread]: 
[0m22:51:56.209549 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 16 at position 16 unexpected 'ALLselect'.
[0m22:51:56.209549 [info ] [MainThread]: 
[0m22:51:56.210749 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:51:56.212784 [debug] [MainThread]: Command `dbt test` failed at 22:51:56.212784 after 6.60 seconds
[0m22:51:56.212784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CB18A9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CAC83580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000280CBAA4B20>]}
[0m22:51:56.212784 [debug] [MainThread]: Flushing usage events
[0m22:52:58.818305 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43C6EE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43F27E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43F27E320>]}


============================== 22:52:58.821562 | f615af0a-5982-4ac4-b79a-2fc5e6e69e19 ==============================
[0m22:52:58.821562 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:52:58.822566 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:52:59.525909 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f615af0a-5982-4ac4-b79a-2fc5e6e69e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43C977A90>]}
[0m22:52:59.571651 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f615af0a-5982-4ac4-b79a-2fc5e6e69e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43C1E3520>]}
[0m22:52:59.572659 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:52:59.593351 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:52:59.836486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:52:59.837493 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:52:59.980717 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f615af0a-5982-4ac4-b79a-2fc5e6e69e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E4580D8130>]}
[0m22:53:00.105769 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f615af0a-5982-4ac4-b79a-2fc5e6e69e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E458056B60>]}
[0m22:53:00.106770 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:53:00.106770 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f615af0a-5982-4ac4-b79a-2fc5e6e69e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E458078880>]}
[0m22:53:00.109100 [info ] [MainThread]: 
[0m22:53:00.109100 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:53:00.114794 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:53:00.129162 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:53:00.130168 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:53:00.130168 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:53:00.778005 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.648 seconds
[0m22:53:00.779008 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:53:00.900138 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f615af0a-5982-4ac4-b79a-2fc5e6e69e19', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E458056FE0>]}
[0m22:53:00.901143 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:53:00.902149 [info ] [MainThread]: 
[0m22:53:00.905161 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:53:00.905161 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:53:00.905161 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:53:00.906165 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:53:00.907278 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:53:00.907278 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:53:00.908280 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:53:00.908280 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:53:00.909670 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:53:00.909670 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:53:00.910693 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:53:00.910693 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:53:00.926906 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:53:00.932488 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:53:00.937495 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:53:00.938608 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:53:00.952946 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:53:00.955038 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:53:00.956050 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:53:00.959060 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:53:00.961187 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:53:00.962209 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:53:00.963428 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:53:00.963428 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:53:00.964504 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:53:00.964504 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:53:00.965534 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:53:00.965534 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:53:00.966535 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:53:00.969811 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:53:01.540593 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.575 seconds
[0m22:53:01.547638 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:53:01.672408 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m22:53:01.673411 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:53:02.533014 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.563 seconds
[0m22:53:02.534045 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:53:02.660149 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.75s]
[0m22:53:02.661154 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:53:03.727242 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.763 seconds
[0m22:53:03.729304 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:53:03.852784 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 2.94s]
[0m22:53:03.853787 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:53:03.854878 [info ] [MainThread]: 
[0m22:53:03.856185 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:53:03.880171 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:53:03.886176 [debug] [MainThread]: Using snowflake connection "master"
[0m22:53:03.886176 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:53:03.887439 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:53:04.873275 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.986 seconds
[0m22:53:04.887566 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:53:04.890678 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:53:04.894715 [debug] [MainThread]: Using snowflake connection "master"
[0m22:53:04.894715 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7641282081604004'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMPUNION ALLselect
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.750478744506836'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMPUNION ALLselect
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.9445042610168457'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP)
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:53:04.983268 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8053-3201-72f1-000b-f6920001c082
[0m22:53:04.983268 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 101 unexpected 'ALLselect'.
[0m22:53:04.984274 [info ] [MainThread]: Database error while running on-run-end
[0m22:53:04.984274 [debug] [MainThread]: On master: Close
[0m22:53:05.105007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:53:05.106012 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:53:05.106012 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:53:05.106605 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:53:05.106605 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:53:05.107615 [info ] [MainThread]: 
[0m22:53:05.107615 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m22:53:05.108619 [debug] [MainThread]: Command end result
[0m22:53:05.145788 [info ] [MainThread]: 
[0m22:53:05.146792 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:53:05.147795 [info ] [MainThread]: 
[0m22:53:05.148829 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:53:05.149834 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:53:05.149834 [info ] [MainThread]: 
[0m22:53:05.150838 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:53:05.151880 [info ] [MainThread]: 
[0m22:53:05.151880 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 14 at position 101 unexpected 'ALLselect'.
[0m22:53:05.152885 [info ] [MainThread]: 
[0m22:53:05.152885 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:53:05.155017 [debug] [MainThread]: Command `dbt test` failed at 22:53:05.155017 after 6.39 seconds
[0m22:53:05.155017 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43C6EE950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43C1E3520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E43E69F490>]}
[0m22:53:05.156032 [debug] [MainThread]: Flushing usage events
[0m22:53:59.430870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D56B9E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5975E530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D5975E350>]}


============================== 22:53:59.434424 | c4da65be-7c32-4bcd-9030-08b06be64a13 ==============================
[0m22:53:59.434424 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:53:59.435427 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:54:00.162481 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c4da65be-7c32-4bcd-9030-08b06be64a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D56E27970>]}
[0m22:54:00.207199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c4da65be-7c32-4bcd-9030-08b06be64a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D56673580>]}
[0m22:54:00.208202 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:54:00.228625 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:54:00.471621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:54:00.472622 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:54:00.611378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c4da65be-7c32-4bcd-9030-08b06be64a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D725B8130>]}
[0m22:54:00.733589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c4da65be-7c32-4bcd-9030-08b06be64a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D725BB3A0>]}
[0m22:54:00.733589 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:54:00.734595 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4da65be-7c32-4bcd-9030-08b06be64a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D72558460>]}
[0m22:54:00.735618 [info ] [MainThread]: 
[0m22:54:00.736621 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:54:00.741639 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:54:00.755243 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:54:00.756244 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:54:00.756244 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:54:01.407729 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.651 seconds
[0m22:54:01.409731 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:54:01.530712 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c4da65be-7c32-4bcd-9030-08b06be64a13', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D725BBE20>]}
[0m22:54:01.531716 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:54:01.532718 [info ] [MainThread]: 
[0m22:54:01.535875 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:54:01.535875 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:54:01.536880 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:54:01.536880 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:54:01.537920 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:54:01.538922 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:54:01.538922 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:54:01.540249 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:54:01.540249 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:54:01.541310 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:54:01.541310 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:54:01.542314 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:54:01.558635 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:54:01.566031 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:54:01.572052 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:54:01.573076 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:54:01.589867 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:54:01.589867 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:54:01.590870 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:54:01.593991 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:54:01.595019 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:54:01.599025 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:54:01.600465 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:54:01.601527 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:54:01.601527 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:54:01.602532 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:54:01.602532 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:54:01.604539 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:54:01.605975 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:54:01.605975 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:54:02.168426 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.562 seconds
[0m22:54:02.174461 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:54:02.197925 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.597 seconds
[0m22:54:02.199940 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:54:02.293074 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.75s]
[0m22:54:02.294078 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:54:02.320971 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.78s]
[0m22:54:02.321976 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:54:03.338753 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.732 seconds
[0m22:54:03.339756 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:54:03.484051 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.94s]
[0m22:54:03.485056 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:54:03.486063 [info ] [MainThread]: 
[0m22:54:03.487066 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:54:03.508612 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:54:03.514899 [debug] [MainThread]: Using snowflake connection "master"
[0m22:54:03.514899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:54:03.515904 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:54:04.486152 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.970 seconds
[0m22:54:04.500281 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:54:04.504300 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:54:04.507311 [debug] [MainThread]: Using snowflake connection "master"
[0m22:54:04.508315 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7528250217437744'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP

          UNION ALLselect
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7810304164886475'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP

          UNION ALLselect
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9427974224090576'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP)
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:54:04.603623 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8054-3201-7237-000b-f692000147e2
[0m22:54:04.604626 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 16 at position 16 unexpected 'ALLselect'.
[0m22:54:04.605630 [info ] [MainThread]: Database error while running on-run-end
[0m22:54:04.605630 [debug] [MainThread]: On master: Close
[0m22:54:04.725818 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:54:04.726822 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:54:04.726822 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:54:04.727826 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:54:04.727826 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:54:04.728830 [info ] [MainThread]: 
[0m22:54:04.728830 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 3.99 seconds (3.99s).
[0m22:54:04.730839 [debug] [MainThread]: Command end result
[0m22:54:04.769285 [info ] [MainThread]: 
[0m22:54:04.770294 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:54:04.770294 [info ] [MainThread]: 
[0m22:54:04.771301 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:54:04.772306 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:54:04.772306 [info ] [MainThread]: 
[0m22:54:04.773310 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:54:04.773310 [info ] [MainThread]: 
[0m22:54:04.774316 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 16 at position 16 unexpected 'ALLselect'.
[0m22:54:04.774316 [info ] [MainThread]: 
[0m22:54:04.775320 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:54:04.775320 [debug] [MainThread]: Command `dbt test` failed at 22:54:04.775320 after 5.40 seconds
[0m22:54:04.776798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D56B9E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D56673580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019D574B4B20>]}
[0m22:54:04.777797 [debug] [MainThread]: Flushing usage events
[0m22:55:09.647345 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754711E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027549CBE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027549CBE320>]}


============================== 22:55:09.650366 | d42e91da-cfc7-404d-aa85-356b8017c8f5 ==============================
[0m22:55:09.650366 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:55:09.650366 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:55:10.355601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd42e91da-cfc7-404d-aa85-356b8017c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275473ABA90>]}
[0m22:55:10.400370 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd42e91da-cfc7-404d-aa85-356b8017c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027546C13520>]}
[0m22:55:10.401376 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:55:10.424031 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:55:10.667892 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:55:10.667892 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:55:10.808388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd42e91da-cfc7-404d-aa85-356b8017c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562B18130>]}
[0m22:55:10.927228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd42e91da-cfc7-404d-aa85-356b8017c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562A96B60>]}
[0m22:55:10.927228 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:55:10.928234 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd42e91da-cfc7-404d-aa85-356b8017c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562AB4880>]}
[0m22:55:10.929238 [info ] [MainThread]: 
[0m22:55:10.930241 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:55:10.935265 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:55:10.949417 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:55:10.950421 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:55:10.950421 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:11.597362 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.647 seconds
[0m22:55:11.599392 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:55:11.720768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd42e91da-cfc7-404d-aa85-356b8017c8f5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027562A96FE0>]}
[0m22:55:11.720768 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:55:11.722196 [info ] [MainThread]: 
[0m22:55:11.725326 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:11.725326 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:11.725326 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:11.726335 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:55:11.726335 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:55:11.727341 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:55:11.728345 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:55:11.728345 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:55:11.729349 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:55:11.729349 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:11.730356 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:11.730356 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:11.744546 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:55:11.750573 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:55:11.755673 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:55:11.756682 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:11.756682 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:11.772964 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:55:11.775979 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:55:11.775979 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:11.778997 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:55:11.778997 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:55:11.780002 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:55:11.781006 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:55:11.781812 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:55:11.782820 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:55:11.782820 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:11.784105 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:55:11.784105 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:55:11.786177 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:55:12.367836 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.584 seconds
[0m22:55:12.373965 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:55:12.495631 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.77s]
[0m22:55:12.496635 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:13.330227 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.544 seconds
[0m22:55:13.331238 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:55:13.455721 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.73s]
[0m22:55:13.456725 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:14.508740 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.724 seconds
[0m22:55:14.509744 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:55:14.648166 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.92s]
[0m22:55:14.648166 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:14.650615 [info ] [MainThread]: 
[0m22:55:14.650615 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:55:14.672226 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:55:14.677516 [debug] [MainThread]: Using snowflake connection "master"
[0m22:55:14.678523 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:55:14.678523 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:15.897168 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.218 seconds
[0m22:55:15.911388 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:55:15.915407 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:55:15.918439 [debug] [MainThread]: Using snowflake connection "master"
[0m22:55:15.919442 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7682895660400391'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMPUNION ALLselect
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7263712882995605'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMPUNION ALLselect
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.918820381164551'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP)
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:55:16.007846 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8055-3201-72d3-000b-f692000181e2
[0m22:55:16.008357 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 14 at position 101 unexpected 'ALLselect'.
[0m22:55:16.008872 [info ] [MainThread]: Database error while running on-run-end
[0m22:55:16.009907 [debug] [MainThread]: On master: Close
[0m22:55:16.140039 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:16.141043 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:55:16.141043 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:55:16.141043 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:55:16.142048 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:55:16.142048 [info ] [MainThread]: 
[0m22:55:16.143196 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 5.21 seconds (5.21s).
[0m22:55:16.144201 [debug] [MainThread]: Command end result
[0m22:55:16.180712 [info ] [MainThread]: 
[0m22:55:16.181917 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:55:16.181917 [info ] [MainThread]: 
[0m22:55:16.182923 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:55:16.183926 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:55:16.184983 [info ] [MainThread]: 
[0m22:55:16.184983 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:55:16.186009 [info ] [MainThread]: 
[0m22:55:16.186009 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 14 at position 101 unexpected 'ALLselect'.
[0m22:55:16.186009 [info ] [MainThread]: 
[0m22:55:16.187282 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:55:16.188286 [debug] [MainThread]: Command `dbt test` failed at 22:55:16.188286 after 6.60 seconds
[0m22:55:16.189290 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002754711E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027546C13520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000275490CF490>]}
[0m22:55:16.189290 [debug] [MainThread]: Flushing usage events
[0m22:55:39.961365 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6A81F29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AADAE530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6AADAE350>]}


============================== 22:55:39.964458 | dc95aa22-5973-4cbc-a078-65d594a367e1 ==============================
[0m22:55:39.964458 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:55:39.965463 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m22:55:40.683438 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc95aa22-5973-4cbc-a078-65d594a367e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6A8477970>]}
[0m22:55:40.726846 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc95aa22-5973-4cbc-a078-65d594a367e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6A7CE3580>]}
[0m22:55:40.727849 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:55:40.748012 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:55:40.991029 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:55:40.991029 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:55:41.130456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc95aa22-5973-4cbc-a078-65d594a367e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C3C08130>]}
[0m22:55:41.248238 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc95aa22-5973-4cbc-a078-65d594a367e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C3B86FE0>]}
[0m22:55:41.249245 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:55:41.250248 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc95aa22-5973-4cbc-a078-65d594a367e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C3BA84F0>]}
[0m22:55:41.251342 [info ] [MainThread]: 
[0m22:55:41.252346 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:55:41.256359 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:55:41.271228 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:55:41.271228 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:55:41.272231 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:55:41.901250 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.629 seconds
[0m22:55:41.902270 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:55:42.023799 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc95aa22-5973-4cbc-a078-65d594a367e1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C3970910>]}
[0m22:55:42.024804 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:55:42.025813 [info ] [MainThread]: 
[0m22:55:42.027819 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:42.028878 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:42.028878 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:42.028878 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:55:42.029887 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:55:42.030949 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:55:42.030949 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:55:42.031953 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:55:42.031953 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:55:42.032973 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:42.032973 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:42.033979 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:42.048155 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:55:42.054187 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:55:42.059218 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:55:42.060224 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:42.075280 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:55:42.075280 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:42.076285 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:42.079418 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:55:42.080419 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:55:42.083421 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:55:42.084525 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:55:42.085541 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:55:42.085541 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:55:42.086544 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:55:42.086544 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:55:42.088649 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:55:42.089654 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:55:42.089654 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:55:42.680366 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m22:55:42.681371 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m22:55:42.688405 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:55:42.690412 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:55:42.809960 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m22:55:42.810979 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:55:42.815865 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.78s]
[0m22:55:42.816868 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:55:43.585545 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.496 seconds
[0m22:55:43.587559 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:55:43.706349 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.67s]
[0m22:55:43.707368 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:55:43.708372 [info ] [MainThread]: 
[0m22:55:43.709693 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:55:43.728910 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:55:43.734106 [debug] [MainThread]: Using snowflake connection "master"
[0m22:55:43.735108 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:55:43.735108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:55:44.707474 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.972 seconds
[0m22:55:44.721705 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:55:44.725732 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:55:44.728810 [debug] [MainThread]: Using snowflake connection "master"
[0m22:55:44.729813 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7780063152313232'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7839109897613525'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.6743953227996826'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:55:45.328867 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.598 seconds
[0m22:55:45.328867 [debug] [MainThread]: Using snowflake connection "master"
[0m22:55:45.329876 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from () as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m22:55:45.425574 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8055-3201-72e6-000b-f6920001a16e
[0m22:55:45.425574 [debug] [MainThread]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 7 at position 12 unexpected ')'.
[0m22:55:45.426577 [info ] [MainThread]: Database error while running on-run-end
[0m22:55:45.427581 [debug] [MainThread]: On master: Close
[0m22:55:45.557454 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:55:45.558461 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:55:45.558461 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:55:45.558461 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:55:45.559466 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:55:45.559466 [info ] [MainThread]: 
[0m22:55:45.560469 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.31 seconds (4.31s).
[0m22:55:45.561473 [debug] [MainThread]: Command end result
[0m22:55:45.598660 [info ] [MainThread]: 
[0m22:55:45.599669 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m22:55:45.599669 [info ] [MainThread]: 
[0m22:55:45.600673 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:55:45.601676 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:55:45.601676 [info ] [MainThread]: 
[0m22:55:45.602700 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:55:45.602700 [info ] [MainThread]: 
[0m22:55:45.603767 [error] [MainThread]:   on-run-end failed, error:
 001003 (42000): SQL compilation error:
syntax error line 7 at position 12 unexpected ')'.
[0m22:55:45.603767 [info ] [MainThread]: 
[0m22:55:45.604816 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=2 SKIP=0 TOTAL=4
[0m22:55:45.605820 [debug] [MainThread]: Command `dbt test` failed at 22:55:45.605820 after 5.70 seconds
[0m22:55:45.605820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6A81F29B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6A7CE3580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C6C3C09F00>]}
[0m22:55:45.606825 [debug] [MainThread]: Flushing usage events
[0m22:57:34.635860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9574029B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C959FF6530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C959FF6350>]}


============================== 22:57:34.639886 | a60ce6f1-869e-44be-8f36-db1d28cee42c ==============================
[0m22:57:34.639886 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:57:34.640890 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example', 'send_anonymous_usage_stats': 'True'}
[0m22:57:35.401235 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a60ce6f1-869e-44be-8f36-db1d28cee42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C957687970>]}
[0m22:57:35.446634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a60ce6f1-869e-44be-8f36-db1d28cee42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C956ED3580>]}
[0m22:57:35.447706 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:57:35.473062 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:57:35.740126 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:57:35.741135 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:57:35.908949 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a60ce6f1-869e-44be-8f36-db1d28cee42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C972E18130>]}
[0m22:57:36.033102 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a60ce6f1-869e-44be-8f36-db1d28cee42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C972D97490>]}
[0m22:57:36.034106 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:57:36.035109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a60ce6f1-869e-44be-8f36-db1d28cee42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C972DB4550>]}
[0m22:57:36.036315 [info ] [MainThread]: 
[0m22:57:36.037317 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:57:36.041321 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:57:36.055854 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:57:36.056858 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:57:36.056858 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:57:36.705979 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.649 seconds
[0m22:57:36.707988 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:57:36.833416 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a60ce6f1-869e-44be-8f36-db1d28cee42c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C972D97A00>]}
[0m22:57:36.833416 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:57:36.834471 [info ] [MainThread]: 
[0m22:57:36.837890 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:57:36.837890 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:57:36.837890 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:57:36.838896 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:57:36.838896 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:57:36.839901 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:57:36.840910 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:57:36.840910 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:57:36.841914 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:57:36.841914 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:57:36.842918 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:57:36.842918 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:57:36.858267 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:57:36.864299 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:57:36.870572 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:57:36.871619 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:57:36.882710 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:57:36.888933 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:57:36.891949 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:57:36.891949 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:57:36.894963 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:57:36.895963 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:57:36.897049 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:57:36.897049 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:57:36.898052 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:57:36.898052 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:57:36.899054 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:57:36.899054 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:57:36.900054 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:57:36.901055 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:57:37.491222 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m22:57:37.497249 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:57:37.498753 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.599 seconds
[0m22:57:37.501881 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:57:37.622964 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 0.78s]
[0m22:57:37.623964 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m22:57:37.625420 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:57:37.625420 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:57:38.409542 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.508 seconds
[0m22:57:38.411592 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:57:38.535458 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.69s]
[0m22:57:38.536461 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:57:38.537503 [info ] [MainThread]: 
[0m22:57:38.538511 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:57:38.560633 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:57:38.566868 [debug] [MainThread]: Using snowflake connection "master"
[0m22:57:38.567873 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:57:38.567873 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:57:39.602282 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.034 seconds
[0m22:57:39.616517 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:57:39.620533 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:57:39.624549 [debug] [MainThread]: Using snowflake connection "master"
[0m22:57:39.625562 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.783062219619751'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7830541133880615'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.6945481300354004'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:57:40.141852 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.516 seconds
[0m22:57:40.141852 [debug] [MainThread]: Using snowflake connection "master"
[0m22:57:40.142856 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'expression_is_true'::varchar(4000) as test_name,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m22:57:40.490431 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.347 seconds
[0m22:57:40.491432 [debug] [MainThread]: Using snowflake connection "master"
[0m22:57:40.491432 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
;
[0m22:57:40.574169 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba8057-3201-72f0-000b-f6920001b122
[0m22:57:40.575173 [debug] [MainThread]: Snowflake adapter: Snowflake error: 000900 (42601): SQL compilation error:
Empty SQL statement.
[0m22:57:40.575173 [debug] [MainThread]: Snowflake adapter: got empty sql statement, moving on
[0m22:57:40.575173 [debug] [MainThread]: On master: Close
[0m22:57:40.695533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:57:40.696534 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:57:40.696534 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:57:40.696534 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:57:40.697690 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:57:40.697690 [info ] [MainThread]: 
[0m22:57:40.698697 [info ] [MainThread]: Finished running 3 data tests in 0 hours 0 minutes and 4.66 seconds (4.66s).
[0m22:57:40.699706 [error] [MainThread]: Encountered an error:
cannot unpack non-iterable NoneType object
[0m22:57:40.701159 [error] [MainThread]: Traceback (most recent call last):
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 138, in wrapper
    result, success = func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 101, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 218, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 247, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 294, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\requires.py", line 332, in wrapper
    return func(*args, **kwargs)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\cli\main.py", line 816, in test
    results = task.run()
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 526, in run
    result = self.execute_with_hooks(selected_uids)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\runnable.py", line 488, in execute_with_hooks
    self.after_run(adapter, res)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 484, in after_run
    self.safe_run_hooks(adapter, RunHookType.End, extras)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 423, in safe_run_hooks
    self.run_hooks(adapter, hook_type, extra_context)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\task\run.py", line 391, in run_hooks
    response, _ = adapter.execute(sql, auto_begin=False, fetch=False)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\base\impl.py", line 379, in execute
    return self.connections.execute(sql=sql, auto_begin=auto_begin, fetch=fetch, limit=limit)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 471, in execute
    _, cursor = self.add_query(sql, auto_begin)
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 506, in add_query
    connection, cursor = self._add_standard_queries(
  File "C:\Users\Vignesh\AppData\Local\Programs\Python\Python310\lib\site-packages\dbt\adapters\snowflake\connections.py", line 562, in _add_standard_queries
    connection, cursor = self.add_standard_query(query, **kwargs)
TypeError: cannot unpack non-iterable NoneType object

[0m22:57:40.702542 [debug] [MainThread]: Command `dbt test` failed at 22:57:40.702542 after 6.12 seconds
[0m22:57:40.702542 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9574029B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C973149750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C9732996C0>]}
[0m22:57:40.703675 [debug] [MainThread]: Flushing usage events
[0m22:58:46.791836 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592407E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025926C4E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025926C4E320>]}


============================== 22:58:46.794906 | 59f2bff4-d241-4377-a61d-faf0a5c640c9 ==============================
[0m22:58:46.794906 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:58:46.795917 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m22:58:47.562404 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '59f2bff4-d241-4377-a61d-faf0a5c640c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025924307EB0>]}
[0m22:58:47.606704 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '59f2bff4-d241-4377-a61d-faf0a5c640c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002593F5597E0>]}
[0m22:58:47.607706 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:58:47.629635 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:58:47.873119 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:58:47.874122 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m22:58:48.016475 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '59f2bff4-d241-4377-a61d-faf0a5c640c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002593FAA8130>]}
[0m22:58:48.138165 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '59f2bff4-d241-4377-a61d-faf0a5c640c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002593FAABEE0>]}
[0m22:58:48.139171 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m22:58:48.139171 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f2bff4-d241-4377-a61d-faf0a5c640c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002593FA48D00>]}
[0m22:58:48.141182 [info ] [MainThread]: 
[0m22:58:48.142187 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:58:48.147331 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:58:48.166854 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:58:48.166854 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:58:48.168337 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:58:48.784729 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.616 seconds
[0m22:58:48.786736 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:58:48.911513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '59f2bff4-d241-4377-a61d-faf0a5c640c9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002593F6DE4D0>]}
[0m22:58:48.911513 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:58:48.912516 [info ] [MainThread]: 
[0m22:58:48.915523 [debug] [Thread-1 (]: Began running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:58:48.916657 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:58:48.916657 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:58:48.917661 [info ] [Thread-1 (]: 1 of 3 START test dbt_utils_expression_is_true_my_first_dbt_model_id___1 ....... [RUN]
[0m22:58:48.917661 [info ] [Thread-2 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:58:48.918668 [info ] [Thread-3 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:58:48.918668 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da'
[0m22:58:48.919672 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:58:48.920823 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:58:48.920823 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:58:48.921827 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:58:48.921827 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:58:48.937354 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:58:48.943389 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:58:48.948404 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:58:48.949408 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:58:48.964777 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:58:48.964777 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:58:48.965781 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:58:48.969930 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:58:48.969930 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"
[0m22:58:48.972957 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:58:48.973962 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      



select
    1
from dev_dwdb.compute_wh.my_first_dbt_model

where not(id >= 1)


      
    ) dbt_internal_test
[0m22:58:48.974966 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:58:48.974966 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:58:48.975968 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:58:48.975968 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:58:48.977975 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:58:48.978978 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:58:48.978978 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m22:58:49.516284 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m22:58:49.523446 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:58:49.644916 [error] [Thread-2 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.73s]
[0m22:58:49.645941 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:58:50.543641 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.568 seconds
[0m22:58:50.544645 [debug] [Thread-1 (]: On test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da: Close
[0m22:58:50.555216 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.576 seconds
[0m22:58:50.557223 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:58:50.665666 [info ] [Thread-1 (]: 1 of 3 PASS dbt_utils_expression_is_true_my_first_dbt_model_id___1 ............. [[32mPASS[0m in 1.75s]
[0m22:58:50.666678 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da
[0m22:58:50.676021 [info ] [Thread-3 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.76s]
[0m22:58:50.677141 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:58:50.678146 [info ] [MainThread]: 
[0m22:58:50.678146 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:58:50.700462 [info ] [MainThread]: {'my_first_dbt_model': 'compute_wh', 'my_second_dbt_model': 'compute_wh'}
[0m22:58:50.705627 [debug] [MainThread]: Using snowflake connection "master"
[0m22:58:50.706630 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:58:50.706630 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:58:51.665472 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.958 seconds
[0m22:58:51.679044 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:58:51.683069 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:58:51.687106 [debug] [MainThread]: Using snowflake connection "master"
[0m22:58:51.688111 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7252438068389893'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('expression_is_true' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'expression_is_true'::varchar(4000) as test_name,
            'dbt_utils_expression_is_true_my_first_dbt_model_id___1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7469985485076904'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7563488483428955'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:58:52.305415 [debug] [MainThread]: SQL status: SUCCESS 3 in 0.617 seconds
[0m22:58:52.305415 [debug] [MainThread]: Using snowflake connection "master"
[0m22:58:52.306641 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'expression_is_true'::varchar(4000) as test_name,
            'select     1 from dev_dwdb.compute_wh.my_first_dbt_model  where not(id >= 1)'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m22:58:52.636713 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.329 seconds
[0m22:58:52.637717 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.95s]
[0m22:58:52.638722 [info ] [MainThread]: 
[0m22:58:52.638722 [debug] [MainThread]: On master: Close
[0m22:58:52.767902 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:58:52.769010 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:58:52.769010 [debug] [MainThread]: Connection 'test.dbt_dataops.dbt_utils_expression_is_true_my_first_dbt_model_id___1.69fdcca0da' was properly closed.
[0m22:58:52.770014 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:58:52.770014 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:58:52.770014 [info ] [MainThread]: 
[0m22:58:52.771018 [info ] [MainThread]: Finished running 3 data tests, 1 project hook in 0 hours 0 minutes and 4.63 seconds (4.63s).
[0m22:58:52.772021 [debug] [MainThread]: Command end result
[0m22:58:52.810697 [info ] [MainThread]: 
[0m22:58:52.811698 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:58:52.812777 [info ] [MainThread]: 
[0m22:58:52.812777 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:58:52.813780 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:58:52.814901 [info ] [MainThread]: 
[0m22:58:52.814901 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:58:52.815926 [info ] [MainThread]: 
[0m22:58:52.815926 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m22:58:52.818436 [debug] [MainThread]: Command `dbt test` failed at 22:58:52.817430 after 6.08 seconds
[0m22:58:52.818436 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592407E920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002593F6B8850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002592605F4C0>]}
[0m22:58:52.818436 [debug] [MainThread]: Flushing usage events
[0m22:59:39.161199 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB492E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB74EA530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB74EA350>]}


============================== 22:59:39.164208 | 1ebe7988-94f5-4846-8ced-ae9d93ff2e43 ==============================
[0m22:59:39.164208 [info ] [MainThread]: Running with dbt=1.8.7
[0m22:59:39.165211 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m22:59:39.945032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1ebe7988-94f5-4846-8ced-ae9d93ff2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB4BB7970>]}
[0m22:59:39.989990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1ebe7988-94f5-4846-8ced-ae9d93ff2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB4403580>]}
[0m22:59:39.992001 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m22:59:40.012656 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m22:59:40.253528 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m22:59:40.254532 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m22:59:40.607727 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1ebe7988-94f5-4846-8ced-ae9d93ff2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD0654130>]}
[0m22:59:40.726297 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1ebe7988-94f5-4846-8ced-ae9d93ff2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD0656410>]}
[0m22:59:40.726297 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m22:59:40.727361 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ebe7988-94f5-4846-8ced-ae9d93ff2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AD02E0C40>]}
[0m22:59:40.729371 [info ] [MainThread]: 
[0m22:59:40.730374 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m22:59:40.734390 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m22:59:40.747572 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m22:59:40.748576 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m22:59:40.748576 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m22:59:41.374155 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.625 seconds
[0m22:59:41.375161 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m22:59:41.497985 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1ebe7988-94f5-4846-8ced-ae9d93ff2e43', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021ACFDD2D10>]}
[0m22:59:41.497985 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m22:59:41.498990 [info ] [MainThread]: 
[0m22:59:41.501012 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:59:41.502021 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:59:41.502021 [info ] [Thread-1 (]: 1 of 2 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m22:59:41.503026 [info ] [Thread-2 (]: 2 of 2 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m22:59:41.503026 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m22:59:41.504030 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m22:59:41.504030 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:59:41.505034 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:59:41.519193 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:59:41.524419 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:59:41.525424 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:59:41.526435 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:59:41.542805 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:59:41.544812 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:59:41.546832 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m22:59:41.546832 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m22:59:41.547839 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m22:59:41.547839 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m22:59:41.548845 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m22:59:41.548845 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m22:59:42.086459 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.538 seconds
[0m22:59:42.093467 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m22:59:42.213510 [info ] [Thread-2 (]: 2 of 2 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.71s]
[0m22:59:42.214514 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m22:59:43.090547 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.542 seconds
[0m22:59:43.092558 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m22:59:43.207945 [error] [Thread-1 (]: 1 of 2 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.70s]
[0m22:59:43.208950 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m22:59:43.209955 [info ] [MainThread]: 
[0m22:59:43.211038 [info ] [MainThread]: Running 1 on-run-end hook
[0m22:59:43.231656 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m22:59:43.236665 [debug] [MainThread]: Using snowflake connection "master"
[0m22:59:43.237666 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m22:59:43.237666 [debug] [MainThread]: Opening a new connection, currently in state init
[0m22:59:44.291501 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.053 seconds
[0m22:59:44.304753 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m22:59:44.308270 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m22:59:44.312303 [debug] [MainThread]: Using snowflake connection "master"
[0m22:59:44.312303 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7094800472259521'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.704918384552002'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m22:59:44.856567 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.543 seconds
[0m22:59:44.856567 [debug] [MainThread]: Using snowflake connection "master"
[0m22:59:44.857573 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m22:59:45.288026 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.430 seconds
[0m22:59:45.289030 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.98s]
[0m22:59:45.290033 [info ] [MainThread]: 
[0m22:59:45.290033 [debug] [MainThread]: On master: Close
[0m22:59:45.421981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m22:59:45.423105 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m22:59:45.423105 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m22:59:45.423105 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m22:59:45.424109 [info ] [MainThread]: 
[0m22:59:45.425115 [info ] [MainThread]: Finished running 2 data tests, 1 project hook in 0 hours 0 minutes and 4.69 seconds (4.69s).
[0m22:59:45.426118 [debug] [MainThread]: Command end result
[0m22:59:45.523291 [info ] [MainThread]: 
[0m22:59:45.524301 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m22:59:45.524301 [info ] [MainThread]: 
[0m22:59:45.525301 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m22:59:45.526302 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m22:59:45.526302 [info ] [MainThread]: 
[0m22:59:45.527362 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m22:59:45.527362 [info ] [MainThread]: 
[0m22:59:45.527362 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
[0m22:59:45.529990 [debug] [MainThread]: Command `dbt test` failed at 22:59:45.528785 after 6.43 seconds
[0m22:59:45.529990 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB492E9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB37644C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021AB36F7CA0>]}
[0m22:59:45.530994 [debug] [MainThread]: Flushing usage events
[0m23:01:16.715187 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021138F9A8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113BB9E5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113BB9E3E0>]}


============================== 23:01:16.719386 | 17c5c765-6896-4dbb-bf41-257a08447eb8 ==============================
[0m23:01:16.719386 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:01:16.719386 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt build --select tag:example_1', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:01:17.468982 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '17c5c765-6896-4dbb-bf41-257a08447eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021154492D40>]}
[0m23:01:17.512629 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '17c5c765-6896-4dbb-bf41-257a08447eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113AFDB730>]}
[0m23:01:17.513630 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:01:17.535146 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:01:17.783389 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:01:17.784395 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_second_dbt_model.sql
[0m23:01:17.784395 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_first_dbt_model.sql
[0m23:01:18.172666 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '17c5c765-6896-4dbb-bf41-257a08447eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021154C0C130>]}
[0m23:01:18.299325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '17c5c765-6896-4dbb-bf41-257a08447eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021154C0F6D0>]}
[0m23:01:18.300326 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m23:01:18.301701 [info ] [MainThread]: 
[0m23:01:18.302705 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:01:18.303708 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m23:01:18.316041 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m23:01:18.316041 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m23:01:18.317084 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:18.959903 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.643 seconds
[0m23:01:18.960907 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m23:01:19.089740 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:01:19.098502 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:01:19.099506 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:01:19.099506 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:01:19.686003 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.586 seconds
[0m23:01:19.687006 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:01:19.806444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '17c5c765-6896-4dbb-bf41-257a08447eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021154C0F5B0>]}
[0m23:01:19.806444 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:01:19.807447 [info ] [MainThread]: 
[0m23:01:19.810456 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m23:01:19.810456 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m23:01:19.811466 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m23:01:19.812473 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m23:01:19.818492 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m23:01:19.821825 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m23:01:19.846067 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m23:01:19.847070 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m23:01:19.848074 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data;
[0m23:01:19.849077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:01:20.358799 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01ba805b-3201-727e-000b-f692000191ee
[0m23:01:20.359305 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 001003 (42000): SQL compilation error:
syntax error line 24 at position 16 unexpected ';'.
[0m23:01:20.359305 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m23:01:20.519583 [debug] [Thread-1 (]: Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 16 unexpected ';'.
  compiled code at target\run\dbt_dataops\models\example\my_first_dbt_model.sql
[0m23:01:20.521602 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '17c5c765-6896-4dbb-bf41-257a08447eb8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002113AF7D330>]}
[0m23:01:20.521602 [error] [Thread-1 (]: 1 of 3 ERROR creating sql table model compute_wh.my_first_dbt_model ............ [[31mERROR[0m in 0.71s]
[0m23:01:20.522609 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m23:01:20.523615 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:01:20.524621 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:01:20.525623 [info ] [Thread-3 (]: 2 of 3 SKIP test not_null_my_first_dbt_model_id ................................ [[33mSKIP[0m]
[0m23:01:20.526639 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:01:20.525623 [info ] [Thread-4 (]: 3 of 3 SKIP test unique_my_first_dbt_model_id .................................. [[33mSKIP[0m]
[0m23:01:20.527644 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:01:20.528649 [info ] [MainThread]: 
[0m23:01:20.529886 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:01:20.554394 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:01:20.559401 [debug] [MainThread]: Using snowflake connection "master"
[0m23:01:20.560538 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:01:20.561555 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:01:21.584975 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.023 seconds
[0m23:01:21.598029 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:01:21.602108 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:01:21.606119 [debug] [MainThread]: Using snowflake connection "master"
[0m23:01:21.606119 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0'::text as execution_time_seconds,
            'skipped'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'None'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0'::text as execution_time_seconds,
            'skipped'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'None'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m23:01:22.084226 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.477 seconds
[0m23:01:22.084226 [debug] [MainThread]: Using snowflake connection "master"
[0m23:01:22.085233 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'None'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'None'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:01:22.509432 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.424 seconds
[0m23:01:22.510437 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 0.91s]
[0m23:01:22.511565 [info ] [MainThread]: 
[0m23:01:22.512640 [debug] [MainThread]: On master: Close
[0m23:01:22.643766 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:01:22.643766 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m23:01:22.644770 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:01:22.644770 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m23:01:22.645780 [info ] [MainThread]: 
[0m23:01:22.645780 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 4.34 seconds (4.34s).
[0m23:01:22.646793 [debug] [MainThread]: Command end result
[0m23:01:22.742324 [info ] [MainThread]: 
[0m23:01:22.742324 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:01:22.743430 [info ] [MainThread]: 
[0m23:01:22.744429 [error] [MainThread]:   Database Error in model my_first_dbt_model (models\example\my_first_dbt_model.sql)
  001003 (42000): SQL compilation error:
  syntax error line 24 at position 16 unexpected ';'.
  compiled code at target\run\dbt_dataops\models\example\my_first_dbt_model.sql
[0m23:01:22.744429 [info ] [MainThread]: 
[0m23:01:22.745764 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=2 TOTAL=3
[0m23:01:22.746768 [debug] [MainThread]: Command `dbt build` failed at 23:01:22.746768 after 6.09 seconds
[0m23:01:22.746768 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021138F9A8C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211550F07C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000211550F0D90>]}
[0m23:01:22.747773 [debug] [MainThread]: Flushing usage events
[0m23:02:07.054723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092EA9E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020931662680>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000209316624A0>]}


============================== 23:02:07.058151 | 7411b70f-1bad-4a6d-bcc8-770bf20fd3e2 ==============================
[0m23:02:07.058151 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:02:07.059364 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_1', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:02:07.766483 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '7411b70f-1bad-4a6d-bcc8-770bf20fd3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092ED27DC0>]}
[0m23:02:07.810056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '7411b70f-1bad-4a6d-bcc8-770bf20fd3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092E59F550>]}
[0m23:02:07.811066 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:02:07.831866 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:02:08.090651 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:02:08.090651 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\my_first_dbt_model.sql
[0m23:02:08.483709 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '7411b70f-1bad-4a6d-bcc8-770bf20fd3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A710130>]}
[0m23:02:08.605378 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '7411b70f-1bad-4a6d-bcc8-770bf20fd3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A711270>]}
[0m23:02:08.605378 [info ] [MainThread]: Found 1 operation, 2 models, 3 data tests, 840 macros
[0m23:02:08.607413 [info ] [MainThread]: 
[0m23:02:08.608421 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:02:08.610429 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m23:02:08.622331 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m23:02:08.622331 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m23:02:08.623339 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:09.255675 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.633 seconds
[0m23:02:09.258904 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m23:02:09.384368 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:02:09.392444 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:02:09.393447 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:02:09.393447 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:02:09.985441 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.592 seconds
[0m23:02:09.986450 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:02:10.106640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '7411b70f-1bad-4a6d-bcc8-770bf20fd3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A7112D0>]}
[0m23:02:10.106640 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:02:10.107648 [info ] [MainThread]: 
[0m23:02:10.109886 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m23:02:10.110890 [info ] [Thread-1 (]: 1 of 3 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m23:02:10.111896 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m23:02:10.111896 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m23:02:10.118959 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m23:02:10.119964 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m23:02:10.143351 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m23:02:10.144354 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m23:02:10.145358 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m23:02:10.145358 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:02:11.101033 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.955 seconds
[0m23:02:11.117343 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m23:02:11.234752 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '7411b70f-1bad-4a6d-bcc8-770bf20fd3e2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020949F3FBE0>]}
[0m23:02:11.235755 [info ] [Thread-1 (]: 1 of 3 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.12s]
[0m23:02:11.236759 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m23:02:11.237763 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:02:11.237763 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:02:11.238767 [info ] [Thread-3 (]: 2 of 3 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:02:11.238767 [info ] [Thread-4 (]: 3 of 3 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:02:11.239771 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:02:11.239771 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m23:02:11.240775 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:02:11.240775 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:02:11.251910 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:02:11.256955 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:02:11.257959 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:02:11.258963 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:02:11.271519 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:02:11.273526 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:02:11.275548 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:02:11.275548 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:02:11.276557 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:02:11.276557 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:02:11.277710 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:02:11.278715 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:02:11.956385 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m23:02:11.960417 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:02:12.085721 [error] [Thread-3 (]: 2 of 3 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.85s]
[0m23:02:12.086824 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:02:12.824275 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.545 seconds
[0m23:02:12.826362 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:02:12.972276 [info ] [Thread-4 (]: 3 of 3 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.73s]
[0m23:02:12.973286 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:02:12.974691 [info ] [MainThread]: 
[0m23:02:12.975702 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:02:12.997654 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:02:13.003744 [debug] [MainThread]: Using snowflake connection "master"
[0m23:02:13.004747 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:02:13.004747 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:02:14.087297 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.082 seconds
[0m23:02:14.100918 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:02:14.104934 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:02:14.167045 [debug] [MainThread]: Using snowflake connection "master"
[0m23:02:14.167045 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.845949649810791'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7325050830841064'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m23:02:14.728892 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.560 seconds
[0m23:02:14.728892 [debug] [MainThread]: Using snowflake connection "master"
[0m23:02:14.729898 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:02:15.178834 [debug] [MainThread]: SQL status: SUCCESS 2 in 0.448 seconds
[0m23:02:15.179838 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 2[0m in 1.07s]
[0m23:02:15.179838 [info ] [MainThread]: 
[0m23:02:15.180840 [debug] [MainThread]: On master: Close
[0m23:02:15.295751 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:02:15.295751 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m23:02:15.296760 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:02:15.296760 [debug] [MainThread]: Connection 'model.dbt_dataops.my_first_dbt_model' was properly closed.
[0m23:02:15.297764 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:02:15.297764 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:02:15.297764 [info ] [MainThread]: 
[0m23:02:15.298841 [info ] [MainThread]: Finished running 1 table model, 2 data tests, 1 project hook in 0 hours 0 minutes and 6.69 seconds (6.69s).
[0m23:02:15.299845 [debug] [MainThread]: Command end result
[0m23:02:15.336681 [info ] [MainThread]: 
[0m23:02:15.336681 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:02:15.337688 [info ] [MainThread]: 
[0m23:02:15.338690 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:02:15.339703 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:02:15.339703 [info ] [MainThread]: 
[0m23:02:15.340717 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:02:15.340717 [info ] [MainThread]: 
[0m23:02:15.341722 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m23:02:15.342752 [debug] [MainThread]: Command `dbt build` failed at 23:02:15.342752 after 8.34 seconds
[0m23:02:15.342752 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002092EA9E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A538100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002094A538A30>]}
[0m23:02:15.343757 [debug] [MainThread]: Flushing usage events
[0m23:04:48.771650 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F8A9E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1FB65A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1FB65A320>]}


============================== 23:04:48.774662 | 3e77a54a-802a-42f3-bc16-d4d478907758 ==============================
[0m23:04:48.774662 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:04:48.775678 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:04:49.482023 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3e77a54a-802a-42f3-bc16-d4d478907758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F8D2BA90>]}
[0m23:04:49.526035 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3e77a54a-802a-42f3-bc16-d4d478907758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F8583520>]}
[0m23:04:49.528047 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:04:49.548255 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:04:49.789523 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:04:49.790553 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m23:04:50.162485 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3e77a54a-802a-42f3-bc16-d4d478907758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C194868130>]}
[0m23:04:50.283734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3e77a54a-802a-42f3-bc16-d4d478907758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C194869150>]}
[0m23:04:50.284737 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m23:04:50.284737 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e77a54a-802a-42f3-bc16-d4d478907758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19434ECE0>]}
[0m23:04:50.286105 [info ] [MainThread]: 
[0m23:04:50.287108 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:04:50.292203 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:04:50.305442 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:04:50.305442 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:04:50.306451 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:04:50.984351 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.678 seconds
[0m23:04:50.985354 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:04:51.109757 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3e77a54a-802a-42f3-bc16-d4d478907758', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C19486A710>]}
[0m23:04:51.110761 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:04:51.111765 [info ] [MainThread]: 
[0m23:04:51.113776 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:04:51.114784 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:04:51.114784 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:04:51.115794 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:04:51.115794 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:04:51.116798 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:04:51.116798 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m23:04:51.117803 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:04:51.118810 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:04:51.119896 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:04:51.119896 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m23:04:51.120901 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:04:51.120901 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:04:51.121907 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:04:51.121907 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:04:51.122906 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:04:51.135453 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:04:51.139593 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:04:51.143611 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:04:51.146644 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:04:51.148656 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:04:51.148656 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:04:51.163806 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:04:51.163806 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:04:51.166828 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:04:51.166828 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:04:51.171033 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:04:51.171033 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:04:51.174046 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:04:51.174046 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:04:51.175051 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:04:51.176070 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:04:51.176070 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:04:51.177077 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:04:51.177077 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:04:51.178083 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m23:04:51.178083 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:04:51.179090 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:04:51.180111 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:04:51.182121 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:04:51.862248 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.684 seconds
[0m23:04:51.869413 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:04:51.870418 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.690 seconds
[0m23:04:51.872425 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m23:04:51.995281 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.87s]
[0m23:04:51.996295 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:04:51.995281 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.88s]
[0m23:04:51.997310 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:04:51.998314 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:04:51.998314 [info ] [Thread-3 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:04:51.999317 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m23:04:51.999317 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:04:52.005578 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:04:52.006579 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:04:52.009582 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:04:52.010583 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:04:52.010583 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:04:52.011584 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m23:04:52.576475 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m23:04:52.577824 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:04:52.700553 [info ] [Thread-3 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.70s]
[0m23:04:52.701558 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:04:52.760760 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.579 seconds
[0m23:04:52.762792 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:04:52.882874 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.76s]
[0m23:04:52.883879 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:04:53.878748 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.700 seconds
[0m23:04:53.880764 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:04:54.001470 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 2.88s]
[0m23:04:54.002190 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:04:54.003230 [info ] [MainThread]: 
[0m23:04:54.004251 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:04:54.026227 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:04:54.031361 [debug] [MainThread]: Using snowflake connection "master"
[0m23:04:54.032364 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:04:54.032364 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:04:55.058717 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.026 seconds
[0m23:04:55.073939 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:04:55.077961 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:04:55.083073 [debug] [MainThread]: Using snowflake connection "master"
[0m23:04:55.084076 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8743650913238525'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8764705657958984'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7012357711791992'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7619729042053223'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.881648540496826'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m23:04:55.480033 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.395 seconds
[0m23:04:55.480033 [debug] [MainThread]: Using snowflake connection "master"
[0m23:04:55.481051 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:04:55.760959 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.280 seconds
[0m23:04:55.761966 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.68s]
[0m23:04:55.762972 [info ] [MainThread]: 
[0m23:04:55.763976 [debug] [MainThread]: On master: Close
[0m23:04:55.885292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:04:55.885292 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:04:55.886312 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m23:04:55.886312 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:04:55.886312 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:04:55.887316 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:04:55.887316 [info ] [MainThread]: 
[0m23:04:55.888325 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 5.60 seconds (5.60s).
[0m23:04:55.889331 [debug] [MainThread]: Command end result
[0m23:04:55.928299 [info ] [MainThread]: 
[0m23:04:55.929303 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:04:55.930449 [info ] [MainThread]: 
[0m23:04:55.930449 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:04:55.931470 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:04:55.932474 [info ] [MainThread]: 
[0m23:04:55.932474 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:04:55.933479 [info ] [MainThread]: 
[0m23:04:55.933479 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:04:55.935489 [debug] [MainThread]: Command `dbt test` failed at 23:04:55.935489 after 7.22 seconds
[0m23:04:55.935489 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C1F8A9E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C194621BA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C194620550>]}
[0m23:04:55.936520 [debug] [MainThread]: Flushing usage events
[0m23:05:25.684574 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBBFE2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBEB9A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBEB9A230>]}


============================== 23:05:25.687951 | e8814e36-024a-4890-9135-e77affb55113 ==============================
[0m23:05:25.687951 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:05:25.688959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:05:26.414927 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e8814e36-024a-4890-9135-e77affb55113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBC26B760>]}
[0m23:05:26.458661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e8814e36-024a-4890-9135-e77affb55113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBE01B700>]}
[0m23:05:26.460670 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:05:26.482262 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:05:26.728160 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:05:26.729164 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:05:26.775662 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'e8814e36-024a-4890-9135-e77affb55113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD79F3FA0>]}
[0m23:05:26.943524 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'e8814e36-024a-4890-9135-e77affb55113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD74D10C0>]}
[0m23:05:26.944529 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m23:05:26.945533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8814e36-024a-4890-9135-e77affb55113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD799CE80>]}
[0m23:05:26.946536 [info ] [MainThread]: 
[0m23:05:26.947542 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:05:26.951634 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:05:26.966344 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:05:26.967357 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:05:26.967357 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:05:27.598651 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.631 seconds
[0m23:05:27.600669 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:05:27.729584 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'e8814e36-024a-4890-9135-e77affb55113', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD79F02E0>]}
[0m23:05:27.729584 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:05:27.730593 [info ] [MainThread]: 
[0m23:05:27.733674 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:05:27.733674 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:05:27.734680 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:05:27.734680 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:05:27.734680 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:05:27.736765 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:05:27.736765 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m23:05:27.737767 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:05:27.737767 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:05:27.738863 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:05:27.739867 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m23:05:27.739867 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:05:27.740872 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:05:27.740872 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:05:27.741877 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:05:27.741877 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:05:27.755165 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:05:27.759173 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:05:27.763605 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:05:27.767641 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:05:27.768900 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:05:27.769912 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:05:27.786276 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:05:27.787285 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:05:27.789767 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:05:27.790786 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:05:27.793883 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:05:27.793883 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:05:27.796912 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:05:27.797915 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:05:27.797915 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:05:27.799293 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:05:27.799293 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:05:27.800626 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:05:27.800626 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:05:27.800626 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m23:05:27.800626 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:05:27.802129 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:05:27.803569 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:05:27.804654 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:05:28.370291 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m23:05:28.377346 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:05:28.405338 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.605 seconds
[0m23:05:28.406354 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:05:28.498604 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.76s]
[0m23:05:28.499614 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:05:28.500638 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:05:28.500638 [info ] [Thread-4 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:05:28.501641 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m23:05:28.501641 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:05:28.507942 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:05:28.508949 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:05:28.510978 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:05:28.511982 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:05:28.512984 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:05:28.512984 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:05:28.534834 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.80s]
[0m23:05:28.536058 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:05:29.004837 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.492 seconds
[0m23:05:29.006848 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:05:29.132851 [info ] [Thread-4 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.63s]
[0m23:05:29.133864 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:05:29.387826 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.587 seconds
[0m23:05:29.389833 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:05:29.392287 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.589 seconds
[0m23:05:29.393510 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m23:05:29.509157 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.77s]
[0m23:05:29.510161 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:05:29.519379 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 1.78s]
[0m23:05:29.520380 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:05:29.521648 [info ] [MainThread]: 
[0m23:05:29.521648 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:05:29.543133 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:05:29.549161 [debug] [MainThread]: Using snowflake connection "master"
[0m23:05:29.549161 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:05:29.550164 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:05:30.557981 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.008 seconds
[0m23:05:30.572278 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:05:30.577307 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:05:30.581412 [debug] [MainThread]: Using snowflake connection "master"
[0m23:05:30.582415 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7587368488311768'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7970669269561768'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6312093734741211'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.770293951034546'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.780515432357788'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m23:05:31.089601 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.507 seconds
[0m23:05:31.090741 [debug] [MainThread]: Using snowflake connection "master"
[0m23:05:31.090741 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:05:31.373374 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.282 seconds
[0m23:05:31.374399 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.80s]
[0m23:05:31.375421 [info ] [MainThread]: 
[0m23:05:31.376432 [debug] [MainThread]: On master: Close
[0m23:05:31.516716 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:05:31.516716 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:05:31.517726 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m23:05:31.517726 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:05:31.517726 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m23:05:31.518731 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:05:31.518731 [info ] [MainThread]: 
[0m23:05:31.519735 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.57 seconds (4.57s).
[0m23:05:31.520738 [debug] [MainThread]: Command end result
[0m23:05:31.558727 [info ] [MainThread]: 
[0m23:05:31.559732 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:05:31.559732 [info ] [MainThread]: 
[0m23:05:31.560736 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:05:31.561739 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:05:31.561739 [info ] [MainThread]: 
[0m23:05:31.562742 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:05:31.562742 [info ] [MainThread]: 
[0m23:05:31.563745 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:05:31.564749 [debug] [MainThread]: Command `dbt test` failed at 23:05:31.564749 after 5.94 seconds
[0m23:05:31.564749 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBBFE2890>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDBE01B700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CDD7DC5D20>]}
[0m23:05:31.565753 [debug] [MainThread]: Flushing usage events
[0m23:06:58.262950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222D7029B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222302BA530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222302BA350>]}


============================== 23:06:58.266396 | 6efefc91-0222-4269-9083-42e896c77cd4 ==============================
[0m23:06:58.266396 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:06:58.267474 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:06:59.037658 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6efefc91-0222-4269-9083-42e896c77cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222D987970>]}
[0m23:06:59.083742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6efefc91-0222-4269-9083-42e896c77cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222D1D3580>]}
[0m23:06:59.084747 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:06:59.108324 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:06:59.345820 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:06:59.346824 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m23:06:59.725913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '6efefc91-0222-4269-9083-42e896c77cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022249420130>]}
[0m23:06:59.854001 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '6efefc91-0222-4269-9083-42e896c77cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222494230A0>]}
[0m23:06:59.855003 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m23:06:59.855003 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6efefc91-0222-4269-9083-42e896c77cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222490C0370>]}
[0m23:06:59.857334 [info ] [MainThread]: 
[0m23:06:59.858338 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:06:59.864530 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:06:59.877442 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:06:59.878449 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:06:59.878449 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:00.536491 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.658 seconds
[0m23:07:00.538493 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:07:00.679442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '6efefc91-0222-4269-9083-42e896c77cd4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022249420370>]}
[0m23:07:00.680445 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:00.681448 [info ] [MainThread]: 
[0m23:07:00.685359 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:00.685359 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:00.685874 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:00.686396 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:00.686913 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:07:00.687428 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:07:00.688460 [info ] [Thread-3 (]: 3 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:07:00.688978 [info ] [Thread-4 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:07:00.689490 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:07:00.690529 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:07:00.691044 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:07:00.691559 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m23:07:00.692077 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:00.692591 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:00.693108 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:00.693621 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:00.708122 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:07:00.711132 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:07:00.715240 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:07:00.721280 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:07:00.722283 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:00.723287 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:00.724293 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:00.740449 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:07:00.740449 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:00.743471 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:07:00.746559 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:07:00.749578 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:07:00.749578 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:07:00.750583 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:07:00.751588 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:07:00.752593 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:07:00.752593 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:07:00.753599 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:07:00.754603 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:07:00.754603 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:07:00.755604 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:07:00.755604 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:07:00.756604 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:07:00.760340 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:07:01.295183 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.540 seconds
[0m23:07:01.302434 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:07:01.347783 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m23:07:01.349794 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:07:01.419305 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.73s]
[0m23:07:01.421482 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:01.473001 [error] [Thread-3 (]: 3 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m23:07:01.474004 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:02.348636 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.593 seconds
[0m23:07:02.350743 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:07:02.469886 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.78s]
[0m23:07:02.470897 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:02.473021 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.713 seconds
[0m23:07:02.475178 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:07:02.598939 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.91s]
[0m23:07:02.599942 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:02.601949 [info ] [MainThread]: 
[0m23:07:02.601949 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:07:02.623225 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:07:02.628331 [debug] [MainThread]: Using snowflake connection "master"
[0m23:07:02.629335 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:07:02.629335 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:03.696126 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.066 seconds
[0m23:07:03.771600 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:07:03.776991 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:07:03.781012 [debug] [MainThread]: Using snowflake connection "master"
[0m23:07:03.782017 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7298152446746826'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7809545993804932'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7785532474517822'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.907379388809204'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        current_timestamp as created_timestamp,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, created_timestamp, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', current_timestamp, null
      );
[0m23:07:04.236775 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.455 seconds
[0m23:07:04.237881 [debug] [MainThread]: Using snowflake connection "master"
[0m23:07:04.238882 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:07:04.710611 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.471 seconds
[0m23:07:04.711785 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.93s]
[0m23:07:04.711785 [info ] [MainThread]: 
[0m23:07:04.712789 [debug] [MainThread]: On master: Close
[0m23:07:04.834411 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:04.835548 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:07:04.835548 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m23:07:04.835548 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:07:04.836550 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:07:04.836550 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:07:04.837630 [info ] [MainThread]: 
[0m23:07:04.837630 [info ] [MainThread]: Finished running 4 data tests, 1 project hook in 0 hours 0 minutes and 4.98 seconds (4.98s).
[0m23:07:04.839640 [debug] [MainThread]: Command end result
[0m23:07:04.877527 [info ] [MainThread]: 
[0m23:07:04.878534 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:07:04.878534 [info ] [MainThread]: 
[0m23:07:04.879537 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:07:04.880751 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:07:04.880751 [info ] [MainThread]: 
[0m23:07:04.881863 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:07:04.881863 [info ] [MainThread]: 
[0m23:07:04.882926 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:07:04.884006 [debug] [MainThread]: Command `dbt test` failed at 23:07:04.884006 after 6.68 seconds
[0m23:07:04.885007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002222D7029B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022249301150>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222496675B0>]}
[0m23:07:04.885007 [debug] [MainThread]: Flushing usage events
[0m23:07:23.838224 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C219BCE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C21C78E410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C21C78E230>]}


============================== 23:07:23.841354 | c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e ==============================
[0m23:07:23.841354 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:07:23.842467 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:07:24.625111 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C219E5BCD0>]}
[0m23:07:24.669817 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C21BC0B760>]}
[0m23:07:24.670818 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:07:24.693060 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:07:24.942464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m23:07:24.943754 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m23:07:24.944760 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m23:07:25.341286 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C2358FD630>]}
[0m23:07:25.465810 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23535CB50>]}
[0m23:07:25.466856 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m23:07:25.468077 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23558C700>]}
[0m23:07:25.469228 [info ] [MainThread]: 
[0m23:07:25.470233 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:07:25.475513 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:07:25.490612 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:07:25.491699 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:07:25.491699 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:07:26.135051 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.643 seconds
[0m23:07:26.136055 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:07:26.255549 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c7d7a79c-0a0c-47dd-bb9a-059a4cc4085e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23535D720>]}
[0m23:07:26.256552 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:07:26.257753 [info ] [MainThread]: 
[0m23:07:26.259855 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:26.260932 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:26.260932 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:07:26.260932 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:26.261938 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:07:26.261938 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:07:26.262943 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m23:07:26.263947 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:07:26.263947 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:07:26.264951 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:07:26.264951 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m23:07:26.265957 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:07:26.265957 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:26.266957 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:26.266957 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:07:26.268199 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:26.281590 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:07:26.285593 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:07:26.291079 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:07:26.294097 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:07:26.295108 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:26.304237 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:07:26.312531 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:07:26.312531 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:26.315547 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:07:26.315547 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:26.317559 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:07:26.318564 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:07:26.321819 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:07:26.322826 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:07:26.322826 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:07:26.323833 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:07:26.324838 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m23:07:26.324838 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:07:26.325841 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:07:26.325841 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:07:26.326842 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:07:26.326842 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:07:26.328253 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:07:26.330263 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:07:26.912420 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.587 seconds
[0m23:07:26.919109 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:07:26.949609 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m23:07:26.951625 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m23:07:26.967958 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m23:07:26.969973 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:07:27.037539 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.77s]
[0m23:07:27.038113 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:07:27.039119 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:27.040120 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:07:27.040120 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m23:07:27.041166 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:27.106208 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:07:27.108413 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:27.112435 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:07:27.109419 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.84s]
[0m23:07:27.113439 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:07:27.109419 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.84s]
[0m23:07:27.114444 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:07:27.114444 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:07:27.115452 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:07:27.116618 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:07:27.657257 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m23:07:27.659264 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:07:27.784633 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.74s]
[0m23:07:27.785640 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:07:27.876232 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.547 seconds
[0m23:07:27.877236 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:07:27.990788 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.73s]
[0m23:07:27.991802 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:07:27.992814 [info ] [MainThread]: 
[0m23:07:27.993818 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:07:28.015317 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:07:28.020348 [debug] [MainThread]: Using snowflake connection "master"
[0m23:07:28.021357 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:07:28.021357 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:07:29.029654 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.008 seconds
[0m23:07:29.044917 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:07:29.049249 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:07:29.054365 [debug] [MainThread]: Using snowflake connection "master"
[0m23:07:29.054365 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.773592472076416'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8434619903564453'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8434619903564453'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7445132732391357'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.725837230682373'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m23:07:29.527214 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.472 seconds
[0m23:07:29.528218 [debug] [MainThread]: Using snowflake connection "master"
[0m23:07:29.528218 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:07:29.812287 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.283 seconds
[0m23:07:29.813293 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.76s]
[0m23:07:29.814296 [info ] [MainThread]: 
[0m23:07:29.814296 [debug] [MainThread]: On master: Close
[0m23:07:29.930585 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:07:29.930585 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:07:29.931966 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:07:29.931966 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:07:29.931966 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m23:07:29.932970 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:07:29.932970 [info ] [MainThread]: 
[0m23:07:29.933973 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.46 seconds (4.46s).
[0m23:07:29.934980 [debug] [MainThread]: Command end result
[0m23:07:29.971427 [info ] [MainThread]: 
[0m23:07:29.972431 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:07:29.973435 [info ] [MainThread]: 
[0m23:07:29.974439 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:07:29.974439 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:07:29.975447 [info ] [MainThread]: 
[0m23:07:29.976525 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:07:29.976525 [info ] [MainThread]: 
[0m23:07:29.977529 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:07:29.978532 [debug] [MainThread]: Command `dbt test` failed at 23:07:29.978532 after 6.20 seconds
[0m23:07:29.979535 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C219BCE8F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C21C0C1AB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C23560A530>]}
[0m23:07:29.979535 [debug] [MainThread]: Flushing usage events
[0m23:09:37.299343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204B50B2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204B7C6E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204B7C6E320>]}


============================== 23:09:37.302360 | 5bc68fe2-554b-4a71-ab8d-4ef9609b6916 ==============================
[0m23:09:37.302360 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:09:37.303363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m23:09:38.043350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5bc68fe2-554b-4a71-ab8d-4ef9609b6916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204B533BEB0>]}
[0m23:09:38.087793 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5bc68fe2-554b-4a71-ab8d-4ef9609b6916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D05797E0>]}
[0m23:09:38.088798 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:09:38.109461 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:09:38.347549 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:09:38.347549 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:09:38.395019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5bc68fe2-554b-4a71-ab8d-4ef9609b6916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D0AC3E50>]}
[0m23:09:38.566864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5bc68fe2-554b-4a71-ab8d-4ef9609b6916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D0AC2F20>]}
[0m23:09:38.567878 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m23:09:38.567878 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc68fe2-554b-4a71-ab8d-4ef9609b6916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D0A71300>]}
[0m23:09:38.569886 [info ] [MainThread]: 
[0m23:09:38.570889 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:09:38.574903 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:09:38.588989 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:09:38.589993 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:09:38.589993 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:09:39.265623 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.675 seconds
[0m23:09:39.266630 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:09:39.394449 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5bc68fe2-554b-4a71-ab8d-4ef9609b6916', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D0AC0490>]}
[0m23:09:39.394449 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:09:39.395520 [info ] [MainThread]: 
[0m23:09:39.398538 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:09:39.398538 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:09:39.399539 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:09:39.399539 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:09:39.400540 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:09:39.400540 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:09:39.401541 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m23:09:39.402542 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:09:39.402542 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:09:39.403543 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:09:39.403543 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m23:09:39.404636 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:09:39.404636 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:09:39.405640 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:09:39.405640 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:09:39.406645 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:09:39.420423 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:09:39.424580 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:09:39.428602 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:09:39.431715 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:09:39.432720 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:09:39.433725 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:09:39.445942 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:09:39.450061 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:09:39.451068 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:09:39.454081 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:09:39.456096 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:09:39.459114 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:09:39.460118 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:09:39.461119 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:09:39.462120 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:09:39.462120 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:09:39.462120 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:09:39.463414 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:09:39.463414 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:09:39.464419 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m23:09:39.464419 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:09:39.465425 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:09:39.467433 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:09:39.469447 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:09:40.037659 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.573 seconds
[0m23:09:40.044686 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:09:40.088985 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.622 seconds
[0m23:09:40.091008 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m23:09:40.092012 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.627 seconds
[0m23:09:40.094184 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:09:40.163107 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.76s]
[0m23:09:40.164328 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:09:40.164328 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:09:40.165331 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:09:40.165331 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m23:09:40.166338 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:09:40.172474 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:09:40.173480 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:09:40.175499 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:09:40.176505 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:09:40.177510 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:09:40.177510 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:09:40.219455 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.82s]
[0m23:09:40.221463 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:09:40.224477 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.82s]
[0m23:09:40.225482 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:09:40.728402 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.550 seconds
[0m23:09:40.729405 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:09:40.853606 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.69s]
[0m23:09:40.855039 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:09:41.004175 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.535 seconds
[0m23:09:41.005181 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:09:41.131930 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.73s]
[0m23:09:41.133937 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:09:41.134960 [info ] [MainThread]: 
[0m23:09:41.134960 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:09:41.157677 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:09:41.163705 [debug] [MainThread]: Using snowflake connection "master"
[0m23:09:41.163705 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:09:41.164710 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:09:42.214305 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.050 seconds
[0m23:09:42.230268 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:09:42.234390 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:09:42.238591 [debug] [MainThread]: Using snowflake connection "master"
[0m23:09:42.239655 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7605652809143066'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8159122467041016'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8209342956542969'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6882753372192383'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7272937297821045'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
      and target.is_active = 'Y'
    when matched then
      update set TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m23:09:42.685350 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.444 seconds
[0m23:09:42.685350 [debug] [MainThread]: Using snowflake connection "master"
[0m23:09:42.686351 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:09:42.965057 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.278 seconds
[0m23:09:42.966064 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.73s]
[0m23:09:42.967108 [info ] [MainThread]: 
[0m23:09:42.968114 [debug] [MainThread]: On master: Close
[0m23:09:43.090804 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:09:43.090804 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:09:43.091895 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:09:43.091895 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:09:43.092901 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m23:09:43.092901 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:09:43.092901 [info ] [MainThread]: 
[0m23:09:43.093906 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.52 seconds (4.52s).
[0m23:09:43.094911 [debug] [MainThread]: Command end result
[0m23:09:43.134830 [info ] [MainThread]: 
[0m23:09:43.135851 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:09:43.135851 [info ] [MainThread]: 
[0m23:09:43.136875 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:09:43.138009 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:09:43.138009 [info ] [MainThread]: 
[0m23:09:43.139088 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:09:43.139088 [info ] [MainThread]: 
[0m23:09:43.140384 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:09:43.141451 [debug] [MainThread]: Command `dbt test` failed at 23:09:43.141451 after 5.90 seconds
[0m23:09:43.142474 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204B50B2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204B4B834F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000204D0E96230>]}
[0m23:09:43.142474 [debug] [MainThread]: Flushing usage events
[0m23:10:05.624979 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026029D3E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602C8DE560>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602C8DE380>]}


============================== 23:10:05.628082 | 0922541d-117b-4a0a-aaa5-ebcee8f02669 ==============================
[0m23:10:05.628082 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:10:05.629085 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m23:10:06.327851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '0922541d-117b-4a0a-aaa5-ebcee8f02669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602A5B4820>]}
[0m23:10:06.372777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '0922541d-117b-4a0a-aaa5-ebcee8f02669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602BD21720>]}
[0m23:10:06.373781 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:10:06.395014 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:10:06.627887 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:06.627887 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m23:10:06.770765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '0922541d-117b-4a0a-aaa5-ebcee8f02669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604573C130>]}
[0m23:10:06.891783 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '0922541d-117b-4a0a-aaa5-ebcee8f02669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604536F340>]}
[0m23:10:06.891783 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m23:10:06.892787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0922541d-117b-4a0a-aaa5-ebcee8f02669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002602A0C9300>]}
[0m23:10:06.894790 [info ] [MainThread]: 
[0m23:10:06.895879 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:10:06.899895 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:10:06.914457 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:10:06.914457 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:10:06.915462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:07.592563 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.677 seconds
[0m23:10:07.594571 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:10:07.717715 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '0922541d-117b-4a0a-aaa5-ebcee8f02669', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002604573E7D0>]}
[0m23:10:07.717715 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:10:07.719190 [info ] [MainThread]: 
[0m23:10:07.722299 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:07.722299 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:07.723424 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:07.723424 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:07.723424 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:10:07.724430 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:10:07.725434 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m23:10:07.725434 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:10:07.726438 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:10:07.727520 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:10:07.727520 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m23:10:07.728526 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:10:07.728526 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:07.729531 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:07.729531 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:07.730539 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:07.743312 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:07.747328 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:07.751358 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:10:07.754380 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:07.755385 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:07.756400 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:07.771559 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:07.771559 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:07.775111 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:07.776116 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:07.779135 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:10:07.779135 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:07.782167 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:07.783177 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:07.784202 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:10:07.785209 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:10:07.785209 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:10:07.786704 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:07.786704 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:10:07.787711 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m23:10:07.787711 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:10:07.788716 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:10:07.790800 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:10:07.791805 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:10:08.314801 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m23:10:08.321332 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:10:08.443993 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.72s]
[0m23:10:08.445072 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:08.446076 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:08.446076 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:10:08.447080 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m23:10:08.448084 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:08.453781 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:08.453781 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:08.456973 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:08.457977 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:08.458980 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:10:08.458980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:10:08.979819 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.521 seconds
[0m23:10:08.981832 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:10:09.150594 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.70s]
[0m23:10:09.151597 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:09.353795 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.564 seconds
[0m23:10:09.355812 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m23:10:09.475518 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 1.75s]
[0m23:10:09.477537 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:10.621805 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.834 seconds
[0m23:10:10.623835 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:10:10.630400 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.838 seconds
[0m23:10:10.631416 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:10:10.740737 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 3.01s]
[0m23:10:10.742744 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:10.748503 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 3.02s]
[0m23:10:10.749503 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:10.750007 [info ] [MainThread]: 
[0m23:10:10.751010 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:10:10.773959 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:10:10.779967 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:10.780968 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:10:10.780968 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:11.813943 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.032 seconds
[0m23:10:11.828193 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:10:11.832213 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:10:11.837352 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:11.838354 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7175557613372803'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7035138607025146'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7479979991912842'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.013216972351074'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.018955945968628'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched and target.is_active = 'Y' then
      update set TIMESTAMP = source.TIMESTAMP
    when matched and target.is_active = 'N' then
      update set 
        is_active = 'Y',
        deactivated_timestamp = null,
        TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m23:10:12.350150 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.511 seconds
[0m23:10:12.350150 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:12.351153 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:10:12.739472 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.388 seconds
[0m23:10:12.741008 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.91s]
[0m23:10:12.741519 [info ] [MainThread]: 
[0m23:10:12.742551 [debug] [MainThread]: On master: Close
[0m23:10:12.857144 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:12.858165 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:10:12.858165 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:10:12.859169 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:10:12.859169 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m23:10:12.860172 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:10:12.860172 [info ] [MainThread]: 
[0m23:10:12.860172 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 5.97 seconds (5.97s).
[0m23:10:12.862477 [debug] [MainThread]: Command end result
[0m23:10:12.900774 [info ] [MainThread]: 
[0m23:10:12.900774 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:10:12.901777 [info ] [MainThread]: 
[0m23:10:12.902780 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:10:12.903862 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:10:12.903862 [info ] [MainThread]: 
[0m23:10:12.904894 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:10:12.904894 [info ] [MainThread]: 
[0m23:10:12.905899 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:10:12.906902 [debug] [MainThread]: Command `dbt test` failed at 23:10:12.906902 after 7.34 seconds
[0m23:10:12.908036 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026029D3E9E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026045272B60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026045C61810>]}
[0m23:10:12.908036 [debug] [MainThread]: Flushing usage events
[0m23:10:25.007912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD54F9E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD57B4A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD57B4A320>]}


============================== 23:10:25.010992 | a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31 ==============================
[0m23:10:25.010992 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:10:25.011995 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m23:10:25.723806 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD55227A90>]}
[0m23:10:25.768867 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD54A93520>]}
[0m23:10:25.769870 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:10:25.791140 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:10:26.041803 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:26.042809 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m23:10:26.414114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD70CB0130>]}
[0m23:10:26.539861 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD70CB0640>]}
[0m23:10:26.539861 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m23:10:26.540866 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD709504C0>]}
[0m23:10:26.542869 [info ] [MainThread]: 
[0m23:10:26.543871 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:10:26.549074 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:10:26.561138 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:10:26.562374 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:10:26.562374 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:27.216238 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.654 seconds
[0m23:10:27.218247 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:10:27.350285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'a38ac74e-bbe2-4e5e-ba78-e4c82fd49c31', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD70CB0910>]}
[0m23:10:27.350285 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:10:27.351553 [info ] [MainThread]: 
[0m23:10:27.354564 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:27.354564 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:27.355583 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:27.355583 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:27.356589 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:10:27.356589 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:10:27.357604 [info ] [Thread-3 (]: 3 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:10:27.357604 [info ] [Thread-4 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:10:27.358610 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:10:27.358610 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:10:27.359618 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:10:27.360623 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m23:10:27.360623 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:27.360623 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:27.361628 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:27.361628 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:27.374829 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:27.378866 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:27.382961 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:27.389014 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:27.390023 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:27.395067 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:27.395067 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:27.406422 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:27.408431 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:27.409434 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:27.412545 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:27.414556 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:27.415571 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:27.416576 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:27.417587 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:27.417587 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:10:27.418590 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:10:27.418590 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:27.418590 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:10:27.419671 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:10:27.419671 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:10:27.420681 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:10:27.420681 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:10:27.424709 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:10:27.984663 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.565 seconds
[0m23:10:27.992730 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:10:28.112256 [error] [Thread-3 (]: 3 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.75s]
[0m23:10:28.114283 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:29.004932 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.581 seconds
[0m23:10:29.007176 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:10:29.133961 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.77s]
[0m23:10:29.134963 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:29.155142 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.736 seconds
[0m23:10:29.157311 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:10:29.279971 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 1.92s]
[0m23:10:29.282009 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:30.168050 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.747 seconds
[0m23:10:30.171074 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:10:30.296087 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 2.94s]
[0m23:10:30.297092 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:30.299100 [info ] [MainThread]: 
[0m23:10:30.299100 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:10:30.325060 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:10:30.334090 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:30.335281 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:10:30.335281 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:31.338938 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.003 seconds
[0m23:10:31.414784 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:10:31.418970 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:10:31.424001 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:31.425007 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7526371479034424'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7743422985076904'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9213614463806152'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.9374773502349854'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched and target.is_active = 'Y' then
      update set TIMESTAMP = source.TIMESTAMP
    when matched and target.is_active = 'N' then
      update set 
        is_active = 'Y',
        deactivated_timestamp = null,
        TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m23:10:31.872584 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.447 seconds
[0m23:10:31.873589 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:31.873589 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:10:32.281613 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.407 seconds
[0m23:10:32.282617 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.86s]
[0m23:10:32.283620 [info ] [MainThread]: 
[0m23:10:32.283620 [debug] [MainThread]: On master: Close
[0m23:10:32.414124 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:32.415134 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:10:32.415134 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m23:10:32.415134 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:10:32.416139 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m23:10:32.416139 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:10:32.417146 [info ] [MainThread]: 
[0m23:10:32.417146 [info ] [MainThread]: Finished running 4 data tests, 1 project hook in 0 hours 0 minutes and 5.87 seconds (5.87s).
[0m23:10:32.419154 [debug] [MainThread]: Command end result
[0m23:10:32.454805 [info ] [MainThread]: 
[0m23:10:32.455823 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:10:32.456982 [info ] [MainThread]: 
[0m23:10:32.458018 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:10:32.458018 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:10:32.459310 [info ] [MainThread]: 
[0m23:10:32.459310 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:10:32.460313 [info ] [MainThread]: 
[0m23:10:32.460313 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m23:10:32.461319 [debug] [MainThread]: Command `dbt test` failed at 23:10:32.461319 after 7.51 seconds
[0m23:10:32.462327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD54F9E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD70BC1F60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CD710E40A0>]}
[0m23:10:32.462327 [debug] [MainThread]: Flushing usage events
[0m23:10:43.626189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678488E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678741A4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678741A2F0>]}


============================== 23:10:43.629207 | 82f52b82-9559-4f9a-a997-42c9a55357ec ==============================
[0m23:10:43.629207 [info ] [MainThread]: Running with dbt=1.8.7
[0m23:10:43.630235 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m23:10:44.364689 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '82f52b82-9559-4f9a-a997-42c9a55357ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267873D6980>]}
[0m23:10:44.408582 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '82f52b82-9559-4f9a-a997-42c9a55357ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678513C7C0>]}
[0m23:10:44.409585 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m23:10:44.430808 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m23:10:44.663363 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:10:44.664366 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m23:10:45.019182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '82f52b82-9559-4f9a-a997-42c9a55357ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A0588130>]}
[0m23:10:45.136183 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '82f52b82-9559-4f9a-a997-42c9a55357ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A05880D0>]}
[0m23:10:45.137301 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m23:10:45.138306 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f52b82-9559-4f9a-a997-42c9a55357ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A0220D30>]}
[0m23:10:45.139311 [info ] [MainThread]: 
[0m23:10:45.140315 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m23:10:45.145357 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m23:10:45.158584 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m23:10:45.158584 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m23:10:45.159588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:10:45.798626 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.639 seconds
[0m23:10:45.799632 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m23:10:45.923162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '82f52b82-9559-4f9a-a997-42c9a55357ec', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A0588070>]}
[0m23:10:45.924168 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m23:10:45.924168 [info ] [MainThread]: 
[0m23:10:45.927348 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:45.928352 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:45.928352 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:45.928352 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:45.929356 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m23:10:45.929356 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m23:10:45.930359 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m23:10:45.930359 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m23:10:45.931360 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m23:10:45.931360 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m23:10:45.932630 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m23:10:45.932630 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m23:10:45.933635 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:45.933635 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:45.934641 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:45.934641 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:45.948043 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:45.951051 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:45.955112 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:10:45.958283 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:45.959286 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:45.960291 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:45.970453 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:45.976847 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:45.980870 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:45.980870 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:45.982878 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:10:45.985928 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:45.987057 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m23:10:45.988062 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m23:10:45.988062 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m23:10:45.989073 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m23:10:45.989073 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m23:10:45.990076 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m23:10:45.990076 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m23:10:45.991205 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m23:10:45.991205 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m23:10:45.992209 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m23:10:45.994221 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m23:10:45.995226 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m23:10:46.598197 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.608 seconds
[0m23:10:46.605235 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m23:10:46.606240 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.611 seconds
[0m23:10:46.608359 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m23:10:46.747836 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.82s]
[0m23:10:46.748841 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m23:10:46.749846 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:46.750856 [info ] [Thread-4 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m23:10:46.751861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m23:10:46.751861 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:46.750856 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.82s]
[0m23:10:46.757883 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:46.758888 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m23:10:46.759893 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:46.820202 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:46.822232 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m23:10:46.822232 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m23:10:46.823343 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m23:10:47.351589 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.529 seconds
[0m23:10:47.353598 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m23:10:47.480169 [info ] [Thread-4 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.73s]
[0m23:10:47.482119 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m23:10:47.516344 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.525 seconds
[0m23:10:47.518247 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m23:10:47.636985 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.70s]
[0m23:10:47.637989 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m23:10:48.746526 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.752 seconds
[0m23:10:48.747535 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m23:10:48.876709 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 2.94s]
[0m23:10:48.877712 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m23:10:48.879102 [info ] [MainThread]: 
[0m23:10:48.880104 [info ] [MainThread]: Running 1 on-run-end hook
[0m23:10:48.902904 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m23:10:48.908990 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:48.908990 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m23:10:48.909995 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:10:49.887380 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.977 seconds
[0m23:10:49.902573 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m23:10:49.906703 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m23:10:49.911726 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:49.912732 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8152055740356445'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8194959163665771'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7293133735656738'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7046194076538086'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.943072557449341'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched and target.is_active = 'Y' then
      update set TIMESTAMP = source.TIMESTAMP
    when matched and target.is_active = 'N' then
      update set 
        is_active = 'Y',
        deactivated_timestamp = null,
        TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m23:10:50.353496 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.441 seconds
[0m23:10:50.354521 [debug] [MainThread]: Using snowflake connection "master"
[0m23:10:50.354521 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m23:10:50.647702 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.292 seconds
[0m23:10:50.648706 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.74s]
[0m23:10:50.649712 [info ] [MainThread]: 
[0m23:10:50.649712 [debug] [MainThread]: On master: Close
[0m23:10:50.770788 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:10:50.771804 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m23:10:50.771804 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m23:10:50.771804 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m23:10:50.772808 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m23:10:50.772808 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m23:10:50.773812 [info ] [MainThread]: 
[0m23:10:50.773812 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 5.63 seconds (5.63s).
[0m23:10:50.775905 [debug] [MainThread]: Command end result
[0m23:10:50.813321 [info ] [MainThread]: 
[0m23:10:50.814322 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m23:10:50.815323 [info ] [MainThread]: 
[0m23:10:50.816324 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m23:10:50.817325 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m23:10:50.817325 [info ] [MainThread]: 
[0m23:10:50.818326 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m23:10:50.818326 [info ] [MainThread]: 
[0m23:10:50.819326 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m23:10:50.821352 [debug] [MainThread]: Command `dbt test` failed at 23:10:50.820328 after 7.25 seconds
[0m23:10:50.821352 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002678488E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267850F4B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000267A02822F0>]}
[0m23:10:50.822383 [debug] [MainThread]: Flushing usage events
[0m08:22:06.462470 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063B33E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063DEFE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063DEFE320>]}


============================== 08:22:06.467794 | 1a0eac3e-e3a9-43e8-9689-751ea6b8895d ==============================
[0m08:22:06.467794 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:22:06.468802 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:22:07.628495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1a0eac3e-e3a9-43e8-9689-751ea6b8895d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063B5C7DC0>]}
[0m08:22:07.672090 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1a0eac3e-e3a9-43e8-9689-751ea6b8895d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063D926E00>]}
[0m08:22:07.673096 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:22:07.695372 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:22:07.984306 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:22:07.985323 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:22:08.033122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1a0eac3e-e3a9-43e8-9689-751ea6b8895d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020656D53E50>]}
[0m08:22:08.205661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1a0eac3e-e3a9-43e8-9689-751ea6b8895d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020656D53CA0>]}
[0m08:22:08.206840 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:22:08.206840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a0eac3e-e3a9-43e8-9689-751ea6b8895d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020656CFCE80>]}
[0m08:22:08.209004 [info ] [MainThread]: 
[0m08:22:08.209004 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:22:08.215001 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:22:08.230487 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:22:08.231493 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:22:08.231493 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:22:08.888225 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.657 seconds
[0m08:22:08.890245 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:22:09.014302 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1a0eac3e-e3a9-43e8-9689-751ea6b8895d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020656D3B160>]}
[0m08:22:09.014302 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:22:09.015309 [info ] [MainThread]: 
[0m08:22:09.019351 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:22:09.019351 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:22:09.020370 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:22:09.020370 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:22:09.020370 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:22:09.021375 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:22:09.022379 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:22:09.022379 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:22:09.023379 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:22:09.023379 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:22:09.024548 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:22:09.024548 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:22:09.025554 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:22:09.025554 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:22:09.026559 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:22:09.026559 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:22:09.041351 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:22:09.044373 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:22:09.048400 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:22:09.051554 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:22:09.052558 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:22:09.064872 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:22:09.069974 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:22:09.070980 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:22:09.074027 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:22:09.074027 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:22:09.077042 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:22:09.077042 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:22:09.080056 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:22:09.081204 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:22:09.081204 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:22:09.082212 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:22:09.083216 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:22:09.083216 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:22:09.084469 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:22:09.084469 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:22:09.085474 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:22:09.085474 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:22:09.087494 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:22:09.089506 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:22:09.718388 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.634 seconds
[0m08:22:09.719395 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.631 seconds
[0m08:22:09.727233 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:22:09.728715 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:22:09.861467 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.84s]
[0m08:22:09.863478 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:22:09.862473 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.84s]
[0m08:22:09.864483 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:22:09.864483 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:22:09.865488 [info ] [Thread-4 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:22:09.866493 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:22:09.866493 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:22:09.872622 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:22:09.873625 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:22:09.876643 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:22:09.877646 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:22:09.878652 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:22:09.878652 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:22:10.470221 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m08:22:10.472249 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:22:10.596239 [info ] [Thread-4 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.73s]
[0m08:22:10.597264 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:22:10.872855 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.788 seconds
[0m08:22:10.874903 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:22:10.998574 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 1.97s]
[0m08:22:10.999579 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:22:11.760997 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 2.674 seconds
[0m08:22:11.763004 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:22:11.887350 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 2.86s]
[0m08:22:11.887939 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:22:11.888969 [info ] [MainThread]: 
[0m08:22:11.889975 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:22:11.911210 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:22:11.916394 [debug] [MainThread]: Using snowflake connection "master"
[0m08:22:11.917401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:22:11.917401 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:22:13.301020 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.383 seconds
[0m08:22:13.315192 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:22:13.320004 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:22:13.325023 [debug] [MainThread]: Using snowflake connection "master"
[0m08:22:13.326028 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8369193077087402'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8390932083129883'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7307515144348145'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9730193614959717'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.862515687942505'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched and target.is_active = 'Y' then
      update set TIMESTAMP = source.TIMESTAMP
    when matched and target.is_active = 'N' then
      update set 
        is_active = 'Y',
        deactivated_timestamp = null,
        TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:22:14.079571 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.753 seconds
[0m08:22:14.080607 [debug] [MainThread]: Using snowflake connection "master"
[0m08:22:14.080607 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:22:14.540639 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.459 seconds
[0m08:22:14.542654 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.22s]
[0m08:22:14.542654 [info ] [MainThread]: 
[0m08:22:14.543660 [debug] [MainThread]: On master: Close
[0m08:22:14.669278 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:22:14.670282 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:22:14.670282 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:22:14.671286 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:22:14.671286 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:22:14.671286 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:22:14.672296 [info ] [MainThread]: 
[0m08:22:14.672296 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 6.46 seconds (6.46s).
[0m08:22:14.674689 [debug] [MainThread]: Command end result
[0m08:22:14.712588 [info ] [MainThread]: 
[0m08:22:14.713917 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:22:14.715122 [info ] [MainThread]: 
[0m08:22:14.715122 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:22:14.716127 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:22:14.717213 [info ] [MainThread]: 
[0m08:22:14.717213 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:22:14.718217 [info ] [MainThread]: 
[0m08:22:14.718217 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:22:14.720274 [debug] [MainThread]: Command `dbt test` failed at 08:22:14.720274 after 8.32 seconds
[0m08:22:14.720274 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063B33E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002063D31F100>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000206571EC4C0>]}
[0m08:22:14.721275 [debug] [MainThread]: Flushing usage events
[0m08:23:43.491880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB0E6E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB3A2A4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB3A2A2C0>]}


============================== 08:23:43.495005 | 62e59b94-8320-42dc-821c-2e4aa9bcf9ba ==============================
[0m08:23:43.495005 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:23:43.495005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:23:44.190398 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '62e59b94-8320-42dc-821c-2e4aa9bcf9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB10F7A90>]}
[0m08:23:44.234977 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '62e59b94-8320-42dc-821c-2e4aa9bcf9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCC3397E0>]}
[0m08:23:44.235982 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:23:44.256283 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:23:44.484201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:23:44.485204 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:23:44.532265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '62e59b94-8320-42dc-821c-2e4aa9bcf9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCC883E50>]}
[0m08:23:44.690560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '62e59b94-8320-42dc-821c-2e4aa9bcf9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCC362350>]}
[0m08:23:44.691566 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:23:44.692571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62e59b94-8320-42dc-821c-2e4aa9bcf9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCC82D360>]}
[0m08:23:44.693576 [info ] [MainThread]: 
[0m08:23:44.694703 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:23:44.698915 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:23:44.713122 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:23:44.713122 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:23:44.713122 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:23:45.365664 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.653 seconds
[0m08:23:45.367854 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:23:45.488773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '62e59b94-8320-42dc-821c-2e4aa9bcf9ba', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCC360460>]}
[0m08:23:45.488773 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:23:45.489783 [info ] [MainThread]: 
[0m08:23:45.492809 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:23:45.493840 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:23:45.493840 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:23:45.493840 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:23:45.493840 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:23:45.495198 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:23:45.495198 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:23:45.496324 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:23:45.497328 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:23:45.497328 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:23:45.498487 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:23:45.498487 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:23:45.499674 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:23:45.499674 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:23:45.500680 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:23:45.500680 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:23:45.515878 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:23:45.519881 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:23:45.523885 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:23:45.526888 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:23:45.527888 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:23:45.528889 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:23:45.545169 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:23:45.544166 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:23:45.548256 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:23:45.548256 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:23:45.550266 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:23:45.552281 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:23:45.554751 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:23:45.554751 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:23:45.555757 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:23:45.556760 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:23:45.556760 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:23:45.557816 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:23:45.557816 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:23:45.558864 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:23:45.558864 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:23:45.560880 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:23:45.560880 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:23:45.563070 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:23:46.117994 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.561 seconds
[0m08:23:46.125299 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:23:46.186543 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.625 seconds
[0m08:23:46.187999 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:23:46.201092 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m08:23:46.203109 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:23:46.239584 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.74s]
[0m08:23:46.240590 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:23:46.241601 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:23:46.241601 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:23:46.242683 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:23:46.242683 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:23:46.248710 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:23:46.249737 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:23:46.252751 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:23:46.253756 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:23:46.253756 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:23:46.254765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:23:46.307080 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.81s]
[0m08:23:46.309094 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:23:46.316130 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.82s]
[0m08:23:46.317151 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:23:46.721780 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.468 seconds
[0m08:23:46.723797 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:23:46.841563 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.60s]
[0m08:23:46.842591 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:23:47.092741 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.534 seconds
[0m08:23:47.094843 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:23:47.215944 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.72s]
[0m08:23:47.216955 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:23:47.218062 [info ] [MainThread]: 
[0m08:23:47.219066 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:23:47.240302 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:23:47.246309 [debug] [MainThread]: Using snowflake connection "master"
[0m08:23:47.247310 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:23:47.247310 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:23:48.394282 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.147 seconds
[0m08:23:48.412301 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:23:48.417868 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:23:48.422328 [debug] [MainThread]: Using snowflake connection "master"
[0m08:23:48.422328 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7422552108764648'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8085932731628418'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8176431655883789'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.5988805294036865'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.718616008758545'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched and target.is_active = 'Y' then
      update set TIMESTAMP = source.TIMESTAMP
    when matched and target.is_active = 'N' then
      update set 
        is_active = 'Y',
        deactivated_timestamp = null,
        TIMESTAMP = source.TIMESTAMP
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:23:49.006738 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.583 seconds
[0m08:23:49.006738 [debug] [MainThread]: Using snowflake connection "master"
[0m08:23:49.007739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:23:49.572042 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.564 seconds
[0m08:23:49.573053 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.16s]
[0m08:23:49.574114 [info ] [MainThread]: 
[0m08:23:49.574114 [debug] [MainThread]: On master: Close
[0m08:23:49.692368 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:23:49.693382 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:23:49.693382 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:23:49.693382 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:23:49.694388 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:23:49.694388 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:23:49.695479 [info ] [MainThread]: 
[0m08:23:49.695479 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 5.00 seconds (5.00s).
[0m08:23:49.697566 [debug] [MainThread]: Command end result
[0m08:23:49.733545 [info ] [MainThread]: 
[0m08:23:49.733545 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:23:49.734550 [info ] [MainThread]: 
[0m08:23:49.735555 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:23:49.736560 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:23:49.736560 [info ] [MainThread]: 
[0m08:23:49.738576 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:23:49.738576 [info ] [MainThread]: 
[0m08:23:49.739582 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:23:49.740586 [debug] [MainThread]: Command `dbt test` failed at 08:23:49.740586 after 6.31 seconds
[0m08:23:49.741589 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CB0E6E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCCBEBDC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000020CCCD55C60>]}
[0m08:23:49.741589 [debug] [MainThread]: Flushing usage events
[0m08:25:45.144009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BD60E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C01CA4D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C01CA2F0>]}


============================== 08:25:45.147041 | 73606e42-4869-44c0-8e5d-6efa4ddd0533 ==============================
[0m08:25:45.147041 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:25:45.147041 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:25:45.868377 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '73606e42-4869-44c0-8e5d-6efa4ddd0533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222C0186980>]}
[0m08:25:45.913397 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '73606e42-4869-44c0-8e5d-6efa4ddd0533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BDEC62C0>]}
[0m08:25:45.914406 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:25:45.935069 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:25:46.174291 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m08:25:46.174291 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m08:25:46.175294 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m08:25:46.565228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '73606e42-4869-44c0-8e5d-6efa4ddd0533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D9335420>]}
[0m08:25:46.687661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '73606e42-4869-44c0-8e5d-6efa4ddd0533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D8D9FEE0>]}
[0m08:25:46.688706 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m08:25:46.688706 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73606e42-4869-44c0-8e5d-6efa4ddd0533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D8FD0340>]}
[0m08:25:46.690711 [info ] [MainThread]: 
[0m08:25:46.691869 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:25:46.696303 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:25:46.708169 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:25:46.708169 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:25:46.709174 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:25:47.414669 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.705 seconds
[0m08:25:47.415685 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:25:47.533787 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '73606e42-4869-44c0-8e5d-6efa4ddd0533', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D8D9F310>]}
[0m08:25:47.533787 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:25:47.534924 [info ] [MainThread]: 
[0m08:25:47.538171 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:25:47.538171 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:25:47.539214 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:25:47.539214 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:25:47.540220 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:25:47.540220 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:25:47.541225 [info ] [Thread-3 (]: 3 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:25:47.541225 [info ] [Thread-4 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:25:47.542231 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:25:47.542231 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:25:47.543238 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:25:47.544246 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m08:25:47.544246 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:25:47.544246 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:25:47.545254 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:25:47.545254 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:25:47.560433 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:25:47.564468 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:25:47.568610 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:25:47.574647 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:25:47.575653 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:25:47.576658 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:25:47.583353 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:25:47.592532 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:25:47.595547 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:25:47.595547 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:25:47.598562 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:25:47.600719 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:25:47.601720 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:25:47.602845 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:25:47.602845 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:25:47.603863 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:25:47.603863 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:25:47.604868 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:25:47.604868 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:25:47.605873 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:25:47.605873 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:25:47.606877 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:25:47.607888 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:25:47.609903 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:25:48.211184 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.606 seconds
[0m08:25:48.218232 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:25:48.220245 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.614 seconds
[0m08:25:48.222377 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:25:48.336837 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.79s]
[0m08:25:48.338147 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:25:48.340156 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.80s]
[0m08:25:48.341159 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:25:49.311470 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.701 seconds
[0m08:25:49.313471 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:25:49.435526 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.89s]
[0m08:25:49.436530 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:25:51.328387 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 3.720 seconds
[0m08:25:51.329405 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:25:51.453159 [error] [Thread-3 (]: 3 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 3.91s]
[0m08:25:51.454160 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:25:51.456346 [info ] [MainThread]: 
[0m08:25:51.456346 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:25:51.550203 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:25:51.556898 [debug] [MainThread]: Using snowflake connection "master"
[0m08:25:51.557899 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:25:51.557899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:25:52.546814 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.988 seconds
[0m08:25:52.561040 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:25:52.566062 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:25:52.570098 [debug] [MainThread]: Using snowflake connection "master"
[0m08:25:52.570098 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7946052551269531'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7979245185852051'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8922877311706543'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.9099202156066895'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:25:53.026777 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.455 seconds
[0m08:25:53.026777 [debug] [MainThread]: Using snowflake connection "master"
[0m08:25:53.027780 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:25:53.421113 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.393 seconds
[0m08:25:53.422118 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.86s]
[0m08:25:53.423123 [info ] [MainThread]: 
[0m08:25:53.423123 [debug] [MainThread]: On master: Close
[0m08:25:53.547797 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:25:53.548797 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:25:53.548797 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:25:53.548797 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:25:53.549881 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:25:53.549881 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:25:53.550887 [info ] [MainThread]: 
[0m08:25:53.550887 [info ] [MainThread]: Finished running 4 data tests, 1 project hook in 0 hours 0 minutes and 6.86 seconds (6.86s).
[0m08:25:53.552897 [debug] [MainThread]: Command end result
[0m08:25:53.591557 [info ] [MainThread]: 
[0m08:25:53.592571 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:25:53.592571 [info ] [MainThread]: 
[0m08:25:53.593575 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:25:53.594579 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:25:53.594579 [info ] [MainThread]: 
[0m08:25:53.595751 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:25:53.595751 [info ] [MainThread]: 
[0m08:25:53.596756 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:25:53.597784 [debug] [MainThread]: Command `dbt test` failed at 08:25:53.597784 after 8.51 seconds
[0m08:25:53.598789 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222BD60E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D97AE0E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000222D97AE590>]}
[0m08:25:53.598789 [debug] [MainThread]: Flushing usage events
[0m08:27:05.927745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B4342950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B6F36500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B6F36320>]}


============================== 08:27:05.929996 | 1121374e-64a1-4e1c-9722-507a736270d4 ==============================
[0m08:27:05.929996 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:27:05.930998 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:27:06.669762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1121374e-64a1-4e1c-9722-507a736270d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B45C7A90>]}
[0m08:27:06.714781 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1121374e-64a1-4e1c-9722-507a736270d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B3E13520>]}
[0m08:27:06.715785 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:27:06.736149 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:27:06.976564 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:27:06.976564 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:27:07.024327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1121374e-64a1-4e1c-9722-507a736270d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289CFD4C6A0>]}
[0m08:27:07.189832 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1121374e-64a1-4e1c-9722-507a736270d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289CFD4C340>]}
[0m08:27:07.190839 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m08:27:07.190839 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1121374e-64a1-4e1c-9722-507a736270d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289CFCFC940>]}
[0m08:27:07.192848 [info ] [MainThread]: 
[0m08:27:07.193853 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:27:07.197873 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:27:07.212444 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:27:07.212444 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:27:07.212444 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:27:07.846523 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.633 seconds
[0m08:27:07.848525 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:27:07.970649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1121374e-64a1-4e1c-9722-507a736270d4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289CFD4D510>]}
[0m08:27:07.971655 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:27:07.972660 [info ] [MainThread]: 
[0m08:27:07.974676 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:27:07.975846 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:27:07.975846 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:27:07.976850 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:27:07.976850 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:27:07.977859 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:27:07.977859 [info ] [Thread-3 (]: 3 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:27:07.979053 [info ] [Thread-4 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:27:07.979053 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:27:07.979053 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:27:07.980257 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:27:07.981260 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m08:27:07.981260 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:27:07.981260 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:27:07.982557 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:27:07.982557 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:27:07.996058 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:27:08.000076 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:27:08.004082 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:27:08.008578 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:27:08.009581 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:27:08.020899 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:27:08.020899 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:27:08.026976 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:27:08.029501 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:27:08.030505 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:27:08.032508 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:27:08.035606 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:27:08.036609 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:27:08.036609 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:27:08.037747 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:27:08.037747 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:27:08.039110 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:27:08.039110 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:27:08.040222 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:27:08.040222 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:27:08.041225 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:27:08.041225 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:27:08.041225 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:27:08.043670 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:27:08.651599 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.610 seconds
[0m08:27:08.659007 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:27:08.678075 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.638 seconds
[0m08:27:08.680091 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:27:08.682110 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.641 seconds
[0m08:27:08.683115 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:27:08.777778 [error] [Thread-3 (]: 3 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.80s]
[0m08:27:08.778787 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:27:08.799672 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.82s]
[0m08:27:08.800824 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:27:08.800824 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.82s]
[0m08:27:08.801828 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:27:09.771544 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.728 seconds
[0m08:27:09.773551 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:27:09.893051 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.91s]
[0m08:27:09.894056 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:27:09.896174 [info ] [MainThread]: 
[0m08:27:09.896174 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:27:09.916401 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:27:09.922428 [debug] [MainThread]: Using snowflake connection "master"
[0m08:27:09.923440 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:27:09.923440 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:27:11.097088 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.173 seconds
[0m08:27:11.111407 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:27:11.115493 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:27:11.119526 [debug] [MainThread]: Using snowflake connection "master"
[0m08:27:11.120616 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.797520637512207'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8206188678741455'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8206188678741455'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9127938747406006'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:27:11.591201 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.470 seconds
[0m08:27:11.591201 [debug] [MainThread]: Using snowflake connection "master"
[0m08:27:11.592320 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = current_timestamp
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:27:11.854126 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.261 seconds
[0m08:27:11.855135 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.74s]
[0m08:27:11.856139 [info ] [MainThread]: 
[0m08:27:11.856139 [debug] [MainThread]: On master: Close
[0m08:27:11.982299 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:27:11.983302 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:27:11.983302 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:27:11.984306 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:27:11.984306 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:27:11.985310 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:27:11.985310 [info ] [MainThread]: 
[0m08:27:11.986314 [info ] [MainThread]: Finished running 4 data tests, 1 project hook in 0 hours 0 minutes and 4.79 seconds (4.79s).
[0m08:27:11.987326 [debug] [MainThread]: Command end result
[0m08:27:12.022264 [info ] [MainThread]: 
[0m08:27:12.023270 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:27:12.024276 [info ] [MainThread]: 
[0m08:27:12.025279 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:27:12.025279 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:27:12.026283 [info ] [MainThread]: 
[0m08:27:12.026283 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:27:12.027296 [info ] [MainThread]: 
[0m08:27:12.027296 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:27:12.028452 [debug] [MainThread]: Command `dbt test` failed at 08:27:12.028452 after 6.16 seconds
[0m08:27:12.029456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B4342950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289B3E13520>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000289CFBF4430>]}
[0m08:27:12.029456 [debug] [MainThread]: Flushing usage events
[0m08:29:37.191309 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165DD97E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165E053E500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165E053E320>]}


============================== 08:29:37.193322 | 33f0e4c1-83c7-420d-a7dc-36564ac795de ==============================
[0m08:29:37.193322 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:29:37.194326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:29:37.900865 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '33f0e4c1-83c7-420d-a7dc-36564ac795de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165DDC07DC0>]}
[0m08:29:37.944374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '33f0e4c1-83c7-420d-a7dc-36564ac795de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165DFF6AE00>]}
[0m08:29:37.945377 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:29:37.965006 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:29:38.195021 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:29:38.196026 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m08:29:38.345288 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '33f0e4c1-83c7-420d-a7dc-36564ac795de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F9398130>]}
[0m08:29:38.466698 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '33f0e4c1-83c7-420d-a7dc-36564ac795de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F931B4C0>]}
[0m08:29:38.467708 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m08:29:38.468713 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33f0e4c1-83c7-420d-a7dc-36564ac795de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F8F10BB0>]}
[0m08:29:38.469717 [info ] [MainThread]: 
[0m08:29:38.470722 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:29:38.475241 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:29:38.489321 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:29:38.489321 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:29:38.490468 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:29:39.130161 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.640 seconds
[0m08:29:39.132175 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:29:39.251915 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '33f0e4c1-83c7-420d-a7dc-36564ac795de', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F9398460>]}
[0m08:29:39.253153 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:29:39.253153 [info ] [MainThread]: 
[0m08:29:39.256184 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:29:39.256184 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:29:39.257189 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:29:39.257189 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:29:39.258200 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:29:39.258200 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:29:39.259503 [info ] [Thread-3 (]: 3 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:29:39.259503 [info ] [Thread-4 (]: 4 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:29:39.260507 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:29:39.260507 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:29:39.261518 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:29:39.261518 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321'
[0m08:29:39.262523 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:29:39.262523 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:29:39.263530 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:29:39.263530 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:29:39.277803 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:29:39.280925 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:29:39.284953 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:29:39.289491 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:29:39.290771 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:29:39.291778 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:29:39.291778 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:29:39.307200 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:29:39.310218 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:29:39.311222 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:29:39.313243 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:29:39.316258 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:29:39.317262 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:29:39.318268 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:29:39.318268 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:29:39.319274 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:29:39.319274 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:29:39.320283 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:29:39.320283 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:29:39.321418 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:29:39.321418 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:29:39.322423 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:29:39.323429 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:29:39.325439 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:29:39.861434 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.541 seconds
[0m08:29:39.868446 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:29:39.919634 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.595 seconds
[0m08:29:39.920662 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:29:39.937324 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m08:29:39.938326 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:29:39.986401 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.73s]
[0m08:29:39.987410 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:29:40.040556 [error] [Thread-3 (]: 3 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m08:29:40.041560 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:29:40.062849 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.80s]
[0m08:29:40.063854 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:29:40.887818 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.565 seconds
[0m08:29:40.888837 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:29:41.008913 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.75s]
[0m08:29:41.009925 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:29:41.010933 [info ] [MainThread]: 
[0m08:29:41.012437 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:29:41.032553 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:29:41.038877 [debug] [MainThread]: Using snowflake connection "master"
[0m08:29:41.038877 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:29:41.039883 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:29:42.053112 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.013 seconds
[0m08:29:42.067239 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:29:42.071720 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:29:42.075742 [debug] [MainThread]: Using snowflake connection "master"
[0m08:29:42.076744 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7258942127227783'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7790384292602539'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8013308048248291'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7484056949615479'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:29:42.528804 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.451 seconds
[0m08:29:42.528804 [debug] [MainThread]: Using snowflake connection "master"
[0m08:29:42.529805 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:29:42.745724 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.215 seconds
[0m08:29:42.746858 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.67s]
[0m08:29:42.746858 [info ] [MainThread]: 
[0m08:29:42.748208 [debug] [MainThread]: On master: Close
[0m08:29:42.870582 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:29:42.871608 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:29:42.871608 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:29:42.872708 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:29:42.872708 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:29:42.872708 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:29:42.873712 [info ] [MainThread]: 
[0m08:29:42.873712 [info ] [MainThread]: Finished running 4 data tests, 1 project hook in 0 hours 0 minutes and 4.40 seconds (4.40s).
[0m08:29:42.875718 [debug] [MainThread]: Command end result
[0m08:29:42.912075 [info ] [MainThread]: 
[0m08:29:42.913078 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:29:42.914081 [info ] [MainThread]: 
[0m08:29:42.914081 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:29:42.915084 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:29:42.915084 [info ] [MainThread]: 
[0m08:29:42.916086 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:29:42.916086 [info ] [MainThread]: 
[0m08:29:42.917089 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m08:29:42.918197 [debug] [MainThread]: Command `dbt test` failed at 08:29:42.918197 after 5.78 seconds
[0m08:29:42.919201 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165DD97E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165DFF6AE00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000165F96974C0>]}
[0m08:29:42.919201 [debug] [MainThread]: Flushing usage events
[0m08:30:08.468551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24D5C2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E25017A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E25017A320>]}


============================== 08:30:08.471561 | b0192a82-9e35-458a-9d80-a034adbc4346 ==============================
[0m08:30:08.471561 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:30:08.472571 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt test --select tag:example_1', 'send_anonymous_usage_stats': 'True'}
[0m08:30:09.193904 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b0192a82-9e35-458a-9d80-a034adbc4346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24D84BEB0>]}
[0m08:30:09.238932 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b0192a82-9e35-458a-9d80-a034adbc4346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E268A897E0>]}
[0m08:30:09.239952 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:30:09.259109 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:30:09.494318 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:30:09.495322 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m08:30:09.852592 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b0192a82-9e35-458a-9d80-a034adbc4346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2692E8130>]}
[0m08:30:09.970382 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b0192a82-9e35-458a-9d80-a034adbc4346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2692E81F0>]}
[0m08:30:09.971387 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:30:09.971387 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0192a82-9e35-458a-9d80-a034adbc4346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E268F7CE80>]}
[0m08:30:09.973644 [info ] [MainThread]: 
[0m08:30:09.973644 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:30:09.977900 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:30:09.991330 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:30:09.992336 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:30:09.992336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:30:10.624232 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.632 seconds
[0m08:30:10.625233 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:30:10.751442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b0192a82-9e35-458a-9d80-a034adbc4346', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2692EA260>]}
[0m08:30:10.751442 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:30:10.752594 [info ] [MainThread]: 
[0m08:30:10.755775 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:30:10.755775 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:30:10.756897 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:30:10.756897 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:30:10.757906 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:30:10.757906 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:30:10.758912 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:30:10.759916 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:30:10.760923 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:30:10.760923 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:30:10.761930 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:30:10.761930 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:30:10.762936 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:30:10.762936 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:30:10.763940 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:30:10.763940 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:30:10.779213 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:30:10.783727 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:30:10.787843 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:30:10.791925 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:30:10.792934 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:30:10.793941 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:30:10.802041 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:30:10.813693 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:30:10.816920 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:30:10.816920 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:30:10.820061 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:30:10.823079 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:30:10.824085 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:30:10.825090 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:30:10.825090 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:30:10.825090 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:30:10.826593 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:30:10.826593 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:30:10.827614 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:30:10.827614 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:30:10.828618 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:30:10.828618 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:30:10.830631 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:30:10.831638 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:30:11.375047 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.547 seconds
[0m08:30:11.382060 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:30:11.496429 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.73s]
[0m08:30:11.497435 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:30:11.497435 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:30:11.498439 [info ] [Thread-2 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:30:11.498439 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:30:11.499443 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:30:11.505469 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:30:11.505469 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:30:11.568324 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:30:11.569332 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:30:11.570339 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:30:11.570339 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:30:12.064245 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.493 seconds
[0m08:30:12.065381 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:30:12.276571 [info ] [Thread-2 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.78s]
[0m08:30:12.277572 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:30:12.630674 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.803 seconds
[0m08:30:12.632057 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:30:12.645159 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.814 seconds
[0m08:30:12.646162 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:30:12.673486 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.842 seconds
[0m08:30:12.675499 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:30:12.756382 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 2.00s]
[0m08:30:12.757389 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:30:12.763081 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 2.00s]
[0m08:30:12.764539 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:30:12.795413 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.03s]
[0m08:30:12.796414 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:30:12.797567 [info ] [MainThread]: 
[0m08:30:12.798803 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:30:12.820174 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:30:12.826327 [debug] [MainThread]: Using snowflake connection "master"
[0m08:30:12.826327 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:30:12.827336 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:30:13.785259 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.958 seconds
[0m08:30:13.800960 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:30:13.805205 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:30:13.811405 [debug] [MainThread]: Using snowflake connection "master"
[0m08:30:13.811405 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7345066070556641'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7771313190460205'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.9964654445648193'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.0011513233184814'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.0334832668304443'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:30:14.232006 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.419 seconds
[0m08:30:14.232006 [debug] [MainThread]: Using snowflake connection "master"
[0m08:30:14.233020 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:30:14.515971 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.282 seconds
[0m08:30:14.516981 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.71s]
[0m08:30:14.517984 [info ] [MainThread]: 
[0m08:30:14.517984 [debug] [MainThread]: On master: Close
[0m08:30:14.637608 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:30:14.638612 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:30:14.638612 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:30:14.639617 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:30:14.639617 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:30:14.639617 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:30:14.640621 [info ] [MainThread]: 
[0m08:30:14.640621 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.67 seconds (4.67s).
[0m08:30:14.642760 [debug] [MainThread]: Command end result
[0m08:30:14.678583 [info ] [MainThread]: 
[0m08:30:14.679588 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:30:14.680593 [info ] [MainThread]: 
[0m08:30:14.680593 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:30:14.681595 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:30:14.681595 [info ] [MainThread]: 
[0m08:30:14.682611 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:30:14.682611 [info ] [MainThread]: 
[0m08:30:14.683775 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:30:14.684779 [debug] [MainThread]: Command `dbt test` failed at 08:30:14.684779 after 6.27 seconds
[0m08:30:14.685782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E24D5C2920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2690F1660>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2690F2D40>]}
[0m08:30:14.685782 [debug] [MainThread]: Flushing usage events
[0m08:31:12.981122 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263E802950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226413B6470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226413B6290>]}


============================== 08:31:12.984099 | eefa3fdf-cdcc-405d-ab8c-21e024af463e ==============================
[0m08:31:12.984099 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:31:12.984099 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:31:15.213525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'eefa3fdf-cdcc-405d-ab8c-21e024af463e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263F0B5180>]}
[0m08:31:15.261180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'eefa3fdf-cdcc-405d-ab8c-21e024af463e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002264083B7C0>]}
[0m08:31:15.263191 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:31:15.311490 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:31:16.723621 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:31:16.724624 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:31:16.771887 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'eefa3fdf-cdcc-405d-ab8c-21e024af463e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002265A213EE0>]}
[0m08:31:16.961399 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'eefa3fdf-cdcc-405d-ab8c-21e024af463e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022659E012D0>]}
[0m08:31:16.962415 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:31:16.962415 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eefa3fdf-cdcc-405d-ab8c-21e024af463e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022659D9A0E0>]}
[0m08:31:16.964521 [info ] [MainThread]: 
[0m08:31:16.965526 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:31:16.969539 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:31:16.983617 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:31:16.984618 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:31:16.984618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:17.631806 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.647 seconds
[0m08:31:17.633808 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:31:17.763883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'eefa3fdf-cdcc-405d-ab8c-21e024af463e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022659E4ED10>]}
[0m08:31:17.763883 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:31:17.764887 [info ] [MainThread]: 
[0m08:31:17.768327 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:17.768327 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:17.769332 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:17.769332 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:17.769332 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:31:17.770336 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:31:17.771340 [info ] [Thread-3 (]: 3 of 6 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:31:17.771340 [info ] [Thread-4 (]: 4 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:31:17.772352 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:31:17.772352 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:31:17.773727 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:31:17.773727 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:31:17.774737 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:17.774737 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:17.775743 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:17.775743 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:17.791127 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:31:17.795661 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:31:17.798673 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:31:17.801687 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:31:17.803703 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:17.819167 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:17.820344 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:31:17.821347 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:17.823355 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:31:17.823355 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:17.826390 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:31:17.827395 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:31:17.829403 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:31:17.830405 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:31:17.830405 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:31:17.831415 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:31:17.832431 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:31:17.833436 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:31:17.833436 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:31:17.833436 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:31:17.834441 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:31:17.834441 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:31:17.836556 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:31:17.838570 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:31:18.421504 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.588 seconds
[0m08:31:18.428629 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:31:18.455321 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.620 seconds
[0m08:31:18.456324 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:31:18.547173 [info ] [Thread-1 (]: 1 of 6 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.77s]
[0m08:31:18.548174 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:18.549248 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:18.549248 [info ] [Thread-1 (]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:31:18.550253 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:31:18.551256 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:18.556434 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:31:18.557438 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:18.560451 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:31:18.561454 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:31:18.561454 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:31:18.562460 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:31:18.581274 [info ] [Thread-2 (]: 2 of 6 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.81s]
[0m08:31:18.582288 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:18.583292 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:31:18.583292 [info ] [Thread-2 (]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m08:31:18.584297 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672, now test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493)
[0m08:31:18.584297 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:31:18.588319 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:31:18.589321 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:31:18.593356 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:31:18.594360 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:31:18.594360 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:31:18.595684 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:31:19.095378 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.534 seconds
[0m08:31:19.097390 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:31:19.123689 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.528 seconds
[0m08:31:19.124691 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m08:31:19.216445 [info ] [Thread-1 (]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.67s]
[0m08:31:19.217450 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:19.243525 [info ] [Thread-2 (]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.66s]
[0m08:31:19.244528 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:31:19.333401 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.495 seconds
[0m08:31:19.335471 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:31:19.451585 [error] [Thread-4 (]: 4 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.68s]
[0m08:31:19.452682 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:20.624791 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 2.788 seconds
[0m08:31:20.627793 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:31:20.751066 [info ] [Thread-3 (]: 3 of 6 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 2.98s]
[0m08:31:20.752070 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:20.754079 [info ] [MainThread]: 
[0m08:31:20.754079 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:31:20.777437 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:31:20.783658 [debug] [MainThread]: Using snowflake connection "master"
[0m08:31:20.784658 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:31:20.784658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:31:21.799999 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.015 seconds
[0m08:31:21.818017 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:31:21.823022 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:31:21.830805 [debug] [MainThread]: Using snowflake connection "master"
[0m08:31:21.831833 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7748215198516846'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8089218139648438'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6661927700042725'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6592273712158203'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.6778583526611328'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.977339267730713'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:31:22.402369 [debug] [MainThread]: SQL status: SUCCESS 6 in 0.569 seconds
[0m08:31:22.402369 [debug] [MainThread]: Using snowflake connection "master"
[0m08:31:22.403375 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:31:22.689859 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.285 seconds
[0m08:31:22.690860 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.87s]
[0m08:31:22.692349 [info ] [MainThread]: 
[0m08:31:22.692349 [debug] [MainThread]: On master: Close
[0m08:31:22.814978 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:31:22.815984 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:31:22.815984 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:31:22.816988 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:31:22.816988 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:31:22.816988 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:31:22.817992 [info ] [MainThread]: 
[0m08:31:22.817992 [info ] [MainThread]: Finished running 6 data tests, 1 project hook in 0 hours 0 minutes and 5.85 seconds (5.85s).
[0m08:31:22.820002 [debug] [MainThread]: Command end result
[0m08:31:22.858074 [info ] [MainThread]: 
[0m08:31:22.859077 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:31:22.859077 [info ] [MainThread]: 
[0m08:31:22.860130 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:31:22.861136 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:31:22.861136 [info ] [MainThread]: 
[0m08:31:22.862139 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:31:22.863375 [info ] [MainThread]: 
[0m08:31:22.863375 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:31:22.864632 [debug] [MainThread]: Command `dbt test` failed at 08:31:22.864632 after 9.96 seconds
[0m08:31:22.865633 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002263E802950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000226407DAD10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000022659E4EF20>]}
[0m08:31:22.865633 [debug] [MainThread]: Flushing usage events
[0m08:31:37.364367 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E238BD28F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23B78A410>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23B78A230>]}


============================== 08:31:37.367550 | 1970e064-63f5-4a3d-9b65-19e85fb0065b ==============================
[0m08:31:37.367550 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:31:37.369042 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:31:38.087766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1970e064-63f5-4a3d-9b65-19e85fb0065b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2540F7BB0>]}
[0m08:31:38.134818 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1970e064-63f5-4a3d-9b65-19e85fb0065b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E23AC0B760>]}
[0m08:31:38.135821 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:31:38.156982 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:31:38.385703 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:31:38.385703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:31:38.433069 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1970e064-63f5-4a3d-9b65-19e85fb0065b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2545E3FD0>]}
[0m08:31:38.592601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1970e064-63f5-4a3d-9b65-19e85fb0065b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2545E2AA0>]}
[0m08:31:38.593724 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:31:38.594728 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1970e064-63f5-4a3d-9b65-19e85fb0065b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E254590D60>]}
[0m08:31:38.595731 [info ] [MainThread]: 
[0m08:31:38.596734 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:31:38.601752 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:31:38.614945 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:31:38.615949 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:31:38.615949 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:31:39.280810 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.664 seconds
[0m08:31:39.281810 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:31:39.400870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1970e064-63f5-4a3d-9b65-19e85fb0065b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2545E03D0>]}
[0m08:31:39.402191 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:31:39.402191 [info ] [MainThread]: 
[0m08:31:39.405307 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:39.406313 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:39.406313 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:39.406313 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:39.407324 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:31:39.407324 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:31:39.408343 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:31:39.409348 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:31:39.409348 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:31:39.410354 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:31:39.410354 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:31:39.411360 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:31:39.411360 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:39.412367 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:39.412367 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:39.413475 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:39.426564 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:31:39.430763 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:31:39.433793 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:31:39.437812 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:31:39.438853 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:39.438853 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:39.456352 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:31:39.459501 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:31:39.459501 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:39.459501 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:39.462525 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:31:39.463532 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:31:39.465545 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:31:39.466549 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:31:39.466549 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:31:39.467667 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:31:39.468674 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:31:39.468674 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:31:39.469699 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:31:39.469699 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:31:39.469699 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:31:39.471711 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:31:39.472715 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:31:39.473722 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:31:40.081593 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m08:31:40.088665 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:31:40.089698 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.621 seconds
[0m08:31:40.092730 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:31:40.099518 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.629 seconds
[0m08:31:40.100526 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:31:40.104368 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m08:31:40.106375 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:31:40.210097 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.80s]
[0m08:31:40.212110 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:31:40.212110 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:40.213117 [info ] [Thread-3 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:31:40.213117 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:31:40.214120 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:40.219204 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:31:40.221210 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:40.225232 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:31:40.222215 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.81s]
[0m08:31:40.227249 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:31:40.222215 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.81s]
[0m08:31:40.228254 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:31:40.227249 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.82s]
[0m08:31:40.229257 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:31:40.230258 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:31:40.230258 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:31:40.231747 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:31:40.736217 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.504 seconds
[0m08:31:40.737217 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:31:40.869492 [info ] [Thread-3 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.66s]
[0m08:31:40.870556 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:31:40.871948 [info ] [MainThread]: 
[0m08:31:40.871948 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:31:40.893875 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:31:40.898891 [debug] [MainThread]: Using snowflake connection "master"
[0m08:31:40.899894 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:31:40.899894 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:31:41.881103 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.980 seconds
[0m08:31:41.895564 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:31:41.899158 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:31:41.905180 [debug] [MainThread]: Using snowflake connection "master"
[0m08:31:41.905180 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7997438907623291'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8098509311676025'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8128671646118164'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8179013729095459'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6563758850097656'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:31:42.390585 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.484 seconds
[0m08:31:42.390585 [debug] [MainThread]: Using snowflake connection "master"
[0m08:31:42.391586 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:31:42.811214 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.420 seconds
[0m08:31:42.812315 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.91s]
[0m08:31:42.813319 [info ] [MainThread]: 
[0m08:31:42.814323 [debug] [MainThread]: On master: Close
[0m08:31:43.012824 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:31:43.012824 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:31:43.013829 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:31:43.013829 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:31:43.015009 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:31:43.015009 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:31:43.015009 [info ] [MainThread]: 
[0m08:31:43.016298 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.42 seconds (4.42s).
[0m08:31:43.017311 [debug] [MainThread]: Command end result
[0m08:31:43.053743 [info ] [MainThread]: 
[0m08:31:43.054747 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:31:43.054747 [info ] [MainThread]: 
[0m08:31:43.055752 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:31:43.056949 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:31:43.056949 [info ] [MainThread]: 
[0m08:31:43.057955 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:31:43.057955 [info ] [MainThread]: 
[0m08:31:43.058960 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:31:43.059965 [debug] [MainThread]: Command `dbt test` failed at 08:31:43.059965 after 5.75 seconds
[0m08:31:43.060971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E238BD28F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E238F2F6A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E254AB3A60>]}
[0m08:31:43.060971 [debug] [MainThread]: Flushing usage events
[0m08:35:30.629606 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F96E5BE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F97117A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F97117A320>]}


============================== 08:35:30.632616 | 3a85214e-55ed-4edd-a9da-f5da0d02a5af ==============================
[0m08:35:30.632616 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:35:30.633620 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:35:31.328692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '3a85214e-55ed-4edd-a9da-f5da0d02a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F96E847DC0>]}
[0m08:35:31.373246 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '3a85214e-55ed-4edd-a9da-f5da0d02a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F970BAAE00>]}
[0m08:35:31.374371 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:35:31.395086 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:35:31.616898 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:35:31.617901 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:35:31.663594 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '3a85214e-55ed-4edd-a9da-f5da0d02a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90A053E50>]}
[0m08:35:31.827930 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '3a85214e-55ed-4edd-a9da-f5da0d02a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90A053CA0>]}
[0m08:35:31.828951 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:35:31.828951 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a85214e-55ed-4edd-a9da-f5da0d02a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90A000E80>]}
[0m08:35:31.830960 [info ] [MainThread]: 
[0m08:35:31.830960 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:35:31.836198 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:35:31.851304 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:35:31.851304 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:35:31.851304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:35:32.492955 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.641 seconds
[0m08:35:32.494964 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:35:32.613925 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '3a85214e-55ed-4edd-a9da-f5da0d02a5af', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90A02CEB0>]}
[0m08:35:32.615023 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:35:32.616022 [info ] [MainThread]: 
[0m08:35:32.618539 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:35:32.618539 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:35:32.618539 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:35:32.619546 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:35:32.619546 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:35:32.619546 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:35:32.620785 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:35:32.621898 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:35:32.620785 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:35:32.621898 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:35:32.622978 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:35:32.622978 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:35:32.623983 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:35:32.623983 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:35:32.624989 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:35:32.638224 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:35:32.639228 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:35:32.642254 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:35:32.646548 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:35:32.649570 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:35:32.650575 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:35:32.651579 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:35:32.651579 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:35:32.667846 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:35:32.669855 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:35:32.670870 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:35:32.672877 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:35:32.674971 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:35:32.676975 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:35:32.678360 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:35:32.678360 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:35:32.679363 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:35:32.679363 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:35:32.679363 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:35:32.680839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:35:32.680839 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:35:32.682049 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:35:32.682049 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:35:32.684066 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:35:32.686072 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:35:33.296431 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.612 seconds
[0m08:35:33.297528 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.616 seconds
[0m08:35:33.303554 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:35:33.305585 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:35:33.306592 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.626 seconds
[0m08:35:33.310614 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:35:33.423415 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.80s]
[0m08:35:33.424419 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:35:33.425430 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:35:33.425430 [info ] [Thread-3 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:35:33.426437 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:35:33.426437 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:35:33.432984 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:35:33.427941 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.81s]
[0m08:35:33.433990 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:35:33.434993 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:35:33.434993 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.81s]
[0m08:35:33.439079 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:35:33.439079 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:35:33.440083 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:35:33.441201 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:35:33.441201 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:35:33.990432 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.549 seconds
[0m08:35:33.991446 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:35:34.112074 [info ] [Thread-3 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.69s]
[0m08:35:34.113080 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:35:34.246052 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 1.561 seconds
[0m08:35:34.248067 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:35:34.371708 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.75s]
[0m08:35:34.372722 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:35:34.373726 [info ] [MainThread]: 
[0m08:35:34.374729 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:35:34.396307 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:35:34.401412 [debug] [MainThread]: Using snowflake connection "master"
[0m08:35:34.402420 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:35:34.402420 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:35:35.418040 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.015 seconds
[0m08:35:35.433054 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:35:35.437268 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:35:35.441663 [debug] [MainThread]: Using snowflake connection "master"
[0m08:35:35.442676 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8004374504089355'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8060431480407715'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8130948543548584'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6856365203857422'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7477242946624756'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:35:35.892779 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.449 seconds
[0m08:35:35.892779 [debug] [MainThread]: Using snowflake connection "master"
[0m08:35:35.893792 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Handle deactivation of removed tests in a separate statement
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    )
[0m08:35:36.182199 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.288 seconds
[0m08:35:36.183205 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.74s]
[0m08:35:36.183205 [info ] [MainThread]: 
[0m08:35:36.184209 [debug] [MainThread]: On master: Close
[0m08:35:36.305386 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:35:36.305386 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:35:36.306386 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:35:36.306386 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:35:36.307387 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:35:36.307387 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:35:36.307387 [info ] [MainThread]: 
[0m08:35:36.308416 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.48 seconds (4.48s).
[0m08:35:36.309600 [debug] [MainThread]: Command end result
[0m08:35:36.346065 [info ] [MainThread]: 
[0m08:35:36.347486 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:35:36.347486 [info ] [MainThread]: 
[0m08:35:36.348491 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:35:36.349496 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:35:36.349496 [info ] [MainThread]: 
[0m08:35:36.350501 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:35:36.350501 [info ] [MainThread]: 
[0m08:35:36.351539 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:35:36.352543 [debug] [MainThread]: Command `dbt test` failed at 08:35:36.352543 after 5.78 seconds
[0m08:35:36.353550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F96E5BE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F97059ED40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F90A04B700>]}
[0m08:35:36.353550 [debug] [MainThread]: Flushing usage events
[0m08:35:58.602890 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A92C2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4ABE7A470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4ABE7A290>]}


============================== 08:35:58.605902 | 661659d8-48c4-4c91-bd94-3e412d3c8ec1 ==============================
[0m08:35:58.605902 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:35:58.606904 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt test', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:35:59.306418 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '661659d8-48c4-4c91-bd94-3e412d3c8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A9B77E20>]}
[0m08:35:59.349291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '661659d8-48c4-4c91-bd94-3e412d3c8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4AB2FB7C0>]}
[0m08:35:59.350295 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:35:59.370504 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:35:59.614286 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:35:59.615289 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m08:35:59.758855 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '661659d8-48c4-4c91-bd94-3e412d3c8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C4CDC130>]}
[0m08:35:59.878791 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '661659d8-48c4-4c91-bd94-3e412d3c8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C4CDE4D0>]}
[0m08:35:59.878791 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:35:59.879795 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '661659d8-48c4-4c91-bd94-3e412d3c8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C4C80970>]}
[0m08:35:59.881804 [info ] [MainThread]: 
[0m08:35:59.881804 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:35:59.886821 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:35:59.900071 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:35:59.901074 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:35:59.901074 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:36:00.593396 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.692 seconds
[0m08:36:00.595398 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:36:00.718285 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '661659d8-48c4-4c91-bd94-3e412d3c8ec1', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4C4CDC3D0>]}
[0m08:36:00.719296 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:36:00.719296 [info ] [MainThread]: 
[0m08:36:00.722323 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:36:00.723328 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:36:00.723328 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:36:00.724333 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:36:00.724333 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:36:00.725392 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:36:00.725392 [info ] [Thread-3 (]: 3 of 6 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:36:00.726431 [info ] [Thread-4 (]: 4 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:36:00.727563 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:36:00.728567 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:36:00.728567 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:36:00.729574 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:36:00.729574 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:36:00.730723 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:36:00.730723 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:36:00.731727 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:36:00.746080 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:36:00.750588 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:36:00.753986 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:36:00.757992 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:36:00.758993 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:36:00.760058 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:36:00.761073 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:36:00.776247 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:36:00.778517 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:36:00.779521 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:36:00.781621 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:36:00.782811 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:36:00.784832 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:36:00.786159 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:36:00.786159 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:36:00.787167 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:36:00.787167 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:36:00.788171 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:36:00.788171 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:36:00.789174 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:36:00.789174 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:36:00.791529 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:36:00.792563 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:36:00.793563 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:36:01.291898 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.500 seconds
[0m08:36:01.298948 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:36:01.421733 [info ] [Thread-3 (]: 3 of 6 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.69s]
[0m08:36:01.422745 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:36:01.423752 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:36:01.423752 [info ] [Thread-3 (]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:36:01.424764 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:36:01.424764 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:36:01.429900 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:36:01.430906 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:36:01.433912 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:36:01.434921 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:36:01.435926 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:36:01.435926 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:36:01.938643 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.502 seconds
[0m08:36:01.940652 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:36:02.065293 [info ] [Thread-3 (]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.64s]
[0m08:36:02.066296 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:36:02.066296 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:36:02.067307 [info ] [Thread-3 (]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m08:36:02.068312 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321, now test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493)
[0m08:36:02.068312 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:36:02.072336 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:36:02.073344 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:36:02.076595 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:36:02.077600 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:36:02.077600 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:36:02.078606 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m08:36:02.309265 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.519 seconds
[0m08:36:02.311278 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:36:02.431773 [info ] [Thread-2 (]: 2 of 6 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.70s]
[0m08:36:02.432779 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:36:02.861018 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.783 seconds
[0m08:36:02.862033 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m08:36:02.983360 [info ] [Thread-3 (]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.92s]
[0m08:36:02.984361 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:36:03.601452 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 2.814 seconds
[0m08:36:03.603464 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:36:03.605477 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.812 seconds
[0m08:36:03.607488 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:36:03.728956 [error] [Thread-4 (]: 4 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 3.00s]
[0m08:36:03.729962 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:36:03.730966 [info ] [Thread-1 (]: 1 of 6 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 3.00s]
[0m08:36:03.731975 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:36:03.732978 [info ] [MainThread]: 
[0m08:36:03.732978 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:36:03.754391 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:36:03.760452 [debug] [MainThread]: Using snowflake connection "master"
[0m08:36:03.760452 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:36:03.761459 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:36:04.797458 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.036 seconds
[0m08:36:04.812685 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:36:04.815751 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:36:04.823354 [debug] [MainThread]: Using snowflake connection "master"
[0m08:36:04.824358 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6931660175323486'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.640528678894043'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7042100429534912'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9150476455688477'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.9993820190429688'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '3.0034029483795166'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:36:05.385815 [debug] [MainThread]: SQL status: SUCCESS 6 in 0.561 seconds
[0m08:36:05.385815 [debug] [MainThread]: Using snowflake connection "master"
[0m08:36:05.386816 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Modified deactivation logic to only affect tests for current models
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          )
      select * from current_test_runs
    ) as current_tests
      where regexp_like(dqm.dq_dbt_test_results_central.model_refs, '.*' || current_tests.model_refs || '.*')
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:36:05.734329 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.347 seconds
[0m08:36:05.735335 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.92s]
[0m08:36:05.736341 [info ] [MainThread]: 
[0m08:36:05.736341 [debug] [MainThread]: On master: Close
[0m08:36:05.856391 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:36:05.857398 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:36:05.857398 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:36:05.857398 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:36:05.858402 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:36:05.858402 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:36:05.859414 [info ] [MainThread]: 
[0m08:36:05.859414 [info ] [MainThread]: Finished running 6 data tests, 1 project hook in 0 hours 0 minutes and 5.98 seconds (5.98s).
[0m08:36:05.861421 [debug] [MainThread]: Command end result
[0m08:36:05.896355 [info ] [MainThread]: 
[0m08:36:05.897360 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:36:05.898367 [info ] [MainThread]: 
[0m08:36:05.898367 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:36:05.899371 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:36:05.900480 [info ] [MainThread]: 
[0m08:36:05.900480 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:36:05.901483 [info ] [MainThread]: 
[0m08:36:05.901483 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m08:36:05.903492 [debug] [MainThread]: Command `dbt test` failed at 08:36:05.903492 after 7.36 seconds
[0m08:36:05.903492 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A92C2950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4AB2FB7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F4A9B363B0>]}
[0m08:36:05.904495 [debug] [MainThread]: Flushing usage events
[0m08:37:03.574120 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7D82EA980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DAEAE500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DAEAE320>]}


============================== 08:37:03.576628 | 86b26879-bc54-471d-9c27-cff4122aa84a ==============================
[0m08:37:03.576628 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:37:03.577631 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test --select tag:example_1', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:37:04.273465 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '86b26879-bc54-471d-9c27-cff4122aa84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7D8577DC0>]}
[0m08:37:04.317333 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '86b26879-bc54-471d-9c27-cff4122aa84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7DA8DEE00>]}
[0m08:37:04.318336 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:37:04.339826 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:37:04.571124 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:37:04.572133 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:37:04.618043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '86b26879-bc54-471d-9c27-cff4122aa84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F3D03E50>]}
[0m08:37:04.777544 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '86b26879-bc54-471d-9c27-cff4122aa84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F3D03CA0>]}
[0m08:37:04.777544 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:37:04.778551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b26879-bc54-471d-9c27-cff4122aa84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F3CACE80>]}
[0m08:37:04.780557 [info ] [MainThread]: 
[0m08:37:04.780557 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:37:04.785579 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:37:04.798769 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:37:04.799772 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:37:04.799772 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:37:05.429767 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.630 seconds
[0m08:37:05.431781 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:37:05.550765 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '86b26879-bc54-471d-9c27-cff4122aa84a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F3CE0EB0>]}
[0m08:37:05.550765 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:37:05.551909 [info ] [MainThread]: 
[0m08:37:05.554942 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:37:05.554942 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:37:05.554942 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:37:05.555948 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:37:05.555948 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:37:05.556953 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:37:05.556953 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:37:05.557963 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:37:05.557963 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:37:05.558968 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:37:05.559974 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:37:05.559974 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:37:05.560980 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:37:05.560980 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:37:05.560980 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:37:05.575015 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:37:05.575015 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:37:05.579397 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:37:05.582408 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:37:05.585925 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:37:05.586934 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:37:05.586934 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:37:05.587941 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:37:05.603211 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:37:05.604214 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:37:05.606222 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:37:05.609247 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:37:05.612335 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:37:05.613340 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:37:05.614345 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:37:05.614345 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:37:05.615350 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:37:05.615350 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:37:05.616380 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:37:05.616380 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:37:05.617384 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:37:05.617384 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:37:05.618389 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:37:05.620401 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:37:05.621405 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:37:06.191538 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.574 seconds
[0m08:37:06.192548 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.571 seconds
[0m08:37:06.198659 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:37:06.200690 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:37:06.211505 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.594 seconds
[0m08:37:06.213512 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:37:06.320901 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.76s]
[0m08:37:06.321905 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:37:06.322935 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:37:06.322935 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:37:06.323995 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:37:06.323995 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:37:06.330023 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:37:06.331049 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:37:06.334067 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:37:06.332056 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.77s]
[0m08:37:06.336077 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:37:06.337083 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:37:06.337083 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:37:06.336077 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.78s]
[0m08:37:06.338087 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:37:06.338087 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:37:06.835047 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.497 seconds
[0m08:37:06.837060 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:37:06.962362 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.64s]
[0m08:37:06.963367 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:37:07.306236 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.686 seconds
[0m08:37:07.307243 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:37:07.433299 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 1.87s]
[0m08:37:07.434304 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:37:07.435327 [info ] [MainThread]: 
[0m08:37:07.436331 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:37:07.458454 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:37:07.464559 [debug] [MainThread]: Using snowflake connection "master"
[0m08:37:07.464559 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:37:07.465570 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:37:08.449527 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.984 seconds
[0m08:37:08.463752 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:37:08.467767 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:37:08.474009 [debug] [MainThread]: Using snowflake connection "master"
[0m08:37:08.474009 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7629387378692627'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7720820903778076'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.777108907699585'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6383664608001709'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8743312358856201'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:37:08.965649 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.490 seconds
[0m08:37:08.965649 [debug] [MainThread]: Using snowflake connection "master"
[0m08:37:08.966652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Modified deactivation logic to only affect tests for current models
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          )
      select * from current_test_runs
    ) as current_tests
      where regexp_like(dqm.dq_dbt_test_results_central.model_refs, '.*' || current_tests.model_refs || '.*')
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            '.'::varchar(10000) as model_refs
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:37:09.405521 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.439 seconds
[0m08:37:09.406530 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.94s]
[0m08:37:09.407545 [info ] [MainThread]: 
[0m08:37:09.408627 [debug] [MainThread]: On master: Close
[0m08:37:09.526230 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:37:09.527233 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:37:09.527233 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:37:09.527233 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:37:09.528237 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:37:09.528237 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:37:09.528237 [info ] [MainThread]: 
[0m08:37:09.529240 [info ] [MainThread]: Finished running 5 data tests, 1 project hook in 0 hours 0 minutes and 4.75 seconds (4.75s).
[0m08:37:09.531248 [debug] [MainThread]: Command end result
[0m08:37:09.566833 [info ] [MainThread]: 
[0m08:37:09.567844 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:37:09.568847 [info ] [MainThread]: 
[0m08:37:09.569850 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:37:09.569850 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:37:09.571007 [info ] [MainThread]: 
[0m08:37:09.571007 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:37:09.572011 [info ] [MainThread]: 
[0m08:37:09.572011 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:37:09.573015 [debug] [MainThread]: Command `dbt test` failed at 08:37:09.573015 after 6.06 seconds
[0m08:37:09.574018 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7D82EA980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F41204F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002A7F4059990>]}
[0m08:37:09.574018 [debug] [MainThread]: Flushing usage events
[0m08:38:42.048094 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7477E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7730A470>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7730A290>]}


============================== 08:38:42.050616 | fbc8248e-951f-487a-9c6e-95429ac06396 ==============================
[0m08:38:42.050616 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:38:42.051618 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:38:42.870965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fbc8248e-951f-487a-9c6e-95429ac06396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7502BE20>]}
[0m08:38:42.916881 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fbc8248e-951f-487a-9c6e-95429ac06396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7678B7C0>]}
[0m08:38:42.918882 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:38:42.939814 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:38:43.191565 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:38:43.192568 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m08:38:43.349459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fbc8248e-951f-487a-9c6e-95429ac06396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0FDFD6F0>]}
[0m08:38:43.475055 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fbc8248e-951f-487a-9c6e-95429ac06396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0FE8FA60>]}
[0m08:38:43.475055 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:38:43.476060 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc8248e-951f-487a-9c6e-95429ac06396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F102008E0>]}
[0m08:38:43.478173 [info ] [MainThread]: 
[0m08:38:43.479413 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:38:43.483436 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:38:43.498919 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:38:43.498919 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:38:43.499928 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:44.144909 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.645 seconds
[0m08:38:44.146911 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:38:44.275571 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fbc8248e-951f-487a-9c6e-95429ac06396', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0FE8FC70>]}
[0m08:38:44.275571 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:38:44.276574 [info ] [MainThread]: 
[0m08:38:44.279713 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:44.279713 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:44.279713 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:44.280752 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:44.280752 [info ] [Thread-1 (]: 1 of 6 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:38:44.281758 [info ] [Thread-2 (]: 2 of 6 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:38:44.281758 [info ] [Thread-3 (]: 3 of 6 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:38:44.283768 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:38:44.282763 [info ] [Thread-4 (]: 4 of 6 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:38:44.283768 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:38:44.284777 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:38:44.284777 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:44.285800 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:38:44.285800 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:44.286804 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:44.300257 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:38:44.301262 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:44.304276 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:38:44.308467 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:38:44.312497 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:38:44.313504 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:44.313504 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:44.329801 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:38:44.329801 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:44.332817 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:38:44.332817 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:44.335937 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:38:44.335937 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:38:44.338982 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:38:44.338982 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:38:44.339988 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:38:44.340993 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:38:44.340993 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:38:44.341998 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:38:44.343002 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:38:44.343002 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:38:44.344007 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:38:44.345012 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:38:44.346017 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:38:44.348033 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:38:44.932463 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.585 seconds
[0m08:38:44.939658 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:38:44.966096 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.624 seconds
[0m08:38:44.967159 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:38:45.063851 [error] [Thread-4 (]: 4 of 6 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.78s]
[0m08:38:45.064855 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:45.065859 [debug] [Thread-4 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:45.065859 [info ] [Thread-4 (]: 5 of 6 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:38:45.066861 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:38:45.066861 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:45.073366 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:38:45.074374 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:45.077532 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:38:45.078538 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:38:45.078538 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:38:45.079544 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m08:38:45.084448 [info ] [Thread-1 (]: 1 of 6 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 0.80s]
[0m08:38:45.085707 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:45.085707 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:38:45.086712 [info ] [Thread-1 (]: 6 of 6 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m08:38:45.086712 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4, now test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493)
[0m08:38:45.087725 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:38:45.090800 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:38:45.091808 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:38:45.094900 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:38:45.095905 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:38:45.095905 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:38:45.096911 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:38:45.687991 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.609 seconds
[0m08:38:45.690180 [debug] [Thread-4 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:38:45.726014 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.630 seconds
[0m08:38:45.728528 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m08:38:45.832338 [info ] [Thread-4 (]: 5 of 6 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.77s]
[0m08:38:45.833560 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:45.853445 [info ] [Thread-1 (]: 6 of 6 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.77s]
[0m08:38:45.854450 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:38:45.938900 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 1.592 seconds
[0m08:38:45.939907 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:38:45.964629 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.621 seconds
[0m08:38:45.966804 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:38:46.059689 [info ] [Thread-3 (]: 3 of 6 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 1.77s]
[0m08:38:46.060696 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:46.093900 [info ] [Thread-2 (]: 2 of 6 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 1.81s]
[0m08:38:46.095069 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:46.096078 [info ] [MainThread]: 
[0m08:38:46.097083 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:38:46.120184 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:38:46.125539 [debug] [MainThread]: Using snowflake connection "master"
[0m08:38:46.126548 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:38:46.126548 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:38:47.114741 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.988 seconds
[0m08:38:47.130372 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:38:47.134532 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:38:47.140553 [debug] [MainThread]: Using snowflake connection "master"
[0m08:38:47.141701 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7770466804504395'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8016848564147949'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7654762268066406'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7667331695556641'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.7749125957489014'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.8101325035095215'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:38:47.550992 [debug] [MainThread]: SQL status: SUCCESS 6 in 0.408 seconds
[0m08:38:47.551995 [debug] [MainThread]: Using snowflake connection "master"
[0m08:38:47.551995 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_second_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          )
      select distinct regexp_split_to_table(model_refs, ',') as model_name 
      from current_models 
      where model_refs != ''
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:38:47.744352 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba829c-3201-72e6-000b-f6920001d116
[0m08:38:47.744352 [debug] [MainThread]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function REGEXP_SPLIT_TO_TABLE
[0m08:38:47.745353 [info ] [MainThread]: Database error while running on-run-end
[0m08:38:47.746357 [debug] [MainThread]: On master: Close
[0m08:38:47.864708 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:38:47.865709 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:38:47.865709 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:38:47.865709 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:38:47.866710 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:38:47.866710 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:38:47.868038 [info ] [MainThread]: 
[0m08:38:47.868542 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 4.39 seconds (4.39s).
[0m08:38:47.869549 [debug] [MainThread]: Command end result
[0m08:38:47.907729 [info ] [MainThread]: 
[0m08:38:47.908731 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:38:47.909736 [info ] [MainThread]: 
[0m08:38:47.910743 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:38:47.911747 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:38:47.912761 [info ] [MainThread]: 
[0m08:38:47.913771 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:38:47.913771 [info ] [MainThread]: 
[0m08:38:47.914891 [error] [MainThread]:   on-run-end failed, error:
 002140 (42601): SQL compilation error:
Unknown function REGEXP_SPLIT_TO_TABLE
[0m08:38:47.914891 [info ] [MainThread]: 
[0m08:38:47.915897 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m08:38:47.916905 [debug] [MainThread]: Command `dbt test` failed at 08:38:47.916905 after 5.93 seconds
[0m08:38:47.916905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F7477E950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0FE68E20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F0FE8CAF0>]}
[0m08:38:47.917908 [debug] [MainThread]: Flushing usage events
[0m08:38:55.385705 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA6E22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA99DA4A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA99DA2C0>]}


============================== 08:38:55.389992 | 5003d24c-81ca-4626-a1f5-f451d3aa4d44 ==============================
[0m08:38:55.389992 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:38:55.391010 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test --select tag:example_1', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:38:56.148585 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '5003d24c-81ca-4626-a1f5-f451d3aa4d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA70A7A90>]}
[0m08:38:56.194554 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '5003d24c-81ca-4626-a1f5-f451d3aa4d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC22E97E0>]}
[0m08:38:56.195560 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:38:56.218261 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:38:56.460933 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:38:56.461974 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:38:56.509889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '5003d24c-81ca-4626-a1f5-f451d3aa4d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC2833E50>]}
[0m08:38:56.673221 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '5003d24c-81ca-4626-a1f5-f451d3aa4d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC2312350>]}
[0m08:38:56.674227 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:38:56.675231 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5003d24c-81ca-4626-a1f5-f451d3aa4d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC27DD360>]}
[0m08:38:56.676235 [info ] [MainThread]: 
[0m08:38:56.677239 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:38:56.681276 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:38:56.695689 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:38:56.696695 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:38:56.696695 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:38:57.298196 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.602 seconds
[0m08:38:57.300209 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:38:57.429303 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '5003d24c-81ca-4626-a1f5-f451d3aa4d44', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC23101F0>]}
[0m08:38:57.430321 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:38:57.430321 [info ] [MainThread]: 
[0m08:38:57.433338 [debug] [Thread-1 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:57.434379 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:57.434379 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:57.434379 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:57.435384 [info ] [Thread-1 (]: 1 of 5 START test not_null_my_first_dbt_model_column_1 ......................... [RUN]
[0m08:38:57.435384 [info ] [Thread-2 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:38:57.436389 [info ] [Thread-3 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:38:57.436389 [info ] [Thread-4 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:38:57.437395 [debug] [Thread-1 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4'
[0m08:38:57.437395 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:38:57.438399 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:38:57.439402 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:38:57.439402 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:57.439402 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:57.440423 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:57.440423 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:57.455363 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:38:57.458375 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:38:57.461808 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:38:57.465831 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:38:57.466837 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:38:57.467927 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:57.467927 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:57.483131 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:38:57.486149 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:38:57.486149 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:38:57.489163 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:38:57.492398 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:38:57.493402 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"
[0m08:38:57.493402 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:38:57.494750 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:38:57.495756 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_1
from dev_dwdb.compute_wh.my_first_dbt_model
where column_1 is null



      
    ) dbt_internal_test
[0m08:38:57.495756 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:38:57.496761 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:38:57.496761 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:38:57.497764 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:38:57.497764 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:38:57.498769 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:38:57.498769 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:38:57.500781 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:38:58.085353 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.586 seconds
[0m08:38:58.092360 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:38:58.093687 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.596 seconds
[0m08:38:58.095728 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:38:58.213996 [info ] [Thread-2 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.78s]
[0m08:38:58.216010 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:38:58.216010 [debug] [Thread-2 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:58.216010 [info ] [Thread-3 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.78s]
[0m08:38:58.217014 [info ] [Thread-2 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:38:58.218117 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:38:58.218117 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:38:58.219122 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:58.224143 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:38:58.225150 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:58.227166 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:38:58.228170 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:38:58.229175 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:38:58.229175 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m08:38:58.734497 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.505 seconds
[0m08:38:58.736503 [debug] [Thread-2 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:38:58.855923 [info ] [Thread-2 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.64s]
[0m08:38:58.857942 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:38:59.005073 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.508 seconds
[0m08:38:59.007088 [debug] [Thread-1 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4: Close
[0m08:38:59.126926 [info ] [Thread-1 (]: 1 of 5 PASS not_null_my_first_dbt_model_column_1 ............................... [[32mPASS[0m in 1.69s]
[0m08:38:59.128043 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4
[0m08:39:00.260988 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 2.761 seconds
[0m08:39:00.263008 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:39:00.385333 [error] [Thread-4 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 2.95s]
[0m08:39:00.386337 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:39:00.388459 [info ] [MainThread]: 
[0m08:39:00.388459 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:39:00.416201 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:39:00.423648 [debug] [MainThread]: Using snowflake connection "master"
[0m08:39:00.424651 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:39:00.424651 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:39:01.454472 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.029 seconds
[0m08:39:01.469573 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:39:01.473615 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:39:01.478745 [debug] [MainThread]: Using snowflake connection "master"
[0m08:39:01.479750 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7766005992889404'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.777611255645752'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.6378059387207031'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_1'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.689530611038208'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '2.946934700012207'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:39:02.024087 [debug] [MainThread]: SQL status: SUCCESS 5 in 0.544 seconds
[0m08:39:02.025118 [debug] [MainThread]: Using snowflake connection "master"
[0m08:39:02.026124 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          )
      select distinct regexp_split_to_table(model_refs, ',') as model_name 
      from current_models 
      where model_refs != ''
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_1 from dev_dwdb.compute_wh.my_first_dbt_model where column_1 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:39:02.120083 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba829d-3201-72f1-000b-f6920001c1b2
[0m08:39:02.120083 [debug] [MainThread]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function REGEXP_SPLIT_TO_TABLE
[0m08:39:02.121583 [info ] [MainThread]: Database error while running on-run-end
[0m08:39:02.121583 [debug] [MainThread]: On master: Close
[0m08:39:02.243778 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:02.244779 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:39:02.244779 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_1.632d966eb4' was properly closed.
[0m08:39:02.244779 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:39:02.244779 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:39:02.246205 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:39:02.246205 [info ] [MainThread]: 
[0m08:39:02.247491 [info ] [MainThread]: Finished running 5 data tests in 0 hours 0 minutes and 5.57 seconds (5.57s).
[0m08:39:02.248495 [debug] [MainThread]: Command end result
[0m08:39:02.285361 [info ] [MainThread]: 
[0m08:39:02.285361 [info ] [MainThread]: [31mCompleted with 2 errors and 0 warnings:[0m
[0m08:39:02.286367 [info ] [MainThread]: 
[0m08:39:02.287371 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:39:02.287371 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:39:02.288374 [info ] [MainThread]: 
[0m08:39:02.289375 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:39:02.289375 [info ] [MainThread]: 
[0m08:39:02.290376 [error] [MainThread]:   on-run-end failed, error:
 002140 (42601): SQL compilation error:
Unknown function REGEXP_SPLIT_TO_TABLE
[0m08:39:02.290376 [info ] [MainThread]: 
[0m08:39:02.291377 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=2 SKIP=0 TOTAL=6
[0m08:39:02.291377 [debug] [MainThread]: Command `dbt test` failed at 08:39:02.291377 after 6.96 seconds
[0m08:39:02.292880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA6E22950>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CA8DFF490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000018CC2CC68F0>]}
[0m08:39:02.293881 [debug] [MainThread]: Flushing usage events
[0m08:39:19.736613 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D771128F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D79CD25C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D79CD23E0>]}


============================== 08:39:19.739634 | 4825d648-622f-48d2-8a2c-be2bed630fcc ==============================
[0m08:39:19.739634 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:39:19.740637 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_2', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:39:20.461292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4825d648-622f-48d2-8a2c-be2bed630fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D12662D40>]}
[0m08:39:20.504897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4825d648-622f-48d2-8a2c-be2bed630fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7914B760>]}
[0m08:39:20.506904 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:39:20.527099 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:39:20.753790 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:39:20.753790 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:39:20.802660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4825d648-622f-48d2-8a2c-be2bed630fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D12B78A60>]}
[0m08:39:20.973994 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4825d648-622f-48d2-8a2c-be2bed630fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D12B7ADA0>]}
[0m08:39:20.975092 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:39:20.977101 [info ] [MainThread]: 
[0m08:39:20.978106 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:39:20.979110 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m08:39:20.991516 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m08:39:20.992521 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m08:39:20.992521 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:21.612066 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.619 seconds
[0m08:39:21.614080 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m08:39:21.734904 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:39:21.742431 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:39:21.743436 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:39:21.743436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:39:22.275235 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.531 seconds
[0m08:39:22.276239 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:39:22.399200 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4825d648-622f-48d2-8a2c-be2bed630fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D12B6AB90>]}
[0m08:39:22.399200 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:39:22.400204 [info ] [MainThread]: 
[0m08:39:22.402211 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m08:39:22.403240 [info ] [Thread-1 (]: 1 of 2 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m08:39:22.404247 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m08:39:22.404247 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m08:39:22.411299 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m08:39:22.412467 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m08:39:22.435887 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m08:39:22.437911 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m08:39:22.437911 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m08:39:22.438919 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:39:23.523824 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.085 seconds
[0m08:39:23.540956 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m08:39:23.655647 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4825d648-622f-48d2-8a2c-be2bed630fcc', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D790EC820>]}
[0m08:39:23.655647 [info ] [Thread-1 (]: 1 of 2 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.25s]
[0m08:39:23.656719 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m08:39:23.657724 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:39:23.658729 [info ] [Thread-3 (]: 2 of 2 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m08:39:23.658729 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m08:39:23.659757 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:39:23.667818 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:39:23.668976 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:39:23.682189 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:39:23.683193 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:39:23.684289 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:39:23.684289 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:39:24.335278 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.650 seconds
[0m08:39:24.338290 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m08:39:24.454375 [info ] [Thread-3 (]: 2 of 2 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.80s]
[0m08:39:24.455380 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:39:24.456385 [info ] [MainThread]: 
[0m08:39:24.457391 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:39:24.480721 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:39:24.485847 [debug] [MainThread]: Using snowflake connection "master"
[0m08:39:24.486852 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:39:24.486852 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:39:25.500069 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.013 seconds
[0m08:39:25.513128 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:39:25.517390 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:39:25.519398 [debug] [MainThread]: Using snowflake connection "master"
[0m08:39:25.520401 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7956461906433105'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:39:25.926604 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.405 seconds
[0m08:39:25.926604 [debug] [MainThread]: Using snowflake connection "master"
[0m08:39:25.927605 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          )
      select distinct regexp_split_to_table(model_refs, ',') as model_name 
      from current_models 
      where model_refs != ''
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:39:26.019700 [debug] [MainThread]: Snowflake adapter: Snowflake query id: 01ba829d-3201-72d0-000b-f692000175e2
[0m08:39:26.020701 [debug] [MainThread]: Snowflake adapter: Snowflake error: 002140 (42601): SQL compilation error:
Unknown function REGEXP_SPLIT_TO_TABLE
[0m08:39:26.020701 [info ] [MainThread]: Database error while running on-run-end
[0m08:39:26.021702 [debug] [MainThread]: On master: Close
[0m08:39:26.140130 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:39:26.141136 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m08:39:26.141136 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:39:26.142147 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m08:39:26.142147 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:39:26.143150 [info ] [MainThread]: 
[0m08:39:26.143150 [info ] [MainThread]: Finished running 1 table model, 1 test in 0 hours 0 minutes and 5.17 seconds (5.17s).
[0m08:39:26.144152 [debug] [MainThread]: Command end result
[0m08:39:26.180108 [info ] [MainThread]: 
[0m08:39:26.181111 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:39:26.182116 [info ] [MainThread]: 
[0m08:39:26.183121 [error] [MainThread]:   on-run-end failed, error:
 002140 (42601): SQL compilation error:
Unknown function REGEXP_SPLIT_TO_TABLE
[0m08:39:26.183121 [info ] [MainThread]: 
[0m08:39:26.184125 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
[0m08:39:26.185128 [debug] [MainThread]: Command `dbt build` failed at 08:39:26.185128 after 6.51 seconds
[0m08:39:26.186131 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D771128F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D7914B760>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023D12F27F70>]}
[0m08:39:26.186131 [debug] [MainThread]: Flushing usage events
[0m08:44:07.210835 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D6C6E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D982E620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D982E440>]}


============================== 08:44:07.213909 | 4ac4bc92-e200-44a4-88ff-e5f56ed82d2e ==============================
[0m08:44:07.213909 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:44:07.214912 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_2', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:44:07.931634 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '4ac4bc92-e200-44a4-88ff-e5f56ed82d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D6EF7DC0>]}
[0m08:44:07.976053 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '4ac4bc92-e200-44a4-88ff-e5f56ed82d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F21615D0>]}
[0m08:44:07.978065 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:44:07.999288 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:44:08.237690 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:44:08.238695 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://macros\store_test_results.sql
[0m08:44:08.388910 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '4ac4bc92-e200-44a4-88ff-e5f56ed82d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F2690130>]}
[0m08:44:08.511149 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '4ac4bc92-e200-44a4-88ff-e5f56ed82d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F22C7D90>]}
[0m08:44:08.512154 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:44:08.513158 [info ] [MainThread]: 
[0m08:44:08.514161 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:44:08.515164 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m08:44:08.527308 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m08:44:08.528311 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m08:44:08.528311 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:09.191577 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.664 seconds
[0m08:44:09.193621 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m08:44:09.317537 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:44:09.325078 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:44:09.326077 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:44:09.326077 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:09.873234 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.547 seconds
[0m08:44:09.875248 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:44:09.998550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '4ac4bc92-e200-44a4-88ff-e5f56ed82d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F26AA920>]}
[0m08:44:09.999556 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:44:09.999556 [info ] [MainThread]: 
[0m08:44:10.001586 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m08:44:10.002903 [info ] [Thread-1 (]: 1 of 2 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m08:44:10.003908 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m08:44:10.003908 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m08:44:10.012103 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m08:44:10.013110 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m08:44:10.034829 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m08:44:10.035835 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m08:44:10.036839 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m08:44:10.036839 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:44:11.042236 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.005 seconds
[0m08:44:11.058441 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m08:44:11.185754 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4ac4bc92-e200-44a4-88ff-e5f56ed82d2e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F210FBB0>]}
[0m08:44:11.185754 [info ] [Thread-1 (]: 1 of 2 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.18s]
[0m08:44:11.186757 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m08:44:11.187767 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:11.188774 [info ] [Thread-3 (]: 2 of 2 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m08:44:11.188774 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m08:44:11.189781 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:11.197808 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:44:11.198811 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:11.211943 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:44:11.212947 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:44:11.212947 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:44:11.213951 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:44:11.845580 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.632 seconds
[0m08:44:11.848588 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m08:44:11.978846 [info ] [Thread-3 (]: 2 of 2 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.79s]
[0m08:44:11.979963 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:11.981215 [info ] [MainThread]: 
[0m08:44:11.981215 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:44:12.004716 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:44:12.010739 [debug] [MainThread]: Using snowflake connection "master"
[0m08:44:12.010739 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:44:12.011742 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:44:12.981023 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.969 seconds
[0m08:44:12.994233 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:44:12.998315 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:44:13.001326 [debug] [MainThread]: Using snowflake connection "master"
[0m08:44:13.001326 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7900722026824951'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:44:13.454959 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.452 seconds
[0m08:44:13.454959 [debug] [MainThread]: Using snowflake connection "master"
[0m08:44:13.455963 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:44:14.093024 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.637 seconds
[0m08:44:14.094042 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 1.10s]
[0m08:44:14.095052 [info ] [MainThread]: 
[0m08:44:14.095052 [debug] [MainThread]: On master: Close
[0m08:44:14.209916 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:14.210917 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m08:44:14.210917 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:44:14.210917 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m08:44:14.210917 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:44:14.212411 [info ] [MainThread]: 
[0m08:44:14.212411 [info ] [MainThread]: Finished running 1 table model, 1 test, 1 project hook in 0 hours 0 minutes and 5.70 seconds (5.70s).
[0m08:44:14.213672 [debug] [MainThread]: Command end result
[0m08:44:14.249171 [info ] [MainThread]: 
[0m08:44:14.250175 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:44:14.251178 [info ] [MainThread]: 
[0m08:44:14.251178 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:44:14.253241 [debug] [MainThread]: Command `dbt build` succeeded at 08:44:14.252237 after 7.10 seconds
[0m08:44:14.253241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8D6C6E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F21C3B20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A8F210E3B0>]}
[0m08:44:14.254246 [debug] [MainThread]: Flushing usage events
[0m08:44:29.660850 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC6CDE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC98DA650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC98DA470>]}


============================== 08:44:29.663861 | 1177147d-34c8-4022-9983-c156ebd31ddd ==============================
[0m08:44:29.663861 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:44:29.664864 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt build --select tag:example_2', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m08:44:30.367244 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '1177147d-34c8-4022-9983-c156ebd31ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE21AE230>]}
[0m08:44:30.411525 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '1177147d-34c8-4022-9983-c156ebd31ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE21AF3A0>]}
[0m08:44:30.413535 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:44:30.433919 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:44:30.667634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:44:30.668638 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:44:30.714572 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '1177147d-34c8-4022-9983-c156ebd31ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE26E8B20>]}
[0m08:44:30.881808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '1177147d-34c8-4022-9983-c156ebd31ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE26CDC30>]}
[0m08:44:30.881808 [info ] [MainThread]: Found 1 operation, 2 models, 6 data tests, 840 macros
[0m08:44:30.883822 [info ] [MainThread]: 
[0m08:44:30.885130 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:44:30.886134 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m08:44:30.898629 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m08:44:30.899634 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m08:44:30.899634 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:31.544087 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.645 seconds
[0m08:44:31.546089 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m08:44:31.696079 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:44:31.704126 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:44:31.704126 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:44:31.704126 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:44:32.274074 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.570 seconds
[0m08:44:32.276081 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:44:32.399848 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '1177147d-34c8-4022-9983-c156ebd31ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE26CC1F0>]}
[0m08:44:32.400861 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:44:32.401865 [info ] [MainThread]: 
[0m08:44:32.403872 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m08:44:32.404938 [info ] [Thread-1 (]: 1 of 2 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m08:44:32.406096 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m08:44:32.406096 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m08:44:32.413132 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m08:44:32.414240 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m08:44:32.436623 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m08:44:32.437631 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m08:44:32.438636 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m08:44:32.438636 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:44:33.548287 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.109 seconds
[0m08:44:33.565560 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m08:44:33.685473 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1177147d-34c8-4022-9983-c156ebd31ddd', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE217FBE0>]}
[0m08:44:33.686476 [info ] [Thread-1 (]: 1 of 2 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.28s]
[0m08:44:33.687489 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m08:44:33.688496 [debug] [Thread-3 (]: Began running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:33.688496 [info ] [Thread-3 (]: 2 of 2 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m08:44:33.689499 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493'
[0m08:44:33.690502 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:33.699094 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:44:33.700097 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:33.714426 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:44:33.715430 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"
[0m08:44:33.716433 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_second_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:44:33.716433 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:44:34.308273 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.592 seconds
[0m08:44:34.312413 [debug] [Thread-3 (]: On test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493: Close
[0m08:44:34.439422 [info ] [Thread-3 (]: 2 of 2 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 0.75s]
[0m08:44:34.440427 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493
[0m08:44:34.441432 [info ] [MainThread]: 
[0m08:44:34.441432 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:44:34.465611 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:44:34.471861 [debug] [MainThread]: Using snowflake connection "master"
[0m08:44:34.471861 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:44:34.472868 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:44:35.560935 [debug] [MainThread]: SQL status: SUCCESS 1 in 1.088 seconds
[0m08:44:35.574127 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:44:35.578221 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:44:35.581239 [debug] [MainThread]: Using snowflake connection "master"
[0m08:44:35.581239 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_second_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_second_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.7489063739776611'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:44:36.023196 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.442 seconds
[0m08:44:36.024554 [debug] [MainThread]: Using snowflake connection "master"
[0m08:44:36.025557 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_second_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_second_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:44:36.361429 [debug] [MainThread]: SQL status: SUCCESS 0 in 0.336 seconds
[0m08:44:36.362432 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 0[0m in 0.78s]
[0m08:44:36.363475 [info ] [MainThread]: 
[0m08:44:36.364479 [debug] [MainThread]: On master: Close
[0m08:44:36.490287 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:44:36.491293 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m08:44:36.491293 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:44:36.492307 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m08:44:36.492307 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m08:44:36.492307 [info ] [MainThread]: 
[0m08:44:36.493310 [info ] [MainThread]: Finished running 1 table model, 1 test, 1 project hook in 0 hours 0 minutes and 5.61 seconds (5.61s).
[0m08:44:36.495488 [debug] [MainThread]: Command end result
[0m08:44:36.538266 [info ] [MainThread]: 
[0m08:44:36.538266 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:44:36.539705 [info ] [MainThread]: 
[0m08:44:36.540709 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m08:44:36.542782 [debug] [MainThread]: Command `dbt build` succeeded at 08:44:36.542782 after 6.94 seconds
[0m08:44:36.542782 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABC6CDE9B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE236A080>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002ABE2AABFD0>]}
[0m08:44:36.543787 [debug] [MainThread]: Flushing usage events
[0m08:45:18.833864 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002103652E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210390EE620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210390EE440>]}


============================== 08:45:18.836894 | 217ea278-dd92-4051-b6ef-aaedd9eaa667 ==============================
[0m08:45:18.836894 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:45:18.837898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt build --select tag:example_2', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m08:45:19.566228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '217ea278-dd92-4051-b6ef-aaedd9eaa667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210367B7DC0>]}
[0m08:45:19.611505 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '217ea278-dd92-4051-b6ef-aaedd9eaa667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021051A215D0>]}
[0m08:45:19.612508 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:45:19.632800 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:45:19.872047 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:45:19.873052 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m08:45:20.181575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '217ea278-dd92-4051-b6ef-aaedd9eaa667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021052180130>]}
[0m08:45:20.303777 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '217ea278-dd92-4051-b6ef-aaedd9eaa667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021051B59F60>]}
[0m08:45:20.303777 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m08:45:20.306144 [info ] [MainThread]: 
[0m08:45:20.306144 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:45:20.308161 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m08:45:20.318265 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m08:45:20.319267 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m08:45:20.319267 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:20.951289 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.631 seconds
[0m08:45:20.952290 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m08:45:21.081017 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:45:21.088173 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:45:21.089179 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:45:21.089179 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:45:21.677303 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.588 seconds
[0m08:45:21.678309 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:45:21.807935 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '217ea278-dd92-4051-b6ef-aaedd9eaa667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021051EF0910>]}
[0m08:45:21.807935 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:45:21.808939 [info ] [MainThread]: 
[0m08:45:21.812056 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_second_dbt_model
[0m08:45:21.812056 [info ] [Thread-1 (]: 1 of 1 START sql table model compute_wh.my_second_dbt_model .................... [RUN]
[0m08:45:21.813058 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_second_dbt_model'
[0m08:45:21.814152 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_second_dbt_model
[0m08:45:21.821180 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_second_dbt_model"
[0m08:45:21.821180 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_second_dbt_model
[0m08:45:21.843749 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_second_dbt_model"
[0m08:45:21.844754 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_second_dbt_model"
[0m08:45:21.845759 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_second_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_second_dbt_model
         as
        (-- Use the `ref` function to select from other models

select *
from dev_dwdb.compute_wh.my_first_dbt_model
where id = 1
        );
[0m08:45:21.845759 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:45:22.783658 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.937 seconds
[0m08:45:22.800782 [debug] [Thread-1 (]: On model.dbt_dataops.my_second_dbt_model: Close
[0m08:45:22.921246 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '217ea278-dd92-4051-b6ef-aaedd9eaa667', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000210519CFBB0>]}
[0m08:45:22.922253 [info ] [Thread-1 (]: 1 of 1 OK created sql table model compute_wh.my_second_dbt_model ............... [[32mSUCCESS 1[0m in 1.11s]
[0m08:45:22.923259 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_second_dbt_model
[0m08:45:22.924261 [info ] [MainThread]: 
[0m08:45:22.924261 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:45:22.944605 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:45:22.947639 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:45:22.948646 [debug] [MainThread]: Using snowflake connection "master"
[0m08:45:22.949652 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select 1
[0m08:45:22.949652 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:45:23.441540 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.492 seconds
[0m08:45:23.442546 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.49s]
[0m08:45:23.443546 [info ] [MainThread]: 
[0m08:45:23.444781 [debug] [MainThread]: On master: Close
[0m08:45:23.574664 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:45:23.575665 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m08:45:23.575665 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:45:23.575665 [debug] [MainThread]: Connection 'model.dbt_dataops.my_second_dbt_model' was properly closed.
[0m08:45:23.576666 [info ] [MainThread]: 
[0m08:45:23.576666 [info ] [MainThread]: Finished running 1 table model, 1 project hook in 0 hours 0 minutes and 3.27 seconds (3.27s).
[0m08:45:23.577895 [debug] [MainThread]: Command end result
[0m08:45:23.614787 [info ] [MainThread]: 
[0m08:45:23.615792 [info ] [MainThread]: [32mCompleted successfully[0m
[0m08:45:23.616791 [info ] [MainThread]: 
[0m08:45:23.616791 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m08:45:23.617856 [debug] [MainThread]: Command `dbt build` succeeded at 08:45:23.617856 after 4.84 seconds
[0m08:45:23.618860 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002103652E980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021051F426B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000021051A63730>]}
[0m08:45:23.618860 [debug] [MainThread]: Flushing usage events
[0m08:45:38.649467 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023717ECE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371AA9A500>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371AA9A320>]}


============================== 08:45:38.652487 | 72b64932-361f-4fde-8c43-7f18a57eadce ==============================
[0m08:45:38.652487 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:45:38.653490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test --select tag:example_2', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:45:39.386386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '72b64932-361f-4fde-8c43-7f18a57eadce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023718157DC0>]}
[0m08:45:39.433513 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '72b64932-361f-4fde-8c43-7f18a57eadce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002371A4B6E00>]}
[0m08:45:39.434514 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:45:39.455878 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:45:39.692930 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m08:45:39.692930 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m08:45:39.743663 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '72b64932-361f-4fde-8c43-7f18a57eadce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237338F3DC0>]}
[0m08:45:39.926075 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '72b64932-361f-4fde-8c43-7f18a57eadce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237338F0EE0>]}
[0m08:45:39.927087 [info ] [MainThread]: Found 1 operation, 2 models, 5 data tests, 840 macros
[0m08:45:39.928091 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '72b64932-361f-4fde-8c43-7f18a57eadce', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002373389CB80>]}
[0m08:45:39.929289 [info ] [MainThread]: 
[0m08:45:39.930295 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m08:45:39.932305 [debug] [MainThread]: Command end result
[0m08:45:39.968792 [debug] [MainThread]: Command `dbt test` succeeded at 08:45:39.967785 after 1.38 seconds
[0m08:45:39.968792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000023717ECE980>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237338EA710>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000237338EBE50>]}
[0m08:45:39.969798 [debug] [MainThread]: Flushing usage events
[0m08:46:01.960825 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A624DE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A6508E5C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A6508E3E0>]}


============================== 08:46:01.962840 | 2735cd6d-7ae9-442e-9c35-1a198ad64a04 ==============================
[0m08:46:01.962840 [info ] [MainThread]: Running with dbt=1.8.7
[0m08:46:01.964095 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': 'C:\\Users\\Vignesh\\.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': 'C:\\Users\\Vignesh\\Desktop\\dbt_dataops\\logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt build --select tag:example_1', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m08:46:02.672304 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '2735cd6d-7ae9-442e-9c35-1a198ad64a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A62767EB0>]}
[0m08:46:02.716380 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '2735cd6d-7ae9-442e-9c35-1a198ad64a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A61FD34C0>]}
[0m08:46:02.717383 [info ] [MainThread]: Registered adapter: snowflake=1.8.3
[0m08:46:02.737781 [debug] [MainThread]: checksum: 4af21dafb485259c48497ac86b711ddb1982f3d0f1c0ca4e09356de488b753c0, vars: {}, profile: , target: , version: 1.8.7
[0m08:46:02.969578 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m08:46:02.970585 [debug] [MainThread]: Partial parsing: updated file: dbt_dataops://models\example\schema.yml
[0m08:46:03.336870 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '2735cd6d-7ae9-442e-9c35-1a198ad64a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A7E1EC130>]}
[0m08:46:03.458581 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '2735cd6d-7ae9-442e-9c35-1a198ad64a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A7E1EEC50>]}
[0m08:46:03.459588 [info ] [MainThread]: Found 1 operation, 2 models, 4 data tests, 840 macros
[0m08:46:03.460592 [info ] [MainThread]: 
[0m08:46:03.461596 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m08:46:03.462616 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb'
[0m08:46:03.473776 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb"
[0m08:46:03.473776 [debug] [ThreadPool]: On list_dev_dwdb: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb"} */
show terse schemas in database dev_dwdb
    limit 10000
[0m08:46:03.474787 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:04.208288 [debug] [ThreadPool]: SQL status: SUCCESS 5 in 0.734 seconds
[0m08:46:04.209289 [debug] [ThreadPool]: On list_dev_dwdb: Close
[0m08:46:04.333852 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_dev_dwdb_compute_wh'
[0m08:46:04.340976 [debug] [ThreadPool]: Using snowflake connection "list_dev_dwdb_compute_wh"
[0m08:46:04.341979 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "list_dev_dwdb_compute_wh"} */
show objects in dev_dwdb.compute_wh limit 10000
[0m08:46:04.341979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m08:46:04.899202 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 0.557 seconds
[0m08:46:04.901212 [debug] [ThreadPool]: On list_dev_dwdb_compute_wh: Close
[0m08:46:05.019241 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '2735cd6d-7ae9-442e-9c35-1a198ad64a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A7E1EDC00>]}
[0m08:46:05.020267 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m08:46:05.021272 [info ] [MainThread]: 
[0m08:46:05.023287 [debug] [Thread-1 (]: Began running node model.dbt_dataops.my_first_dbt_model
[0m08:46:05.024346 [info ] [Thread-1 (]: 1 of 5 START sql table model compute_wh.my_first_dbt_model ..................... [RUN]
[0m08:46:05.024346 [debug] [Thread-1 (]: Acquiring new snowflake connection 'model.dbt_dataops.my_first_dbt_model'
[0m08:46:05.025680 [debug] [Thread-1 (]: Began compiling node model.dbt_dataops.my_first_dbt_model
[0m08:46:05.031916 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_dataops.my_first_dbt_model"
[0m08:46:05.033936 [debug] [Thread-1 (]: Began executing node model.dbt_dataops.my_first_dbt_model
[0m08:46:05.056269 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_dataops.my_first_dbt_model"
[0m08:46:05.057369 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_dataops.my_first_dbt_model"
[0m08:46:05.058373 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "model.dbt_dataops.my_first_dbt_model"} */
create or replace transient table dev_dwdb.compute_wh.my_first_dbt_model
         as
        (/*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (
    select 1 as id
    union all
    select null as id
)

select 
    id,
    'value_1' as column_1,
    'value_2' as column_2,
    'value_3' as column_3
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
        );
[0m08:46:05.058373 [debug] [Thread-1 (]: Opening a new connection, currently in state init
[0m08:46:06.144986 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.086 seconds
[0m08:46:06.162161 [debug] [Thread-1 (]: On model.dbt_dataops.my_first_dbt_model: Close
[0m08:46:06.344830 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2735cd6d-7ae9-442e-9c35-1a198ad64a04', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A7D96FB50>]}
[0m08:46:06.345837 [info ] [Thread-1 (]: 1 of 5 OK created sql table model compute_wh.my_first_dbt_model ................ [[32mSUCCESS 1[0m in 1.32s]
[0m08:46:06.346843 [debug] [Thread-1 (]: Finished running node model.dbt_dataops.my_first_dbt_model
[0m08:46:06.347846 [debug] [Thread-3 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:46:06.347846 [debug] [Thread-4 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:46:06.348859 [debug] [Thread-2 (]: Began running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:46:06.348859 [debug] [Thread-1 (]: Began running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:46:06.348859 [info ] [Thread-3 (]: 2 of 5 START test not_null_my_first_dbt_model_column_2 ......................... [RUN]
[0m08:46:06.349863 [info ] [Thread-4 (]: 3 of 5 START test not_null_my_first_dbt_model_column_3 ......................... [RUN]
[0m08:46:06.350978 [info ] [Thread-2 (]: 4 of 5 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m08:46:06.350978 [info ] [Thread-1 (]: 5 of 5 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m08:46:06.351983 [debug] [Thread-3 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672'
[0m08:46:06.351983 [debug] [Thread-4 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf'
[0m08:46:06.352987 [debug] [Thread-2 (]: Acquiring new snowflake connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710'
[0m08:46:06.352987 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.dbt_dataops.my_first_dbt_model, now test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321)
[0m08:46:06.353991 [debug] [Thread-3 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:46:06.353991 [debug] [Thread-4 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:46:06.354996 [debug] [Thread-2 (]: Began compiling node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:46:06.354996 [debug] [Thread-1 (]: Began compiling node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:46:06.365277 [debug] [Thread-3 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:46:06.368384 [debug] [Thread-4 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:46:06.372421 [debug] [Thread-2 (]: Writing injected SQL for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:46:06.377442 [debug] [Thread-1 (]: Writing injected SQL for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:46:06.378447 [debug] [Thread-3 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:46:06.379454 [debug] [Thread-4 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:46:06.391711 [debug] [Thread-3 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:46:06.392715 [debug] [Thread-2 (]: Began executing node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:46:06.392715 [debug] [Thread-1 (]: Began executing node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:46:06.395726 [debug] [Thread-4 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:46:06.453841 [debug] [Thread-2 (]: Writing runtime sql for node "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:46:06.456855 [debug] [Thread-1 (]: Writing runtime sql for node "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:46:06.456855 [debug] [Thread-3 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"
[0m08:46:06.458918 [debug] [Thread-4 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"
[0m08:46:06.458918 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_2
from dev_dwdb.compute_wh.my_first_dbt_model
where column_2 is null



      
    ) dbt_internal_test
[0m08:46:06.459923 [debug] [Thread-2 (]: Using snowflake connection "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"
[0m08:46:06.459923 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select column_3
from dev_dwdb.compute_wh.my_first_dbt_model
where column_3 is null



      
    ) dbt_internal_test
[0m08:46:06.460929 [debug] [Thread-1 (]: Using snowflake connection "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"
[0m08:46:06.460929 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m08:46:06.461942 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from dev_dwdb.compute_wh.my_first_dbt_model
where id is null



      
    ) dbt_internal_test
[0m08:46:06.461942 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m08:46:06.462950 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "node_id": "test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

select
    id as unique_field,
    count(*) as n_records

from dev_dwdb.compute_wh.my_first_dbt_model
where id is not null
group by id
having count(*) > 1



      
    ) dbt_internal_test
[0m08:46:06.463955 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m08:46:06.465964 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m08:46:07.083770 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.618 seconds
[0m08:46:07.087803 [debug] [Thread-1 (]: On test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321: Close
[0m08:46:07.132902 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.671 seconds
[0m08:46:07.134916 [debug] [Thread-4 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf: Close
[0m08:46:07.140993 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.680 seconds
[0m08:46:07.143007 [debug] [Thread-3 (]: On test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672: Close
[0m08:46:07.213860 [info ] [Thread-1 (]: 5 of 5 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.86s]
[0m08:46:07.214873 [debug] [Thread-1 (]: Finished running node test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321
[0m08:46:07.257640 [info ] [Thread-4 (]: 3 of 5 PASS not_null_my_first_dbt_model_column_3 ............................... [[32mPASS[0m in 0.91s]
[0m08:46:07.258653 [debug] [Thread-4 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf
[0m08:46:07.260760 [info ] [Thread-3 (]: 2 of 5 PASS not_null_my_first_dbt_model_column_2 ............................... [[32mPASS[0m in 0.91s]
[0m08:46:07.261885 [debug] [Thread-3 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672
[0m08:46:08.032044 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.568 seconds
[0m08:46:08.034054 [debug] [Thread-2 (]: On test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710: Close
[0m08:46:08.186667 [error] [Thread-2 (]: 4 of 5 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.83s]
[0m08:46:08.187785 [debug] [Thread-2 (]: Finished running node test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710
[0m08:46:08.189801 [info ] [MainThread]: 
[0m08:46:08.189801 [info ] [MainThread]: Running 1 on-run-end hook
[0m08:46:08.213762 [info ] [MainThread]: {'my_second_dbt_model': 'compute_wh', 'my_first_dbt_model': 'compute_wh'}
[0m08:46:08.219960 [debug] [MainThread]: Using snowflake connection "master"
[0m08:46:08.220474 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
select distinct
            table_schema as "table_schema",
            table_name as "table_name",
            
            case table_type
                when 'BASE TABLE' then 'table'
                when 'EXTERNAL TABLE' then 'external'
                when 'MATERIALIZED VIEW' then 'materializedview'
                else lower(table_type)
            end as "table_type"

        from dev_dwdb.information_schema.tables
        where table_schema ilike 'DQM'
        and table_name ilike 'DQ_DBT_TEST_RESULTS_CENTRAL'
        and table_name not ilike ''
[0m08:46:08.220987 [debug] [MainThread]: Opening a new connection, currently in state init
[0m08:46:09.171266 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.950 seconds
[0m08:46:09.186279 [debug] [MainThread]: Writing injected SQL for node "operation.dbt_dataops.dbt_dataops-on-run-end-0"
[0m08:46:09.190310 [info ] [MainThread]: 1 of 1 START hook: dbt_dataops.on-run-end.0 .................................... [RUN]
[0m08:46:09.194922 [debug] [MainThread]: Using snowflake connection "master"
[0m08:46:09.195926 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
merge into dqm.dq_dbt_test_results_central as target using (
      with current_test_runs as (select
            md5(cast(coalesce(cast('unique' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'unique'::varchar(4000) as test_name,
            'unique_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.8608729839324951'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_3'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9056580066680908'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_column_2'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '0.9087774753570557'::text as execution_time_seconds,
            'pass'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          union all select
            md5(cast(coalesce(cast('not_null' as TEXT), '_dbt_utils_surrogate_key_null_') || '-' || coalesce(cast(current_time as TEXT), '_dbt_utils_surrogate_key_null_') as TEXT)) as test_sk,
            'not_null'::varchar(4000) as test_name,
            'not_null_my_first_dbt_model_id'::varchar(10000) as test_name_long,
            'generic'::varchar(250) as test_type,
            'compute_wh.my_first_dbt_model'::varchar(10000) as model_refs,
            ''::varchar(10000) as source_refs,
            'ERROR'::varchar(250) as test_severity_config,
            '1.83367919921875'::text as execution_time_seconds,
            'fail'::varchar(125) as test_result,
            'models\example\schema.yml'::varchar(4000) as file_test_defined,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql,
            convert_timezone('America/New_York', current_timestamp::timestamp_ntz) as TIMESTAMP
          )
      select 
        s.*,
        'Y' as is_active,
        null as deactivated_timestamp
      from current_test_runs s
    ) as source 
      on target.test_name = source.test_name 
      and target.compiled_sql = source.compiled_sql
    when matched then
      update set 
        TIMESTAMP = convert_timezone('America/New_York', current_timestamp::timestamp_ntz),
        is_active = 'Y',
        deactivated_timestamp = null
    when not matched then
      insert (
        test_sk, test_name, test_name_long, test_type, model_refs,
        source_refs, test_severity_config, execution_time_seconds,
        test_result, file_test_defined, compiled_sql, TIMESTAMP,
        is_active, deactivated_timestamp
      )
      values (
        source.test_sk, source.test_name, source.test_name_long, 
        source.test_type, source.model_refs, source.source_refs,
        source.test_severity_config, source.execution_time_seconds,
        source.test_result, source.file_test_defined,
        source.compiled_sql, source.TIMESTAMP,
        'Y', null
      );
[0m08:46:09.682833 [debug] [MainThread]: SQL status: SUCCESS 4 in 0.486 seconds
[0m08:46:09.682833 [debug] [MainThread]: Using snowflake connection "master"
[0m08:46:09.683837 [debug] [MainThread]: On master: /* {"app": "dbt", "dbt_version": "1.8.7", "profile_name": "dbt_dataops", "target_name": "dev", "connection_name": "master"} */
-- Get current models being tested
    

    -- Handle deactivation of removed tests, but only for models currently being tested
    update dqm.dq_dbt_test_results_central
    set is_active = 'N',
        deactivated_timestamp = convert_timezone('America/New_York', current_timestamp::timestamp_ntz)
    where is_active = 'Y'
    and exists (
      select 1 
      from (
      with current_models as (select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          union all select 'compute_wh.my_first_dbt_model' as model_refs
          ),
      split_models as (
        select distinct value as model_name
        from current_models,
        lateral flatten(input => split(model_refs, ','))
        where model_refs != ''
      )
      select * from split_models
    ) as current_models
      where dqm.dq_dbt_test_results_central.model_refs like '%' || current_models.model_name || '%'
    )
    and not exists (
      select 1 
      from (
      with current_test_runs as (select
            'unique'::varchar(4000) as test_name,
            'select     id as unique_field,     count(*) as n_records  from dev_dwdb.compute_wh.my_first_dbt_model where id is not null group by id having count(*) > 1'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_3 from dev_dwdb.compute_wh.my_first_dbt_model where column_3 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select column_2 from dev_dwdb.compute_wh.my_first_dbt_model where column_2 is null'::varchar(65535) as compiled_sql
          union all select
            'not_null'::varchar(4000) as test_name,
            'select id from dev_dwdb.compute_wh.my_first_dbt_model where id is null'::varchar(65535) as compiled_sql
          )
      select * from current_test_runs
    ) as current_tests
      where current_tests.test_name = dqm.dq_dbt_test_results_central.test_name
      and current_tests.compiled_sql = dqm.dq_dbt_test_results_central.compiled_sql
    );
[0m08:46:10.140790 [debug] [MainThread]: SQL status: SUCCESS 1 in 0.456 seconds
[0m08:46:10.141791 [info ] [MainThread]: 1 of 1 OK hook: dbt_dataops.on-run-end.0 ....................................... [[32mSUCCESS 1[0m in 0.95s]
[0m08:46:10.142922 [info ] [MainThread]: 
[0m08:46:10.142922 [debug] [MainThread]: On master: Close
[0m08:46:10.260981 [debug] [MainThread]: Connection 'master' was properly closed.
[0m08:46:10.260981 [debug] [MainThread]: Connection 'list_dev_dwdb' was properly closed.
[0m08:46:10.261982 [debug] [MainThread]: Connection 'list_dev_dwdb_compute_wh' was properly closed.
[0m08:46:10.261982 [debug] [MainThread]: Connection 'test.dbt_dataops.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m08:46:10.262983 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_2.6659e88672' was properly closed.
[0m08:46:10.262983 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_column_3.9fa4761bcf' was properly closed.
[0m08:46:10.263995 [debug] [MainThread]: Connection 'test.dbt_dataops.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m08:46:10.263995 [info ] [MainThread]: 
[0m08:46:10.265069 [info ] [MainThread]: Finished running 1 table model, 4 data tests, 1 project hook in 0 hours 0 minutes and 6.80 seconds (6.80s).
[0m08:46:10.266074 [debug] [MainThread]: Command end result
[0m08:46:10.301072 [info ] [MainThread]: 
[0m08:46:10.302171 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m08:46:10.303199 [info ] [MainThread]: 
[0m08:46:10.303199 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models\example\schema.yml)[0m
[0m08:46:10.304203 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m08:46:10.305206 [info ] [MainThread]: 
[0m08:46:10.305206 [info ] [MainThread]:   compiled code at target\compiled\dbt_dataops\models\example\schema.yml\not_null_my_first_dbt_model_id.sql
[0m08:46:10.306294 [info ] [MainThread]: 
[0m08:46:10.306294 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m08:46:10.307298 [debug] [MainThread]: Command `dbt build` failed at 08:46:10.307298 after 8.40 seconds
[0m08:46:10.308301 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A624DE920>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A61FD0310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026A61FD34C0>]}
[0m08:46:10.308301 [debug] [MainThread]: Flushing usage events
